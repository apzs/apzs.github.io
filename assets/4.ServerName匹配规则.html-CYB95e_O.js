import{_ as t}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as o,o as s,c as d,a,b as e,d as p,e as n}from"./app-db_OQQsY.js";const c={},i=n(`<h2 id="servername匹配规则" tabindex="-1"><a class="header-anchor" href="#servername匹配规则" aria-hidden="true">#</a> ServerName匹配规则</h2><p>我们可以在同一个servername中配置多个域名</p><h3 id="完整匹配" tabindex="-1"><a class="header-anchor" href="#完整匹配" aria-hidden="true">#</a> 完整匹配</h3><p>server中可以配置多个域名，例如：</p><pre><code>server_name  test81.xzj520520.cn  test82.xzj520520.cn;
</code></pre><h3 id="通配符匹配" tabindex="-1"><a class="header-anchor" href="#通配符匹配" aria-hidden="true">#</a> 通配符匹配</h3><p>使用通配符的方式如下：</p><pre><code>server_name  *.xzj520520.cn;
</code></pre>`,8),h={href:"https://so.csdn.net/so/search?q=%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D&spm=1001.2101.3001.7020",target:"_blank",rel:"noopener noreferrer"},_=n(`<h3 id="通配符结束匹配" tabindex="-1"><a class="header-anchor" href="#通配符结束匹配" aria-hidden="true">#</a> 通配符结束匹配</h3><p>使用通配符结束匹配的方式如下：</p><pre><code>server_name  www.xzj520520.*;
</code></pre><h3 id="正则匹配" tabindex="-1"><a class="header-anchor" href="#正则匹配" aria-hidden="true">#</a> 正则匹配</h3><p>采用正则的匹配方式如下:</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/41d0a93f50338db6ed3b62480fc92319.png" alt="image-20220430170058418" tabindex="0" loading="lazy"><figcaption>image-20220430170058418</figcaption></figure><p>访问结果如下：</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/fec34ecd0651686a90d97ddd18d21ae3.png" alt="image-20220430170141303" tabindex="0" loading="lazy"><figcaption>image-20220430170141303</figcaption></figure>`,8),l=a("code",null,"~",-1),m=a("code",null,"server_name ~^www\\d+\\.example\\.net$;",-1),x=a("code",null,"~",-1),f=a("code",null,"^",-1),g=a("code",null,"$",-1),u=a("code",null,".",-1),b=a("code",null,".",-1),v={href:"https://so.csdn.net/so/search?q=%E8%BD%AC%E4%B9%89&spm=1001.2101.3001.7020",target:"_blank",rel:"noopener noreferrer"},z=a("code",null,"{",-1),w=a("code",null,"}",-1),E=a("code",null,'directive "server_name" is not terminated by ";" in ...',-1),k=n(`<h3 id="特殊匹配格式" tabindex="-1"><a class="header-anchor" href="#特殊匹配格式" aria-hidden="true">#</a> 特殊匹配格式</h3><pre><code>server_name &quot;&quot;; 匹配Host请求头不存在的情况。
</code></pre><h3 id="匹配顺序" tabindex="-1"><a class="header-anchor" href="#匹配顺序" aria-hidden="true">#</a> 匹配顺序</h3><pre><code>1. 精确的名字
2. 以*号开头的最长通配符名称，例如 *.example.org
3. 以*号结尾的最长通配符名称，例如 mail.*
4. 第一个匹配的正则表达式（在配置文件中出现的顺序）
</code></pre><h3 id="优化" tabindex="-1"><a class="header-anchor" href="#优化" aria-hidden="true">#</a> 优化</h3><pre><code>1. 尽量使用精确匹配;
2. 当定义大量server_name时或特别长的server_name时，需要在http级别调整server_names_hash_max_size和server_names_hash_bucket_size，否则nginx将无法启动。
</code></pre><p><strong>附录</strong>：</p><p>为区分大小写的匹配</p><p>~* 不区分大小写的匹配（匹配firefox的正则同时匹配FireFox）</p><p>!~ 区分大小写不匹配</p><p>!~* 不区分大小写不匹配</p><p>. 匹配除换行符以外的任意字符</p><p>\\w 匹配字母或数字或下划线或汉字</p><p>\\s 匹配任意的空白符</p><p>\\d 匹配数字</p><p>\\b 匹配单词的开始或结束</p><p>^ 匹配字符串的开始</p><p>$ 匹配字符串的结束</p><p>*重复零次或更多次前面一个字符</p><p>+重复一次或更多次前面一个字符</p><p>? 重复零次或一次前面一个字符</p><p>{n} 重复n次前面一个字符{n,} 重复n次或更多次</p><p>{n,m} 重复n到m次</p><p>*? 重复任意次，但尽可能少重复</p><p>+? 重复1次或更多次，但尽可能少重复</p><p>?? 重复0次或1次，但尽可能少重复{n,m}? 重复n到m次，但尽可能少重复{n,}? 重复n次以上，但尽可能少重复</p><p>\\W 匹配任意不是字母，数字，下划线，汉字的字符</p><p>\\S 匹配任意不是空白符的字符</p><p>\\D 匹配任意非数字的字符</p><p>\\B 匹配不是单词开头或结束的位置</p><p>[^x] 匹配除了x以外的任意字符</p><p>[^abc] 匹配除了abc这几个字母以外的任意字符</p><p>(exp) 匹配exp,并捕获文本到0…9</p><p>(?exp) 匹配exp,并捕获文本到名称为name的组里，也可以写成(?&#39;name’exp)(?:exp) 匹配exp,不捕获匹配的文本，也不给此分组分配组号</p><p>(?=exp) 零宽断言,匹配exp前面的位置</p><p>(?&lt;=exp) 匹配exp后面的位置</p><p>(?!exp) 匹配后面跟的不是exp的位置</p><p>(?&lt;!exp) 匹配前面不是exp的位置</p><p>(?#comment) 注释,这种类型的分组不对正则表达式的处理产生任何影响，用于提供注释让人阅读</p>`,39);function B(N,S){const r=o("ExternalLinkIcon");return s(),d("div",null,[i,a("p",null,[e("需要注意的是精确匹配的优先级大于通配符匹配和"),a("a",h,[e("正则匹配"),p(r)]),e("。")]),_,a("p",null,[e("正则匹配格式，必须以"),l,e("开头，比如："),m,e("。如果开头没有"),x,e("，则nginx认为是精确匹配。在逻辑上，需要添加"),f,e("和"),g,e("锚定符号。注意，正则匹配格式中"),u,e("为正则元字符，如果需要匹配"),b,e("，则需要反斜线"),a("a",v,[e("转义"),p(r)]),e("。如果正则匹配中含有"),z,e("和"),w,e("则需要双引号引用起来，避免nginx报错，如果没有加双引号，则nginx会报如下错误："),E,e("。")]),k])}const D=t(c,[["render",B],["__file","4.ServerName匹配规则.html.vue"]]);export{D as default};
