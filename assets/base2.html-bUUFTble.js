import{_ as p}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as o,o as c,c as i,a,b as n,d as t,e}from"./app-ldxHvpH7.js";const l={},u=e(`<h1 id="å››ã€å‰åç«¯è”è°ƒ" tabindex="-1"><a class="header-anchor" href="#å››ã€å‰åç«¯è”è°ƒ" aria-hidden="true">#</a> å››ã€å‰åç«¯è”è°ƒ</h1><h2 id="_4-1ã€å•†å“æœåŠ¡-api-ä¸‰çº§åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#_4-1ã€å•†å“æœåŠ¡-api-ä¸‰çº§åˆ†ç±»" aria-hidden="true">#</a> 4.1ã€å•†å“æœåŠ¡-API-ä¸‰çº§åˆ†ç±»</h2><h3 id="_4-1-1ã€å•†å“æœåŠ¡-api-ä¸‰çº§åˆ†ç±»åç«¯" tabindex="-1"><a class="header-anchor" href="#_4-1-1ã€å•†å“æœåŠ¡-api-ä¸‰çº§åˆ†ç±»åç«¯" aria-hidden="true">#</a> 4.1.1ã€å•†å“æœåŠ¡-API-ä¸‰çº§åˆ†ç±»åç«¯</h3><h4 id="_1ã€å…ˆæ‰§è¡Œsql" tabindex="-1"><a class="header-anchor" href="#_1ã€å…ˆæ‰§è¡Œsql" aria-hidden="true">#</a> 1ã€å…ˆæ‰§è¡Œsql</h4><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.1.1.png" alt="image-20220426164247687" tabindex="0" loading="lazy"><figcaption>image-20220426164247687</figcaption></figure><h4 id="_2ã€ä¿®æ”¹com-atguigu-gulimall-product-controller-categorycontrollerçš„listæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹com-atguigu-gulimall-product-controller-categorycontrollerçš„listæ–¹æ³•" aria-hidden="true">#</a> 2ã€ä¿®æ”¹<code>com.atguigu.gulimall.product.controller.CategoryController</code>çš„listæ–¹æ³•</h4><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.1.2.1.png" alt="image-20220426164551505" tabindex="0" loading="lazy"><figcaption>image-20220426164551505</figcaption></figure><p>æ”¹ä¸º</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token doc-comment comment">/**
     * æŸ¥è¯¢åˆ†ç±»å‡ å­åˆ†ç±»ï¼Œä»¥æ ‘çŠ¶å½¢å¼ç»„è£…
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/list&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryEntity</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> categoryService<span class="token punctuation">.</span><span class="token function">listWithTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.1.2.2.png" alt="image-20220426164901518" tabindex="0" loading="lazy"><figcaption>image-20220426164901518</figcaption></figure><h4 id="_3ã€å®ç°categoryserviceçš„listwithtreeæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€å®ç°categoryserviceçš„listwithtreeæ–¹æ³•" aria-hidden="true">#</a> 3ã€å®ç°<code>CategoryService</code>çš„<code>listWithTree</code>æ–¹æ³•</h4><h5 id="_1ã€categoryserviceæ¥å£æ·»åŠ æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€categoryserviceæ¥å£æ·»åŠ æ–¹æ³•" aria-hidden="true">#</a> 1ã€CategoryServiceæ¥å£æ·»åŠ æ–¹æ³•</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">listWithTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.1.3.1.png" alt="image-20220426165019336" tabindex="0" loading="lazy"><figcaption>image-20220426165019336</figcaption></figure><h5 id="_2ã€å…ˆæŸ¥è¯¢æ‰€æœ‰" tabindex="-1"><a class="header-anchor" href="#_2ã€å…ˆæŸ¥è¯¢æ‰€æœ‰" aria-hidden="true">#</a> 2ã€å…ˆæŸ¥è¯¢æ‰€æœ‰</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">listWithTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//baseMapperå°±æ˜¯ServiceImpl&lt;CategoryDao, CategoryEntity&gt;ä¸­çš„CategoryDao</span>
    <span class="token comment">//æŸ¥è¯¢æ‰€æœ‰åˆ†ç±»</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryEntity</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> baseMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> list<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.1.3.2.png" alt="image-20220426170219018" tabindex="0" loading="lazy"><figcaption>image-20220426170219018</figcaption></figure><h5 id="_3ã€æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_3ã€æµ‹è¯•" aria-hidden="true">#</a> 3ã€æµ‹è¯•</h5><p>http://localhost:10000/product/category/list/tree</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.1.3.3.png" alt="image-20220426170316381" tabindex="0" loading="lazy"><figcaption>image-20220426170316381</figcaption></figure><h5 id="_4ã€å®ä½“æ·»åŠ å±æ€§" tabindex="-1"><a class="header-anchor" href="#_4ã€å®ä½“æ·»åŠ å±æ€§" aria-hidden="true">#</a> 4ã€å®ä½“æ·»åŠ å±æ€§</h5><p>åœ¨<code>com.atguigu.gulimall.product.entity.CategoryEntity</code>ç±»æ·»åŠ <code>children</code>å­—æ®µ</p><p><code>children</code>å­—æ®µä¸ºå…¶ä¸‹ä¸€çº§åˆ†ç±»ï¼ˆå…±æœ‰ä¸‰çº§åˆ†ç±»ï¼‰</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.1.3.4.png" alt="image-20220426172202666" tabindex="0" loading="lazy"><figcaption>image-20220426172202666</figcaption></figure><h5 id="_5ã€ä¿®æ”¹serviceå±‚ä»£ç " tabindex="-1"><a class="header-anchor" href="#_5ã€ä¿®æ”¹serviceå±‚ä»£ç " aria-hidden="true">#</a> 5ã€ä¿®æ”¹Serviceå±‚ä»£ç </h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">listWithTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//baseMapperå°±æ˜¯ServiceImpl&lt;CategoryDao, CategoryEntity&gt;ä¸­çš„CategoryDao</span>
        <span class="token comment">//æŸ¥è¯¢æ‰€æœ‰åˆ†ç±»</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryEntity</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> baseMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryEntity</span><span class="token punctuation">&gt;</span></span> topCategory <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">//æŸ¥å‡ºä¸€çº§åˆ†ç±»</span>
                <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>categoryEntity <span class="token operator">-&gt;</span> categoryEntity<span class="token punctuation">.</span><span class="token function">getParentCid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token comment">//æ˜ å°„æ–¹æ³•ï¼Œæ”¹å˜å¯¹è±¡ç»“æ„</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span>
                    menu<span class="token punctuation">.</span><span class="token function">setChildren</span><span class="token punctuation">(</span><span class="token function">getAllChildren</span><span class="token punctuation">(</span>menu<span class="token punctuation">,</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> menu<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token comment">//æ ¹æ®sortå­—æ®µæ’åº</span>
                <span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparingInt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token operator">-&gt;</span>menu<span class="token punctuation">.</span><span class="token function">getSort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token keyword">null</span><span class="token operator">?</span>menu<span class="token punctuation">.</span><span class="token function">getSort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment">//æœé›†</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> topCategory<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * ä»listé›†åˆä¸­è·å¾—å½“å‰èœå•çš„å­èœå•
     * <span class="token keyword">@param</span> <span class="token parameter">root</span> å½“å‰èœå•
     * <span class="token keyword">@param</span> <span class="token parameter">list</span>  èœå•é›†åˆ
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAllChildren</span><span class="token punctuation">(</span><span class="token class-name">CategoryEntity</span> root<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryEntity</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryEntity</span><span class="token punctuation">&gt;</span></span> collect <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>categoryEntity <span class="token operator">-&gt;</span> root<span class="token punctuation">.</span><span class="token function">getCatId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>categoryEntity<span class="token punctuation">.</span><span class="token function">getParentCid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment">//</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span>
                    <span class="token comment">//é€’å½’æ±‚è§£å…¶å­èœå•</span>
                     menu<span class="token punctuation">.</span><span class="token function">setChildren</span><span class="token punctuation">(</span><span class="token function">getAllChildren</span><span class="token punctuation">(</span>menu<span class="token punctuation">,</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                     <span class="token keyword">return</span> menu<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token comment">//æ ¹æ®sortå­—æ®µæ’åº</span>
                <span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparingInt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token operator">-&gt;</span>menu<span class="token punctuation">.</span><span class="token function">getSort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token keyword">null</span><span class="token operator">?</span>menu<span class="token punctuation">.</span><span class="token function">getSort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> collect<span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.1.3.5.png" alt="image-20220426205730443" style="zoom:50%;"><h5 id="_6ã€æŸ¥çœ‹ç»“æœ" tabindex="-1"><a class="header-anchor" href="#_6ã€æŸ¥çœ‹ç»“æœ" aria-hidden="true">#</a> 6ã€æŸ¥çœ‹ç»“æœ</h5><p>å¯ä»¥çœ‹åˆ°æ•°æ®å·²ç»æŒ‰æ ‘çŠ¶æ˜¾ç¤ºï¼Œå¹¶ä¸”æŒ‰sortå­—æ®µæ’åº**ğŸ˜„**</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.1.3.6.png" alt="image-20220426205415943" tabindex="0" loading="lazy"><figcaption>image-20220426205415943</figcaption></figure><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//1.å¯ä»¥é€šè¿‡Collection ç³»åˆ—é›†åˆæä¾›çš„stream()æˆ–parallelStream()</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream1 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//2.é€šè¿‡Arraysä¸­çš„é™æ€æ–¹æ³•stream() è·æ”¶æ•°ç»„æµ</span>
<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ints <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;d&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream2 <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>ints<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//3.é€šè¿‡Streamç±»ä¸­çš„é™æ€æ–¹æ³•of()</span>
<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream3 <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//4.è¿­ä»£æ–¹å¼åˆ›å»ºæ— é™æµ</span>
<span class="token comment">//10ã€12ã€14ã€16ã€18ã€20ã€22ã€24ã€26ã€28 Â·Â·Â·Â·Â·Â·(ä»10å¼€å§‹ï¼Œä¸‹ä¸€ä¸ªæ˜¯ 10+2=12,ä¸‹ä¸€ä¸ªæ˜¯12+2Â·Â·Â·Â·Â·Â·)</span>
<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> stream4 <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//10ã€12ã€14ã€16ã€18</span>
stream4<span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">print</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//5.ç”Ÿæˆæ–¹å¼åˆ›å»ºæ— é™æµ</span>
<span class="token comment">//æ²¡æœ‰ç§å­ï¼Œæ¯ä¸€æ¬¡ç”Ÿæˆçš„å…ƒç´ ä¸ä¸Šä¸€æ¬¡ç”Ÿæˆçš„å…ƒç´ æ²¡æœ‰å…³ç³»ï¼Œç”Ÿæˆçš„å…ƒç´ ä¸ºdoubleç±»å‹</span>
<span class="token comment">// 1.2 1.2 1.2 1.2 1.2</span>
<span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token number">1.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> stream5 <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token operator">::</span><span class="token function">random</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//0.3522966301192748</span>
<span class="token comment">//0.20867372930661876</span>
<span class="token comment">//0.06987341089850951</span>
<span class="token comment">//0.10069902801339281</span>
<span class="token comment">//0.3395435668418123</span>
stream5<span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-1-2ã€å•†å“æœåŠ¡-api-ä¸‰çº§åˆ†ç±»å‰ç«¯" tabindex="-1"><a class="header-anchor" href="#_4-1-2ã€å•†å“æœåŠ¡-api-ä¸‰çº§åˆ†ç±»å‰ç«¯" aria-hidden="true">#</a> 4.1.2ã€å•†å“æœåŠ¡-API-ä¸‰çº§åˆ†ç±»å‰ç«¯</h3><h4 id="_1ã€å…ˆå¯åŠ¨é¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#_1ã€å…ˆå¯åŠ¨é¡¹ç›®" aria-hidden="true">#</a> 1ã€å…ˆå¯åŠ¨é¡¹ç›®</h4><h5 id="_1ã€å¯åŠ¨åç«¯" tabindex="-1"><a class="header-anchor" href="#_1ã€å¯åŠ¨åç«¯" aria-hidden="true">#</a> 1ã€å¯åŠ¨åç«¯</h5><p>å¯åŠ¨ <code>renren-fast</code>çš„<code>io.renren.RenrenApplication</code>ç±»</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.1.1.png" alt="image-20220426213132389" tabindex="0" loading="lazy"><figcaption>image-20220426213132389</figcaption></figure><h5 id="_2ã€å¯åŠ¨å‰ç«¯" tabindex="-1"><a class="header-anchor" href="#_2ã€å¯åŠ¨å‰ç«¯" aria-hidden="true">#</a> 2ã€å¯åŠ¨å‰ç«¯</h5><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>npm run dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.1.2.png" alt="image-20220426213208523" tabindex="0" loading="lazy"><figcaption>image-20220426213208523</figcaption></figure><h4 id="_2ã€è·¨åŸŸæŠ¥é”™" tabindex="-1"><a class="header-anchor" href="#_2ã€è·¨åŸŸæŠ¥é”™" aria-hidden="true">#</a> 2ã€è·¨åŸŸæŠ¥é”™ğŸ˜ </h4><p><code>è·¨åŸŸ</code>ï¼šæŒ‡çš„æ˜¯æµè§ˆå™¨ä¸èƒ½æ‰§è¡Œå…¶ä»–ç½‘ç«™çš„è„šæœ¬ã€‚å®ƒæ˜¯ç”±æµè§ˆå™¨çš„åŒæºç­–ç•¥é€ æˆçš„ï¼Œæ˜¯ æµè§ˆå™¨å¯¹<strong>javascript</strong>æ–½åŠ çš„å®‰å…¨é™åˆ¶ã€‚</p><p><code>åŒæºç­–ç•¥</code>ï¼šæ˜¯æŒ‡åè®®ï¼ŒåŸŸåï¼Œç«¯å£éƒ½è¦ç›¸åŒï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªä¸åŒéƒ½ä¼šäº§ç”Ÿè·¨åŸŸï¼›</p><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.2.0.1.png" alt="image-20220721201231225" style="zoom:67%;"><p>è·¨åŸŸæµç¨‹ï¼š</p><p>éç®€å•è¯·æ±‚(PUTã€DELETE) ç­‰,éœ€è¦å…ˆå‘é€é¢„æ£€è¯·æ±‚</p><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.2.0.2.png" alt="image-20220721201441177" style="zoom:50%;"><p>å‚è€ƒç½‘å€ï¼š https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS</p><p>è§£å†³è·¨åŸŸ-ï¼ˆä¸€ï¼‰ä½¿ç”¨nginxéƒ¨ç½²ä¸ºåŒä¸€åŸŸ</p><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.2.0.3.png" alt="image-20220721201658286" style="zoom:67%;"><p>è§£å†³è·¨åŸŸ-ï¼ˆäºŒï¼‰é…ç½®å½“æ¬¡è¯·æ±‚å…è®¸è·¨åŸŸ</p><p><strong>æ·»åŠ å“åº”å¤´</strong></p><ul><li>Access-Control-Allow-Originï¼šæ”¯æŒå“ªäº›æ¥æºçš„è¯·æ±‚è·¨åŸŸ</li><li>Access-Control-Allow-Methodsï¼šæ”¯æŒå“ªäº›æ–¹æ³•è·¨åŸŸ</li><li>Access-Control-Allow-Credentialsï¼šè·¨åŸŸè¯·æ±‚é»˜è®¤ä¸åŒ…å«cookieï¼Œè®¾ç½®ä¸ºtrueå¯ä»¥åŒ…å« cookie</li><li>Access-Control-Expose-Headersï¼šè·¨åŸŸè¯·æ±‚æš´éœ²çš„å­—æ®µ CORSè¯·æ±‚æ—¶ï¼ŒXMLHttpRequestå¯¹è±¡çš„getResponseHeader()æ–¹æ³•åªèƒ½æ‹¿åˆ°6ä¸ªåŸºæœ¬å­—æ®µï¼š Cache-Controlã€Content-Languageã€Content-Typeã€Expiresã€Last-Modifiedã€Pragmaã€‚å¦‚ æœæƒ³æ‹¿åˆ°å…¶ä»–å­—æ®µï¼Œå°±å¿…é¡»åœ¨Access-Control-Expose-Headersé‡Œé¢æŒ‡å®šã€‚</li><li>Access-Control-Max-Ageï¼šè¡¨æ˜è¯¥å“åº”çš„æœ‰æ•ˆæ—¶é—´ä¸ºå¤šå°‘ç§’ã€‚åœ¨æœ‰æ•ˆæ—¶é—´å†…ï¼Œæµè§ˆå™¨æ—  é¡»ä¸ºåŒä¸€è¯·æ±‚å†æ¬¡å‘èµ·é¢„æ£€è¯·æ±‚ã€‚è¯·æ³¨æ„ï¼Œæµè§ˆå™¨è‡ªèº«ç»´æŠ¤äº†ä¸€ä¸ªæœ€å¤§æœ‰æ•ˆæ—¶é—´ï¼Œå¦‚æœ è¯¥é¦–éƒ¨å­—æ®µçš„å€¼è¶…è¿‡äº†æœ€å¤§æœ‰æ•ˆæ—¶é—´ï¼Œå°†ä¸ä¼šç”Ÿæ•ˆã€‚</li></ul><h5 id="_1ã€æµè§ˆå™¨è¾“å…¥ç½‘å€" tabindex="-1"><a class="header-anchor" href="#_1ã€æµè§ˆå™¨è¾“å…¥ç½‘å€" aria-hidden="true">#</a> 1ã€æµè§ˆå™¨è¾“å…¥ç½‘å€</h5><p>http://localhost:8001/#/login</p><p>å¯ä»¥</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.2.1.png" alt="è·¨åŸŸæŠ¥é”™" tabindex="0" loading="lazy"><figcaption>è·¨åŸŸæŠ¥é”™</figcaption></figure><h5 id="_2ã€è§£å†³è·¨åŸŸé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_2ã€è§£å†³è·¨åŸŸé—®é¢˜" aria-hidden="true">#</a> 2ã€è§£å†³è·¨åŸŸé—®é¢˜</h5><p>1ã€æ–¹å¼ä¸€:</p>`,58),r={href:"https://blog.csdn.net/qq_28325291/article/details/113931232",target:"_blank",rel:"noopener noreferrer"},d=a("p",null,"è·¨åŸŸå¯ä»¥åœ¨å‰ç«¯é€šè¿‡ JSONP æ¥è§£å†³ï¼Œä½†æ˜¯ JSONP åªå¯ä»¥å‘é€ GET è¯·æ±‚ï¼Œæ— æ³•å‘é€å…¶ä»–ç±»å‹çš„è¯·æ±‚ï¼Œåœ¨ RESTful é£æ ¼çš„åº”ç”¨ä¸­ï¼Œå°±æ˜¾å¾—éå¸¸é¸¡è‚‹ï¼Œå› æ­¤æˆ‘ä»¬æ¨èåœ¨åç«¯é€šè¿‡ ï¼ˆCORSï¼ŒCross-origin resource sharingï¼‰ æ¥è§£å†³è·¨åŸŸé—®é¢˜ã€‚è¿™ç§è§£å†³æ–¹æ¡ˆå¹¶é Spring Boot ç‰¹æœ‰çš„ï¼Œåœ¨ä¼ ç»Ÿçš„ SSM æ¡†æ¶ä¸­ï¼Œå°±å¯ä»¥é€šè¿‡ CORS æ¥è§£å†³è·¨åŸŸé—®é¢˜ï¼Œåªä¸è¿‡ä¹‹å‰æˆ‘ä»¬æ˜¯åœ¨ XML æ–‡ä»¶ä¸­é…ç½® CORS ï¼Œç°åœ¨å¯ä»¥é€šè¿‡å®ç°WebMvcConfigureræ¥å£ç„¶åé‡å†™addCorsMappingsæ–¹æ³•è§£å†³è·¨åŸŸé—®é¢˜ã€‚",-1),k=e(`<p>æŠŠ <code>renren-fast</code>æ¨¡å—çš„<code>io.renren.config.CorsConfig</code>ç±»çš„<code>addCorsMappings</code>æ–¹æ³•æ³¨é‡Šæ‰“å¼€</p><p>è¿™ä¸ªæœ¬æ¥æ˜¯å¼€ç€çš„ï¼Œç”±äºæˆ‘ä½¿ç”¨çš„æ˜¯èµ„æ–™æä¾›çš„ä»£ç ï¼Œæ‰€æœ‰è¿™é‡Œå…ˆå–æ¶ˆæ³¨é‡Šï¼Œåæ¥è¿™ä¸ªæ˜¯è¦æ³¨é‡Šæ‰çš„</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.2.2.png" alt="image-20220426213642581" tabindex="0" loading="lazy"><figcaption>image-20220426213642581</figcaption></figure><p>2ã€æ·»åŠ è¿‡æ»¤å™¨</p><blockquote><p>é¡¹ç›®ä¸­å‰åç«¯åˆ†ç¦»éƒ¨ç½²ï¼Œæ‰€ä»¥éœ€è¦è§£å†³è·¨åŸŸçš„é—®é¢˜ã€‚ æˆ‘ä»¬ä½¿ç”¨cookieå­˜æ”¾ç”¨æˆ·ç™»å½•çš„ä¿¡æ¯ï¼Œåœ¨springæ‹¦æˆªå™¨è¿›è¡Œæƒé™æ§åˆ¶ï¼Œå½“æƒé™ä¸ç¬¦åˆæ—¶ï¼Œç›´æ¥è¿”å›ç»™ç”¨æˆ·å›ºå®šçš„jsonç»“æœã€‚ å½“ç”¨æˆ·ç™»å½•ä»¥åï¼Œæ­£å¸¸ä½¿ç”¨ï¼›å½“ç”¨æˆ·é€€å‡ºç™»å½•çŠ¶æ€æ—¶æˆ–è€…tokenè¿‡æœŸæ—¶ï¼Œç”±äºæ‹¦æˆªå™¨å’Œè·¨åŸŸçš„é¡ºåºæœ‰é—®é¢˜ï¼Œå‡ºç°äº†è·¨åŸŸçš„ç°è±¡ã€‚ æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªhttpè¯·æ±‚ï¼Œå…ˆèµ°filterï¼Œåˆ°è¾¾servletåæ‰è¿›è¡Œæ‹¦æˆªå™¨çš„å¤„ç†ï¼Œå¦‚æœæˆ‘ä»¬æŠŠcorsæ”¾åœ¨filteré‡Œï¼Œå°±å¯ä»¥ä¼˜å…ˆäºæƒé™æ‹¦æˆªå™¨æ‰§è¡Œã€‚</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">io<span class="token punctuation">.</span>renren<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>cors<span class="token punctuation">.</span></span><span class="token class-name">CorsConfiguration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>cors<span class="token punctuation">.</span></span><span class="token class-name">UrlBasedCorsConfigurationSource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span></span><span class="token class-name">CorsFilter</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * springbootè§£å†³è·¨åŸŸé—®é¢˜
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CorsConfig2</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">CorsFilter</span> <span class="token function">corsFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CorsConfiguration</span> corsConfiguration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CorsConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        corsConfiguration<span class="token punctuation">.</span><span class="token function">addAllowedOrigin</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        corsConfiguration<span class="token punctuation">.</span><span class="token function">addAllowedHeader</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        corsConfiguration<span class="token punctuation">.</span><span class="token function">addAllowedMethod</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        corsConfiguration<span class="token punctuation">.</span><span class="token function">setAllowCredentials</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">UrlBasedCorsConfigurationSource</span> source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UrlBasedCorsConfigurationSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        source<span class="token punctuation">.</span><span class="token function">registerCorsConfiguration</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">,</span> corsConfiguration<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CorsFilter</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.2.2.2.png" alt="image-20220426221916301" tabindex="0" loading="lazy"><figcaption>image-20220426221916301</figcaption></figure><h4 id="_3ã€æ·»åŠ ä¸€çº§èœå•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ ä¸€çº§èœå•" aria-hidden="true">#</a> 3ã€æ·»åŠ ä¸€çº§èœå•</h4><p>æ·»åŠ å•†å“ç³»ç»Ÿä¸ºä¸€çº§èœå•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.3.png" alt="image-20220426223335101" tabindex="0" loading="lazy"><figcaption>image-20220426223335101</figcaption></figure><h4 id="_4ã€æ•°æ®åº“ä¸­æŸ¥çœ‹" tabindex="-1"><a class="header-anchor" href="#_4ã€æ•°æ®åº“ä¸­æŸ¥çœ‹" aria-hidden="true">#</a> 4ã€æ•°æ®åº“ä¸­æŸ¥çœ‹</h4><p>å¯ä»¥çœ‹åˆ°å•†å“ç³»ç»Ÿå·²ç»æ·»åŠ è¿›æ¥äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.4.png" alt="image-20220426223429705" tabindex="0" loading="lazy"><figcaption>image-20220426223429705</figcaption></figure><h4 id="_5ã€æ·»åŠ äºŒçº§èœå•" tabindex="-1"><a class="header-anchor" href="#_5ã€æ·»åŠ äºŒçº§èœå•" aria-hidden="true">#</a> 5ã€æ·»åŠ äºŒçº§èœå•</h4><p>æ·»åŠ åˆ†ç±»ç»´æŠ¤ä¸ºå•†å“ç³»ç»Ÿçš„ä¸‹ä¸€çº§èœå•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.5.png" alt="image-20220426224339948" tabindex="0" loading="lazy"><figcaption>image-20220426224339948</figcaption></figure><h4 id="_6ã€åˆ†æè·¯ç”±è§„åˆ™" tabindex="-1"><a class="header-anchor" href="#_6ã€åˆ†æè·¯ç”±è§„åˆ™" aria-hidden="true">#</a> 6ã€åˆ†æè·¯ç”±è§„åˆ™</h4><h5 id="_1ã€èœå•urlä¸è®¿é—®urlå¯¹åº”å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_1ã€èœå•urlä¸è®¿é—®urlå¯¹åº”å…³ç³»" aria-hidden="true">#</a> 1ã€èœå•URLä¸è®¿é—®URLå¯¹åº”å…³ç³»</h5><p>å¯ä»¥å‘ç°å½“èœå•URLä¸º<code>product/category</code>æ—¶ï¼Œè®¿é—®çš„urlä¸º<code>product-category</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.6.1.1.png" alt="image-20220426230159499" tabindex="0" loading="lazy"><figcaption>image-20220426230159499</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.6.1.2.png" alt="image-20220426230258838" tabindex="0" loading="lazy"><figcaption>image-20220426230258838</figcaption></figure><h5 id="_2ã€è®¿é—®urlä¸è·¯å¾„çš„å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_2ã€è®¿é—®urlä¸è·¯å¾„çš„å…³ç³»" aria-hidden="true">#</a> 2ã€è®¿é—®URLä¸è·¯å¾„çš„å…³ç³»</h5><p>å¯ä»¥å‘ç°å½“è®¿é—®çš„URLä¸º<code>sys-role</code>æ—¶ï¼Œæ–‡ä»¶è·¯å¾„ä¸ºsrc/views/modules/sys/role.vue</p><p>å› æ­¤åˆ†ç±»ç»´æŠ¤<code>product-category</code>çš„æ–‡ä»¶è·¯å¾„src/views/modules/product/category.vue</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.6.2.1.png" alt="image-20220426230951488" tabindex="0" loading="lazy"><figcaption>image-20220426230951488</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.6.2.2.png" alt="image-20220426230916453" tabindex="0" loading="lazy"><figcaption>image-20220426230916453</figcaption></figure><h4 id="_7ã€åˆ›å»ºç›®å½•å’Œvueæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_7ã€åˆ›å»ºç›®å½•å’Œvueæ–‡ä»¶" aria-hidden="true">#</a> 7ã€åˆ›å»ºç›®å½•å’Œvueæ–‡ä»¶</h4><p>åœ¨<code>src/views/modules/</code>ç›®å½•ä¸­åˆ›å»º<code>product</code>ç›®å½•ï¼Œåœ¨<code>product</code>ç›®å½•ä¸‹åˆ›å»º<code>category.vue</code>æ–‡ä»¶</p><p>åœ¨<code>category.vue</code>ä¸­è¾“å…¥vueç„¶åå›è½¦ï¼Œç”Ÿæˆæ¨¡æ¿</p><p>éšä¾¿åœ¨divå†™ç‚¹ä¸œè¥¿ï¼Œç„¶åè¿è¡Œé¡¹ç›®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.7.1.png" alt="image-20220427155235060" tabindex="0" loading="lazy"><figcaption>image-20220427155235060</figcaption></figure><h4 id="_8ã€å‘ç°es-linkæ³¨é‡ŠæŠ¥é”™-é¡¹ç›®èƒ½è¿è¡Œ" tabindex="-1"><a class="header-anchor" href="#_8ã€å‘ç°es-linkæ³¨é‡ŠæŠ¥é”™-é¡¹ç›®èƒ½è¿è¡Œ" aria-hidden="true">#</a> 8ã€å‘ç°ES Linkæ³¨é‡ŠæŠ¥é”™(é¡¹ç›®èƒ½è¿è¡Œ)</h4><p>è¿™ä¸ªES Linkæˆ‘ç¦ç”¨äº†è¿˜æŠ¥é”™ğŸ˜ ï¼Œä½†æ˜¯é¡¹ç›®èƒ½è¿è¡Œ</p><p>è¿™ä¸ªES LinkçœŸæ˜¯é˜´é­‚ä¸æ•£</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.8.1.png" alt="image-20220427154646562" tabindex="0" loading="lazy"><figcaption>image-20220427154646562</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.8.2.png" alt="image-20220427155049406" tabindex="0" loading="lazy"><figcaption>image-20220427155049406</figcaption></figure><h6 id="æ–¹æ³•ä¸€" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•ä¸€" aria-hidden="true">#</a> æ–¹æ³•ä¸€</h6><p>å°†<code>eslintrc.js</code>é‡Œé¢çš„<code>extends: &#39;standard&#39;,</code>æ³¨é‡Šæ‰å°±ä¸æŠ¥é”™äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.8.3.png" alt="image-20220427160029935" tabindex="0" loading="lazy"><figcaption>image-20220427160029935</figcaption></figure><h6 id="æ–¹æ³•äºŒ" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•äºŒ" aria-hidden="true">#</a> æ–¹æ³•äºŒ</h6><p>åˆ æ‰<code>build\\webpack.base.conf.js</code>é‡Œé¢çš„<code>createLintingRule()</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.8.4.png" alt="image-20220427160549017" tabindex="0" loading="lazy"><figcaption>image-20220427160549017</figcaption></figure><h6 id="æ–¹æ³•ä¸‰" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•ä¸‰" aria-hidden="true">#</a> æ–¹æ³•ä¸‰</h6><p>åˆ æ‰<code>build\\webpack.base.conf.js</code>é‡Œé¢<code>reateLintingRule()</code>æ–¹æ³•é‡Œé¢çš„ä»£ç </p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.8.5.png" alt="image-20220503140831432" tabindex="0" loading="lazy"><figcaption>image-20220503140831432</figcaption></figure><h6 id="æ–¹æ³•å››" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•å››" aria-hidden="true">#</a> æ–¹æ³•å››</h6><p>åˆ æ‰<code>config\\index.js</code>é‡Œé¢çš„<code>useEslint: true,</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.8.6.png" alt="image-20220503141016797" tabindex="0" loading="lazy"><figcaption>image-20220503141016797</figcaption></figure><p>ğŸ“Œåæ¥æˆ‘åˆä½¿ç”¨çš„æ˜¯renren-fast-vueï¼Œæ”¾å¼ƒäº†èµ„æ–™æä¾›çš„åšå¥½çš„ä»£ç </p><p>æŠ¥äº†ä¸€ä¸ªVS Codeçš„é”™</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>could not use PowerShell to find Visual Studio 2017 or newer, try re-running with &#39;--loglevel silly&#39; for more details
æ— æ³•ä½¿ç”¨Power ShellæŸ¥æ‰¾Visual Studio 2017æˆ–æ›´æ–°ï¼Œè¯·å°è¯•ä½¿ç”¨â€œ -loglevel Sillyâ€é‡æ–°è¿è¡Œï¼Œä»¥è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯
You need to install the latest version of Visual Studio        
find VS including the &quot;Desktop development with C++&quot; workload.
æ‚¨éœ€è¦å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Visual StudioæŸ¥æ‰¾VSï¼ŒåŒ…æ‹¬â€œå¸¦æœ‰C ++çš„æ¡Œé¢å¼€å‘â€å·¥ä½œè´Ÿè½½ã€‚
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.8.7.png" alt="image-20220426234340229" tabindex="0" loading="lazy"><figcaption>image-20220426234340229</figcaption></figure><p>ä¿®æ”¹ä¸€ä¸‹msvs_versionç‰ˆæœ¬å°±è¡Œäº†</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>npm config set msvs_version 2019
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_9ã€ä½¿ç”¨treeæ ‘å½¢ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#_9ã€ä½¿ç”¨treeæ ‘å½¢ç»„ä»¶" aria-hidden="true">#</a> 9ã€ä½¿ç”¨treeæ ‘å½¢ç»„ä»¶</h4>`,55),m=a("code",null,"src\\views\\modules\\product\\category.vue",-1),g={href:"https://element.eleme.io/#/zh-CN/component/tree",target:"_blank",rel:"noopener noreferrer"},v=e(`<p><a href="code/4.1.2.9.category.vue">ç‚¹å‡»æŸ¥çœ‹<code>category.vue</code>å®Œæ•´ä»£ç </a></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.9.1.png" alt="image-20220429123519980" tabindex="0" loading="lazy"><figcaption>image-20220429123519980</figcaption></figure><p>å°è£…çš„å‘é€<code>ajax</code>è¯·æ±‚æ–¹æ³•åœ¨<code>src\\utils\\httpRequest.js</code>æ–‡ä»¶å†…ï¼Œ<code>get</code>è¯·æ±‚å¯ä»¥å¤åˆ¶<code>src\\views\\modules\\sys\\role.vue</code>é‡Œé¢çš„</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.9.2.png" alt="image-20220429123839285" tabindex="0" loading="lazy"><figcaption>image-20220429123839285</figcaption></figure><h4 id="_10ã€è¿è¡Œé¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#_10ã€è¿è¡Œé¡¹ç›®" aria-hidden="true">#</a> 10ã€è¿è¡Œé¡¹ç›®</h4><h5 id="_1ã€ç«¯å£è®¿é—®é”™è¯¯" tabindex="-1"><a class="header-anchor" href="#_1ã€ç«¯å£è®¿é—®é”™è¯¯" aria-hidden="true">#</a> 1ã€ç«¯å£è®¿é—®é”™è¯¯</h5><p>å‘ç°è¯·æ±‚çš„urlä¸º http://localhost:8080/renren-fast/product/category/list/tree</p><p>è€Œæ­£ç¡®çš„urlä¸º http://localhost:10000/product/category/list/tree</p><p>è®¿é—®çš„æ˜¯8080ç«¯å£ä¸‹çš„renren-fastï¼Œè€Œæƒ³è®¿é—®çš„æ˜¯10000ç«¯å£</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.10.1.png" alt="image-20220427203758880" tabindex="0" loading="lazy"><figcaption>image-20220427203758880</figcaption></figure><h5 id="_2ã€ä¿®æ”¹ç«¯å£" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹ç«¯å£" aria-hidden="true">#</a> 2ã€ä¿®æ”¹ç«¯å£</h5><p><code>ctrl+shift+F</code> å…¨å±€æœç´¢<code>localhost:8080/renren-fast</code></p><p>å‘ç°å…¶å®šä¹‰åœ¨<code>static\\config\\index.js</code>é‡Œçš„<code>window.SITE_CONFIG[&#39;baseUrl&#39;]</code>å­—æ®µ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.10.2.1.png" alt="image-20220427205415040" tabindex="0" loading="lazy"><figcaption>image-20220427205415040</figcaption></figure><p>ç”±äºè¦å‘å¤šä¸ªæ¨¡å—å‘è¯·æ±‚ï¼Œæ‰€ä»¥å¯ä»¥æŒ‡å®šè®¿é—®ç½‘å…³ï¼Œç½‘å…³å†è·¯ç”±åˆ°å…¶ä»–æ¨¡å—</p><div class="language-http line-numbers-mode" data-ext="http"><pre class="language-http"><code><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//localhost:88</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ps:åé¢åˆä¿®æ”¹ä¸º <code>http://localhost:88/api</code> äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.10.2.2.png" alt="image-20220427205600163" tabindex="0" loading="lazy"><figcaption>image-20220427205600163</figcaption></figure><h5 id="_3ã€åˆ·æ–°é¡µé¢" tabindex="-1"><a class="header-anchor" href="#_3ã€åˆ·æ–°é¡µé¢" aria-hidden="true">#</a> 3ã€åˆ·æ–°é¡µé¢</h5><p>åˆ·æ–°é¡µé¢å‘ç°éªŒè¯ç ä¹Ÿç»™ç½‘å…³å‘è¯·æ±‚äº†ï¼Œè¿™æ˜¯å› ä¸ºåˆšåˆšé…ç½®äº†basUrlï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å‘ç»™ç½‘å…³</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.10.3.1.png" alt="åˆ·æ–°é¡µé¢" tabindex="0" loading="lazy"><figcaption>åˆ·æ–°é¡µé¢</figcaption></figure><h4 id="_11ã€ä¿®æ”¹ç½‘å…³é…ç½®" tabindex="-1"><a class="header-anchor" href="#_11ã€ä¿®æ”¹ç½‘å…³é…ç½®" aria-hidden="true">#</a> 11ã€ä¿®æ”¹ç½‘å…³é…ç½®</h4><p>å…ˆè®©ç½‘å…³éƒ½è½¬ç»™renren-fastæ¨¡å—</p><h5 id="_1ã€renren-fastæ¨¡å—æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_1ã€renren-fastæ¨¡å—æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ" aria-hidden="true">#</a> 1ã€renren-fastæ¨¡å—æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ</h5><p>1ã€ä¾èµ–<code>gulimall-common</code>æ¨¡å—</p><p><code>gulimall-common</code>æ¨¡å—é…ç½®çš„æœ‰nacosï¼Œä¾èµ–<code>gulimall-common</code>æ¨¡å—åï¼Œç‚¹å‡»åˆ·æ–°</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.gulimall<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>gulimall-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.0.1-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.11.1.png" alt="image-20220427210524719" tabindex="0" loading="lazy"><figcaption>image-20220427210524719</figcaption></figure><p>ç”±äº<code>gulimall-common</code>æ¨¡å—ä¾èµ–äº†é…ç½®ä¸­å¿ƒï¼Œ&quot;renren-fast&quot;æ¨¡å—æš‚æ—¶æ²¡é…ï¼Œæ‰€ä»¥å¯ä»¥å…ˆæ’é™¤æ‰é…ç½®ä¸­å¿ƒ</p><p>è¿™æ ·çš„è¯è¿è¡Œå¯ä»¥ä¸æŠ¥é”™(ä¸æ’é™¤ä¹Ÿèƒ½è¿è¡Œï¼Œä¸è¿‡ä¼šæŠ¥é”™)</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.gulimall<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>gulimall-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.0.1-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2ã€ä¿®æ”¹é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹é…ç½®æ–‡ä»¶" aria-hidden="true">#</a> 2ã€ä¿®æ”¹é…ç½®æ–‡ä»¶</h5><p>é…ç½®åº”ç”¨åå’Œæ³¨å†Œä¸­å¿ƒåœ°å€</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>  
    <span class="token key atrule">application</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> renren<span class="token punctuation">-</span>fast
    <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
      <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
        <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
          <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.11.2.png" alt="image-20220427210950685" tabindex="0" loading="lazy"><figcaption>image-20220427210950685</figcaption></figure><h5 id="_3ã€å¯åŠ¨ç±»æ·»åŠ æœåŠ¡å‘ç°æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_3ã€å¯åŠ¨ç±»æ·»åŠ æœåŠ¡å‘ç°æ³¨è§£" aria-hidden="true">#</a> 3ã€å¯åŠ¨ç±»æ·»åŠ æœåŠ¡å‘ç°æ³¨è§£</h5><h6 id="_1ã€æ·»åŠ æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ æ³¨è§£" aria-hidden="true">#</a> 1ã€æ·»åŠ æ³¨è§£</h6><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableDiscoveryClient</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.11.3.1.png" alt="image-20220427211241374" tabindex="0" loading="lazy"><figcaption>image-20220427211241374</figcaption></figure><h6 id="_2ã€æç¤ºgsonä¸å­˜åœ¨" tabindex="-1"><a class="header-anchor" href="#_2ã€æç¤ºgsonä¸å­˜åœ¨" aria-hidden="true">#</a> 2ã€æç¤ºGsonä¸å­˜åœ¨</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.11.3.2.png" alt="image-20220427211712823" tabindex="0" loading="lazy"><figcaption>image-20220427211712823</figcaption></figure><h6 id="_3ã€æ·»åŠ gsonä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ gsonä¾èµ–" aria-hidden="true">#</a> 3ã€æ·»åŠ gsonä¾èµ–</h6><p>æ·»åŠ gsonä¾èµ–åï¼Œé‡å¯æ¨¡å—</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.google.code.gson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>gson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.8.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.11.3.3.png" alt="image-20220427211829461" tabindex="0" loading="lazy"><figcaption>image-20220427211829461</figcaption></figure><h6 id="_4ã€é…ç½®ä¸­å¿ƒæŠ¥é”™" tabindex="-1"><a class="header-anchor" href="#_4ã€é…ç½®ä¸­å¿ƒæŠ¥é”™" aria-hidden="true">#</a> 4ã€é…ç½®ä¸­å¿ƒæŠ¥é”™</h6><p>ç”±äºåœ¨<code>gulimall-common</code>é…ç½®äº†é…ç½®ä¸­å¿ƒï¼Œè€Œé¡¹ç›®æ²¡æœ‰é…ç½®é…ç½®ä¸­å¿ƒåœ°å€å’Œç«¯å£</p><p>å› æ­¤é¡¹ç›®å¯åŠ¨æ—¶ï¼Œä¼šæŠ¥é…ç½®ä¸­å¿ƒç›¸å…³çš„é”™è¯¯ï¼Œè¿™é‡Œå…ˆä¸ç”¨ç®¡</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.11.3.4.png" alt="image-20220428160014549" tabindex="0" loading="lazy"><figcaption>image-20220428160014549</figcaption></figure><h5 id="_4ã€æŸ¥çœ‹æ³¨å†Œä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_4ã€æŸ¥çœ‹æ³¨å†Œä¸­å¿ƒ" aria-hidden="true">#</a> 4ã€æŸ¥çœ‹æ³¨å†Œä¸­å¿ƒ</h5><p>å¯åŠ¨nacosï¼Œåœ¨æµè§ˆå™¨è¾“å…¥: http://localhost:8848/nacos/</p><p>ç”¨æˆ·åå’Œå¯†ç éƒ½ä¸ºnacos</p><p>å¯ä»¥å‘ç°å·²ç»æ³¨å†Œåˆ°nacosä¸Šäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.11.4.png" alt="image-20220427212615394" tabindex="0" loading="lazy"><figcaption>image-20220427212615394</figcaption></figure><h5 id="_5ã€ä¿®æ”¹ç½‘å…³é…ç½®" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¿®æ”¹ç½‘å…³é…ç½®" aria-hidden="true">#</a> 5ã€ä¿®æ”¹ç½‘å…³é…ç½®</h5><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> admin_route
  <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//renren<span class="token punctuation">-</span>fast   <span class="token comment">#loadbalanced è´Ÿè½½å‡è¡¡</span>
  <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> Path=/api/<span class="token important">**</span>		  <span class="token comment">#Pathè¯·æ±‚è·¯å¾„ï¼Œè¯·æ±‚è·¯å¾„å‰é¢åŠ ä¸€ä¸ª/apiï¼Œ**è¡¨ç¤ºä»»æ„è¯·æ±‚</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.11.5.1.png" alt="image-20220427213105152" tabindex="0" loading="lazy"><figcaption>image-20220427213105152</figcaption></figure><p>å‰ç«¯çš„index.jsçš„baseUrlä¹Ÿç”±</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">window.SITE_CONFIG[&#39;baseUrl&#39;]</span> <span class="token punctuation">=</span> <span class="token value attr-value">&#39;http://localhost:88&#39;;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¿®æ”¹ä¸º</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">window.SITE_CONFIG[&#39;baseUrl&#39;]</span> <span class="token punctuation">=</span> <span class="token value attr-value">&#39;http://localhost:88/api&#39;;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å‚è€ƒæ–‡æ¡£:https://docs.spring.io/spring-cloud-gateway/docs/2.2.9.RELEASE/reference/html/#the-cookie-route-predicate-factory</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.11.5.2.png" alt="image-20220427214715052" tabindex="0" loading="lazy"><figcaption>image-20220427214715052</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.11.5.3.png" alt="image-20220427215853495" tabindex="0" loading="lazy"><figcaption>image-20220427215853495</figcaption></figure><h5 id="_6ã€é‡å¯é¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#_6ã€é‡å¯é¡¹ç›®" aria-hidden="true">#</a> 6ã€é‡å¯é¡¹ç›®</h5><p>é‡å¯é¡¹ç›®å‘ç°è¿˜æ˜¯è®¿é—®ä¸äº†</p><p>è®¿é—®ä¸äº†çš„åŸå› æ˜¯</p><p>å‰ç«¯è®¿é—®äº† http://localhost:88/api/captcha.jpg</p><p>é€šè¿‡ç½‘å…³ï¼Œæ–­è¨€åŒ¹é…åˆ°äº† /api/**</p><p>æ‰€ä»¥ç½‘å…³è·¯ç”±åˆ°äº†renren-fastæ¨¡å—,å³æ‰¾åˆ°äº† http://localhost:8080</p><p>ç„¶åå°†<code> http://localhost:8080</code>ä¸<code> /api/captcha.jpg</code>ç»„æˆäº† http://localhost:8080/api/captcha.jpg</p><p>è€Œæ­£ç¡®çš„è·¯å¾„ä¸º http://localhost:8080/renren-fast/captcha.jpg</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.11.6.png" alt="image-20220427215308179" tabindex="0" loading="lazy"><figcaption>image-20220427215308179</figcaption></figure><h5 id="_7ã€è·¯å¾„é‡å†™" tabindex="-1"><a class="header-anchor" href="#_7ã€è·¯å¾„é‡å†™" aria-hidden="true">#</a> 7ã€è·¯å¾„é‡å†™</h5><p>å°†å°†è¯·æ±‚ç”± http://localhost:88/api/captcha.jpg å˜ä¸º http://localhost:8080/renren-fast/captcha.jpg</p><p>ç„¶åé‡å¯é¡¹ç›®</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">filters</span><span class="token punctuation">:</span>
  <span class="token comment">#è·¯å¾„é‡å†™,å°†è¯·æ±‚ç”± http://localhost:88/api/captcha.jpg å˜ä¸º http://localhost:8080/renren-fast/captcha.jpg</span>
  <span class="token punctuation">-</span> RewritePath=/api/(<span class="token punctuation">?</span>&lt;segment<span class="token punctuation">&gt;</span>/<span class="token punctuation">?</span>.<span class="token important">*)</span><span class="token punctuation">,</span>/renren<span class="token punctuation">-</span>fast/$\\<span class="token punctuation">{</span>segment<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.11.7.1.png" alt="image-20220428162416500" tabindex="0" loading="lazy"><figcaption>image-20220428162416500</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.11.7.2.png" alt="image-20220427220727452" tabindex="0" loading="lazy"><figcaption>image-20220427220727452</figcaption></figure><h4 id="_12ã€éªŒè¯ç å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†" tabindex="-1"><a class="header-anchor" href="#_12ã€éªŒè¯ç å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†" aria-hidden="true">#</a> 12ã€éªŒè¯ç å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†</h4><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.12.png" alt="image-20220427221353624" tabindex="0" loading="lazy"><figcaption>image-20220427221353624</figcaption></figure><h4 id="_13ã€è·¨åŸŸè¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_13ã€è·¨åŸŸè¯·æ±‚" aria-hidden="true">#</a> 13ã€è·¨åŸŸè¯·æ±‚</h4><p>ç‚¹å‡»ç™»å½•å‘ç°æ²¡ååº”ï¼Œçœ‹ä¸€ä¸‹æ§åˆ¶å°æ˜¾ç¤ºè·¨åŸŸè¯·æ±‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Access to XMLHttpRequest at &#39;http://localhost:88/api/sys/login&#39; from origin &#39;http://localhost:8001&#39; has been blocked by CORS policy: Response to preflight request doesn&#39;t pass access control check: No &#39;Access-Control-Allow-Origin&#39; header is present on the requested resource.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.13.1.png" alt="image-20220427224950491" tabindex="0" loading="lazy"><figcaption>image-20220427224950491</figcaption></figure><p>æŸ¥çœ‹Networkå¯ä»¥çœ‹åˆ°æœ‰<code>CORS error</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.13.2.png" alt="image-20220427225621837" tabindex="0" loading="lazy"><figcaption>image-20220427225621837</figcaption></figure><p>ç‚¹å‡»ç¬¬äºŒä¸ªloginï¼Œå‘ç°è¯·æ±‚æ–¹å¼ä¸º<code>OPTION</code>ï¼Œè¡¨ç¤ºè¿™ä¸ªè¯·æ±‚ä¸º<code>åŸŸæ£€è¯·æ±‚</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.13.3.png" alt="image-20220427225801035" tabindex="0" loading="lazy"><figcaption>image-20220427225801035</figcaption></figure><h4 id="_14ã€åç«¯é…ç½®å…è®¸è·¨åŸŸè¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_14ã€åç«¯é…ç½®å…è®¸è·¨åŸŸè¯·æ±‚" aria-hidden="true">#</a> 14ã€åç«¯é…ç½®å…è®¸è·¨åŸŸè¯·æ±‚</h4><p>ç”±äºå‰ç«¯æŒ‡å®šè®¿é—®ç½‘å…³ï¼Œç½‘å…³å†è·¯ç”±åˆ°å…¶ä»–æ¨¡å—ï¼Œæ‰€æœ‰å¯ä»¥å†ç½‘å…³æ¨¡å—é…ç½®è·¨åŸŸè¯·æ±‚ï¼Œè¿™æ ·åˆ«çš„æ¨¡å—å°±ä¸ç”¨é…ç½®è·¨åŸŸè¯·æ±‚äº†</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>gateway<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>cors<span class="token punctuation">.</span></span><span class="token class-name">CorsConfiguration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>cors<span class="token punctuation">.</span>reactive<span class="token punctuation">.</span></span><span class="token class-name">CorsWebFilter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>cors<span class="token punctuation">.</span>reactive<span class="token punctuation">.</span></span><span class="token class-name">UrlBasedCorsConfigurationSource</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/4/27
 * @Description: è·¨åŸŸè¯·æ±‚è¿‡æ»¤å™¨
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GulimallCorsConfiguration</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">CorsWebFilter</span> <span class="token function">corsWebFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">CorsConfiguration</span> corsConfiguration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CorsConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ·»åŠ å…è®¸çš„è¯·æ±‚å¤´</span>
        corsConfiguration<span class="token punctuation">.</span><span class="token function">addAllowedHeader</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ·»åŠ å…è®¸çš„è¯·æ±‚æ–¹å¼</span>
        corsConfiguration<span class="token punctuation">.</span><span class="token function">addAllowedMethod</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ·»åŠ å…è®¸çš„è¯·æ±‚æ¥æº</span>
        corsConfiguration<span class="token punctuation">.</span><span class="token function">addAllowedOrigin</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ˜¯å¦å…è®¸æºå¸¦cookieè¿›è¡Œè·¨åŸŸ</span>
        <span class="token comment">//è®¾ä¸ºfalseä¼šä¸¢å¤±cookieä¿¡æ¯</span>
        corsConfiguration<span class="token punctuation">.</span><span class="token function">setAllowCredentials</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//CorsWebFilteréœ€è¦ä¼ å…¥CorsConfigurationSourceæ¥å£ç±»å‹çš„å‚æ•°</span>
        <span class="token comment">//UrlBasedCorsConfigurationSourceæ˜¯CorsConfigurationSourceæ¥å£çš„å®ç°ç±»</span>
        <span class="token class-name">UrlBasedCorsConfigurationSource</span> source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UrlBasedCorsConfigurationSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// &quot;/**&quot;è¡¨ç¤ºä»»æ„è·¯å¾„</span>
        source<span class="token punctuation">.</span><span class="token function">registerCorsConfiguration</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">,</span>corsConfiguration<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CorsWebFilter</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.14.png" alt="image-20220427230019471" tabindex="0" loading="lazy"><figcaption>image-20220427230019471</figcaption></figure><h4 id="_15ã€åˆ·æ–°å‰ç«¯é¡µé¢" tabindex="-1"><a class="header-anchor" href="#_15ã€åˆ·æ–°å‰ç«¯é¡µé¢" aria-hidden="true">#</a> 15ã€åˆ·æ–°å‰ç«¯é¡µé¢</h4><p>é‡å¯<code>gulimall-gateway</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>The &#39;Access-Control-Allow-Origin&#39; header contains multiple values &#39;http://localhost:8001, http://localhost:8001&#39;, but only one is allowed.
&#39;Access-Control-Allow-Origin&#39;å¤´åŒ…å«å¤šä¸ªå€¼ï¼Œä½†åªæœ‰ä¸€ä¸ªè¢«å…è®¸
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.15.1.png" alt="image-20220427231312786" tabindex="0" loading="lazy"><figcaption>image-20220427231312786</figcaption></figure><p>NetWorkä¹Ÿå¯ä»¥çœ‹åˆ°åŒ…å«äº†ä¸¤ä¸ª</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.15.2.png" alt="image-20220427231548647" tabindex="0" loading="lazy"><figcaption>image-20220427231548647</figcaption></figure><h4 id="_16ã€å–æ¶ˆrenren-fasté¡¹ç›®çš„è·¨åŸŸé…ç½®" tabindex="-1"><a class="header-anchor" href="#_16ã€å–æ¶ˆrenren-fasté¡¹ç›®çš„è·¨åŸŸé…ç½®" aria-hidden="true">#</a> 16ã€å–æ¶ˆrenren-fasté¡¹ç›®çš„è·¨åŸŸé…ç½®</h4><p>åŒ…å«ä¸¤ä¸ªå€¼çš„åŸå› æ˜¯gulimall-gatewayé…ç½®äº†è·¨åŸŸ</p><p>è€Œrenren-fasté¡¹ç›®é»˜è®¤ä¹Ÿé…ç½®äº†è·¨åŸŸ</p><p>å› æ­¤å–æ¶ˆçš„renren-fasté¡¹ç›®çš„è·¨åŸŸé…ç½®å°±è¡Œäº†</p><p>æ³¨é‡Šåˆ°è¿™é‡Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.16.png" alt="image-20220427232200865" tabindex="0" loading="lazy"><figcaption>image-20220427232200865</figcaption></figure><h4 id="_17ã€é‡æ–°åˆ·æ–°å‰ç«¯é¡µé¢" tabindex="-1"><a class="header-anchor" href="#_17ã€é‡æ–°åˆ·æ–°å‰ç«¯é¡µé¢" aria-hidden="true">#</a> 17ã€é‡æ–°åˆ·æ–°å‰ç«¯é¡µé¢</h4><p>é‡å¯renren-fasté¡¹ç›®å,é‡æ–°åˆ·æ–°å‰ç«¯é¡µé¢,ç‚¹å‡»ç™»å½•åï¼Œå‘ç°å·²ç»ç™»å½•æˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.2.17.png" alt="image-20220427232353711" tabindex="0" loading="lazy"><figcaption>image-20220427232353711</figcaption></figure><h3 id="_4-1-3ã€æ˜¾ç¤ºå•†å“æœåŠ¡ä¸‹çš„åˆ†ç±»ç»´æŠ¤" tabindex="-1"><a class="header-anchor" href="#_4-1-3ã€æ˜¾ç¤ºå•†å“æœåŠ¡ä¸‹çš„åˆ†ç±»ç»´æŠ¤" aria-hidden="true">#</a> 4.1.3ã€æ˜¾ç¤ºå•†å“æœåŠ¡ä¸‹çš„åˆ†ç±»ç»´æŠ¤</h3><h4 id="_1ã€åˆ†ç±»ç»´æŠ¤é¡µé¢" tabindex="-1"><a class="header-anchor" href="#_1ã€åˆ†ç±»ç»´æŠ¤é¡µé¢" aria-hidden="true">#</a> 1ã€åˆ†ç±»ç»´æŠ¤é¡µé¢</h4><p>ç‚¹å‡»<code>å•†å“ç³»ç»Ÿ</code>ä¸‹çš„<code>åˆ†ç±»ç»´æŠ¤</code>ï¼Œå‘ç°æ²¡æœ‰æ•°æ®ï¼Œæ‰“å¼€æ§åˆ¶å°ï¼Œå‘ç°ç»™ç½‘å…³å‘é€äº†è¯·æ±‚ï¼Œä½†è¯·æ±‚å¤±è´¥</p><p>è¯·æ±‚è·¯å¾„ä¸º: http://localhost:88/api/product/category/list/tree</p><p>æ­£ç¡®çš„è¯·æ±‚ä¸º: http://localhost:10000/product/category/list/tree</p><p>ç½‘å…³ç”±äºæ²¡æœ‰é…ç½®<code>gulimall-product</code>ï¼Œå› æ­¤é»˜è®¤è·¯ç”±åˆ°äº†<code>renren-fast</code></p><p>å³: http://localhost:8080/renren-fast/category/list/tree</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.1.png" alt="image-20220428160942870" tabindex="0" loading="lazy"><figcaption>image-20220428160942870</figcaption></figure><h4 id="_2ã€ç½‘å…³æ·»åŠ é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2ã€ç½‘å…³æ·»åŠ é…ç½®" aria-hidden="true">#</a> 2ã€ç½‘å…³æ·»åŠ é…ç½®</h4><p>åœ¨ç½‘å…³çš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ è·¯ç”±åˆ°<code>gulumall-product</code>æ¨¡å—çš„é…ç½®</p><p>(<code>product_route</code>çš„<code>filters</code>å†™é”™äº†ï¼Œå°‘å†™äº†ä¸ª<code>s</code>ğŸ˜¨)</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> product_route
  <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//gulimall<span class="token punctuation">-</span>product
  <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> Path=/api/product/<span class="token important">**</span>
  <span class="token key atrule">filter</span><span class="token punctuation">:</span>  <span class="token comment">#è¿™é‡Œåº”è¯¥ä¸º\`filters\`ï¼Œå°‘å†™äº†ä¸€ä¸ª\`s\`</span>
    <span class="token comment">#http://localhost:88/api/product/category/list/tree å˜ä¸ºhttp://localhost:10000/product/category/list/tree</span>
    <span class="token punctuation">-</span> RewritePath=/api/(<span class="token punctuation">?</span>&lt;segment<span class="token punctuation">&gt;</span>/<span class="token punctuation">?</span>.<span class="token important">*)</span><span class="token punctuation">,</span>/$\\<span class="token punctuation">{</span>segment<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.2.png" alt="image-20220428163318103" tabindex="0" loading="lazy"><figcaption>image-20220428163318103</figcaption></figure><h4 id="_3ã€æ–°å»ºproductå‘½åç©ºé—´" tabindex="-1"><a class="header-anchor" href="#_3ã€æ–°å»ºproductå‘½åç©ºé—´" aria-hidden="true">#</a> 3ã€æ–°å»ºproductå‘½åç©ºé—´</h4><h5 id="_1ã€æ–°å»ºproductå‘½åç©ºé—´-ä½œä¸ºgilimall-producté¡¹ç›®åœ¨é…ç½®ä¸­å¿ƒçš„å‘½åç©ºé—´" tabindex="-1"><a class="header-anchor" href="#_1ã€æ–°å»ºproductå‘½åç©ºé—´-ä½œä¸ºgilimall-producté¡¹ç›®åœ¨é…ç½®ä¸­å¿ƒçš„å‘½åç©ºé—´" aria-hidden="true">#</a> 1ã€æ–°å»ºproductå‘½åç©ºé—´ï¼Œä½œä¸º<code>gilimall-product</code>é¡¹ç›®åœ¨é…ç½®ä¸­å¿ƒçš„å‘½åç©ºé—´</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.3.1.png" alt="image-20220428164008683" tabindex="0" loading="lazy"><figcaption>image-20220428164008683</figcaption></figure><h5 id="_2ã€å¤åˆ¶productçš„å‘½åç©ºé—´id" tabindex="-1"><a class="header-anchor" href="#_2ã€å¤åˆ¶productçš„å‘½åç©ºé—´id" aria-hidden="true">#</a> 2ã€å¤åˆ¶productçš„å‘½åç©ºé—´ID</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.3.2.png" alt="image-20220428164334571" tabindex="0" loading="lazy"><figcaption>image-20220428164334571</figcaption></figure><h4 id="_4ã€é…ç½®é…ç½®ä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_4ã€é…ç½®é…ç½®ä¸­å¿ƒ" aria-hidden="true">#</a> 4ã€é…ç½®é…ç½®ä¸­å¿ƒ</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„resourceç›®å½•ä¸‹æ–°å»º<code>bootstrap.properties</code>æ–‡ä»¶ï¼Œå¹¶é…ç½® åº”ç”¨åã€é…ç½®ä¸­å¿ƒåœ°å€ã€å‘½åç©ºé—´ç­‰</p><p><code>namespace</code>å†™åˆšåˆšå¤åˆ¶çš„productçš„å‘½åç©ºé—´ID</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token value attr-value">gulimall-product</span>

<span class="token key attr-name">spring.cloud.nacos.config.server-addr</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1:8848</span>
<span class="token key attr-name">spring.cloud.nacos.config.namespace</span><span class="token punctuation">=</span><span class="token value attr-value">d6d03bd1-5815-4fa1-8caf-93b09462fd45</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.4.png" alt="image-20220428165002877" tabindex="0" loading="lazy"><figcaption>image-20220428165002877</figcaption></figure><h4 id="_5ã€é…ç½®æ³¨å†Œä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_5ã€é…ç½®æ³¨å†Œä¸­å¿ƒ" aria-hidden="true">#</a> 5ã€é…ç½®æ³¨å†Œä¸­å¿ƒ</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>application.yml</code>é…ç½®æ–‡ä»¶ä¸­é…ç½®æ³¨å†Œä¸­å¿ƒåœ°å€</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.5.png" alt="image-20220428165402783" tabindex="0" loading="lazy"><figcaption>image-20220428165402783</figcaption></figure><h4 id="_6ã€å¼€å¯æœåŠ¡å‘ç°" tabindex="-1"><a class="header-anchor" href="#_6ã€å¼€å¯æœåŠ¡å‘ç°" aria-hidden="true">#</a> 6ã€å¼€å¯æœåŠ¡å‘ç°</h4><p><code>gulimall-product</code>æ¨¡å—æ·»åŠ <code>@EnableDiscoveryClient</code>æ³¨è§£ï¼Œæ¥å¼€å¯æœåŠ¡å‘ç°</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.6.png" alt="image-20220428165643767" tabindex="0" loading="lazy"><figcaption>image-20220428165643767</figcaption></figure><h4 id="_7ã€æŸ¥çœ‹æ˜¯å¦æ·»åŠ åˆ°æ³¨å†Œä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_7ã€æŸ¥çœ‹æ˜¯å¦æ·»åŠ åˆ°æ³¨å†Œä¸­å¿ƒ" aria-hidden="true">#</a> 7ã€æŸ¥çœ‹æ˜¯å¦æ·»åŠ åˆ°æ³¨å†Œä¸­å¿ƒ</h4><p>é‡æ–°å¯åŠ¨<code>gulimall-product</code>é¡¹ç›®,å¯ä»¥çœ‹åˆ°<code>gulimall-product</code>å·²ç»æ·»åŠ åˆ°æ³¨å†Œä¸­å¿ƒä¸Šäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.7.png" alt="image-20220428170006762" tabindex="0" loading="lazy"><figcaption>image-20220428170006762</figcaption></figure><h4 id="_8ã€æŸ¥çœ‹å‰ç«¯é¡µé¢" tabindex="-1"><a class="header-anchor" href="#_8ã€æŸ¥çœ‹å‰ç«¯é¡µé¢" aria-hidden="true">#</a> 8ã€æŸ¥çœ‹å‰ç«¯é¡µé¢</h4><h5 id="_1ã€ç¬¬äºŒä¸ªtreeçš„è¯·æ±‚å‡ºé”™" tabindex="-1"><a class="header-anchor" href="#_1ã€ç¬¬äºŒä¸ªtreeçš„è¯·æ±‚å‡ºé”™" aria-hidden="true">#</a> 1ã€ç¬¬äºŒä¸ªtreeçš„è¯·æ±‚å‡ºé”™</h5><p>å‘ç°ç¬¬äºŒä¸ªtreeçš„è¯·æ±‚å‡ºé”™ï¼ˆç¬¬ä¸€ä¸ª<code>OPTIONS</code>è¯·æ±‚æ–¹å¼çš„<code>åŸŸæ£€è¯·æ±‚</code>è¯·æ±‚æˆåŠŸï¼‰</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.8.1.png" alt="image-20220428170834876" tabindex="0" loading="lazy"><figcaption>image-20220428170834876</figcaption></figure><h5 id="_2ã€ä»¤ç‰Œæ— æ•ˆ" tabindex="-1"><a class="header-anchor" href="#_2ã€ä»¤ç‰Œæ— æ•ˆ" aria-hidden="true">#</a> 2ã€ä»¤ç‰Œæ— æ•ˆ</h5><p>http://localhost:88/api/product/category/list/tree</p><p>ç›´æ¥è®¿é—®ä¼šå‡ºç°<code>invalid token</code>ï¼šä»¤ç‰Œæ— æ•ˆï¼Œéæ³•çš„ä»¤ç‰Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.8.2.png" alt="image-20220428171048454" tabindex="0" loading="lazy"><figcaption>image-20220428171048454</figcaption></figure><h5 id="_3ã€ç›´æ¥è®¿é—®æ­£å¸¸" tabindex="-1"><a class="header-anchor" href="#_3ã€ç›´æ¥è®¿é—®æ­£å¸¸" aria-hidden="true">#</a> 3ã€ç›´æ¥è®¿é—®æ­£å¸¸</h5><p>http://localhost:10000/product/category/list/tree</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.8.3.png" alt="image-20220428173622969" tabindex="0" loading="lazy"><figcaption>image-20220428173622969</figcaption></figure><h5 id="_4ã€æŸ¥çœ‹åŒ¹é…çš„è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#_4ã€æŸ¥çœ‹åŒ¹é…çš„è·¯ç”±" aria-hidden="true">#</a> 4ã€æŸ¥çœ‹åŒ¹é…çš„è·¯ç”±</h5><p>åœ¨<code>gulimall-gateway</code>æ¨¡å—çš„<code>application.yml</code>é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹æ—¥å¿—çº§åˆ«</p><p>rootè¡¨ç¤ºæ‰€æœ‰åŒ…</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>logging<span class="token operator">:</span>
  level<span class="token operator">:</span>
    root<span class="token operator">:</span> debug
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é‡æ–°è¿è¡Œé¡¹ç›®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.8.4.png" alt="image-20220428180356028" tabindex="0" loading="lazy"><figcaption>image-20220428180356028</figcaption></figure><h4 id="_9ã€è°ƒæ•´è·¯ç”±é¡ºåº" tabindex="-1"><a class="header-anchor" href="#_9ã€è°ƒæ•´è·¯ç”±é¡ºåº" aria-hidden="true">#</a> 9ã€è°ƒæ•´è·¯ç”±é¡ºåº</h4><p>ä»¤ç‰Œæ— æ•ˆçš„åŸå› æ˜¯<code>product_route</code>æ²¡æœ‰ç”Ÿæ•ˆï¼Œå…ˆè¢«<code>admin_route</code>æ‹¦æˆªäº†</p><p>è°ƒæ•´ä¸€ä¸‹<code>product_route</code>å’Œ<code>admin_route</code>çš„è·¯ç”±é¡ºåº</p><p>(<code>product_route</code>çš„<code>filters</code>å†™é”™äº†ï¼Œå°‘å†™äº†ä¸ª<code>s</code>ğŸ˜¨)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.9.png" alt="image-20220428171421729" tabindex="0" loading="lazy"><figcaption>image-20220428171421729</figcaption></figure><h4 id="_10ã€å‘ç°é”™è¯¯" tabindex="-1"><a class="header-anchor" href="#_10ã€å‘ç°é”™è¯¯" aria-hidden="true">#</a> 10ã€å‘ç°é”™è¯¯</h4><h5 id="_1ã€è¯·æ±‚æŠ¥é”™" tabindex="-1"><a class="header-anchor" href="#_1ã€è¯·æ±‚æŠ¥é”™" aria-hidden="true">#</a> 1ã€è¯·æ±‚æŠ¥é”™</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.10.1.png" alt="image-20220428173247272" tabindex="0" loading="lazy"><figcaption>image-20220428173247272</figcaption></figure><h5 id="_2ã€ç›´æ¥è®¿é—®æ­£å¸¸" tabindex="-1"><a class="header-anchor" href="#_2ã€ç›´æ¥è®¿é—®æ­£å¸¸" aria-hidden="true">#</a> 2ã€ç›´æ¥è®¿é—®æ­£å¸¸</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.10.2.png" alt="image-20220428173746039" tabindex="0" loading="lazy"><figcaption>image-20220428173746039</figcaption></figure><h5 id="_3ã€ä¿®æ”¹æ—¥å¿—çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹æ—¥å¿—çº§åˆ«" aria-hidden="true">#</a> 3ã€ä¿®æ”¹æ—¥å¿—çº§åˆ«</h5><p>åœ¨<code>gulimall-gateway</code>æ¨¡å—çš„<code>application.yml</code>é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹æ—¥å¿—çº§åˆ«</p><p>rootè¡¨ç¤ºæ‰€æœ‰åŒ…</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">root</span><span class="token punctuation">:</span> debug
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.10.3.png" alt="image-20220428173856379" tabindex="0" loading="lazy"><figcaption>image-20220428173856379</figcaption></figure><h5 id="_4ã€æŸ¥çœ‹é”™è¯¯" tabindex="-1"><a class="header-anchor" href="#_4ã€æŸ¥çœ‹é”™è¯¯" aria-hidden="true">#</a> 4ã€æŸ¥çœ‹é”™è¯¯</h5><p>çš„ç¡®åŒ¹é…åˆ°äº†<code>product_route</code>ä½†æ˜¯è¯·æ±‚è·¯å¾„å˜æˆäº† http://192.168.19.1:10000/api/product/category/list/tree</p><p>è€Œæ­£ç¡®çš„è·¯å¾„åº”è¯¥ä¸º: http://192.168.19.1:10000/product/category/list/tree</p><p>æ²¡æœ‰è¿™ä¸ª<code>/api</code>ï¼Œåº”è¯¥æ˜¯è·¯å¾„é‡å†™æ²¡æœ‰ç”Ÿæ•ˆ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.10.4.1.png" alt="image-20220428173111604" tabindex="0" loading="lazy"><figcaption>image-20220428173111604</figcaption></figure><p>è¿™é‡Œçš„ipä¸º<code>192.168.19.1</code>æ˜¯å› ä¸ºå®ƒç”¨çš„æ˜¯VMnet8çš„ip</p><p><code>cmd</code>è¾“å…¥<code>ipconfig</code>å‘½ä»¤å¯ä»¥æŸ¥çœ‹æ‰€æœ‰ip</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ipconfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.10.4.2.png" alt="image-20220428182149959" tabindex="0" loading="lazy"><figcaption>image-20220428182149959</figcaption></figure><h5 id="_5ã€å°‘å†™äº†ä¸ªs" tabindex="-1"><a class="header-anchor" href="#_5ã€å°‘å†™äº†ä¸ªs" aria-hidden="true">#</a> 5ã€å°‘å†™äº†ä¸ªsğŸ˜¨</h5><p><code>filters</code>å†™æˆäº†<code>filter</code>,å°‘å†™äº†ä¸ªsğŸ˜¨</p><p>æ”¹è¿‡æ¥å°±è¡Œäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.10.5.png" alt="image-20220428182642830" tabindex="0" loading="lazy"><figcaption>image-20220428182642830</figcaption></figure><h4 id="_11ã€åˆ·æ–°é¡µé¢" tabindex="-1"><a class="header-anchor" href="#_11ã€åˆ·æ–°é¡µé¢" aria-hidden="true">#</a> 11ã€åˆ·æ–°é¡µé¢</h4><p>å·²ç»ä¸æŠ¥é”™ï¼Œå¹¶ä¸”æ•°æ®ä¹Ÿè·å–åˆ°äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.11.1.png" alt="image-20220428182729802" tabindex="0" loading="lazy"><figcaption>image-20220428182729802</figcaption></figure><p>æ§åˆ¶å°ä¹Ÿè¾“å‡ºæ•°æ®äº†ï¼Œæ•°æ®åœ¨<code>data.data</code>ä¸­</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.11.2.png" alt="image-20220428183017017" tabindex="0" loading="lazy"><figcaption>image-20220428183017017</figcaption></figure><h4 id="_12ã€è·å¾—æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_12ã€è·å¾—æ•°æ®" aria-hidden="true">#</a> 12ã€è·å¾—æ•°æ®</h4><p>ä½¿ç”¨<code>console.log(data)</code>è¿”å›çš„æ•°æ®åœ¨<code>data.data</code>ä¸­</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>console.log(data)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.12.1.png" alt="image-20220428184002713" tabindex="0" loading="lazy"><figcaption>image-20220428184002713</figcaption></figure><p>å› æ­¤ä½¿ç”¨<code>console.log(data.data.data)</code>å³ä¸ºæ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.12.2.png" alt="image-20220428184312865" tabindex="0" loading="lazy"><figcaption>image-20220428184312865</figcaption></figure><p>è¿™æ ·å†™å¯ä»¥å°‘å†™ä¸€ä¸ª<code>.data</code>ï¼Œç”±<code>console.log(data.data.data)</code>æ”¹ä¸º<code>console.log(data.data)</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>data<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.12.3.png" alt="image-20220428184442887" tabindex="0" loading="lazy"><figcaption>image-20220428184442887</figcaption></figure><p>æŠŠæ•°æ®èµ‹ç»™<code>data</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.12.4.png" alt="image-20220428185149029" tabindex="0" loading="lazy"><figcaption>image-20220428185149029</figcaption></figure><h4 id="_13ã€ç»“æ„å‡ºæ¥äº†" tabindex="-1"><a class="header-anchor" href="#_13ã€ç»“æ„å‡ºæ¥äº†" aria-hidden="true">#</a> 13ã€ç»“æ„å‡ºæ¥äº†</h4><p>ç»“æ„å‡ºæ¥äº†ä½†æ˜¯æ²¡æœ‰æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.13.png" alt="image-20220428184923869" tabindex="0" loading="lazy"><figcaption>image-20220428184923869</figcaption></figure><h4 id="_14ã€ä¿®æ”¹å±æ€§åå­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_14ã€ä¿®æ”¹å±æ€§åå­—æ®µ" aria-hidden="true">#</a> 14ã€ä¿®æ”¹å±æ€§åå­—æ®µ</h4><p>é»˜è®¤çš„å±æ€§åä¸º<code>label</code>ï¼Œè¦æ”¹ä¸º<code>name</code></p><p><code>data</code>ä¹Ÿæ”¹ä¸º<code>menu</code>ï¼Œå…±3å¤„</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.14.png" alt="image-20220428185623465" tabindex="0" loading="lazy"><figcaption>image-20220428185623465</figcaption></figure><h4 id="_15ã€æ˜¾ç¤ºæ ‘å½¢ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_15ã€æ˜¾ç¤ºæ ‘å½¢ç»“æ„" aria-hidden="true">#</a> 15ã€æ˜¾ç¤ºæ ‘å½¢ç»“æ„</h4><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.15.png" alt="image-20220428185858698" tabindex="0" loading="lazy"><figcaption>image-20220428185858698</figcaption></figure><h4 id="_16ã€æ˜¾ç¤ºæ·»åŠ å’Œåˆ é™¤" tabindex="-1"><a class="header-anchor" href="#_16ã€æ˜¾ç¤ºæ·»åŠ å’Œåˆ é™¤" aria-hidden="true">#</a> 16ã€æ˜¾ç¤ºæ·»åŠ å’Œåˆ é™¤</h4><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>data</td><td>å±•ç¤ºæ•°æ®</td><td>array</td><td></td></tr><tr><td>node-key</td><td>æ¯ä¸ªæ ‘èŠ‚ç‚¹ç”¨æ¥ä½œä¸ºå”¯ä¸€æ ‡è¯†çš„å±æ€§ï¼Œæ•´æ£µæ ‘åº”è¯¥æ˜¯å”¯ä¸€çš„</td><td>String</td><td></td></tr><tr><td>props</td><td>é…ç½®é€‰é¡¹</td><td>object</td><td></td></tr><tr><td>expand-on-click-node</td><td>æ˜¯å¦åœ¨ç‚¹å‡»èŠ‚ç‚¹çš„æ—¶å€™å±•å¼€æˆ–è€…æ”¶ç¼©èŠ‚ç‚¹ï¼Œ é»˜è®¤å€¼ä¸º trueï¼Œå¦‚æœä¸º falseï¼Œåˆ™åªæœ‰ç‚¹ç®­å¤´å›¾æ ‡çš„æ—¶å€™æ‰ä¼šå±•å¼€æˆ–è€…æ”¶ç¼©èŠ‚ç‚¹ã€‚</td><td>boolean</td><td>true</td></tr><tr><td>show-checkbox</td><td>èŠ‚ç‚¹æ˜¯å¦å¯è¢«é€‰æ‹©</td><td>boolean</td><td>false</td></tr></tbody></table><p>ä»¥ä¸‹ä»£ç å‡åœ¨<code>category.vue</code>æ–‡ä»¶ä¸­ä¿®æ”¹</p><h5 id="_1ã€æ˜¾ç¤ºappendå’Œdelete" tabindex="-1"><a class="header-anchor" href="#_1ã€æ˜¾ç¤ºappendå’Œdelete" aria-hidden="true">#</a> 1ã€æ˜¾ç¤º<code>append</code>å’Œ<code>delete</code></h5><p>åœ¨<code>el-tree</code>æ ‡ç­¾å†…æ·»åŠ  <code>Append</code>å’Œ<code>Delete</code></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>custom-tree-node<span class="token punctuation">&quot;</span></span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ node, data }<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>{{ node.label }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mini<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>() =&gt; append(data)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      Append
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mini<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>() =&gt; remove(node, data)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      Delete
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2ã€æ·»åŠ appendå’Œremoveæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ appendå’Œremoveæ–¹æ³•" aria-hidden="true">#</a> 2ã€æ·»åŠ <code>append</code>å’Œ<code>remove</code>æ–¹æ³•</h5><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">append</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;appendæ–¹æ³•ä¸­çš„dataå‚æ•°ï¼š&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">remove</span><span class="token punctuation">(</span><span class="token parameter">node<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;removeæ–¹æ³•ä¸­çš„nodeå‚æ•°ï¼š&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;removeæ–¹æ³•ä¸­çš„dataå‚æ•°ï¼š&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3ã€ä¿®æ”¹æ·»åŠ å’Œåˆ é™¤æŒ‰é’®æ˜¾ç¤ºè§„åˆ™" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹æ·»åŠ å’Œåˆ é™¤æŒ‰é’®æ˜¾ç¤ºè§„åˆ™" aria-hidden="true">#</a> 3ã€ä¿®æ”¹æ·»åŠ å’Œåˆ é™¤æŒ‰é’®æ˜¾ç¤ºè§„åˆ™</h5><p>å½“ä¸æ˜¯å¶å­èŠ‚ç‚¹æ—¶æ‰æ˜¾ç¤º<code>Append</code></p><p>åœ¨å†…å®¹ä¸º<code>Append</code>å¯¹åº”çš„<code>el-button</code>æ ‡ç­¾å†…æ·»åŠ å±æ€§<code>v-if=&quot;data.catLevel&lt;=2&quot;</code>,ä½¿å½“å‰èŠ‚ç‚¹æ·±åº¦å°‘äº2æ—¶æ‰æ˜¾ç¤º</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>v-if=&quot;data.catLevel&lt;=2&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å½“æ²¡æœ‰å­èŠ‚ç‚¹æ—¶æ‰æ˜¾ç¤º<code>Delete</code></p><p>åœ¨å†…å®¹ä¸º<code>Delete</code>å¯¹åº”çš„<code>el-button</code>æ ‡ç­¾å†…æ·»åŠ å±æ€§<code>v-if=&quot;data.children.length==0&quot;</code>,ä½¿å½“å‰èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹æ—¶æ‰æ˜¾ç¤º</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>v-if=&quot;data.children.length==0&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_4ã€el-treeæ ‡ç­¾å†…æ·»åŠ å±æ€§" tabindex="-1"><a class="header-anchor" href="#_4ã€el-treeæ ‡ç­¾å†…æ·»åŠ å±æ€§" aria-hidden="true">#</a> 4ã€<code>el-tree</code>æ ‡ç­¾å†…æ·»åŠ å±æ€§</h5><p><code>:expand-on-click-node=&quot;false&quot;</code>ä½¿ç”¨æˆ·åªæœ‰ç‚¹å‡»ç®­å¤´å›¾æ ‡çš„æ—¶å€™æ‰ä¼šå±•å¼€æˆ–è€…æ”¶ç¼©èŠ‚ç‚¹ã€‚</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token punctuation">:</span>expand-on-click-node<span class="token punctuation">=</span>&quot;false&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_5ã€æ˜¾ç¤ºå¤é€‰æ¡†" tabindex="-1"><a class="header-anchor" href="#_5ã€æ˜¾ç¤ºå¤é€‰æ¡†" aria-hidden="true">#</a> 5ã€æ˜¾ç¤ºå¤é€‰æ¡†</h5><p><code>el-tree</code>æ ‡ç­¾å†…æ·»åŠ <code>show-checkbox</code>å±æ€§</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>show-checkbox
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_6ã€æ·»åŠ èŠ‚ç‚¹æ ‡è¯†" tabindex="-1"><a class="header-anchor" href="#_6ã€æ·»åŠ èŠ‚ç‚¹æ ‡è¯†" aria-hidden="true">#</a> 6ã€æ·»åŠ èŠ‚ç‚¹æ ‡è¯†</h5><p>ç”±äº<code>catId</code>ä¸ºå”¯ä¸€idï¼Œä¸ä¼šé‡å¤ï¼Œæ‰€ä»¥æŠŠ<code>catId</code>ä½œä¸ºèŠ‚ç‚¹æ ‡è¯†</p><p><s>ç»™<code>el-tree</code>æ ‡ç­¾æ·»åŠ å±æ€§<code>node-key=&quot;data.catId&quot;</code></s>,æŠŠ<code>catId</code>ä½œä¸ºèŠ‚ç‚¹æ ‡è¯†ï¼ŒåŠ å¿«æ¸²æŸ“æ•ˆç‡</p><p>åº”è¯¥ä¸º<code>node-key=&quot;catId&quot;</code>ï¼Œåé¢å‘ç°å†™é”™äº†,å¯ä»¥çœ‹åˆ°ç‚¹å‡»â€œæ‘„å½±æ‘„åƒâ€ï¼Œä¸‹æ–¹ç›´æ¥æ‰“å°çš„&quot;catId&quot;å³ä¸ºæƒ³è¦è®¾ç½®çš„å€¼ï¼Œå¹¶ä¸åœ¨dataä¸‹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.3.16.6.png" alt="image-20220429205157370" tabindex="0" loading="lazy"><figcaption>image-20220429205157370</figcaption></figure><h4 id="_17ã€å®Œæ•´ä»£ç " tabindex="-1"><a class="header-anchor" href="#_17ã€å®Œæ•´ä»£ç " aria-hidden="true">#</a> 17ã€å®Œæ•´ä»£ç </h4><p><a href="code/4.1.3.17.vue">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç </a></p><h3 id="_4-1-4ã€åˆ†ç±»ç»´æŠ¤å®ç°æ·»åŠ å’Œåˆ é™¤åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#_4-1-4ã€åˆ†ç±»ç»´æŠ¤å®ç°æ·»åŠ å’Œåˆ é™¤åŠŸèƒ½" aria-hidden="true">#</a> 4.1.4ã€åˆ†ç±»ç»´æŠ¤å®ç°æ·»åŠ å’Œåˆ é™¤åŠŸèƒ½</h3><h4 id="_1ã€æ·»åŠ æµ‹è¯•æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ æµ‹è¯•æ•°æ®" aria-hidden="true">#</a> 1ã€æ·»åŠ æµ‹è¯•æ•°æ®</h4><p>Duplicate entry &#39;1432&#39; for key &#39;Primary &#39;: ä¸»é”®é‡å¤</p><p>Duplicate: é‡å¤ï¼Œå¤åˆ¶</p><p>æˆ‘éƒ½æ²¡ç”¨ï¼Œå®ƒè¯´æˆ‘ä¸»é”®é‡å¤ğŸ˜¨</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.1.1.png" alt="image-20220429090628243" tabindex="0" loading="lazy"><figcaption>image-20220429090628243</figcaption></figure><p>ä¸å†™<code>cat_id</code>ç›´æ¥æ·»åŠ æ•°æ®ï¼Œå‘ç°<code>cat_id</code>å·²ç»åˆ°1433äº†ï¼Œ<s>åº”è¯¥æ˜¯å¯¼å…¥çš„sqlè¯­å¥å·²ç»ç”¨è¿‡1432äº†</s></p><p>ï¼ˆè¿™é‡Œæ˜¯<code>navicat</code>æ²¡æ˜¾ç¤ºå®Œ,1432å·²ç»è¢«ä½¿ç”¨äº†ï¼Œæ­»å‘ğŸ˜ˆï¼‰</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.1.2.png" alt="image-20220429091322757" tabindex="0" loading="lazy"><figcaption>image-20220429091322757</figcaption></figure><p>æ±‰å­—ä¹±ç æ˜¯å› ä¸º<code>cmd</code>ç¼–ç ä¸º<code>gbk</code>ï¼Œè€Œmysqlè®¾ç½®çš„ç¼–ç ä¸º<code>utf-8</code>ï¼Œè¿™é‡Œä¸ç”¨ç®¡å®ƒ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.1.3.png" alt="image-20220429110456709" tabindex="0" loading="lazy"><figcaption>image-20220429110456709</figcaption></figure><h4 id="_2ã€æµ‹è¯•åˆ é™¤æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æµ‹è¯•åˆ é™¤æ–¹æ³•" aria-hidden="true">#</a> 2ã€æµ‹è¯•åˆ é™¤æ–¹æ³•</h4><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.2.1.png" alt="image-20220429092432729" tabindex="0" loading="lazy"><figcaption>image-20220429092432729</figcaption></figure><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST http://localhost:10000/product/category/delete
Content-Type: application/json

[1433]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.2.2.png" alt="image-20220429091751970" tabindex="0" loading="lazy"><figcaption>image-20220429091751970</figcaption></figure><p>å¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸäº†(&quot;msg&quot;ä¸º&quot;success&quot;)</p><p>åˆ·æ–°ä¸€ä¸‹è¡¨ï¼Œå·²ç»æ²¡æœ‰æµ‹è¯•æ•°æ®äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.2.3.png" alt="image-20220429092613049" tabindex="0" loading="lazy"><figcaption>image-20220429092613049</figcaption></figure><h4 id="_3ã€åˆ é™¤åŠŸèƒ½controller" tabindex="-1"><a class="header-anchor" href="#_3ã€åˆ é™¤åŠŸèƒ½controller" aria-hidden="true">#</a> 3ã€åˆ é™¤åŠŸèƒ½Controller</h4><p><code>categoryService.removeByIds(Arrays.asList(catIds));</code>è¿™ä¸€è¡Œåº”è¯¥åˆ æ‰ï¼Œè¿™é‡Œå†™é”™äº†</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * åˆ é™¤
 * @RequestBody ;è·å–è¯·æ±‚ä½“ï¼Œå¿…é¡»å‘é€POSTè¯·æ±‚
 * SpringMVCè‡ªåŠ¨å°†è¯·æ±‚ä½“çš„æ•°æ®(json) ï¼Œè½¬ä¸ºå¯¹åº”çš„å¯¹è±¡
 */</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/delete&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> catIds<span class="token punctuation">)</span><span class="token punctuation">{</span>
    categoryService<span class="token punctuation">.</span><span class="token function">removeByIds</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>catIds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//è¿™ä¸€è¡Œåº”è¯¥åˆ æ‰</span>

    <span class="token comment">//æ£€æŸ¥å½“å‰åˆ é™¤çš„èœå•æ˜¯å¦è¢«åˆ«çš„åœ°æ–¹å¼•ç”¨</span>
    <span class="token comment">//categoryService.removeByIds(Arrays.asList(catIds));</span>

    <span class="token comment">//æ‰¹é‡åˆ é™¤</span>
    categoryService<span class="token punctuation">.</span><span class="token function">removeMenuByIds</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>catIds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.3.png" alt="image-20220429100222561" tabindex="0" loading="lazy"><figcaption>image-20220429100222561</figcaption></figure><h4 id="_4ã€åˆ é™¤åŠŸèƒ½serviceæ¥å£" tabindex="-1"><a class="header-anchor" href="#_4ã€åˆ é™¤åŠŸèƒ½serviceæ¥å£" aria-hidden="true">#</a> 4ã€åˆ é™¤åŠŸèƒ½Serviceæ¥å£</h4><p>åœ¨Controllerçš„è°ƒç”¨è¯¥æ–¹æ³•çš„åœ°æ–¹ä½¿ç”¨<code>alt+enter</code>å¿«æ·é”®å¯ä»¥å¿«é€Ÿè½¬åˆ°<code>CategoryService</code>æ¥å£ï¼Œå¹¶ç”Ÿæˆè¯¥æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.4.png" alt="image-20220429093531976" tabindex="0" loading="lazy"><figcaption>image-20220429093531976</figcaption></figure><h4 id="_5ã€å®ç°æ‰¹é‡åˆ é™¤æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€å®ç°æ‰¹é‡åˆ é™¤æ–¹æ³•" aria-hidden="true">#</a> 5ã€å®ç°æ‰¹é‡åˆ é™¤æ–¹æ³•</h4><p>åœ¨æ¥å£ç±»çš„å·¦ä¾§ç‚¹å‡»ä¸‹ç®­å¤´å¯ä»¥è¿…é€Ÿè·³è½¬åˆ°å®ç°ç±»,ä½¿ç”¨<code>alt+enter</code>å¿«æ·å°†æ·»åŠ æœªå®ç°çš„æ–¹æ³•</p><p>å…ˆéœ€è¦æ£€æŸ¥ï¼Œç”±äºä¸çŸ¥é“ä»€ä¹ˆä¸šåŠ¡ä¼šå¼•ç”¨èœå•ï¼Œå› æ­¤å…ˆåŠ ä¸ª<code>//TODO</code>åšä¸ªæ ‡è®°(ç”±äºç”Ÿæˆçš„æ—¶å€™é‡Œé¢æœ‰å¾ˆå¤š<code>//TODO</code>æ‰€ä»¥å¾…åŠäº‹é¡¹çœ‹èµ·æ¥æœ‰å¾ˆå¤š)</p><p>(å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨<code>IDEA</code>ä¸­çš„<code>Favorites</code>,è¿™ä¸ªæ„Ÿè§‰å¾ˆå¥½ç”¨)</p><p>ç„¶åå†ä½¿ç”¨é€»è¾‘åˆ é™¤æ¥æ‰¹é‡åˆ é™¤æ•°æ®</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeMenuByIds</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> asList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//TODO æ£€æŸ¥å½“å‰åˆ é™¤çš„èœå•æ˜¯å¦è¢«åˆ«çš„åœ°æ–¹å¼•ç”¨</span>

    <span class="token comment">//é€»è¾‘åˆ é™¤(show_statusä½œä¸ºæ ‡å¿—ä½ï¼Œç½®ä¸º0è¡¨ç¤ºåˆ é™¤)</span>
    baseMapper<span class="token punctuation">.</span><span class="token function">deleteBatchIds</span><span class="token punctuation">(</span>asList<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.5.png" alt="image-20220429095942397" tabindex="0" loading="lazy"><figcaption>image-20220429095942397</figcaption></figure><h4 id="_6ã€é…ç½®é€»è¾‘åˆ é™¤" tabindex="-1"><a class="header-anchor" href="#_6ã€é…ç½®é€»è¾‘åˆ é™¤" aria-hidden="true">#</a> 6ã€é…ç½®é€»è¾‘åˆ é™¤</h4><h5 id="_1ã€æ·»åŠ é…ç½®" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ é…ç½®" aria-hidden="true">#</a> 1ã€æ·»åŠ é…ç½®</h5><blockquote><p>é…ç½®<code>com.baomidou.mybatisplus.core.config.GlobalConfig$DbConfig</code></p></blockquote><p>(è¿™ä¸ªé…ç½®æ­£å¥½å’Œéœ€æ±‚æ˜¯åçš„)</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">mybatis-plus</span><span class="token punctuation">:</span>
  <span class="token key atrule">global-config</span><span class="token punctuation">:</span>
    <span class="token key atrule">db-config</span><span class="token punctuation">:</span>
      <span class="token key atrule">logic-delete-field</span><span class="token punctuation">:</span> flag <span class="token comment"># å…¨å±€é€»è¾‘åˆ é™¤çš„å®ä½“å­—æ®µå(since 3.3.0,é…ç½®åå¯ä»¥å¿½ç•¥ä¸é…ç½®æ­¥éª¤2)</span>
      <span class="token key atrule">logic-delete-value</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token comment"># é€»è¾‘å·²åˆ é™¤å€¼(é»˜è®¤ä¸º 1)</span>
      <span class="token key atrule">logic-not-delete-value</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token comment"># é€»è¾‘æœªåˆ é™¤å€¼(é»˜è®¤ä¸º 0)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.6.1.png" alt="image-20220429101346965" tabindex="0" loading="lazy"><figcaption>image-20220429101346965</figcaption></figure><h5 id="_2ã€æ·»åŠ æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ æ³¨è§£" aria-hidden="true">#</a> 2ã€æ·»åŠ æ³¨è§£</h5><blockquote><p>åœ¨<code>com.atguigu.gulimall.product.entity.CategoryEntity</code>ç±»çš„<code>showStatus</code>å­—æ®µæ·»åŠ æ³¨è§£</p><ul><li><code>value</code>é€»è¾‘æœªåˆ é™¤é™¤çš„å€¼</li><li><code>delval</code> é€»è¾‘è¢«åˆ é™¤çš„å€¼</li></ul></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@TableLogic</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>delval <span class="token operator">=</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.6.2.png" alt="image-20220429101838137" tabindex="0" loading="lazy"><figcaption>image-20220429101838137</figcaption></figure><h5 id="_3ã€è°ƒæ•´æ—¥å¿—çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#_3ã€è°ƒæ•´æ—¥å¿—çº§åˆ«" aria-hidden="true">#</a> 3ã€è°ƒæ•´æ—¥å¿—çº§åˆ«</h5><p>åœ¨<code>gulimall-product\\src\\main\\resources\\application.yml</code>é‡Œé¢æ·»åŠ é…ç½®,è°ƒæˆ<code>debug</code>çº§åˆ«</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">com.atguigu.gulimall</span><span class="token punctuation">:</span> debug
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å›¾çš„gulimallå†™é”™äº†,åæ¥æ²¡æ‰“å°sqlè¯­å¥æ‰å‘ç°çš„</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.6.3.png" alt="image-20220429102750359" tabindex="0" loading="lazy"><figcaption>image-20220429102750359</figcaption></figure><h4 id="_7ã€æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_7ã€æµ‹è¯•" aria-hidden="true">#</a> 7ã€æµ‹è¯•</h4><h5 id="_1ã€æ·»åŠ æµ‹è¯•æ•°æ®-1" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ æµ‹è¯•æ•°æ®-1" aria-hidden="true">#</a> 1ã€æ·»åŠ æµ‹è¯•æ•°æ®</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.7.1.png" alt="image-20220429102907478" tabindex="0" loading="lazy"><figcaption>image-20220429102907478</figcaption></figure><h5 id="_2ã€åˆ é™¤cat-idä¸º1434çš„æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_2ã€åˆ é™¤cat-idä¸º1434çš„æ•°æ®" aria-hidden="true">#</a> 2ã€åˆ é™¤cat_idä¸º1434çš„æ•°æ®</h5><p>é‡æ–°è¿è¡Œé¡¹ç›®ï¼Œç‚¹å‡»è¿è¡ŒæŒ‰é’®ï¼Œå‘é€åˆ é™¤çš„è¯·æ±‚</p><p>å¯ä»¥çœ‹åˆ°å·²ç»åˆ é™¤æˆåŠŸäº†</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST http://localhost:10000/product/category/delete
Content-Type: application/json

[1434]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.7.2.png" alt="image-20220429103123471" tabindex="0" loading="lazy"><figcaption>image-20220429103123471</figcaption></figure><h5 id="_3ã€æ£€æŸ¥æ˜¯å¦é€»è¾‘åˆ é™¤" tabindex="-1"><a class="header-anchor" href="#_3ã€æ£€æŸ¥æ˜¯å¦é€»è¾‘åˆ é™¤" aria-hidden="true">#</a> 3ã€æ£€æŸ¥æ˜¯å¦é€»è¾‘åˆ é™¤</h5><h6 id="_1ã€åˆ·æ–°å-å‘ç°ç›´æ¥åˆ é™¤äº†" tabindex="-1"><a class="header-anchor" href="#_1ã€åˆ·æ–°å-å‘ç°ç›´æ¥åˆ é™¤äº†" aria-hidden="true">#</a> 1ã€åˆ·æ–°åï¼Œå‘ç°ç›´æ¥åˆ é™¤äº†</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.7.3.1.png" alt="image-20220429103338298" tabindex="0" loading="lazy"><figcaption>image-20220429103338298</figcaption></figure><h6 id="_2ã€åˆ é™¤æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€åˆ é™¤æ–¹æ³•" aria-hidden="true">#</a> 2ã€åˆ é™¤æ–¹æ³•</h6><p>åˆ é™¤<code>CategoryController</code>ç±»çš„è¿™ä¸€è¡Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.7.3.2.png" alt="image-20220429103415229" tabindex="0" loading="lazy"><figcaption>image-20220429103415229</figcaption></figure><h6 id="_3ã€é‡æ–°æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_3ã€é‡æ–°æµ‹è¯•" aria-hidden="true">#</a> 3ã€é‡æ–°æµ‹è¯•</h6><p>é‡å¯é¡¹ç›®,é‡æ–°æµ‹è¯•å‘ç°æ²¡æœ‰æ‰“å°sqlè¯­å¥ï¼Œè¿™ä¸ªæ—¥å¿—é…ç½®å†™é”™äº†ä¸€ä¸ªå­—æ¯ğŸ˜¨</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">com.atguigu.gulimall</span><span class="token punctuation">:</span> debug
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.7.3.3.png" alt="image-20220429104837069" tabindex="0" loading="lazy"><figcaption>image-20220429104837069</figcaption></figure><h6 id="_4ã€å‘ç°è¿˜æ˜¯ç›´æ¥åˆ é™¤äº†" tabindex="-1"><a class="header-anchor" href="#_4ã€å‘ç°è¿˜æ˜¯ç›´æ¥åˆ é™¤äº†" aria-hidden="true">#</a> 4ã€<s>å‘ç°è¿˜æ˜¯ç›´æ¥åˆ é™¤äº†</s></h6><p>éœ€è¦ç‚¹å‡»å³ä¸‹è§’çš„ä¸‹ä¸€é¡µï¼Œæ˜¾ç¤ºåé¢çš„æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.7.3.4.png" alt="image-20220429105019814" tabindex="0" loading="lazy"><figcaption>image-20220429105019814</figcaption></figure><h6 id="_5ã€æ‰“å°çš„sqlè¯­å¥æ˜¾ç¤ºçš„æ˜¯é€»è¾‘åˆ é™¤" tabindex="-1"><a class="header-anchor" href="#_5ã€æ‰“å°çš„sqlè¯­å¥æ˜¾ç¤ºçš„æ˜¯é€»è¾‘åˆ é™¤" aria-hidden="true">#</a> 5ã€æ‰“å°çš„sqlè¯­å¥æ˜¾ç¤ºçš„æ˜¯é€»è¾‘åˆ é™¤</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.7.3.5.png" alt="image-20220429105123536" tabindex="0" loading="lazy"><figcaption>image-20220429105123536</figcaption></figure><h6 id="_6ã€ä½¿ç”¨cmdè¿æ¥mysql" tabindex="-1"><a class="header-anchor" href="#_6ã€ä½¿ç”¨cmdè¿æ¥mysql" aria-hidden="true">#</a> 6ã€ä½¿ç”¨<code>cmd</code>è¿æ¥mysql</h6><p>å¯ä»¥çœ‹åˆ°å…¶å®æ˜¯é€»è¾‘åˆ é™¤ï¼Œæ•°æ®è¿˜åœ¨ï¼Œè€Œä¸”<code>show_status</code>å·²ç»æ ‡è®°ä¸º0äº†(å‘çˆ¹<code>navicat</code>ä¸ä¸€é¡µæ˜¾ç¤ºå…¨æ•°æ®ğŸ˜ˆ)</p><p>æ±‰å­—ä¹±ç æ˜¯å› ä¸º<code>cmd</code>ç¼–ç ä¸º<code>gbk</code>ï¼Œè€Œmysqlè®¾ç½®çš„ç¼–ç ä¸º<code>utf-8</code>ï¼Œè¿™é‡Œä¸ç”¨ç®¡å®ƒ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.7.3.6.png" alt="image-20220429105941270" tabindex="0" loading="lazy"><figcaption>image-20220429105941270</figcaption></figure><h6 id="_7ã€å³ä¸‹è§’å¯ä»¥ç¿»é¡µ" tabindex="-1"><a class="header-anchor" href="#_7ã€å³ä¸‹è§’å¯ä»¥ç¿»é¡µ" aria-hidden="true">#</a> 7ã€å³ä¸‹è§’å¯ä»¥ç¿»é¡µ</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.7.3.7.png" alt="image-20220429130754284" tabindex="0" loading="lazy"><figcaption>image-20220429130754284</figcaption></figure><h6 id="_8ã€ç‚¹å‡»è®¾ç½®å¯ä»¥æ›´æ”¹æ¯é¡µæ˜¾ç¤ºçš„è¡Œæ•°" tabindex="-1"><a class="header-anchor" href="#_8ã€ç‚¹å‡»è®¾ç½®å¯ä»¥æ›´æ”¹æ¯é¡µæ˜¾ç¤ºçš„è¡Œæ•°" aria-hidden="true">#</a> 8ã€ç‚¹å‡»è®¾ç½®å¯ä»¥æ›´æ”¹æ¯é¡µæ˜¾ç¤ºçš„è¡Œæ•°</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.4.7.3.8.png" alt="image-20220429131007804" tabindex="0" loading="lazy"><figcaption>image-20220429131007804</figcaption></figure><h3 id="_4-1-5ã€åˆ†ç±»ç»´æŠ¤å‰ç«¯å‘é€åˆ é™¤è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_4-1-5ã€åˆ†ç±»ç»´æŠ¤å‰ç«¯å‘é€åˆ é™¤è¯·æ±‚" aria-hidden="true">#</a> 4.1.5ã€åˆ†ç±»ç»´æŠ¤å‰ç«¯å‘é€åˆ é™¤è¯·æ±‚</h3><h4 id="_1ã€å°è£…è¯·æ±‚çš„å·¥å…·ç±»" tabindex="-1"><a class="header-anchor" href="#_1ã€å°è£…è¯·æ±‚çš„å·¥å…·ç±»" aria-hidden="true">#</a> 1ã€å°è£…è¯·æ±‚çš„å·¥å…·ç±»</h4><p>å°è£…çš„å‘é€<code>ajax</code>è¯·æ±‚æ–¹æ³•åœ¨<code>src\\utils\\httpRequest.js</code>æ–‡ä»¶å†…</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.5.1.png" alt="image-20220429122946232" tabindex="0" loading="lazy"><figcaption>image-20220429122946232</figcaption></figure><h4 id="_2ã€postè¯·æ±‚æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_2ã€postè¯·æ±‚æ¨¡å—" aria-hidden="true">#</a> 2ã€postè¯·æ±‚æ¨¡å—</h4><p><code>post</code>è¯·æ±‚å¯ä»¥å¤åˆ¶<code>src\\views\\modules\\sys\\role.vue</code>é‡Œé¢çš„</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.5.2.png" alt="image-20220429124108364" tabindex="0" loading="lazy"><figcaption>image-20220429124108364</figcaption></figure><h4 id="_3ã€æ–°å»ºç”¨æˆ·ç‰‡æ®µ" tabindex="-1"><a class="header-anchor" href="#_3ã€æ–°å»ºç”¨æˆ·ç‰‡æ®µ" aria-hidden="true">#</a> 3ã€æ–°å»ºç”¨æˆ·ç‰‡æ®µ</h4><h5 id="_1ã€é€‰æ‹©ç”¨æˆ·ç‰‡æ®µ" tabindex="-1"><a class="header-anchor" href="#_1ã€é€‰æ‹©ç”¨æˆ·ç‰‡æ®µ" aria-hidden="true">#</a> 1ã€é€‰æ‹©ç”¨æˆ·ç‰‡æ®µ</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.5.3.1.png" alt="image-20220429124726677" tabindex="0" loading="lazy"><figcaption>image-20220429124726677</figcaption></figure><h5 id="_2ã€ç‚¹å‡»ä»¥å‰ç”Ÿæˆçš„æ¨¡æ¿" tabindex="-1"><a class="header-anchor" href="#_2ã€ç‚¹å‡»ä»¥å‰ç”Ÿæˆçš„æ¨¡æ¿" aria-hidden="true">#</a> 2ã€ç‚¹å‡»ä»¥å‰ç”Ÿæˆçš„æ¨¡æ¿</h5><p>å¦‚æœè·³è¿‡å‰é¢çš„å‰ç«¯éƒ¨åˆ†ï¼Œåœ¨è¿™é‡Œå¯ä»¥ç‚¹å‡»<code>æ–°å»ºå…¨å±€ä»£ç ç‰‡æ®µæ–‡ä»¶...</code>ï¼Œç„¶åå¤åˆ¶å…¨éƒ¨ä»£ç æ¨¡æ¿</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.5.3.2.png" alt="image-20220429124827693" tabindex="0" loading="lazy"><figcaption>image-20220429124827693</figcaption></figure><h5 id="_3ã€æ·»åŠ getå’Œpostè¯·æ±‚æ¨¡æ¿" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ getå’Œpostè¯·æ±‚æ¨¡æ¿" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>get</code>å’Œ<code>post</code>è¯·æ±‚æ¨¡æ¿</h5><p>åœ¨åé¢æ·»åŠ æ·»åŠ <code>get</code>å’Œ<code>post</code>è¯·æ±‚æ¨¡æ¿,è¾“å…¥&quot;httpget&quot;å’Œ&quot;httppost&quot;å³å¯å‡ºç°ç›¸åº”ä»£ç ç‰‡æ®µ</p><p><code>get</code>è¯·æ±‚æ¨¡æ¿</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token property">&quot;http-get è¯·æ±‚&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token property">&quot;prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;httpget&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token string">&quot;this.\\\\$http({&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;url: this.\\\\$http.adornUrl(&#39;&#39;),&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;method: &#39;get&#39;,&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;params: this.\\\\$http.adornParams({})&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;}).then(({data}) =&gt; {&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;})&quot;</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;httpGET è¯·æ±‚&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>post</code>è¯·æ±‚æ¨¡æ¿</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token property">&quot;http-post è¯·æ±‚&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token property">&quot;prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;httppost&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token string">&quot;this.\\\\$http({&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;url: this.\\\\$http.adornUrl(&#39;&#39;),&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;method: &#39;post&#39;,&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;data: this.\\\\$http.adornData(data, false)&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;}).then(({ data }) =&gt; { });&quot;</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;httpPOST è¯·æ±‚&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="code/4.1.5.3.3.%E4%BB%A3%E7%A0%81%E6%A8%A1%E6%9D%BF.snippets">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç æ¨¡æ¿</a></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.5.3.3.png" alt="image-20220429124905747" tabindex="0" loading="lazy"><figcaption>image-20220429124905747</figcaption></figure><h4 id="_4ã€ç¼–å†™åˆ é™¤ä»£ç " tabindex="-1"><a class="header-anchor" href="#_4ã€ç¼–å†™åˆ é™¤ä»£ç " aria-hidden="true">#</a> 4ã€ç¼–å†™åˆ é™¤ä»£ç </h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">remove</span><span class="token punctuation">(</span><span class="token parameter">node<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> ids <span class="token operator">=</span> <span class="token punctuation">[</span>data<span class="token punctuation">.</span>catId<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span><span class="token string">&#39;/product/category/delete&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&#39;post&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornData</span><span class="token punctuation">(</span>ids<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;åˆ é™¤æˆåŠŸ...&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">//é‡æ–°å‘é€è¯·æ±‚,æ›´æ–°æ•°æ®</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.5.4.png" alt="image-20220429193841630" tabindex="0" loading="lazy"><figcaption>image-20220429193841630</figcaption></figure><h4 id="_5ã€æ·»åŠ æµ‹è¯•æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_5ã€æ·»åŠ æµ‹è¯•æ•°æ®" aria-hidden="true">#</a> 5ã€æ·»åŠ æµ‹è¯•æ•°æ®</h4><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.5.5.png" alt="image-20220429193328389" tabindex="0" loading="lazy"><figcaption>image-20220429193328389</figcaption></figure><h4 id="_6ã€ç‚¹å‡»åˆ é™¤" tabindex="-1"><a class="header-anchor" href="#_6ã€ç‚¹å‡»åˆ é™¤" aria-hidden="true">#</a> 6ã€ç‚¹å‡»åˆ é™¤</h4><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.5.6.1.png" alt="image-20220429194221023" tabindex="0" loading="lazy"><figcaption>image-20220429194221023</figcaption></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå·²ç»æ˜¾ç¤ºåˆ é™¤æˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.5.6.2.png" alt="image-20220429194316686" tabindex="0" loading="lazy"><figcaption>image-20220429194316686</figcaption></figure><h4 id="_7ã€æŸ¥çœ‹ç»“æœ" tabindex="-1"><a class="header-anchor" href="#_7ã€æŸ¥çœ‹ç»“æœ" aria-hidden="true">#</a> 7ã€æŸ¥çœ‹ç»“æœ</h4><p>å¯ä»¥çœ‹åˆ°<code>æµ‹è¯•æ•°æ®5</code>çš„<code>show_status</code>å­—æ®µå·²ç»ä¸º0äº†ï¼ˆå·²ç»é€»è¾‘åˆ é™¤äº†ï¼‰</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.5.7.png" alt="image-20220429194442816" tabindex="0" loading="lazy"><figcaption>image-20220429194442816</figcaption></figure><h4 id="_8ã€ä½“éªŒä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_8ã€ä½“éªŒä¼˜åŒ–" aria-hidden="true">#</a> 8ã€ä½“éªŒä¼˜åŒ–</h4><h5 id="_1ã€æ·»åŠ åˆ é™¤æç¤ºæ¡†" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ åˆ é™¤æç¤ºæ¡†" aria-hidden="true">#</a> 1ã€æ·»åŠ åˆ é™¤æç¤ºæ¡†</h5>`,352),b={href:"https://element.eleme.io/#/zh-CN/component/message-box",target:"_blank",rel:"noopener noreferrer"},h=e(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$confirm</span><span class="token punctuation">(</span><span class="token string">&quot;æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤è¯¥æ–‡ä»¶, æ˜¯å¦ç»§ç»­?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;æç¤º&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">confirmButtonText</span><span class="token operator">:</span> <span class="token string">&quot;ç¡®å®š&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cancelButtonText</span><span class="token operator">:</span> <span class="token string">&quot;å–æ¶ˆ&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;warning&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;åˆ é™¤æˆåŠŸ!&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;å·²å–æ¶ˆåˆ é™¤&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ·»åŠ åˆ é™¤æç¤ºæ¡†</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$confirm</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">æ˜¯å¦åˆ é™¤ã€</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>data<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ã€‘èœå•</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token string">&quot;æç¤º&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">confirmButtonText</span><span class="token operator">:</span> <span class="token string">&quot;ç¡®å®š&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cancelButtonText</span><span class="token operator">:</span> <span class="token string">&quot;å–æ¶ˆ&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;warning&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> ids <span class="token operator">=</span> <span class="token punctuation">[</span>data<span class="token punctuation">.</span>catId<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/product/category/delete&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornData</span><span class="token punctuation">(</span>ids<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> datas <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">ã€</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>data<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ã€‘åˆ é™¤æˆåŠŸ</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//é‡æ–°å‘é€è¯·æ±‚,æ›´æ–°æ•°æ®</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;å·²å–æ¶ˆåˆ é™¤&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2ã€åˆ é™¤åé»˜è®¤å±•å¼€å…¶çˆ¶èŠ‚ç‚¹" tabindex="-1"><a class="header-anchor" href="#_2ã€åˆ é™¤åé»˜è®¤å±•å¼€å…¶çˆ¶èŠ‚ç‚¹" aria-hidden="true">#</a> 2ã€åˆ é™¤åé»˜è®¤å±•å¼€å…¶çˆ¶èŠ‚ç‚¹</h5><blockquote><p>default-expanded-keys: é»˜è®¤å±•å¼€çš„èŠ‚ç‚¹çš„ key çš„æ•°ç»„</p></blockquote><p><code>el-tree</code>æ ‡ç­¾æ·»åŠ å±æ€§<code>:default-expanded-keys=&quot;expandedKey&quot;</code></p><p><code>data</code>çš„ä¸­<code>return</code>è¯­å¥é‡Œæ·»åŠ <code> expandedKey: [],</code></p><p><code>remove</code>æ–¹æ³•æ·»åŠ <code> this.expandedKey = [node.parent.data.catId];</code></p><h6 id="_1ã€å‘ç°å¹¶æ²¡æœ‰å±•å¼€" tabindex="-1"><a class="header-anchor" href="#_1ã€å‘ç°å¹¶æ²¡æœ‰å±•å¼€" aria-hidden="true">#</a> 1ã€å‘ç°å¹¶æ²¡æœ‰å±•å¼€</h6><p>æŠŠ<code>æµ‹è¯•æ•°æ®5</code>çš„<code>show_status</code>å­—æ®µé‡æ–°ç½®ä¸º<code>1</code>åå†åˆ é™¤ï¼Œå‘ç°å¹¶æ²¡æœ‰å±•å¼€</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.5.8.2.1.png" alt="image-20220429203815538" tabindex="0" loading="lazy"><figcaption>image-20220429203815538</figcaption></figure><h6 id="_2ã€ä¿®æ”¹node-key" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹node-key" aria-hidden="true">#</a> 2ã€ä¿®æ”¹<code>node-key</code></h6><p>æŠŠ<code>node-key=&quot;data.catId&quot;</code>æ”¹ä¸º<code>node-key=&quot;catId&quot;</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.5.8.2.2.png" alt="image-20220429204100137" tabindex="0" loading="lazy"><figcaption>image-20220429204100137</figcaption></figure><p>å¯ä»¥çœ‹åˆ°ç‚¹å‡»â€œæ‘„å½±æ‘„åƒâ€ï¼Œä¸‹æ–¹ç›´æ¥æ‰“å°çš„&quot;catId&quot;å³ä¸ºæƒ³è¦è®¾ç½®çš„å€¼ï¼Œå¹¶ä¸åœ¨dataä¸‹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.5.8.2.3.png" alt="image-20220429205411898" tabindex="0" loading="lazy"><figcaption>image-20220429205411898</figcaption></figure><h4 id="_9ã€å®Œæ•´ä»£ç " tabindex="-1"><a class="header-anchor" href="#_9ã€å®Œæ•´ä»£ç " aria-hidden="true">#</a> 9ã€å®Œæ•´ä»£ç </h4><p><a href="code/4.1.5.9.vue">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç </a></p><h3 id="_4-1-6ã€åˆ†ç±»ç»´æŠ¤æ–°å¢åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#_4-1-6ã€åˆ†ç±»ç»´æŠ¤æ–°å¢åŠŸèƒ½" aria-hidden="true">#</a> 4.1.6ã€åˆ†ç±»ç»´æŠ¤æ–°å¢åŠŸèƒ½</h3><h4 id="_1ã€å‰ç«¯å‘é€æ–°å¢è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_1ã€å‰ç«¯å‘é€æ–°å¢è¯·æ±‚" aria-hidden="true">#</a> 1ã€å‰ç«¯å‘é€æ–°å¢è¯·æ±‚</h4><h5 id="_1ã€æ·»åŠ é¡µé¢" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ é¡µé¢" aria-hidden="true">#</a> 1ã€æ·»åŠ é¡µé¢</h5><p>å†<code>template</code>æ ‡ç­¾çš„<code>div</code>é‡Œé¢æ·»åŠ é¡µé¢</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dialog</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æç¤º<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:visible.sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dialogVisible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>30%<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form</span> <span class="token attr-name">:model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>category<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>åˆ†ç±»åç§°<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>category.name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>off<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>footer<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dialog-footer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dialogVisible = false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>å– æ¶ˆ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>addCatagory<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>ç¡® å®š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dialog</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2ã€æ·»åŠ æ•°æ®å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ æ•°æ®å­—æ®µ" aria-hidden="true">#</a> 2ã€æ·»åŠ æ•°æ®å­—æ®µ</h5><p>åœ¨<code>data</code>çš„<code>return</code>è¯­å¥ä¸­æ·»åŠ <code> category: { name: &quot;&quot; },</code></p><h5 id="_3ã€æ·»åŠ æäº¤æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ æäº¤æ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ æäº¤æ–¹æ³•</h5><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">addCatagory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogVisible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;catagoryä¸­çš„æ•°æ®:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_4ã€ç‚¹å‡»appendæ˜¾ç¤ºå¯¹è¯æ¡†" tabindex="-1"><a class="header-anchor" href="#_4ã€ç‚¹å‡»appendæ˜¾ç¤ºå¯¹è¯æ¡†" aria-hidden="true">#</a> 4ã€ç‚¹å‡»<code>append</code>æ˜¾ç¤ºå¯¹è¯æ¡†</h5><p>åœ¨<code>append</code>æ–¹æ³•ä¸­æ·»åŠ <code>this.dialogVisible = true;</code></p><h5 id="_5ã€æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_5ã€æµ‹è¯•" aria-hidden="true">#</a> 5ã€æµ‹è¯•</h5><p>ç‚¹å‡»&quot;append&quot;æŒ‰é’®ï¼Œè¾“å…¥åˆ†ç±»åç§°ï¼Œç‚¹å‡»ç¡®å®šï¼Œå¯ä»¥å‘ç°<code>category</code>ä¸­çš„æ•°æ®æœ‰<code>name: &#39;hhh&#39;</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.6.5.png" alt="image-20220429213147531" tabindex="0" loading="lazy"><figcaption>image-20220429213147531</figcaption></figure><h5 id="_6ã€ä¿®æ”¹categoryæ•°æ®" tabindex="-1"><a class="header-anchor" href="#_6ã€ä¿®æ”¹categoryæ•°æ®" aria-hidden="true">#</a> 6ã€ä¿®æ”¹<code>category</code>æ•°æ®</h5><p>è€Œåç«¯éœ€è¦çš„ç”±ä»¥ä¸‹äº”ä¸ªæ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.6.6.png" alt="image-20220429213643518" tabindex="0" loading="lazy"><figcaption>image-20220429213643518</figcaption></figure><p>ä¿®æ”¹<code>data</code>æ•°æ®ä¸‹<code>retrun</code>é‡Œé¢çš„<code>category</code></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>category: { name: &quot;&quot;, parentCid: 0, catLevel: 0, showStatus: 1, sort: 0 },
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_7ã€ä¿®æ”¹appendæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_7ã€ä¿®æ”¹appendæ–¹æ³•" aria-hidden="true">#</a> 7ã€ä¿®æ”¹<code>append</code>æ–¹æ³•</h5><p>åœ¨<code>append</code>æ–¹æ³•ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç </p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//&lt;ç‚¹å‡»appendæŒ‰é’®çš„èŠ‚ç‚¹&gt;ä¸º&lt;è¦æ·»åŠ çš„èŠ‚ç‚¹&gt;çš„çˆ¶èŠ‚ç‚¹</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>parentCid <span class="token operator">=</span> data<span class="token punctuation">.</span>catId<span class="token punctuation">;</span>
<span class="token comment">//&lt;è¦æ·»åŠ çš„èŠ‚ç‚¹&gt;çš„çˆ¶èŠ‚ç‚¹çš„å±‚çº§ä¸º&lt;ç‚¹å‡»appendæŒ‰é’®çš„èŠ‚ç‚¹&gt;+1</span>
<span class="token comment">//data.catLevel*1 å¯ä»¥å°† Stringç±»å‹çš„ data.catLevel è½¬ä¸º int ç±»å‹</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>catLevel <span class="token operator">=</span> data<span class="token punctuation">.</span>catLevel <span class="token operator">*</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_8ã€æµ‹è¯•categoryæºå¸¦çš„å‚æ•°" tabindex="-1"><a class="header-anchor" href="#_8ã€æµ‹è¯•categoryæºå¸¦çš„å‚æ•°" aria-hidden="true">#</a> 8ã€æµ‹è¯•categoryæºå¸¦çš„å‚æ•°</h5><p>å¯ä»¥çœ‹åˆ°è¿™äº›æ•°æ®éƒ½å¸¦ä¸Šäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.6.8.png" alt="image-20220429215054133" tabindex="0" loading="lazy"><figcaption>image-20220429215054133</figcaption></figure><h5 id="_9ã€å‘åç«¯å‘é€æ–°å¢è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_9ã€å‘åç«¯å‘é€æ–°å¢è¯·æ±‚" aria-hidden="true">#</a> 9ã€å‘åç«¯å‘é€æ–°å¢è¯·æ±‚</h5><p><code>addCatagory</code>æ–¹æ³•å†…æ·»åŠ å‘åç«¯å‘é€æ–°å¢è¯·æ±‚çš„ä»£ç (è¾“å…¥<code>httppost</code>ä¼šç”Ÿæˆç”¨æˆ·ä»£ç ç‰‡æ®µ)</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">addCatagory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogVisible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/product/category/save&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">æ·»åŠ æˆåŠŸ</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//é‡æ–°è·å–æ•°æ®</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//é»˜è®¤å±•å¼€çš„èœå•èŠ‚ç‚¹</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>expandedKey <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>parentCid<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_10ã€æ·»åŠ èœå•" tabindex="-1"><a class="header-anchor" href="#_10ã€æ·»åŠ èœå•" aria-hidden="true">#</a> 10ã€æ·»åŠ èœå•</h5><p>ç‚¹å‡»&quot;append&quot;æŒ‰é’®ï¼Œè¾“å…¥åˆ†ç±»åç§°ï¼Œç‚¹å‡»ç¡®å®šï¼Œå¯ä»¥å‘ç°å·²ç»æœ‰æ•°æ®äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.6.10.png" alt="image-20220429221202449" tabindex="0" loading="lazy"><figcaption>image-20220429221202449</figcaption></figure><h5 id="_11ã€å®Œæ•´ä»£ç " tabindex="-1"><a class="header-anchor" href="#_11ã€å®Œæ•´ä»£ç " aria-hidden="true">#</a> 11ã€å®Œæ•´ä»£ç </h5><p><a href="code/4.1.6.11.vue">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç </a></p><h3 id="_4-1-7ã€åˆ†ç±»ç»´æŠ¤å¢åˆ æŸ¥æ”¹" tabindex="-1"><a class="header-anchor" href="#_4-1-7ã€åˆ†ç±»ç»´æŠ¤å¢åˆ æŸ¥æ”¹" aria-hidden="true">#</a> 4.1.7ã€åˆ†ç±»ç»´æŠ¤å¢åˆ æŸ¥æ”¹</h3><h4 id="_1ã€æ·»åŠ ä¿®æ”¹æŒ‰é’®" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ ä¿®æ”¹æŒ‰é’®" aria-hidden="true">#</a> 1ã€æ·»åŠ ä¿®æ”¹æŒ‰é’®</h4><p>åœ¨<code>åˆ é™¤</code>æŒ‰é’®ä¸‹æ·»åŠ ä¿®æ”¹æŒ‰é’®</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mini<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>() =&gt; edit(data)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  Edit
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2ã€æ·»åŠ æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ æ•°æ®" aria-hidden="true">#</a> 2ã€æ·»åŠ æ•°æ®</h4><p>æ·»åŠ æ•°æ®å­—æ®µï¼Œç”¨æ¥æ ‡è¯†å½“å‰å¯¹è¯æ¡†æ˜¯æ·»åŠ è¿˜æ˜¯åˆ é™¤</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//å¯¹è¯æ¡†çš„ç±»å‹(æ·»åŠ æˆ–åˆ é™¤)</span>
<span class="token literal-property property">dialogType</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
<span class="token comment">//å¯¹è¯æ¡†çš„æ ‡é¢˜(æ·»åŠ åˆ†ç±»æˆ–åˆ é™¤åˆ†ç±»)</span>
<span class="token literal-property property">dialogTitle</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3ã€æ·»åŠ catagoryæ•°æ®å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ catagoryæ•°æ®å­—æ®µ" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>catagory</code>æ•°æ®å­—æ®µ</h4><p>æ·»åŠ <code> catId: null,</code>å­—æ®µ</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token literal-property property">category</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">parentCid</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token literal-property property">catLevel</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token literal-property property">showStatus</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token literal-property property">catId</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4ã€ç¼–å†™editæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€ç¼–å†™editæ–¹æ³•" aria-hidden="true">#</a> 4ã€ç¼–å†™<code>edit</code>æ–¹æ³•</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">edit</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ä¿®æ”¹æŒ‰é’®...&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>name <span class="token operator">=</span> data<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>catId <span class="token operator">=</span> data<span class="token punctuation">.</span>catId<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogType <span class="token operator">=</span> <span class="token string">&quot;edit&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogTitle <span class="token operator">=</span> <span class="token string">&quot;ä¿®æ”¹åˆ†ç±»&quot;</span><span class="token punctuation">;</span>
  <span class="token comment">//æ‰“å¼€æ·»åŠ æˆ–ä¿®æ”¹çš„å¯¹è¯æ¡†</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogVisible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5ã€ä¿®æ”¹appendæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¿®æ”¹appendæ–¹æ³•" aria-hidden="true">#</a> 5ã€ä¿®æ”¹<code>append</code>æ–¹æ³•</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">append</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;appendæ–¹æ³•ä¸­çš„dataå‚æ•°ï¼š&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogType <span class="token operator">=</span> <span class="token string">&quot;append&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogTitle <span class="token operator">=</span> <span class="token string">&quot;æ·»åŠ åˆ†ç±»&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogVisible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token comment">//&lt;ç‚¹å‡»appendæŒ‰é’®çš„èŠ‚ç‚¹&gt;ä¸º&lt;è¦æ·»åŠ çš„èŠ‚ç‚¹&gt;çš„çˆ¶èŠ‚ç‚¹</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>parentCid <span class="token operator">=</span> data<span class="token punctuation">.</span>catId<span class="token punctuation">;</span>
  <span class="token comment">//&lt;è¦æ·»åŠ çš„èŠ‚ç‚¹&gt;çš„çˆ¶èŠ‚ç‚¹çš„å±‚çº§ä¸º&lt;ç‚¹å‡»appendæŒ‰é’®çš„èŠ‚ç‚¹&gt;+1</span>
  <span class="token comment">//data.catLevel*1 å¯ä»¥å°† Stringç±»å‹çš„ data.catLevel è½¬ä¸º int ç±»å‹</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>catLevel <span class="token operator">=</span> data<span class="token punctuation">.</span>catLevel <span class="token operator">*</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6ã€ä¿®æ”¹ç¡®å®šæŒ‰é’®ç»‘å®šçš„äº‹ä»¶æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_6ã€ä¿®æ”¹ç¡®å®šæŒ‰é’®ç»‘å®šçš„äº‹ä»¶æ–¹æ³•" aria-hidden="true">#</a> 6ã€ä¿®æ”¹ç¡®å®šæŒ‰é’®ç»‘å®šçš„äº‹ä»¶æ–¹æ³•</h4><p>ä¿®æ”¹ç¡®å®šæŒ‰é’®ç‚¹å‡»äº‹ä»¶è°ƒç”¨çš„æ–¹æ³•ä¸º<code>submitData</code></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submitData<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>ç¡® å®š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_7ã€æ·»åŠ submitdataæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_7ã€æ·»åŠ submitdataæ–¹æ³•" aria-hidden="true">#</a> 7ã€æ·»åŠ <code>submitData</code>æ–¹æ³•</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">submitData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dialogType <span class="token operator">==</span> <span class="token string">&quot;append&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCatagory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dialogType <span class="token operator">==</span> <span class="token string">&quot;edit&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">editCatagory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8ã€æ‰“å°ä¿®æ”¹è¯·æ±‚æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_8ã€æ‰“å°ä¿®æ”¹è¯·æ±‚æ•°æ®" aria-hidden="true">#</a> 8ã€æ‰“å°ä¿®æ”¹è¯·æ±‚æ•°æ®</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">editCatagory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//å…³é—­å¯¹è¯æ¡†</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogVisible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ä¿®æ”¹æäº¤çš„æ•°æ®ï¼š&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.7.8.png" alt="image-20220430180933340" tabindex="0" loading="lazy"><figcaption>image-20220430180933340</figcaption></figure><h4 id="_9ã€å¯¹è¯æ¡†å†…æ·»åŠ æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#_9ã€å¯¹è¯æ¡†å†…æ·»åŠ æ ‡ç­¾" aria-hidden="true">#</a> 9ã€å¯¹è¯æ¡†å†…æ·»åŠ æ ‡ç­¾</h4><p>åœ¨<code>el-dialog</code>æ ‡ç­¾å†…æ·»åŠ <code>el-form-item</code>æ ‡ç­¾</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å›¾æ ‡<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>category.icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>off<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>è®¡é‡å•ä½<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>category.productUnit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>off<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_10ã€å‘é€ä¿®æ”¹è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_10ã€å‘é€ä¿®æ”¹è¯·æ±‚" aria-hidden="true">#</a> 10ã€å‘é€ä¿®æ”¹è¯·æ±‚</h4><p>è¿™é‡Œçš„ä»£ç å†™çš„æœ‰é—®é¢˜(åé¢æµ‹è¯•å‘ç°æ•°æ®åº“å·²ç»ä¿®æ”¹æ•°æ®äº†ï¼Œä½†æ˜¯å‰ç«¯æ²¡æœ‰æ˜¾ç¤ºï¼Œåˆ·æ–°åæ‰èƒ½æ˜¾ç¤º)</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">editCatagory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ä¿®æ”¹æäº¤çš„æ•°æ®ï¼š&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token punctuation">{</span>catId<span class="token punctuation">,</span>name<span class="token punctuation">,</span>icon<span class="token punctuation">,</span>productUnit<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span><span class="token string">&#39;/product/category/update&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&#39;post&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>catId<span class="token punctuation">,</span>name<span class="token punctuation">,</span>icon<span class="token punctuation">,</span>productUnit<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//å…³é—­å¯¹è¯æ¡†</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dialogVisible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">//é‡æ–°è·å–æ•°æ®</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//é»˜è®¤å±•å¼€çš„èœå•èŠ‚ç‚¹</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>expandedKey <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>parentCid<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åº”è¯¥å†™ä¸º</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">editCatagory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ä¿®æ”¹æäº¤çš„æ•°æ®ï¼š&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token punctuation">{</span> catId<span class="token punctuation">,</span> name<span class="token punctuation">,</span> icon<span class="token punctuation">,</span> productUnit <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/product/category/update&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> catId<span class="token punctuation">,</span> name<span class="token punctuation">,</span> icon<span class="token punctuation">,</span> productUnit <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">æ·»åŠ æˆåŠŸ</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//å…³é—­å¯¹è¯æ¡†</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dialogVisible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">//é‡æ–°è·å–æ•°æ®</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//é»˜è®¤å±•å¼€çš„èœå•èŠ‚ç‚¹</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>expandedKey <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>parentCid<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_11ã€ä¿®æ”¹editæ–¹æ³•-åŠ¨æ€è·å–å€¼" tabindex="-1"><a class="header-anchor" href="#_11ã€ä¿®æ”¹editæ–¹æ³•-åŠ¨æ€è·å–å€¼" aria-hidden="true">#</a> 11ã€ä¿®æ”¹<code>edit</code>æ–¹æ³•,åŠ¨æ€è·å–å€¼</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">edit</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ä¿®æ”¹æŒ‰é’®...&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>catId <span class="token operator">=</span> data<span class="token punctuation">.</span>catId<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogType <span class="token operator">=</span> <span class="token string">&quot;edit&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogTitle <span class="token operator">=</span> <span class="token string">&quot;ä¿®æ”¹åˆ†ç±»&quot;</span><span class="token punctuation">;</span>
  <span class="token comment">//æ‰“å¼€æ·»åŠ æˆ–ä¿®æ”¹çš„å¯¹è¯æ¡†</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogVisible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">/product/category/info/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>catId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ä¿®æ”¹æŒ‰é’®è°ƒç”¨åç«¯å›æ˜¾çš„æ•°æ®:&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>name <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>icon <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>icon<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>productUnit <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>productUnit<span class="token punctuation">;</span>
    <span class="token comment">//æ›´æ–°çˆ¶èœå•idï¼Œå‘é€ä¿®æ”¹è¯·æ±‚åï¼Œå¯ä»¥å±•å¼€çˆ¶èŠ‚ç‚¹</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>parentCid <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>parentCid<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_12ã€ä¿®æ”¹appendæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_12ã€ä¿®æ”¹appendæ–¹æ³•" aria-hidden="true">#</a> 12ã€ä¿®æ”¹<code>append</code>æ–¹æ³•</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">append</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;appendæ–¹æ³•ä¸­çš„dataå‚æ•°ï¼š&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//æ¸…ç©ºcategoryæ•°æ®</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">clearCategory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogType <span class="token operator">=</span> <span class="token string">&quot;append&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogTitle <span class="token operator">=</span> <span class="token string">&quot;æ·»åŠ åˆ†ç±»&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dialogVisible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token comment">//&lt;ç‚¹å‡»appendæŒ‰é’®çš„èŠ‚ç‚¹&gt;ä¸º&lt;è¦æ·»åŠ çš„èŠ‚ç‚¹&gt;çš„çˆ¶èŠ‚ç‚¹</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>parentCid <span class="token operator">=</span> data<span class="token punctuation">.</span>catId<span class="token punctuation">;</span>
  <span class="token comment">//&lt;è¦æ·»åŠ çš„èŠ‚ç‚¹&gt;çš„çˆ¶èŠ‚ç‚¹çš„å±‚çº§ä¸º&lt;ç‚¹å‡»appendæŒ‰é’®çš„èŠ‚ç‚¹&gt;+1</span>
  <span class="token comment">//data.catLevel*1 å¯ä»¥å°† Stringç±»å‹çš„ data.catLevel è½¬ä¸º int ç±»å‹</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>catLevel <span class="token operator">=</span> data<span class="token punctuation">.</span>catLevel <span class="token operator">*</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">clearCategory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>category <span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">parentCid</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">catLevel</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">showStatus</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">productUnit</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">catId</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_13ã€ä¿®æ”¹addcatagoryæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_13ã€ä¿®æ”¹addcatagoryæ–¹æ³•" aria-hidden="true">#</a> 13ã€ä¿®æ”¹<code>addCatagory</code>æ–¹æ³•</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">addCatagory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ·»åŠ æäº¤çš„æ•°æ®ï¼š&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> parentCid<span class="token punctuation">,</span> catLevel<span class="token punctuation">,</span> showStatus<span class="token punctuation">,</span> sort<span class="token punctuation">,</span> icon <span class="token punctuation">,</span>productUnit<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/product/category/save&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> parentCid<span class="token punctuation">,</span> catLevel<span class="token punctuation">,</span> showStatus<span class="token punctuation">,</span> sort<span class="token punctuation">,</span> icon <span class="token punctuation">,</span>productUnit<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">æ·»åŠ æˆåŠŸ</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//å…³é—­å¯¹è¯æ¡†</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dialogVisible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">//é‡æ–°è·å–æ•°æ®</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//é»˜è®¤å±•å¼€çš„èœå•èŠ‚ç‚¹</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>expandedKey <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>parentCid<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_14ã€ä¼˜åŒ–ä½“éªŒ-é˜²æ­¢è¯¯å…³å¯¹è¯æ¡†" tabindex="-1"><a class="header-anchor" href="#_14ã€ä¼˜åŒ–ä½“éªŒ-é˜²æ­¢è¯¯å…³å¯¹è¯æ¡†" aria-hidden="true">#</a> 14ã€ä¼˜åŒ–ä½“éªŒ,é˜²æ­¢è¯¯å…³å¯¹è¯æ¡†</h4><h5 id="_1ã€æ·»åŠ close-on-click-modalå±æ€§" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ close-on-click-modalå±æ€§" aria-hidden="true">#</a> 1ã€æ·»åŠ <code>close-on-click-modal</code>å±æ€§</h5><p>åœ¨<code>el-dialog</code>æ ‡ç­¾å†…æ·»åŠ <code>close-on-click-modal</code>å±æ€§</p><p>ä½¿ç”¨æˆ·åªæœ‰åœ¨ç‚¹å‡»&quot;Ã—&quot;ã€&quot;å–æ¶ˆ&quot;ã€&quot;ç¡®å®š&quot;æ‰ä¼šå…³é—­å¯¹è¯æ¡†ï¼Œé˜²æ­¢è¯¯ç‚¹åˆ°å…¶ä»–åœ°æ–¹å¯¼è‡´å…³é—­äº†å¯¹è¯æ¡†</p><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>ç±»å‹</th><th>å¯é€‰å€¼</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>close-on-click-modal</td><td>æ˜¯å¦å¯ä»¥é€šè¿‡ç‚¹å‡» modal å…³é—­ Dialog</td><td>boolean</td><td>â€”</td><td>true</td></tr></tbody></table><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>close-on-click-modal=&quot;false&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_2ã€æ§åˆ¶å°æ˜¾ç¤ºéœ€è¦booleanç±»å‹-è€Œç»™å‡ºçš„æ˜¯-string-ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_2ã€æ§åˆ¶å°æ˜¾ç¤ºéœ€è¦booleanç±»å‹-è€Œç»™å‡ºçš„æ˜¯-string-ç±»å‹" aria-hidden="true">#</a> 2ã€æ§åˆ¶å°æ˜¾ç¤ºéœ€è¦<code>Boolean</code>ç±»å‹ï¼Œè€Œç»™å‡ºçš„æ˜¯&quot;String&quot;ç±»å‹</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.7.14.2.png" alt="image-20220430204554937" tabindex="0" loading="lazy"><figcaption>image-20220430204554937</figcaption></figure><h5 id="_3ã€ä½¿ç”¨v-bindå±æ€§" tabindex="-1"><a class="header-anchor" href="#_3ã€ä½¿ç”¨v-bindå±æ€§" aria-hidden="true">#</a> 3ã€ä½¿ç”¨<code>v-bind</code>å±æ€§</h5><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>:close-on-click-modal=&quot;false&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.7.14.3.png" alt="image-20220430204921080" tabindex="0" loading="lazy"><figcaption>image-20220430204921080</figcaption></figure><h5 id="_4ã€æ§åˆ¶å°ä¸æŠ¥é”™äº†" tabindex="-1"><a class="header-anchor" href="#_4ã€æ§åˆ¶å°ä¸æŠ¥é”™äº†" aria-hidden="true">#</a> 4ã€æ§åˆ¶å°ä¸æŠ¥é”™äº†</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.7.14.4.png" alt="image-20220430205044369" tabindex="0" loading="lazy"><figcaption>image-20220430205044369</figcaption></figure><h4 id="_15ã€ä¿®æ”¹åå‰ç«¯ä¸æ›´æ–°æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_15ã€ä¿®æ”¹åå‰ç«¯ä¸æ›´æ–°æ•°æ®" aria-hidden="true">#</a> 15ã€ä¿®æ”¹åå‰ç«¯ä¸æ›´æ–°æ•°æ®</h4><p>ä¿®æ”¹åˆ†ç±»åç§°åï¼Œå‘ç°æ•°æ®åº“å·²ç»ä¿®æ”¹æ•°æ®äº†ï¼Œä½†æ˜¯å‰ç«¯æ²¡æœ‰æ˜¾ç¤ºï¼Œåˆ·æ–°åæ‰èƒ½æ˜¾ç¤º</p><h4 id="_16ã€ä¿®æ”¹editcatagoryæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_16ã€ä¿®æ”¹editcatagoryæ–¹æ³•" aria-hidden="true">#</a> 16ã€ä¿®æ”¹<code>editCatagory</code>æ–¹æ³•</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">editCatagory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ä¿®æ”¹æäº¤çš„æ•°æ®ï¼š&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token punctuation">{</span> catId<span class="token punctuation">,</span> name<span class="token punctuation">,</span> icon<span class="token punctuation">,</span> productUnit <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/product/category/update&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> catId<span class="token punctuation">,</span> name<span class="token punctuation">,</span> icon<span class="token punctuation">,</span> productUnit <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">æ·»åŠ æˆåŠŸ</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//å…³é—­å¯¹è¯æ¡†</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dialogVisible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">//é‡æ–°è·å–æ•°æ®</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//é»˜è®¤å±•å¼€çš„èœå•èŠ‚ç‚¹</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>expandedKey <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">.</span>parentCid<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_17ã€å®Œæ•´ä»£ç -1" tabindex="-1"><a class="header-anchor" href="#_17ã€å®Œæ•´ä»£ç -1" aria-hidden="true">#</a> 17ã€å®Œæ•´ä»£ç </h4><p><a href="code/4.1.7.17.vue">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç </a></p><h3 id="_4-1-8ã€æ·»åŠ æ‹–æ‹½èŠ‚ç‚¹åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#_4-1-8ã€æ·»åŠ æ‹–æ‹½èŠ‚ç‚¹åŠŸèƒ½" aria-hidden="true">#</a> 4.1.8ã€æ·»åŠ æ‹–æ‹½èŠ‚ç‚¹åŠŸèƒ½</h3><h4 id="_1ã€æ·»åŠ æ‹–æ‹½åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ æ‹–æ‹½åŠŸèƒ½" aria-hidden="true">#</a> 1ã€æ·»åŠ æ‹–æ‹½åŠŸèƒ½</h4>`,108),f={href:"https://element.eleme.cn/#/zh-CN/component/tree",target:"_blank",rel:"noopener noreferrer"},y=e(`<table><thead><tr><th style="text-align:left;">å‚æ•°</th><th style="text-align:left;">è¯´æ˜</th><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">é»˜è®¤å€¼</th></tr></thead><tbody><tr><td style="text-align:left;">draggable</td><td style="text-align:left;">æ˜¯å¦å¼€å¯æ‹–æ‹½èŠ‚ç‚¹åŠŸèƒ½</td><td style="text-align:left;">boolean</td><td style="text-align:left;">false</td></tr><tr><td style="text-align:left;">allow-drop</td><td style="text-align:left;">æ‹–æ‹½æ—¶åˆ¤å®šç›®æ ‡èŠ‚ç‚¹èƒ½å¦è¢«æ”¾ç½®ã€‚<code>type</code> å‚æ•°æœ‰ä¸‰ç§æƒ…å†µï¼š&#39;prev&#39;ã€&#39;inner&#39; å’Œ &#39;next&#39;ï¼Œåˆ†åˆ«è¡¨ç¤ºæ”¾ç½®åœ¨ç›®æ ‡èŠ‚ç‚¹å‰ã€æ’å…¥è‡³ç›®æ ‡èŠ‚ç‚¹å’Œæ”¾ç½®åœ¨ç›®æ ‡èŠ‚ç‚¹å</td><td style="text-align:left;">Function(draggingNode, dropNode, type)</td><td style="text-align:left;"></td></tr></tbody></table><p><code>el-tree</code>æ ‡ç­¾æ·»åŠ å±æ€§ <code>draggable :allow-drop=&quot;allowDrop&quot;</code></p><p>æ·»åŠ æ•°æ®å­—æ®µ<code>maxLength: 0,</code> è¡¨ç¤ºæ‹–æ‹½èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹åœ¨æ•´é¢—æ ‘çš„æœ€å¤§æ·±åº¦</p><p>å¹¶æ·»åŠ <code>allowDrop</code>æ–¹æ³•ï¼Œåˆ¤æ–­æ˜¯å¦å¯ä»¥æ‹–åŠ¨</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * åˆ¤æ–­è¯¥èŠ‚ç‚¹æ˜¯å¦å¯ä»¥æ‹–æ‹½(èŠ‚ç‚¹æœ€å¤§æ·±åº¦ä¸èƒ½å¤§äº3)
 * <span class="token keyword">@param</span> <span class="token parameter">draggingNode</span>  è¢«æ‹–æ‹½çš„èŠ‚ç‚¹
 * <span class="token keyword">@param</span> <span class="token parameter">dropNode</span>      ç›®æ ‡èŠ‚ç‚¹
 * <span class="token keyword">@param</span> <span class="token parameter">type</span>  æ”¾ç½®åœ¨ç›®æ ‡èŠ‚ç‚¹å‰ï¼š&#39;prev&#39;ã€æ’å…¥è‡³ç›®æ ‡èŠ‚ç‚¹ï¼š&#39;inner&#39;ã€ æ”¾ç½®åœ¨ç›®æ ‡èŠ‚ç‚¹åï¼š&#39;next&#39;
 * <span class="token keyword">@return</span>
 */</span>
<span class="token function">allowDrop</span><span class="token punctuation">(</span><span class="token parameter">draggingNode<span class="token punctuation">,</span> dropNode<span class="token punctuation">,</span> type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ‹–æ‹½èŠ‚ç‚¹:&quot;</span><span class="token punctuation">,</span> draggingNode<span class="token punctuation">,</span> dropNode<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//æœ€å¤§æ·±åº¦åˆå§‹åŒ–ä¸ºè¯¥è¯¥èŠ‚ç‚¹çš„æ·±åº¦,è¡¨ç¤ºæ²¡æœ‰å­èŠ‚ç‚¹</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength <span class="token operator">=</span> draggingNode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>catLevel<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">countNodeLevel</span><span class="token punctuation">(</span>draggingNode<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ‹–æ‹½èŠ‚ç‚¹åçš„menu:&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>menu<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>maxLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¿™é‡Œçš„æ•´æ£µæ ‘æ˜¯æŒ‡ï¼šè¢«æ‹–åŠ¨èŠ‚ç‚¹å’Œç›®æ ‡èŠ‚ç‚¹ åŠå…¶å­èŠ‚ç‚¹ å’Œ å…¶æ‰€æœ‰çˆ¶èŠ‚ç‚¹ ç»„æˆçš„æ ‘</strong></p><p>ç¼–å†™æ‹–åŠ¨çš„èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹åœ¨æ•´é¢—å¤§æ ‘ä¸‹çš„æœ€æ·±æ·±åº¦ï¼ˆè¿™é‡Œçš„ä»£ç æœ‰é—®é¢˜ï¼‰</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">countNodeLevel</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> children <span class="token operator">=</span> data<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>children <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> children<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>catLevel <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>catLevel <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">//é€’å½’æŸ¥æ‰¾å…¶å­æ ‘çš„å­æ ‘çš„æœ€å¤§æ·±åº¦</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">countNodeLevel</span><span class="token punctuation">(</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2ã€æµ‹è¯•æ•°æ®1" tabindex="-1"><a class="header-anchor" href="#_2ã€æµ‹è¯•æ•°æ®1" aria-hidden="true">#</a> 2ã€æµ‹è¯•æ•°æ®1</h4><h5 id="_1ã€æ‹–æ‹½å‰" tabindex="-1"><a class="header-anchor" href="#_1ã€æ‹–æ‹½å‰" aria-hidden="true">#</a> 1ã€æ‹–æ‹½å‰</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.2.1.1.png" alt="image-20220430233700326" tabindex="0" loading="lazy"><figcaption>image-20220430233700326</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.2.1.2.png" alt="image-20220430233559727" tabindex="0" loading="lazy"><figcaption>image-20220430233559727</figcaption></figure><h5 id="_2ã€æ‹–æ‹½å" tabindex="-1"><a class="header-anchor" href="#_2ã€æ‹–æ‹½å" aria-hidden="true">#</a> 2ã€æ‹–æ‹½å</h5><p>(ä¸ç”¨ç®¡æ§åˆ¶å°é‡Œçš„nextï¼Œè·Ÿè¿™ä¸ªæ²¡æœ‰å½±å“ï¼Œåªæ˜¯æˆ‘é€‰çš„ä¸€ç»„æ•°æ®ä¸æ˜¯innerè€Œå·²)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.2.2.1.png" alt="image-20220430234003283" tabindex="0" loading="lazy"><figcaption>image-20220430234003283</figcaption></figure><p>å¯ä»¥å‘ç°catLevelæ”¹å˜äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.2.2.2.png" alt="image-20220430234200253" tabindex="0" loading="lazy"><figcaption>image-20220430234200253</figcaption></figure><h4 id="_3ã€æµ‹è¯•æ•°æ®2" tabindex="-1"><a class="header-anchor" href="#_3ã€æµ‹è¯•æ•°æ®2" aria-hidden="true">#</a> 3ã€æµ‹è¯•æ•°æ®2</h4><h5 id="_1ã€æ‹–åŠ¨å‰" tabindex="-1"><a class="header-anchor" href="#_1ã€æ‹–åŠ¨å‰" aria-hidden="true">#</a> 1ã€æ‹–åŠ¨å‰</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.3.1.1.png" alt="image-20220430235635855" tabindex="0" loading="lazy"><figcaption>image-20220430235635855</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.3.1.2.png" alt="image-20220430235733676" tabindex="0" loading="lazy"><figcaption>image-20220430235733676</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.3.1.3.png" alt="image-20220430235821830" tabindex="0" loading="lazy"><figcaption>image-20220430235821830</figcaption></figure><h5 id="_2ã€æ‹–åŠ¨å" tabindex="-1"><a class="header-anchor" href="#_2ã€æ‹–åŠ¨å" aria-hidden="true">#</a> 2ã€æ‹–åŠ¨å</h5><p>(ä¸ç”¨ç®¡æ§åˆ¶å°é‡Œçš„nextï¼Œè·Ÿè¿™ä¸ªæ²¡æœ‰å½±å“ï¼Œåªæ˜¯æˆ‘é€‰çš„ä¸€ç»„æ•°æ®ä¸æ˜¯innerè€Œå·²)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.3.2.1.png" alt="image-20220501000013931" tabindex="0" loading="lazy"><figcaption>image-20220501000013931</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.3.2.2.png" alt="image-20220501000137695" tabindex="0" loading="lazy"><figcaption>image-20220501000137695</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.3.2.3.png" alt="image-20220501000306998" tabindex="0" loading="lazy"><figcaption>image-20220501000306998</figcaption></figure><h5 id="_3ã€menuä¸­çš„æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_3ã€menuä¸­çš„æ•°æ®" aria-hidden="true">#</a> 3ã€menuä¸­çš„æ•°æ®</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.3.3.1.png" alt="image-20220501000725560" tabindex="0" loading="lazy"><figcaption>image-20220501000725560</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.3.3.2.png" alt="image-20220501000839585" tabindex="0" loading="lazy"><figcaption>image-20220501000839585</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.3.3.3.png" alt="image-20220501000923470" tabindex="0" loading="lazy"><figcaption>image-20220501000923470</figcaption></figure><p>å¯è§menuä¸­çš„æ•°æ®å·²ç»æ”¹å˜äº†</p><p><code>è¢«æ‹–æ‹½èŠ‚ç‚¹</code>çš„å­èŠ‚ç‚¹çš„<code>catLevel</code>éƒ½è¢«æ”¹ä¸ºäº†<code>è¢«æ‹–æ‹½èŠ‚ç‚¹</code>çš„<code>catLevel</code></p><h4 id="_4ã€ä¿®æ”¹countnodelevelæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿®æ”¹countnodelevelæ–¹æ³•" aria-hidden="true">#</a> 4ã€ä¿®æ”¹<code>countNodeLevel</code>æ–¹æ³•</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">countNodeLevel</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> children <span class="token operator">=</span> data<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>children <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> children<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>catLevel <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength <span class="token operator">=</span> children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>catLevel<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">//é€’å½’æŸ¥æ‰¾å…¶å­æ ‘çš„å­æ ‘çš„æœ€å¤§æ·±åº¦</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">countNodeLevel</span><span class="token punctuation">(</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_1ã€æµ‹è¯•æ•°æ®1" tabindex="-1"><a class="header-anchor" href="#_1ã€æµ‹è¯•æ•°æ®1" aria-hidden="true">#</a> 1ã€æµ‹è¯•æ•°æ®1</h5><p>æ”¹åŠ¨åï¼ŒèŠ‚ç‚¹ä¿¡æ¯æ˜¾ç¤ºæ­£å¸¸ï¼Œå¹¶ä¸”æ‰“å°äº†æ­£ç¡®çš„èŠ‚ç‚¹æ·±åº¦</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.4.1.1.png" alt="image-20220501154304218" tabindex="0" loading="lazy"><figcaption>image-20220501154304218</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.4.1.2.png" alt="image-20220501154457199" tabindex="0" loading="lazy"><figcaption>image-20220501154457199</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.4.1.3.png" alt="image-20220501154606221" tabindex="0" loading="lazy"><figcaption>image-20220501154606221</figcaption></figure><h5 id="_2ã€æµ‹è¯•æ•°æ®2" tabindex="-1"><a class="header-anchor" href="#_2ã€æµ‹è¯•æ•°æ®2" aria-hidden="true">#</a> <strong>2ã€æµ‹è¯•æ•°æ®2</strong></h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.4.2.1.png" alt="image-20220501154951313" tabindex="0" loading="lazy"><figcaption>image-20220501154951313</figcaption></figure><p>è¿˜æ˜¯èƒ½æ˜¾ç¤ºæ­£ç¡®çš„æ·±åº¦</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.4.2.2.png" alt="image-20220501155115738" tabindex="0" loading="lazy"><figcaption>image-20220501155115738</figcaption></figure><h5 id="_3ã€æµ‹è¯•æ•°æ®3" tabindex="-1"><a class="header-anchor" href="#_3ã€æµ‹è¯•æ•°æ®3" aria-hidden="true">#</a> 3ã€æµ‹è¯•æ•°æ®3</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.4.3.1.png" alt="image-20220501155748334" tabindex="0" loading="lazy"><figcaption>image-20220501155748334</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.8.4.3.2.png" alt="image-20220501160239808" tabindex="0" loading="lazy"><figcaption>image-20220501160239808</figcaption></figure><p>ç»æµ‹è¯•å¯ä»¥çœ‹åˆ°ï¼Œæœ€é•¿æ·±åº¦çš„è®¡ç®—æ²¡æœ‰é—®é¢˜äº†</p><h4 id="_5ã€ä¿®æ”¹allowdropæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¿®æ”¹allowdropæ–¹æ³•" aria-hidden="true">#</a> 5ã€ä¿®æ”¹<code>allowDrop</code>æ–¹æ³•</h4><p><strong>è¿™é‡Œçš„æ•´æ£µæ ‘æ˜¯æŒ‡ï¼šè¢«æ‹–åŠ¨èŠ‚ç‚¹å’Œç›®æ ‡èŠ‚ç‚¹ åŠå…¶å­èŠ‚ç‚¹ å’Œ å…¶æ‰€æœ‰çˆ¶èŠ‚ç‚¹ ç»„æˆçš„æ ‘</strong></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * åˆ¤æ–­è¯¥èŠ‚ç‚¹æ˜¯å¦å¯ä»¥æ‹–æ‹½(èŠ‚ç‚¹æœ€å¤§æ·±åº¦ä¸èƒ½å¤§äº3)
 * <span class="token keyword">@param</span> <span class="token parameter">draggingNode</span>  è¢«æ‹–æ‹½çš„èŠ‚ç‚¹
 * <span class="token keyword">@param</span> <span class="token parameter">dropNode</span>      ç›®æ ‡èŠ‚ç‚¹
 * <span class="token keyword">@param</span> <span class="token parameter">type</span>  æ”¾ç½®åœ¨ç›®æ ‡èŠ‚ç‚¹å‰ï¼š&#39;prev&#39;ã€æ’å…¥è‡³ç›®æ ‡èŠ‚ç‚¹ï¼š&#39;inner&#39;ã€ æ”¾ç½®åœ¨ç›®æ ‡èŠ‚ç‚¹åï¼š&#39;next&#39;
 * <span class="token keyword">@return</span>
 */</span>
<span class="token function">allowDrop</span><span class="token punctuation">(</span><span class="token parameter">draggingNode<span class="token punctuation">,</span> dropNode<span class="token punctuation">,</span> type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ‹–æ‹½èŠ‚ç‚¹:&quot;</span><span class="token punctuation">,</span> draggingNode<span class="token punctuation">,</span> dropNode<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//æœ€å¤§æ·±åº¦åˆå§‹åŒ–ä¸ºè¯¥è¯¥èŠ‚ç‚¹çš„æ·±åº¦,è¡¨ç¤ºæ²¡æœ‰å­èŠ‚ç‚¹</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength <span class="token operator">=</span> draggingNode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>catLevel<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">countNodeLevel</span><span class="token punctuation">(</span>draggingNode<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ‹–æ‹½èŠ‚ç‚¹åçš„menu:&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>menu<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>maxLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//æ‹–æ‹½èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹ç»„æˆçš„æ ‘çš„æœ€å¤§æ·±åº¦</span>
  <span class="token keyword">let</span> deep <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength <span class="token operator">-</span> draggingNode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>catLevel <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>type<span class="token operator">==</span><span class="token string">&quot;inner&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//ç±»å‹ä¸º inner(è¡¨ç¤ºåœ¨ç›®æ ‡èŠ‚ç‚¹çš„å†…éƒ¨)</span>
    <span class="token comment">//æ‹–æ‹½åæ•´é¢—æ ‘çš„æœ€å¤§æ·±åº¦=(ç›®æ ‡èŠ‚ç‚¹çš„æ·±åº¦ + æ‹–æ‹½èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹ç»„æˆçš„æ ‘çš„æœ€å¤§æ·±åº¦)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>dropNode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>catLevel <span class="token operator">+</span> deep<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      <span class="token comment">//ç±»å‹ä¸º prev æˆ– next (è¡¨ç¤ºåœ¨ç›®æ ‡èŠ‚ç‚¹çš„ä¸Šé¢æˆ–ä¸‹é¢ï¼Œä¸ç›®æ ‡èŠ‚ç‚¹åŒçº§)</span>
      <span class="token comment">//æ‹–æ‹½åæ•´é¢—æ ‘çš„æœ€å¤§æ·±åº¦=(ç›®æ ‡èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹çš„æ·±åº¦ + æ‹–æ‹½èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹ç»„æˆçš„æ ‘çš„æœ€å¤§æ·±åº¦)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>dropNode<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>level <span class="token operator">+</span> deep<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6ã€å®Œæ•´ä»£ç " tabindex="-1"><a class="header-anchor" href="#_6ã€å®Œæ•´ä»£ç " aria-hidden="true">#</a> 6ã€å®Œæ•´ä»£ç </h4><p><a href="code/4.1.8.6.vue">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç </a></p><h3 id="_4-1-9ã€æ·»åŠ æ‹–æ‹½èŠ‚ç‚¹å›è°ƒå‡½æ•°" tabindex="-1"><a class="header-anchor" href="#_4-1-9ã€æ·»åŠ æ‹–æ‹½èŠ‚ç‚¹å›è°ƒå‡½æ•°" aria-hidden="true">#</a> 4.1.9ã€æ·»åŠ æ‹–æ‹½èŠ‚ç‚¹å›è°ƒå‡½æ•°</h3><table><thead><tr><th style="text-align:left;">äº‹ä»¶åç§°</th><th style="text-align:left;">è¯´æ˜</th><th style="text-align:left;">å›è°ƒå‚æ•°</th></tr></thead><tbody><tr><td style="text-align:left;">node-drop</td><td style="text-align:left;">æ‹–æ‹½æˆåŠŸå®Œæˆæ—¶è§¦å‘çš„äº‹ä»¶</td><td style="text-align:left;">å…±å››ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºï¼šè¢«æ‹–æ‹½èŠ‚ç‚¹å¯¹åº”çš„ Nodeã€ç»“æŸæ‹–æ‹½æ—¶æœ€åè¿›å…¥çš„èŠ‚ç‚¹ã€è¢«æ‹–æ‹½èŠ‚ç‚¹çš„æ”¾ç½®ä½ç½®ï¼ˆbeforeã€afterã€innerï¼‰ã€event</td></tr></tbody></table><h4 id="_1ã€el-treeæ·»åŠ å±æ€§" tabindex="-1"><a class="header-anchor" href="#_1ã€el-treeæ·»åŠ å±æ€§" aria-hidden="true">#</a> 1ã€<code>el-tree</code>æ·»åŠ å±æ€§</h4><p><code>el-tree</code>æ·»åŠ <code>@node-drop=&quot;handleDrop&quot;</code>å±æ€§</p><h4 id="_2ã€æ·»åŠ å›è°ƒæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ å›è°ƒæ–¹æ³•" aria-hidden="true">#</a> 2ã€æ·»åŠ å›è°ƒæ–¹æ³•</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">handleDrop</span><span class="token punctuation">(</span><span class="token parameter">draggingNode<span class="token punctuation">,</span> dropNode<span class="token punctuation">,</span> dropType<span class="token punctuation">,</span> ev</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;tree drop: &quot;</span><span class="token punctuation">,</span> dropNode<span class="token punctuation">.</span>label<span class="token punctuation">,</span> dropType<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3ã€æŸ¥çœ‹å›è°ƒå‚æ•°çš„æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_3ã€æŸ¥çœ‹å›è°ƒå‚æ•°çš„æ•°æ®" aria-hidden="true">#</a> 3ã€æŸ¥çœ‹å›è°ƒå‚æ•°çš„æ•°æ®</h4><p>æ•°æ®å’Œæ‹–åŠ¨èŠ‚ç‚¹çš„æ•°æ®å·®ä¸å¤š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.9.3.png" alt="image-20220501233323689" tabindex="0" loading="lazy"><figcaption>image-20220501233323689</figcaption></figure><h4 id="_4ã€ç¼–å†™æ‹–æ‹½æˆåŠŸåè§¦å‘çš„äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#_4ã€ç¼–å†™æ‹–æ‹½æˆåŠŸåè§¦å‘çš„äº‹ä»¶" aria-hidden="true">#</a> 4ã€ç¼–å†™æ‹–æ‹½æˆåŠŸåè§¦å‘çš„äº‹ä»¶</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * æ‹–æ‹½æˆåŠŸåçš„å›è°ƒå‡½æ•°ï¼Œç”¨æ¥æ›´æ–°èŠ‚ç‚¹çš„ä¿¡æ¯
 * <span class="token keyword">@param</span> <span class="token parameter">draggingNode</span>  è¢«æ‹–æ‹½èŠ‚ç‚¹å¯¹åº”çš„ Node (draggingNodeé‡Œçš„æ•°æ®ä¸ä¼šæ›´æ–°)
 * <span class="token keyword">@param</span> <span class="token parameter">dropNode</span>      ç»“æŸæ‹–æ‹½æ—¶æœ€åè¿›å…¥çš„èŠ‚ç‚¹ 
 * (dropNodeé‡Œé¢çš„childNodes,parentç­‰ä¼šåŠ¨æ€æ›´æ–°(dropNodeé‡Œé¢çš„dataä¸ºæ•°æ®åº“è·å–åˆ°çš„,ä¸ä¼šæ›´æ–°))
 * <span class="token keyword">@param</span> <span class="token parameter">type</span>  è¢«æ‹–æ‹½èŠ‚ç‚¹çš„æ”¾ç½®ä½ç½®ï¼ˆbeforeã€afterã€innerï¼‰
 * æ”¾ç½®åœ¨ç›®æ ‡èŠ‚ç‚¹å‰ï¼š&#39;prev&#39;ã€æ’å…¥è‡³ç›®æ ‡èŠ‚ç‚¹ï¼š&#39;inner&#39;ã€ æ”¾ç½®åœ¨ç›®æ ‡èŠ‚ç‚¹åï¼š&#39;next&#39;
 * <span class="token keyword">@return</span>
 */</span>
<span class="token function">handleDrop</span><span class="token punctuation">(</span><span class="token parameter">draggingNode<span class="token punctuation">,</span> dropNode<span class="token punctuation">,</span> dropType<span class="token punctuation">,</span> ev</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ‹–æ‹½æˆåŠŸçš„å›è°ƒå‚æ•°: &quot;</span><span class="token punctuation">,</span> draggingNode<span class="token punctuation">,</span> dropNode<span class="token punctuation">,</span> dropType<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹id</span>
  <span class="token keyword">let</span> pCid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">//æ‹–åŠ¨èŠ‚ç‚¹åï¼Œè¢«æ‹–åŠ¨èŠ‚ç‚¹çš„æ–°çš„çˆ¶èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹æ•°ç»„</span>
  <span class="token keyword">let</span> sliblings <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token comment">//1ã€æ‰¾åˆ°çˆ¶èŠ‚ç‚¹idå’Œçˆ¶èŠ‚ç‚¹çš„å­èŠ‚ç‚¹</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>dropType <span class="token operator">==</span> <span class="token string">&quot;inner&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//ç±»å‹ä¸º inner(è¡¨ç¤ºåœ¨ç›®æ ‡èŠ‚ç‚¹çš„å†…éƒ¨)</span>
    <span class="token comment">//dropNode.dataè¡¨ç¤ºçš„æ˜¯æ•°æ®åº“è·å–åˆ°çš„dataæ•°æ®</span>
    pCid <span class="token operator">=</span> dropNode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>catId<span class="token punctuation">;</span>
    <span class="token comment">//dropNodeé‡Œçš„æ•°æ®(é™¤äº†.data)è¡¨ç¤ºçš„æ˜¯element-uiåŠ¨æ€æ›´æ–°çš„æ•°æ®</span>
    <span class="token comment">//è¿™é‡Œçš„dropNode.childNodesæ˜¯æ‹–åŠ¨æˆåŠŸåï¼Œå·²ç»æ›´æ–°çš„èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¿¡æ¯</span>
    <span class="token comment">//æ‹–æ‹½åˆ°å†…éƒ¨,åˆ™dropNodeå³ä¸ºå…¶çˆ¶èŠ‚ç‚¹</span>
    sliblings <span class="token operator">=</span> dropNode<span class="token punctuation">.</span>childNodes<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">//ç±»å‹ä¸º prev æˆ– next (è¡¨ç¤ºåœ¨ç›®æ ‡èŠ‚ç‚¹çš„ä¸Šé¢æˆ–ä¸‹é¢ï¼Œä¸ç›®æ ‡èŠ‚ç‚¹åŒçº§)</span>
    <span class="token comment">//æ‹–æ‹½åˆ°ä¸Šé¢æˆ–ä¸‹é¢ï¼Œåˆ™ ç›®æ ‡èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å³ä¸ºæ‹–æ‹½èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</span>
    <span class="token comment">//å¦‚æœæ‰˜æ‹–æ‹½åˆ°ä¸€çº§èœå•(level=1)dropNode.parent.dataè£…çš„æ˜¯ä¸€çº§èœå•é›†åˆ(å’ŒdropNode.parent.childNodesæ•°æ®ä¸€æ ·),è·å–åˆ°çš„catIdä¸ºundefined</span>
    <span class="token comment">//å¦‚æœä¸ºundefinedèµ‹å€¼ä¸º0</span>
    pCid <span class="token operator">=</span> dropNode<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>data<span class="token punctuation">.</span>catId <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">//è¿™é‡Œçš„dropNode.parentä¸ºelement-uiæä¾›çš„ï¼Œæ˜¯æ‹–æ‹½åçš„æ›´æ–°è¿‡çš„æ•°æ®(draggingNodeé‡Œçš„æ•°æ®ä¸ä¼šè·Ÿæ–°)</span>
    <span class="token comment">//æ‹–æ‹½åˆ°ä¸Šé¢æˆ–ä¸‹é¢ï¼Œåˆ™ ç›®æ ‡èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å­èŠ‚ç‚¹å³ä¸ºè¢«æ‹–åŠ¨èŠ‚ç‚¹çš„æ–°çš„çˆ¶èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹</span>
    sliblings <span class="token operator">=</span> dropNode<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>childNodes<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">//2ã€å°†å­èŠ‚ç‚¹æ›´æ–°çš„æ•°æ®æ”¾åˆ°updateNodesä¸­</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>updateNodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sliblings<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//å¦‚æœæ˜¯æ­£åœ¨æ‰˜æ‹½çš„èŠ‚ç‚¹ï¼Œéœ€è¦æ›´æ–°å…¶çˆ¶id</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>sliblings<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>catId <span class="token operator">==</span> draggingNode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>catId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> catLevel <span class="token operator">=</span> draggingNode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>catLevel<span class="token punctuation">;</span>
      <span class="token comment">//å½“å‰èŠ‚ç‚¹çš„å±‚çº§å‘ç”Ÿå˜åŒ–å°±æ›´æ–°å­èŠ‚ç‚¹å±‚çº§</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>sliblings<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>level <span class="token operator">!=</span> draggingNode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>catLevel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//å…¶å®è¿™ä¸ªcatLevelå§‹ç»ˆéƒ½æ˜¯ç­‰äºsliblings[i].level,å³æ›´æ–°åçš„level</span>
        catLevel <span class="token operator">=</span> sliblings<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>level<span class="token punctuation">;</span>
        <span class="token comment">//æ›´æ–°å­èŠ‚ç‚¹å±‚çº§</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateChildNodeLevel</span><span class="token punctuation">(</span>sliblings<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>updateNodes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">catId</span><span class="token operator">:</span> sliblings<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>catId<span class="token punctuation">,</span><span class="token literal-property property">sort</span><span class="token operator">:</span> i<span class="token punctuation">,</span><span class="token literal-property property">parentCid</span><span class="token operator">:</span> pCid<span class="token punctuation">,</span><span class="token literal-property property">catLevel</span><span class="token operator">:</span> catLevel<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>updateNodes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">catId</span><span class="token operator">:</span> sliblings<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>catId<span class="token punctuation">,</span> <span class="token literal-property property">sort</span><span class="token operator">:</span> i <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">//3ã€æŠŠæ•°æ®å‘é€ç»™åç«¯</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ‹–æ‹½èŠ‚ç‚¹æˆåŠŸåï¼Œå‘é€ç»™åç«¯çš„æ•°æ®:&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>updateNodes<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">//æ‹–åŠ¨èŠ‚ç‚¹åï¼Œæ›´æ–°å…¶å­èŠ‚ç‚¹çš„å±‚çº§</span>
<span class="token function">updateChildNodeLevel</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>childNodes<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> node<span class="token punctuation">.</span>childNodes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> catId <span class="token operator">=</span> node<span class="token punctuation">.</span>childNodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>catId<span class="token punctuation">;</span>
      <span class="token keyword">let</span> catLevel <span class="token operator">=</span> node<span class="token punctuation">.</span>childNodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>level<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>updateNodes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">catId</span><span class="token operator">:</span> catId<span class="token punctuation">,</span> <span class="token literal-property property">catLevel</span><span class="token operator">:</span> catLevel <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//é€’å½’æ›´æ–°å­èŠ‚ç‚¹å±‚çº§</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateChildNodeLevel</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>childNodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5ã€åç«¯æ·»åŠ æ‰¹é‡ä¿®æ”¹åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#_5ã€åç«¯æ·»åŠ æ‰¹é‡ä¿®æ”¹åŠŸèƒ½" aria-hidden="true">#</a> 5ã€åç«¯æ·»åŠ æ‰¹é‡ä¿®æ”¹åŠŸèƒ½</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¿®æ”¹èŠ‚ç‚¹çš„æ ‘å½¢ç»“æ„
 */</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/update/sort&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">updateSort</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">CategoryEntity</span><span class="token punctuation">[</span><span class="token punctuation">]</span> category<span class="token punctuation">)</span><span class="token punctuation">{</span>
    categoryService<span class="token punctuation">.</span><span class="token function">updateBatchById</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>category<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6ã€handledropæ–¹æ³•é‡Œæ·»åŠ ä»£ç " tabindex="-1"><a class="header-anchor" href="#_6ã€handledropæ–¹æ³•é‡Œæ·»åŠ ä»£ç " aria-hidden="true">#</a> 6ã€<code>handleDrop</code>æ–¹æ³•é‡Œæ·»åŠ ä»£ç </h4><p>åœ¨ç¬¬3æ­¥é‚£é‡Œæ·»åŠ å‘åç«¯å‘é€è¯·æ±‚çš„ä»£ç </p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/product/category/update/sort&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>updateNodes<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">èœå•ç»“æ„ä¿®æ”¹æˆåŠŸ</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//é‡æ–°è·å–æ•°æ®</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//é»˜è®¤å±•å¼€çš„èœå•èŠ‚ç‚¹</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>expandedKey <span class="token operator">=</span> <span class="token punctuation">[</span>pCid<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>updateNodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7ã€æµ‹è¯•æ˜¯å¦æˆåŠŸä¿®æ”¹" tabindex="-1"><a class="header-anchor" href="#_7ã€æµ‹è¯•æ˜¯å¦æˆåŠŸä¿®æ”¹" aria-hidden="true">#</a> 7ã€æµ‹è¯•æ˜¯å¦æˆåŠŸä¿®æ”¹</h4><p>ä¿®æ”¹ä»£ç ç»“æ„åï¼Œåˆ·æ–°é¡µé¢ï¼Œå‘ç°æ ‘çš„ç»“æ„å·²æ­£ç¡®æ˜¾ç¤º</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.9.7.1.png" alt="image-20220502154324423" tabindex="0" loading="lazy"><figcaption>image-20220502154324423</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.9.7.2.png" alt="image-20220502154013655" tabindex="0" loading="lazy"><figcaption>image-20220502154013655</figcaption></figure><h3 id="_4-1-10ã€å¤šæ¬¡æ‹–æ‹½åä¸€æ¬¡æäº¤" tabindex="-1"><a class="header-anchor" href="#_4-1-10ã€å¤šæ¬¡æ‹–æ‹½åä¸€æ¬¡æäº¤" aria-hidden="true">#</a> 4.1.10ã€å¤šæ¬¡æ‹–æ‹½åä¸€æ¬¡æäº¤</h3><p>å¤šæ¬¡æ‹–æ‹½åä¸€æ¬¡æäº¤æœ‰å¯èƒ½å‡ºç°å…¶ä»–çš„ç”¨æˆ·ä¿®æ”¹åï¼Œå½“å‰ç”¨æˆ·æ²¡æœ‰åŠæ—¶æ›´æ–°ï¼Œå½“å‰ç”¨æˆ·è¦†ç›–äº†å…¶ä»–ç”¨æˆ·æ•°æ®ï¼Œä½†å½“å‰ç”¨æˆ·å¹¶ä¸çŸ¥æƒ…</p><p>(ä¸èƒ½åƒä¿®æ”¹èŠ‚ç‚¹ä¿¡æ¯é‚£æ ·,ç‚¹å‡»<code>edit</code>å‘åç«¯å‘é€è¯·æ±‚ï¼Œè·å–æœ€æ–°æ•°æ®)</p><table><thead><tr><th style="text-align:left;">å‚æ•°</th><th style="text-align:left;">è¯´æ˜</th><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">é»˜è®¤å€¼</th></tr></thead><tbody><tr><td style="text-align:left;">draggable</td><td style="text-align:left;">æ˜¯å¦å¼€å¯æ‹–æ‹½èŠ‚ç‚¹åŠŸèƒ½</td><td style="text-align:left;">boolean</td><td style="text-align:left;">false</td></tr></tbody></table><h4 id="_1ã€æ·»åŠ å¼€å…³" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ å¼€å…³" aria-hidden="true">#</a> 1ã€æ·»åŠ å¼€å…³</h4>`,78),w=a("strong",null,"element-ui",-1),x=a("strong",null,"Switchå¼€å…³",-1),_=a("strong",null,"æ–‡å­—æè¿°",-1),z={href:"https://element.eleme.io/#/zh-CN/component/switch",target:"_blank",rel:"noopener noreferrer"},q=e(`<div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-switch</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>draggable<span class="token punctuation">&quot;</span></span> <span class="token attr-name">active-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å¼€å¯æ‹–æ‹½<span class="token punctuation">&quot;</span></span> <span class="token attr-name">inactive-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å…³é—­æ‹–æ‹½<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_2ã€ä¿®æ”¹el-treeçš„draggableå±æ€§" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹el-treeçš„draggableå±æ€§" aria-hidden="true">#</a> 2ã€ä¿®æ”¹<code>el-tree</code>çš„<code>draggable</code>å±æ€§</h4><p>åŠ¨æ€ç»‘å®š<code>draggable</code>çš„å€¼æ¥ç¡®å®šæ˜¯å¦å¯ä»¥æ‹–æ‹½</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token punctuation">:</span>draggable<span class="token punctuation">=</span>&quot;draggable&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_3ã€æ·»åŠ æ•°æ®å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ æ•°æ®å­—æ®µ" aria-hidden="true">#</a> 3ã€æ·»åŠ æ•°æ®å­—æ®µ</h4><p>é»˜è®¤è®¾ç½®ä¸ºä¸å¯æ‹–æ‹½</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code>//æ˜¯å¦å¯ä»¥æ‹–æ‹½
<span class="token key attr-name">draggable</span><span class="token punctuation">:</span> <span class="token value attr-value">false,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4ã€æ·»åŠ æ‰¹é‡ä¿å­˜æŒ‰é’®" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ æ‰¹é‡ä¿å­˜æŒ‰é’®" aria-hidden="true">#</a> 4ã€æ·»åŠ æ‰¹é‡ä¿å­˜æŒ‰é’®</h4><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>draggable<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>batchSave<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>æ‰¹é‡ä¿å­˜<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_5ã€æ·»åŠ batchsaveæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€æ·»åŠ batchsaveæ–¹æ³•" aria-hidden="true">#</a> 5ã€æ·»åŠ <code>batchSave</code>æ–¹æ³•</h4><p>åˆ é™¤<code>handleDrop</code>æ–¹æ³•é‡Œå‘åç«¯å‘é€è¯·æ±‚çš„ä»£ç ï¼ŒæŠŠå‘åç«¯å‘é€è¯·æ±‚çš„ä»£ç å†™åˆ°<code>batchSave</code>é‡Œ</p><p>ç”±äº<code>batchSave</code>é‡Œé¢æ²¡æœ‰<code>pCid</code>ï¼Œå› æ­¤éœ€è¦åœ¨<code>data</code>é‡Œæ·»åŠ <code>pCid : 0,</code></p><p>åœ¨<code>handleDrop</code>æ–¹æ³•é‡Œï¼Œè®¡ç®—å®Œ<code>pCid</code>æŠŠå®ƒèµ‹ç»™<code>this.pCid</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">batchSave</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/product/category/update/sort&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>updateNodes<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">èœå•ç»“æ„ä¿®æ”¹æˆåŠŸ</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//é‡æ–°è·å–æ•°æ®</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//é»˜è®¤å±•å¼€çš„èœå•èŠ‚ç‚¹</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>expandedKey <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>pCid<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>updateNodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//é‡æ–°èµ‹ç»™pCidé»˜è®¤å€¼</span>
    <span class="token comment">//è¿™ä¸€æ­¥å¯ä»¥å¯ä»¥çœç•¥ï¼Œä½†å‰ç«¯ä½¿ç”¨å˜é‡åé‡æ–°èµ‹åˆå€¼æ˜¯ä¸€ä¸ªè‰¯å¥½çš„ä¹ æƒ¯</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>pCid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6ã€ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„å±‚çº§" tabindex="-1"><a class="header-anchor" href="#_6ã€ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„å±‚çº§" aria-hidden="true">#</a> 6ã€ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„å±‚çº§</h4><p>ç”±äºåŠ å…¥äº†<strong>æ‰¹é‡æäº¤</strong>åŠŸèƒ½ï¼Œå½“èŠ‚ç‚¹æ‹–æ‹½å¤šæ¬¡åæ‰æäº¤ç»™åç«¯</p><p>å› æ­¤å¦‚æœè·å–<code>data</code>é‡Œçš„<strong>èŠ‚ç‚¹çš„å±‚çº§</strong>å’Œ<strong>èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹id</strong>ä¼šå¯¼è‡´è·å–åˆ°äº†æ²¡æœ‰æ›´æ–°çš„é”™è¯¯æ•°æ®</p><p>(è€Œä»¥å‰è·å–<code>data</code>é‡Œçš„æ•°æ®åç«‹å³å‘åç«¯å‘é€è¯·æ±‚ï¼Œé‡æ–°è·å–æ–°çš„å·²ç»æ›´æ–°è¿‡çš„æ•°æ®ï¼Œå› æ­¤ä¸ä¼šå‘ç”Ÿé”™è¯¯)</p><p><s>(å…¶å®ä¸æ›´æ–°<strong>èŠ‚ç‚¹çš„å±‚çº§</strong>ä¹Ÿå¯ä»¥ï¼Œå› ä¸ºé”™è¯¯çš„<strong>èŠ‚ç‚¹å±‚çº§</strong>åªç”¨æ¥è®¡ç®—æ‹–åŠ¨èŠ‚ç‚¹çš„å±€éƒ¨æ ‘çš„æ·±åº¦ï¼Œ<code>push</code>çš„éƒ½æ˜¯åŠ¨æ€æ›´æ–°çš„å±‚çº§,</s></p><p><s>è€Œä¸”æ°å·§è¢«æ‹–åŠ¨èŠ‚ç‚¹çš„å±€éƒ¨æ ‘éƒ½æ˜¯ä½¿ç”¨æœªè·Ÿæ–°çš„å±‚çº§ï¼Œå› æ­¤è®¡ç®—çš„æ·±åº¦ä¹Ÿæ˜¯æ­£ç¡®çš„ç»“æœ,ç”±äºè¿™äº›èŠ‚ç‚¹çš„å±‚çº§å¹¶ä¸ç”¨æ¥åšå…¶ä»–ç”¨é€”ï¼Œ</s></p><p><s>å…¶å®ä½¿ç”¨æ—§çš„å±‚çº§æ¥ç¡®å®šæ˜¯å¦å…è®¸æ‹–åŠ¨å¹¶æ²¡æœ‰é—®é¢˜,ä½†<code>return dropNode.parent.level + deep &lt;= 3;</code>å¿…é¡»ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„å±‚çº§ï¼Œ</s></p><p><s>å› ä¸ºå‡è®¾ä¸€ä¸ªèŠ‚ç‚¹çš„å±‚çº§ç”±2å˜ä¸ºäº†1ï¼Œå…¶å¯ä»¥åœ¨é‡Œé¢å†æ”¾2å±‚ï¼Œå¦‚æœä½¿ç”¨æœªæ›´æ–°çš„å±‚çº§åˆ™ä¼šæ˜¾ç¤ºä¸å¯ä»¥æ”¾ï¼Œä½†å…¶å®æ˜¯å¯ä»¥çš„ï¼Œ</s></p><p><s><code>return dropNode.data.catLevel + deep &lt;= 3;</code>ä¸ç”¨æ”¹ï¼Œå› ä¸ºç›®æ ‡èŠ‚ç‚¹çš„å±‚çº§å¹¶ä¸ä¼šæ”¹å˜,åªæœ‰è¢«æ‹–æ‹½èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹å±‚çº§ä¼šæ”¹å˜</s></p><p><s>æ€»ç»“ï¼šè¢«æ‹–åŠ¨èŠ‚ç‚¹çš„å±€éƒ¨æ ‘çš„å±‚çº§å¹¶ä¸å½±å“å…¶æ·±åº¦ï¼Œå¯ä»¥ä¸ç”¨ä¿®æ”¹ï¼Œå½“æ‹–æ‹½åˆ°<code>prev</code>æˆ–<code>next</code>åï¼Œç›®æ ‡èŠ‚ç‚¹çš„å±‚çº§å¹¶ä¸ä¼šæ”¹å˜ä¸ç”¨ä¿®æ”¹ï¼Œä½†<code>return dropNode.parent.level + deep &lt;= 3;</code>å¿…é¡»ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„å±‚çº§)</s></p><p>(å¯ä»¥ä½¿ç”¨ä¸åŠ¨æ€æ›´æ–°çš„å±‚çº§æ˜¯å»ºç«‹åœ¨è¢«æ‹–åŠ¨èŠ‚ç‚¹å…¶å­èŠ‚ç‚¹çš„ç»“æ„(ä¸»è¦æ˜¯æ·±åº¦)æ²¡æœ‰æ”¹å˜çš„æƒ…å†µä¸‹ï¼Œç±»å‹ä¸º<code>prev</code>ã€<code>next</code>å…¶çˆ¶èŠ‚ç‚¹æœ‰å¯èƒ½æ˜¯å·²ç»è¢«æ‹–æ‹½çš„èŠ‚ç‚¹ã€ç±»å‹ä¸º<code>inner</code>ç›®æ ‡èŠ‚ç‚¹ä¹Ÿæœ‰å¯èƒ½ä¸ºå·²ç»è¢«æ‹–æ‹½è¿‡çš„èŠ‚ç‚¹ã€‚å…¶å±‚çº§å¯èƒ½å·²ç»æ”¹å˜ï¼Œå› æ­¤ä¹Ÿå¿…é¡»ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„æ•°æ®ï¼Œè¢«æ‹–åŠ¨èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¹Ÿéœ€è¦ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„å­èŠ‚ç‚¹ï¼Œå±‚çº§ä¹Ÿéœ€è¦ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„å±‚çº§)</p><p>ä¾‹å­:</p><ol><li>ä¸€ä¸ªèŠ‚ç‚¹çš„å±‚çº§ç”±2å˜ä¸ºäº†1ï¼Œå…¶å¯ä»¥åœ¨é‡Œé¢å†æ”¾2å±‚ï¼Œå¦‚æœä½¿ç”¨æœªæ›´æ–°çš„å±‚çº§åˆ™ä¼šæ˜¾ç¤ºä¸å¯ä»¥æ”¾ï¼Œä½†å…¶å®æ˜¯å¯ä»¥çš„</li><li>ä¸€ä¸ªèŠ‚ç‚¹çš„å±‚çº§ç”±3å˜ä¸ºäº†2ï¼Œå…¶å¯ä»¥åœ¨é‡Œé¢å†æ”¾1å±‚ï¼Œå¦‚æœä½¿ç”¨æœªæ›´æ–°çš„å±‚çº§åˆ™ä¼šæ˜¾ç¤ºä¸å¯ä»¥æ”¾ï¼Œä½†å…¶å®æ˜¯å¯ä»¥çš„</li><li>ä¸€ä¸ªèŠ‚ç‚¹çš„å±‚çº§ç”±2å˜ä¸ºäº†1ï¼ŒæŠŠä¸€ä¸ªæ·±åº¦ä¸º2çš„èŠ‚ç‚¹æ”¾åˆ°è¿™ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„<code>prev</code>æˆ–<code>next</code>ï¼Œå¦‚æœä½¿ç”¨æœªæ›´æ–°çš„å±‚çº§åˆ™ä¼šæ˜¾ç¤ºä¸å¯ä»¥æ”¾ï¼Œä½†å…¶å®æ˜¯å¯ä»¥çš„</li></ol><p>æ‰€ä»¥åº”ä½¿ç”¨<code>element-ui</code>æä¾›çš„åŠ¨æ€æ›´æ–°çš„<strong>å±‚çº§</strong>å’Œ<strong>çˆ¶èŠ‚ç‚¹id</strong></p><p>(ä»¥å‰çš„ä»£ç ä½¿ç”¨çš„å°±æ˜¯<code>element-ui</code>æä¾›çš„åŠ¨æ€æ›´æ–°çš„çˆ¶èŠ‚ç‚¹idï¼Œå› æ­¤ä¸ç”¨ä¿®æ”¹äº†)</p><p>ä¿®æ”¹<code>allowDrop</code>æ–¹æ³•é‡Œçš„ä»£ç ï¼Œä½¿ç”¨è¢«æ‹–æ‹½èŠ‚ç‚¹çš„<code>element-ui</code>æä¾›çš„åŠ¨æ€æ›´æ–°çš„å±‚çº§</p><p>è¢«æ‹–æ‹½èŠ‚ç‚¹å¦‚æœè¢«å†æ¬¡æ‹–æ‹½<code>draggingNode.level</code>å’Œ <code>draggingNode.data.catLevel</code>æœ‰å¯èƒ½ä¼šä¸ä¸€æ ·</p><p>æŠŠè¿™æ®µä»£ç </p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>maxLength <span class="token operator">=</span> draggingNode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>catLevel<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¿®æ”¹æ”¹ä¸º</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>maxLength <span class="token operator">=</span> draggingNode<span class="token punctuation">.</span>level<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æŠŠè¿™æ®µä»£ç </p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> deep <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength <span class="token operator">-</span> draggingNode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>catLevel <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¿®æ”¹æ”¹ä¸º</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> deep <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength <span class="token operator">-</span> draggingNode<span class="token punctuation">.</span>level <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><s><code>allowDrop</code>æ–¹æ³•é‡Œçš„è¿™ä¸€è¡Œä¸ç”¨ä¿®æ”¹ï¼Œå› ä¸ºç›®æ ‡èŠ‚ç‚¹çš„å±‚çº§å¹¶ä¸ä¼šæ”¹å˜,åªæœ‰è¢«æ‹–æ‹½èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹å±‚çº§ä¼šæ”¹å˜</s></p><p>æŠŠè¿™æ®µä»£ç </p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">return</span> dropNode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>catLevel <span class="token operator">+</span> deep <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><s>å¯ä»¥</s>å¿…é¡»ä¿®æ”¹ä¸º~~(ä¹Ÿå¯ä»¥ä¸ä¿®æ”¹)~~</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">return</span> dropNode<span class="token punctuation">.</span>level <span class="token operator">+</span> deep <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å­èŠ‚ç‚¹ä¹Ÿä½¿ç”¨åŠ¨æ€æ›´æ–°çš„å±‚çº§ï¼Œå‚æ•°ä¸ä¼ è¢«æ‹–æ‹½èŠ‚ç‚¹çš„<code>data</code>å­—æ®µ,è€Œä¼ è¢«æ‹–æ‹½èŠ‚ç‚¹æœ¬èº«</p><p>åŠ¨æ€è·å–å…¶å­èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹çš„å±‚çº§</p><p>æŠŠè¿™æ®µä»£ç </p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">countNodeLevel</span><span class="token punctuation">(</span>draggingNode<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¿®æ”¹è¯¥ä¸º</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">countNodeLevel</span><span class="token punctuation">(</span>draggingNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æŠŠè¿™æ®µä»£ç </p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">countNodeLevel</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> children <span class="token operator">=</span> data<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>children <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> children<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>catLevel <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength <span class="token operator">=</span> children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>catLevel<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">//é€’å½’æŸ¥æ‰¾å…¶å­æ ‘çš„å­æ ‘çš„æœ€å¤§æ·±åº¦</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">countNodeLevel</span><span class="token punctuation">(</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¿®æ”¹è¯¥ä¸º</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">countNodeLevel</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> children <span class="token operator">=</span> node<span class="token punctuation">.</span>childNodes<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>children <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> children<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>level <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength <span class="token operator">=</span> children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>level<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">//é€’å½’æŸ¥æ‰¾å…¶å­æ ‘çš„å­æ ‘çš„æœ€å¤§æ·±åº¦</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">countNodeLevel</span><span class="token punctuation">(</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7ã€æµ‹è¯•-1" tabindex="-1"><a class="header-anchor" href="#_7ã€æµ‹è¯•-1" aria-hidden="true">#</a> 7ã€æµ‹è¯•</h4><p>å¼€æ‹–æ‹½åï¼Œè¿ç»­æ‹–æ‹½ä»¥ä¸‹ä¸¤æ¬¡ï¼Œå‘ç°å…è®¸æ‹–æ‹½ï¼Œè¯æ˜ä»£ç æ²¡é—®é¢˜</p><p>åˆå§‹ç»“æ„</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.10.7.1.png" alt="image-20220502172234731" tabindex="0" loading="lazy"><figcaption>image-20220502172234731</figcaption></figure><p>æŠŠ<code>2.1</code>æ‹–æ‹½åˆ°ä¸€çº§èœå•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.10.7.2.png" alt="image-20220502182545906" tabindex="0" loading="lazy"><figcaption>image-20220502182545906</figcaption></figure><p>æŠŠ<code>3.1</code>æ‹–æ‹½åˆ°<code>2.1</code>ä¸‹ï¼Œå‘ç°æ˜¯å¯ä»¥çš„ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„æ•°æ®ï¼Œä¼šæ˜¾ç¤ºä¸å¯ä»¥æ‹–æ‹½</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.10.7.3.png" alt="image-20220502192350288" tabindex="0" loading="lazy"><figcaption>image-20220502192350288</figcaption></figure><h4 id="_8ã€å®Œæ•´ä»£ç " tabindex="-1"><a class="header-anchor" href="#_8ã€å®Œæ•´ä»£ç " aria-hidden="true">#</a> 8ã€å®Œæ•´ä»£ç </h4><h5 id="_1ã€ä¸ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„å±‚çº§ä¹‹å‰çš„é”™è¯¯ä»£ç " tabindex="-1"><a class="header-anchor" href="#_1ã€ä¸ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„å±‚çº§ä¹‹å‰çš„é”™è¯¯ä»£ç " aria-hidden="true">#</a> 1ã€ä¸ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„å±‚çº§ä¹‹å‰çš„é”™è¯¯ä»£ç </h5><p><a href="code/4.1.10.8.1.vue">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç </a></p><h5 id="_2ã€ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„å±‚çº§ä¹‹åçš„æ­£ç¡®çš„ä»£ç " tabindex="-1"><a class="header-anchor" href="#_2ã€ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„å±‚çº§ä¹‹åçš„æ­£ç¡®çš„ä»£ç " aria-hidden="true">#</a> 2ã€ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„å±‚çº§ä¹‹åçš„æ­£ç¡®çš„ä»£ç </h5><p><a href="code/4.1.10.8.2.vue">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç </a></p><h3 id="_4-1-11ã€ä¼˜åŒ–ä½“éªŒ" tabindex="-1"><a class="header-anchor" href="#_4-1-11ã€ä¼˜åŒ–ä½“éªŒ" aria-hidden="true">#</a> 4.1.11ã€ä¼˜åŒ–ä½“éªŒ</h3><h4 id="_1ã€æäº¤åå±•å¼€å¤šä¸ªèŠ‚ç‚¹" tabindex="-1"><a class="header-anchor" href="#_1ã€æäº¤åå±•å¼€å¤šä¸ªèŠ‚ç‚¹" aria-hidden="true">#</a> 1ã€æäº¤åå±•å¼€å¤šä¸ªèŠ‚ç‚¹</h4><p>æ‹–æ‹½èŠ‚ç‚¹å¹¶æ‰¹é‡ä¿å­˜æˆåŠŸåå±•å¼€çš„èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªï¼Œå³å±•å¼€çš„æ˜¯æœ€åä¸€æ¬¡æ‹–æ‹½çš„çˆ¶èŠ‚ç‚¹</p><p>å› æ­¤å¯ä»¥å°†<code>pCid: 0,</code>æ”¹ä¸º<code>pCid: [],</code></p><p><code>this.pCid = pCid;</code>æ”¹ä¸º<code>this.pCid.push(pCid);</code></p><p><code>this.pCid = 0;</code>æ”¹ä¸º<code>this.pCid = [];</code></p><p>è¿™æ ·æ¯æ‹–æ‹½èŠ‚ç‚¹æˆåŠŸåï¼Œéƒ½èƒ½ä¿å­˜å…¶çˆ¶èŠ‚ç‚¹idï¼Œæ‰¹é‡ä¿å­˜åå¯ä»¥æ˜¾ç¤ºæ‰€æœ‰æ‹–æ‹½èŠ‚ç‚¹æˆåŠŸçš„èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹id</p><p>(ä½†æ²¡æ‹–æ‹½æˆåŠŸä½†å±•å¼€çš„èŠ‚ç‚¹åœ¨æ‰¹é‡ä¿å­˜åä¸èƒ½å†æ¬¡å±•å¼€)</p><h4 id="_2ã€ä»¥å‰å±•å¼€çš„èŠ‚ç‚¹-æäº¤åä¾ç„¶å±•å¼€" tabindex="-1"><a class="header-anchor" href="#_2ã€ä»¥å‰å±•å¼€çš„èŠ‚ç‚¹-æäº¤åä¾ç„¶å±•å¼€" aria-hidden="true">#</a> 2ã€ä»¥å‰å±•å¼€çš„èŠ‚ç‚¹ï¼Œæäº¤åä¾ç„¶å±•å¼€</h4><table><thead><tr><th style="text-align:left;">äº‹ä»¶åç§°</th><th style="text-align:left;">è¯´æ˜</th><th style="text-align:left;">å›è°ƒå‚æ•°</th></tr></thead><tbody><tr><td style="text-align:left;">node-expand</td><td style="text-align:left;">èŠ‚ç‚¹è¢«å±•å¼€æ—¶è§¦å‘çš„äº‹ä»¶</td><td style="text-align:left;">å…±ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºï¼šä¼ é€’ç»™ <code>data</code> å±æ€§çš„æ•°ç»„ä¸­è¯¥èŠ‚ç‚¹æ‰€å¯¹åº”çš„å¯¹è±¡ã€èŠ‚ç‚¹å¯¹åº”çš„ Nodeã€èŠ‚ç‚¹ç»„ä»¶æœ¬èº«</td></tr><tr><td style="text-align:left;">node-collapse</td><td style="text-align:left;">èŠ‚ç‚¹è¢«å…³é—­æ—¶è§¦å‘çš„äº‹ä»¶</td><td style="text-align:left;">å…±ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºï¼šä¼ é€’ç»™ <code>data</code> å±æ€§çš„æ•°ç»„ä¸­è¯¥èŠ‚ç‚¹æ‰€å¯¹åº”çš„å¯¹è±¡ã€èŠ‚ç‚¹å¯¹åº”çš„ Nodeã€èŠ‚ç‚¹ç»„ä»¶æœ¬èº«</td></tr></tbody></table><p><code>el-tree</code>æ·»åŠ å±æ€§</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>@node-expand=&quot;nodeExpand&quot;
@node-collapse=&quot;nodeCollapse&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ·»åŠ æ–¹æ³•:(ç°åœ¨ <code>this.pCid</code>è¡¨ç¤ºçš„æ˜¯æäº¤æ‹–æ‹½ç»“æœæ—¶éœ€è¦å±•å¼€çš„èŠ‚ç‚¹)</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//èŠ‚ç‚¹è¢«å±•å¼€æ—¶è§¦å‘çš„äº‹ä»¶</span>
<span class="token function">nodeExpand</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> node<span class="token punctuation">,</span> ele</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;èŠ‚ç‚¹è¢«å±•å¼€æ—¶è§¦å‘çš„äº‹ä»¶:&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">,</span> node<span class="token punctuation">,</span> ele<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>pCid<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>catId<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">//èŠ‚ç‚¹è¢«å…³é—­æ—¶è§¦å‘çš„äº‹ä»¶</span>
<span class="token function">nodeCollapse</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> node<span class="token punctuation">,</span> ele</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;èŠ‚ç‚¹è¢«å…³é—­æ—¶è§¦å‘çš„äº‹ä»¶&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">,</span> node<span class="token punctuation">,</span> ele<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>pCid<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>catId<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒç†ï¼Œå¯ä»¥ä½¿ç¼–è¾‘ã€ä¿®æ”¹ã€æ·»åŠ ï¼Œåªè¦æ˜¯é‡æ–°è·å–æ•°æ®(è°ƒç”¨<code>this.getMenus();</code>)å¯¼è‡´å±•å¼€çš„èŠ‚ç‚¹è¢«æŠ˜å çš„éƒ½å¯ä»¥åšç›¸ä¼¼çš„æ“ä½œ</p><p>ä¹Ÿå¯ä»¥å¦è¾Ÿè¹Šå¾„ï¼šå½“å±•å¼€èŠ‚ç‚¹æ—¶å°±æŠŠå®ƒåŠ å…¥åˆ°é»˜è®¤å±•å¼€çš„èŠ‚ç‚¹çš„ key çš„æ•°ç»„ï¼Œå½“æŠ˜å èŠ‚ç‚¹æ—¶å°±æŠŠå®ƒä»é»˜è®¤å±•å¼€çš„èŠ‚ç‚¹çš„ key çš„æ•°ç»„é‡Œåˆ é™¤</p><p>è¿™æ ·é‡æ–°è·å–æ•°æ®åï¼Œä»¥å‰å±•å¼€çš„èŠ‚ç‚¹éƒ½ä¼šè¢«å±•å¼€</p><h5 id="_1ã€ä½¿ç”¨è¯¥æ–¹æ³•å‰" tabindex="-1"><a class="header-anchor" href="#_1ã€ä½¿ç”¨è¯¥æ–¹æ³•å‰" aria-hidden="true">#</a> 1ã€ä½¿ç”¨è¯¥æ–¹æ³•å‰</h5><p><a href="code/4.1.11.2.1.vue">ç‚¹å‡»æŸ¥çœ‹ä½¿ç”¨è¯¥æ–¹æ³•å‰çš„ä»£ç </a></p><h5 id="_2ã€ä½¿ç”¨è¯¥æ–¹æ³•å" tabindex="-1"><a class="header-anchor" href="#_2ã€ä½¿ç”¨è¯¥æ–¹æ³•å" aria-hidden="true">#</a> 2ã€ä½¿ç”¨è¯¥æ–¹æ³•å</h5><p><a href="code/4.1.11.2.2.vue">ç‚¹å‡»æŸ¥çœ‹ä½¿ç”¨è¯¥æ–¹æ³•åçš„ä»£ç </a></p><h5 id="_3ã€åç«¯æŠ¥é”™" tabindex="-1"><a class="header-anchor" href="#_3ã€åç«¯æŠ¥é”™" aria-hidden="true">#</a> 3ã€åç«¯æŠ¥é”™</h5><p>å½“å¼€å¯æ‹–æ‹½èŠ‚ç‚¹åï¼Œä¸æ‹–æ‹½èŠ‚ç‚¹ï¼Œç›´æ¥æ‰¹é‡ä¿å­˜åé¡µé¢æ²¡ååº”</p><p>æ‰“å¼€æ§åˆ¶å°æŠ¥500çš„é”™è¯¯ï¼Œè¯æ˜æ˜¯åç«¯çš„é”™è¯¯</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.11.2.3.1.png" alt="image-20220502230717102" tabindex="0" loading="lazy"><figcaption>image-20220502230717102</figcaption></figure><p>æ‰“å¼€åç«¯å‘ç°ï¼Œå®ä½“åˆ—è¡¨ä¸èƒ½ä¸ºç©º</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.11.2.3.2.png" alt="image-20220502230934587" tabindex="0" loading="lazy"><figcaption>image-20220502230934587</figcaption></figure><p>åç«¯åŠ ä¸ªåˆ¤æ–­å°±è¡Œäº†</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¿®æ”¹èŠ‚ç‚¹çš„æ ‘å½¢ç»“æ„
 */</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/update/sort&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">updateSort</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">CategoryEntity</span><span class="token punctuation">[</span><span class="token punctuation">]</span> category<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>category<span class="token operator">!=</span><span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> category<span class="token punctuation">.</span>length<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        categoryService<span class="token punctuation">.</span><span class="token function">updateBatchById</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>category<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.11.2.3.3.png" alt="image-20220502231359263" tabindex="0" loading="lazy"><figcaption>image-20220502231359263</figcaption></figure><p>é‡å¯é¡¹ç›®åï¼Œå†æ¬¡ä¸æ‹–æ‹½èŠ‚ç‚¹ï¼Œç›´æ¥æ‰¹é‡ä¿å­˜ä¸æŠ¥é”™äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.11.2.3.4.png" alt="image-20220502231603498" tabindex="0" loading="lazy"><figcaption>image-20220502231603498</figcaption></figure><h4 id="_3ã€å¼€å¯æ‹–æ‹½åŠŸèƒ½å-ä¸èƒ½æ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤èŠ‚ç‚¹" tabindex="-1"><a class="header-anchor" href="#_3ã€å¼€å¯æ‹–æ‹½åŠŸèƒ½å-ä¸èƒ½æ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤èŠ‚ç‚¹" aria-hidden="true">#</a> 3ã€å¼€å¯æ‹–æ‹½åŠŸèƒ½åï¼Œä¸èƒ½æ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤èŠ‚ç‚¹</h4><p>åœ¨<code>append</code>ã€<code>remove</code>ã€<code>edit</code>æ–¹æ³•å¼€å¤´éƒ½åŠ ä¸Šå¦‚ä¸‹ç±»ä¼¼ä»£ç (åªéœ€ä¿®æ”¹ä¸€ä¸‹<code>message</code>)</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>draggable<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;warning&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;å¼€å¯æ‹–æ‹½åä¸å¯ä»¥åˆ é™¤èœå•&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4ã€æ‰¹é‡æäº¤åå…³é—­æ‹–æ‹½åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#_4ã€æ‰¹é‡æäº¤åå…³é—­æ‹–æ‹½åŠŸèƒ½" aria-hidden="true">#</a> 4ã€æ‰¹é‡æäº¤åå…³é—­æ‹–æ‹½åŠŸèƒ½</h4><p>åœ¨<code>batchSave</code>æœ€åæ·»åŠ å¦‚ä¸‹ä»£ç </p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//å…³é—­æ‹–æ‹½åŠŸèƒ½</span>
 <span class="token keyword">this</span><span class="token punctuation">.</span>draggable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5ã€å®Œæ•´ä»£ç " tabindex="-1"><a class="header-anchor" href="#_5ã€å®Œæ•´ä»£ç " aria-hidden="true">#</a> 5ã€å®Œæ•´ä»£ç </h4><p><a href="code/4.1.11.5.vue">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç </a></p><h3 id="_4-1-12ã€æ‰¹é‡åˆ é™¤" tabindex="-1"><a class="header-anchor" href="#_4-1-12ã€æ‰¹é‡åˆ é™¤" aria-hidden="true">#</a> 4.1.12ã€æ‰¹é‡åˆ é™¤</h3><h4 id="_1ã€æ·»åŠ æŒ‰é’®" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ æŒ‰é’®" aria-hidden="true">#</a> 1ã€æ·»åŠ æŒ‰é’®</h4>`,109),S=a("strong",null,"element-ui",-1),I=a("strong",null,"ButtonæŒ‰é’®",-1),E=a("strong",null,"åŸºæœ¬ç”¨æ³•",-1),j=a("strong",null,"å±é™©æŒ‰é’®",-1),A={href:"https://element.eleme.io/#/zh-CN/component/button",target:"_blank",rel:"noopener noreferrer"},P=e(`<p>åœ¨æ‰¹é‡ä¿å­˜å³è¾¹æ·»åŠ æ‰¹é‡åˆ é™¤æŒ‰é’®(ä»£ç å†™åœ¨æ‰¹é‡ä¿å­˜ä¸‹é¢ï¼Œel-treeä¸Šé¢)</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>danger<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>batchDelete<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>æ‰¹é‡åˆ é™¤<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_2ã€æ·»åŠ el-treeå±æ€§" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ el-treeå±æ€§" aria-hidden="true">#</a> 2ã€æ·»åŠ <code>el-tree</code>å±æ€§</h4><p>åœ¨<code>el-tree</code>æ ‡ç­¾é‡Œæ·»åŠ <code>ref=&quot;menuTree&quot;</code>å±æ€§ï¼Œæ ‡è®°è¿™ä¸ªç»„ä»¶çš„åå­—</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ref=&quot;menuTree&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_3ã€æ·»åŠ æ‰¹é‡åˆ é™¤æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ æ‰¹é‡åˆ é™¤æ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ æ‰¹é‡åˆ é™¤æ–¹æ³•</h4><table><thead><tr><th style="text-align:left;">æ–¹æ³•å</th><th style="text-align:left;">è¯´æ˜</th><th style="text-align:left;">å‚æ•°</th></tr></thead><tbody><tr><td style="text-align:left;">getCheckedNodes</td><td style="text-align:left;">è‹¥èŠ‚ç‚¹å¯è¢«é€‰æ‹©ï¼ˆå³ <code>show-checkbox</code> ä¸º <code>true</code>ï¼‰ï¼Œåˆ™è¿”å›ç›®å‰è¢«é€‰ä¸­çš„èŠ‚ç‚¹æ‰€ç»„æˆçš„æ•°ç»„</td><td style="text-align:left;">(leafOnly, includeHalfChecked) æ¥æ”¶ä¸¤ä¸ª boolean ç±»å‹çš„å‚æ•°ï¼Œ1. æ˜¯å¦åªæ˜¯å¶å­èŠ‚ç‚¹ï¼Œé»˜è®¤å€¼ä¸º <code>false</code> 2. æ˜¯å¦åŒ…å«åŠé€‰èŠ‚ç‚¹ï¼Œé»˜è®¤å€¼ä¸º <code>false</code></td></tr><tr><td style="text-align:left;">getCheckedKeys</td><td style="text-align:left;">è‹¥èŠ‚ç‚¹å¯è¢«é€‰æ‹©ï¼ˆå³ <code>show-checkbox</code> ä¸º <code>true</code>ï¼‰ï¼Œåˆ™è¿”å›ç›®å‰è¢«é€‰ä¸­çš„èŠ‚ç‚¹çš„ key æ‰€ç»„æˆçš„æ•°ç»„</td><td style="text-align:left;">(leafOnly) æ¥æ”¶ä¸€ä¸ª boolean ç±»å‹çš„å‚æ•°ï¼Œè‹¥ä¸º <code>true</code> åˆ™ä»…è¿”å›è¢«é€‰ä¸­çš„å¶å­èŠ‚ç‚¹çš„ keysï¼Œé»˜è®¤å€¼ä¸º <code>false</code></td></tr></tbody></table><p><code>this.$refs</code>ä¼šè·å–å½“å‰vueæ–‡ä»¶æ‰€æœ‰ç»„ä»¶</p><p><code>this.$refs.menuTree</code>è·å–å½“å‰vueæ–‡ä»¶æ‰€æœ‰æ ‡ç­¾ä¸­<code>ref</code>å±æ€§ä¸º<code>menuTree</code>æˆ–<code>components{}</code>é‡Œé¢ä¸º<code>menuTree</code>çš„ç»„ä»¶</p><p>ç„¶åå†è°ƒç”¨è¯¥ç»„ä»¶çš„æ–¹æ³•</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//æ‰¹é‡åˆ é™¤</span>
<span class="token function">batchDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> catIds <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>menuTree<span class="token punctuation">.</span><span class="token function">getCheckedKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰¹é‡åˆ é™¤çš„idï¼š&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>catIds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> names <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>menuTree
    <span class="token punctuation">.</span><span class="token function">getCheckedNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> node<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰¹é‡åˆ é™¤çš„åå­—:&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$confirm</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">æ˜¯å¦åˆ é™¤ã€</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>names<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ã€‘è¿™äº›èœå•</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token string">&quot;æç¤º&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">confirmButtonText</span><span class="token operator">:</span> <span class="token string">&quot;ç¡®å®š&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">cancelButtonText</span><span class="token operator">:</span> <span class="token string">&quot;å–æ¶ˆ&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;warning&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/product/category/delete&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornData</span><span class="token punctuation">(</span>catIds<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> datas <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">æ‰¹é‡åˆ é™¤æˆåŠŸ</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é‡æ–°å‘é€è¯·æ±‚,æ›´æ–°æ•°æ®</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;å·²å–æ¶ˆæ‰¹é‡åˆ é™¤&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3ç§æ–¹å¼å¯ä»¥è·å–åˆ°é€‰ä¸­èŠ‚ç‚¹çš„id</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> catIds <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>menuTree<span class="token punctuation">.</span><span class="token function">getCheckedKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> catIds <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>menuTree<span class="token punctuation">.</span><span class="token function">getCheckedNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token operator">=&gt;</span>node<span class="token punctuation">.</span>catId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> catIds <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>menuTree<span class="token punctuation">.</span><span class="token function">getCheckedNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> catIds<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>catId<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4ã€ä½“éªŒä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_4ã€ä½“éªŒä¼˜åŒ–" aria-hidden="true">#</a> 4ã€ä½“éªŒä¼˜åŒ–</h4><p>å½“æ²¡æœ‰é€‰ä¸­èŠ‚ç‚¹çš„æ—¶å€™ï¼Œä¸å‡ºç°<strong>æ‰¹é‡åˆ é™¤</strong>æŒ‰é’®</p><h5 id="_1ã€æ·»åŠ æ•°æ®å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ æ•°æ®å­—æ®µ" aria-hidden="true">#</a> 1ã€æ·»åŠ æ•°æ®å­—æ®µ</h5><p>åœ¨<code>data</code>é‡Œæ·»åŠ å­—æ®µï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦æ˜¾ç¤º<strong>æ‰¹é‡åˆ é™¤</strong>æŒ‰é’®</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code> canBatchDeletion: false,
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_2ã€æ·»åŠ v-ifå±æ€§" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ v-ifå±æ€§" aria-hidden="true">#</a> 2ã€æ·»åŠ <code>v-if</code>å±æ€§</h5><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>canBatchDeletion<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>danger<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>batchDelete<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>æ‰¹é‡åˆ é™¤<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_3ã€æ·»åŠ äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ äº‹ä»¶" aria-hidden="true">#</a> 3ã€æ·»åŠ äº‹ä»¶</h5><table><thead><tr><th style="text-align:left;">äº‹ä»¶åç§°</th><th style="text-align:left;">è¯´æ˜</th><th style="text-align:left;">å›è°ƒå‚æ•°</th></tr></thead><tbody><tr><td style="text-align:left;">check-change</td><td style="text-align:left;">èŠ‚ç‚¹é€‰ä¸­çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶çš„å›è°ƒ</td><td style="text-align:left;">å…±ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºï¼šä¼ é€’ç»™ <code>data</code> å±æ€§çš„æ•°ç»„ä¸­è¯¥èŠ‚ç‚¹æ‰€å¯¹åº”çš„å¯¹è±¡ã€èŠ‚ç‚¹æœ¬èº«æ˜¯å¦è¢«é€‰ä¸­ã€èŠ‚ç‚¹çš„å­æ ‘ä¸­æ˜¯å¦æœ‰è¢«é€‰ä¸­çš„èŠ‚ç‚¹</td></tr></tbody></table><p><code>el-tree</code>æ ‡ç­¾å†…æ·»åŠ å±æ€§</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">@check-change</span><span class="token punctuation">=</span><span class="token value attr-value">&quot;nodeCheckChange&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_4ã€ç¼–å†™æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€ç¼–å†™æ–¹æ³•" aria-hidden="true">#</a> 4ã€ç¼–å†™æ–¹æ³•</h5><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">nodeCheckChange</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> checked<span class="token punctuation">,</span> indeterminate</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> catIds <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>menuTree<span class="token punctuation">.</span><span class="token function">getCheckedKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>catIds<span class="token punctuation">)</span>
  <span class="token comment">//å¦‚æœcatIdsé•¿åº¦ä¸º0å°±ä¸æ˜¾ç¤ºæ‰¹é‡åˆ é™¤æŒ‰é’®</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>canBatchDeletion <span class="token operator">=</span> <span class="token operator">!</span><span class="token punctuation">(</span>catIds<span class="token punctuation">.</span>length<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_5ã€å‘ç°é¡µé¢æœ‰æŠ–åŠ¨ç°è±¡" tabindex="-1"><a class="header-anchor" href="#_5ã€å‘ç°é¡µé¢æœ‰æŠ–åŠ¨ç°è±¡" aria-hidden="true">#</a> 5ã€å‘ç°é¡µé¢æœ‰æŠ–åŠ¨ç°è±¡</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.12.4.5.1.gif" alt="4.1.7.6.4.5" tabindex="0" loading="lazy"><figcaption>4.1.7.6.4.5</figcaption></figure><p>æŠŠè¿™ä¸€è¡ŒåŠ ä¸ªdivè®¾ä¸ªé«˜åº¦å°±å¯ä»¥è§£å†³</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">height</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span> <span class="token property">line-height</span><span class="token punctuation">:</span> 50px</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-switch</span>
    <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>draggable<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">active-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å¼€å¯æ‹–æ‹½<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">inactive-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å…³é—­æ‹–æ‹½<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-switch</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- draggableä¸ºtrueæ—¶ï¼Œå¼€å¯äº†æ‹–æ‹½åŠŸèƒ½ï¼Œæ‰¹é‡ä¿å­˜æ‰æ˜¾ç¤º --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>draggable<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>batchSave<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>æ‰¹é‡ä¿å­˜<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>canBatchDeletion<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>danger<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>batchDelete<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>æ‰¹é‡åˆ é™¤<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.1.12.4.5.2.gif" alt="4.1.7.6.4.5.2" tabindex="0" loading="lazy"><figcaption>4.1.7.6.4.5.2</figcaption></figure><h5 id="_6ã€ç‚¹å‡»æ‰¹é‡åˆ é™¤å-éšè—è¯¥æŒ‰é’®" tabindex="-1"><a class="header-anchor" href="#_6ã€ç‚¹å‡»æ‰¹é‡åˆ é™¤å-éšè—è¯¥æŒ‰é’®" aria-hidden="true">#</a> 6ã€ç‚¹å‡»æ‰¹é‡åˆ é™¤åï¼Œéšè—è¯¥æŒ‰é’®</h5><p>åœ¨<code>batchDelete</code>æ–¹æ³•é‡Œé¢ é‡æ–°å‘é€è¯·æ±‚,æ›´æ–°æ•°æ®<code>this.getMenus();</code>çš„è¿™è¡Œä¸‹é¢æ·»åŠ è¿™è¡Œä»£ç </p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>//ä¸æ˜¾ç¤ºæ‰¹é‡åˆ é™¤æŒ‰é’®
this.canBatchDeletion = false;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_7ã€å®Œæ•´ä»£ç " tabindex="-1"><a class="header-anchor" href="#_7ã€å®Œæ•´ä»£ç " aria-hidden="true">#</a> 7ã€å®Œæ•´ä»£ç </h5><p><a href="code/4.1.12.4.7.vue">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç </a></p><h2 id="_4-2ã€å•†å“æœåŠ¡-api-å“ç‰Œç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_4-2ã€å•†å“æœåŠ¡-api-å“ç‰Œç®¡ç†" aria-hidden="true">#</a> 4.2ã€å•†å“æœåŠ¡-API-å“ç‰Œç®¡ç†</h2><h3 id="_4-2-1ã€æ·»åŠ å“ç‰Œç®¡ç†å‰ç«¯é¡µé¢" tabindex="-1"><a class="header-anchor" href="#_4-2-1ã€æ·»åŠ å“ç‰Œç®¡ç†å‰ç«¯é¡µé¢" aria-hidden="true">#</a> 4.2.1ã€æ·»åŠ å“ç‰Œç®¡ç†å‰ç«¯é¡µé¢</h3><h4 id="_1ã€å¤åˆ¶brand-vueæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_1ã€å¤åˆ¶brand-vueæ–‡ä»¶" aria-hidden="true">#</a> 1ã€å¤åˆ¶<code>brand.vue</code>æ–‡ä»¶</h4><p>å¤åˆ¶ä»¥å‰é€†å‘ç”Ÿæˆçš„<code>gulimall-product</code>é¡¹ç›®çš„<code>brand.vue</code>æ–‡ä»¶(åœ¨<code>\\main\\resources\\src\\views\\modules\\product</code>æ–‡ä»¶å¤¹ä¸‹)</p><p>ğŸ“Œå¦‚æœå·²ç»åˆ é™¤äº†å¯ä»¥æŸ¥çœ‹<code>1.10.10</code>èŠ‚çš„ç¬”è®°ï¼Œé‡æ–°é€†å‘ç”Ÿæˆ<code>gulimall-product</code>é¡¹ç›®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.1.1.png" alt="image-20220503114854616" tabindex="0" loading="lazy"><figcaption>image-20220503114854616</figcaption></figure><h4 id="_2ã€å¤åˆ¶åˆ°productæ–‡ä»¶å¤¹ä¸‹" tabindex="-1"><a class="header-anchor" href="#_2ã€å¤åˆ¶åˆ°productæ–‡ä»¶å¤¹ä¸‹" aria-hidden="true">#</a> 2ã€å¤åˆ¶åˆ°<code>product</code>æ–‡ä»¶å¤¹ä¸‹</h4><p>å¤åˆ¶åˆ°å‰ç«¯é¡¹ç›®çš„<code>renren-fast-vue\\src\\views\\modules\\product</code>æ–‡ä»¶å¤¹ä¸‹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.1.2.1.png" alt="image-20220503115203222" tabindex="0" loading="lazy"><figcaption>image-20220503115203222</figcaption></figure><h5 id="å¿«é€Ÿæ‰“å¼€productæ–‡ä»¶å¤¹" tabindex="-1"><a class="header-anchor" href="#å¿«é€Ÿæ‰“å¼€productæ–‡ä»¶å¤¹" aria-hidden="true">#</a> ğŸ“Œå¿«é€Ÿæ‰“å¼€<code>product</code>æ–‡ä»¶å¤¹</h5><p>é€‰ä¸­<code>product</code>--&gt;å³é”®--&gt;åœ¨æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­æ˜¾ç¤º</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.1.2.2.png" alt="image-20220503120339993" tabindex="0" loading="lazy"><figcaption>image-20220503120339993</figcaption></figure><h4 id="_3ã€åˆ é™¤-0-ä¸æ˜¾ç¤º-1-æ˜¾ç¤º" tabindex="-1"><a class="header-anchor" href="#_3ã€åˆ é™¤-0-ä¸æ˜¾ç¤º-1-æ˜¾ç¤º" aria-hidden="true">#</a> 3ã€åˆ é™¤<code>[0-ä¸æ˜¾ç¤ºï¼›1-æ˜¾ç¤º]</code></h4><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.1.3.png" alt="image-20220503120956488" tabindex="0" loading="lazy"><figcaption>image-20220503120956488</figcaption></figure><h4 id="_4ã€æŠ¥äº†ä¸ªé”™" tabindex="-1"><a class="header-anchor" href="#_4ã€æŠ¥äº†ä¸ªé”™" aria-hidden="true">#</a> 4ã€æŠ¥äº†ä¸ªé”™</h4><p>This relative module was not found: æœªæ‰¾åˆ°æ­¤ç›¸å…³æ¨¡å—</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.1.4.1.png" alt="image-20220503163746900" tabindex="0" loading="lazy"><figcaption>image-20220503163746900</figcaption></figure><p>å°±æ˜¯æ‰¾ä¸åˆ°<code>brand-add-or-update</code>ï¼ŒæŠŠ<code>brand-add-or-update.vue</code>æ–‡ä»¶ä¹Ÿå¤åˆ¶è¿›å»å°±è¡Œäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.1.4.2.png" alt="image-20220503170253394" tabindex="0" loading="lazy"><figcaption>image-20220503170253394</figcaption></figure><h4 id="_5ã€æ·»åŠ å“ç‰Œç®¡ç†è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#_5ã€æ·»åŠ å“ç‰Œç®¡ç†è·¯ç”±" aria-hidden="true">#</a> 5ã€æ·»åŠ å“ç‰Œç®¡ç†è·¯ç”±</h4><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.1.5.png" alt="image-20220503165715370" tabindex="0" loading="lazy"><figcaption>image-20220503165715370</figcaption></figure><h4 id="_6ã€å·²æˆåŠŸæ˜¾ç¤º" tabindex="-1"><a class="header-anchor" href="#_6ã€å·²æˆåŠŸæ˜¾ç¤º" aria-hidden="true">#</a> 6ã€å·²æˆåŠŸæ˜¾ç¤º</h4><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.1.6.png" alt="image-20220503170705172" tabindex="0" loading="lazy"><figcaption>image-20220503170705172</figcaption></figure><h3 id="_4-2-2ã€ä¸ºæ˜¾ç¤ºçŠ¶æ€æ‰€åœ¨çš„åˆ—æ·»åŠ æŒ‰é’®" tabindex="-1"><a class="header-anchor" href="#_4-2-2ã€ä¸ºæ˜¾ç¤ºçŠ¶æ€æ‰€åœ¨çš„åˆ—æ·»åŠ æŒ‰é’®" aria-hidden="true">#</a> 4.2.2ã€ä¸ºæ˜¾ç¤ºçŠ¶æ€æ‰€åœ¨çš„åˆ—æ·»åŠ æŒ‰é’®</h3><h4 id="_1ã€æ·»åŠ æŒ‰é’®-1" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ æŒ‰é’®-1" aria-hidden="true">#</a> 1ã€æ·»åŠ æŒ‰é’®</h4>`,63),R=a("strong",null,"element-ui",-1),C=a("strong",null,"Tableè¡¨æ ¼",-1),D=a("strong",null,"çš„è‡ªå®šä¹‰åˆ—æ¨¡æ¿",-1),B={href:"https://element.eleme.io/#/zh-CN/component/table",target:"_blank",rel:"noopener noreferrer"},T=e(`<blockquote><p>é€šè¿‡ <code>Scoped slot</code> å¯ä»¥è·å–åˆ° row, column, $index å’Œ storeï¼ˆtable å†…éƒ¨çš„çŠ¶æ€ç®¡ç†ï¼‰çš„æ•°æ®</p></blockquote><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>el-icon-time<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">margin-left</span><span class="token punctuation">:</span> 10px</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>{{ scope.row.date }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),L=a("strong",null,"element-ui",-1),G=a("strong",null,"Switchå¼€å…³",-1),M=a("strong",null,"åŸºæœ¬ç”¨æ³•",-1),O={href:"https://element.eleme.io/#/zh-CN/component/switch",target:"_blank",rel:"noopener noreferrer"},N=e(`<div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-switch</span>
  <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>value<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">active-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#13ce66<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">inactive-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#ff4949<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-switch</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å› æ­¤åœ¨<code>label</code>ä¸ºæ˜¾ç¤ºçŠ¶æ€çš„åˆ—é‡Œé¢ï¼Œæ·»åŠ å¦‚ä¸‹æ¨¡æ¿</p><p><code>scope.row</code>è·å–å½“å‰è¡Œæ•°æ®ï¼Œ<code>scope.row.showStatus</code>è·å–å½“å‰è¡Œæ•°æ®ä¸­é”®ä¸º<code>showStatus</code>çš„å€¼</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-switch</span>
    <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope.row.showStatus<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">active-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#13ce66<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">inactive-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#ff4949<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-switch</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.1.1.png" alt="image-20220503173256805" tabindex="0" loading="lazy"><figcaption>image-20220503173256805</figcaption></figure><p>æ•ˆæœå°±å‡ºæ¥äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.1.2.png" alt="image-20220503173852450" tabindex="0" loading="lazy"><figcaption>image-20220503173852450</figcaption></figure><h4 id="_2ã€æ–°å»ºå’Œæ‰¹é‡åˆ é™¤æŒ‰é’®ä¸æ˜¾ç¤º" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å»ºå’Œæ‰¹é‡åˆ é™¤æŒ‰é’®ä¸æ˜¾ç¤º" aria-hidden="true">#</a> 2ã€<code>æ–°å»º</code>å’Œ<code>æ‰¹é‡åˆ é™¤</code>æŒ‰é’®ä¸æ˜¾ç¤º</h4><p>ç”±äºä½¿ç”¨äº†<code>v-if</code>å½“<code>isAuth(&#39;product:brand:save&#39;)</code>ä¸º<code>true</code>ï¼ˆæ²¡æœ‰æƒé™ï¼‰æ—¶ï¼Œå°±ä¸æ˜¾ç¤ºæŒ‰é’®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.2.1.png" alt="image-20220503175051236" tabindex="0" loading="lazy"><figcaption>image-20220503175051236</figcaption></figure><p>æŠŠ<code>src\\utils\\index.js</code>çš„<code>isAuth</code>æ–¹æ³•çš„è¿™ä¸€è¡Œåˆ æ‰</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.2.2.png" alt="image-20220503174636295" tabindex="0" loading="lazy"><figcaption>image-20220503174636295</figcaption></figure><p>ç›´æ¥è¿”å›<code>true</code>å°±è¡Œäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.2.3.png" alt="image-20220503174745909" tabindex="0" loading="lazy"><figcaption>image-20220503174745909</figcaption></figure><p>å¯ä»¥çœ‹åˆ°æŒ‰é’®å·²ç»æ˜¾ç¤ºäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.2.4.png" alt="image-20220503174810653" tabindex="0" loading="lazy"><figcaption>image-20220503174810653</figcaption></figure><h4 id="_3ã€ä¿®æ”¹å¯¹è¯æ¡†" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹å¯¹è¯æ¡†" aria-hidden="true">#</a> 3ã€ä¿®æ”¹å¯¹è¯æ¡†</h4><p>ç‚¹å‡»æ–°å»ºæŒ‰é’®çš„å¼¹å‡ºæ¡†å†™åœ¨<code>brand-add-or-update.vue</code>æ–‡ä»¶é‡Œï¼Œåœ¨è¿™é‡Œå¼•å…¥çš„</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.3.1.png" alt="image-20220503175515419" tabindex="0" loading="lazy"><figcaption>image-20220503175515419</figcaption></figure><p>åˆ æ‰è¿™äº›ï¼Œè¿˜æ˜¯ä½¿ç”¨æŒ‰é’®çš„æ–¹å¼</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.3.2.png" alt="image-20220503175845685" tabindex="0" loading="lazy"><figcaption>image-20220503175845685</figcaption></figure><p><code>v-model</code>ç»‘å®šçš„æ•°æ®è¿˜æ˜¯å’Œåˆ é™¤æ‰çš„<code>el-input</code>æ ‡ç­¾åŒå‘ç»‘å®šçš„æ•°æ®ä¸€æ ·ï¼Œæ˜¯<code>dataForm.showStatus</code>ä¸å˜</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-switch</span>
    <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataForm.showStatus<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">active-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#13ce66<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">inactive-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#ff4949<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-switch</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.3.3.png" alt="image-20220503180026375" tabindex="0" loading="lazy"><figcaption>image-20220503180026375</figcaption></figure><p>ç‚¹å‡»<code>æ–°å»º</code>åå¼¹å‡ºçš„<code>æ˜¾ç¤ºçŠ¶æ€</code>å·²ç»æ˜¯æŒ‰é’®äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.3.4.png" alt="image-20220503180641548" tabindex="0" loading="lazy"><figcaption>image-20220503180641548</figcaption></figure><h4 id="_4ã€ä¿®æ”¹è¡¨å•å®½åº¦" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿®æ”¹è¡¨å•å®½åº¦" aria-hidden="true">#</a> 4ã€ä¿®æ”¹è¡¨å•å®½åº¦</h4><p>è¡¨å•çš„å®½åº¦æœ‰ç‚¹çª„</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.4.1.png" alt="image-20220503180824164" tabindex="0" loading="lazy"><figcaption>image-20220503180824164</figcaption></figure><p>è¿™é‡Œæ”¹ä¸º<code>140px</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.4.2.png" alt="image-20220503180933818" tabindex="0" loading="lazy"><figcaption>image-20220503180933818</figcaption></figure><p>è¿™æ ·å°±å¥½çœ‹å¤šäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.4.3.png" alt="image-20220503181014800" tabindex="0" loading="lazy"><figcaption>image-20220503181014800</figcaption></figure><h4 id="_5ã€ç»‘å®šç›‘å¬äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#_5ã€ç»‘å®šç›‘å¬äº‹ä»¶" aria-hidden="true">#</a> 5ã€ç»‘å®šç›‘å¬äº‹ä»¶</h4><table><thead><tr><th style="text-align:left;">äº‹ä»¶åç§°</th><th style="text-align:left;">è¯´æ˜</th><th style="text-align:left;">å›è°ƒå‚æ•°</th></tr></thead><tbody><tr><td style="text-align:left;">change</td><td style="text-align:left;">switch çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶çš„å›è°ƒå‡½æ•°</td><td style="text-align:left;">æ–°çŠ¶æ€çš„å€¼</td></tr></tbody></table><h5 id="_1ã€ä¸ºæŒ‰é’®æ·»åŠ ç›‘å¬äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¸ºæŒ‰é’®æ·»åŠ ç›‘å¬äº‹ä»¶" aria-hidden="true">#</a> 1ã€ä¸ºæŒ‰é’®æ·»åŠ ç›‘å¬äº‹ä»¶</h5><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-switch</span>
    <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope.row.showStatus<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">active-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#13ce66<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">inactive-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#ff4949<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>updateBrandStatus<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-switch</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.5.1.png" alt="image-20220504155713996" tabindex="0" loading="lazy"><figcaption>image-20220504155713996</figcaption></figure><h5 id="_2ã€ç¼–å†™å›è°ƒæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€ç¼–å†™å›è°ƒæ–¹æ³•" aria-hidden="true">#</a> 2ã€ç¼–å†™å›è°ƒæ–¹æ³•</h5><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//æ˜¾ç¤ºçŠ¶æ€æŒ‰é’®çš„å›è°ƒå‡½æ•°</span>
<span class="token function">updateBrandStatus</span><span class="token punctuation">(</span><span class="token parameter">status</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ˜¾ç¤ºçŠ¶æ€:&quot;</span><span class="token operator">+</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3ã€åªæ˜¾ç¤ºtrueæˆ–false" tabindex="-1"><a class="header-anchor" href="#_3ã€åªæ˜¾ç¤ºtrueæˆ–false" aria-hidden="true">#</a> 3ã€åªæ˜¾ç¤º<code>true</code>æˆ–<code>false</code></h5><p>åªæ˜¾ç¤º<code>true</code>æˆ–<code>false</code>ï¼Œå¹¶ä¸èƒ½ç¡®å®šæ˜¯å“ªä¸ªæŒ‰é’®çš„äº‹ä»¶</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.5.3.png" alt="image-20220504160833252" tabindex="0" loading="lazy"><figcaption>image-20220504160833252</figcaption></figure><h5 id="_4ã€ä¿®æ”¹è°ƒç”¨æ–¹æ³•çš„å‚æ•°" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿®æ”¹è°ƒç”¨æ–¹æ³•çš„å‚æ•°" aria-hidden="true">#</a> 4ã€ä¿®æ”¹è°ƒç”¨æ–¹æ³•çš„å‚æ•°</h5><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-switch</span>
    <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope.row.showStatus<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">active-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#13ce66<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">inactive-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#ff4949<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>updateBrandStatus(scope.row)<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-switch</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_5ã€ä¿®æ”¹å›è°ƒæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¿®æ”¹å›è°ƒæ–¹æ³•" aria-hidden="true">#</a> 5ã€ä¿®æ”¹å›è°ƒæ–¹æ³•</h5><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//æ˜¾ç¤ºçŠ¶æ€æŒ‰é’®çš„å›è°ƒå‡½æ•°</span>
<span class="token function">updateBrandStatus</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ˜¾ç¤ºçŠ¶æ€:&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œå·²ç»å¯ä»¥è·å–æ˜¾ç¤ºçŠ¶æ€å¯¹åº”æŒ‰é’®é‚£ä¸€è¡Œçš„ä¿¡æ¯å’ŒæŒ‰é’®çŠ¶æ€äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.5.5.png" alt="image-20220504162444824" tabindex="0" loading="lazy"><figcaption>image-20220504162444824</figcaption></figure><h5 id="_6ã€æµ‹è¯•åç«¯æ¥å£" tabindex="-1"><a class="header-anchor" href="#_6ã€æµ‹è¯•åç«¯æ¥å£" aria-hidden="true">#</a> 6ã€æµ‹è¯•åç«¯æ¥å£</h5><p>ç‚¹å‡»<code>BrandController</code>ç±»<code>update</code>æ–¹æ³•å·¦ä¾§çš„å°å›¾æ ‡ï¼Œè¿›å…¥IDEAè‡ªå¸¦çš„<code>HTTP Client</code>è°ƒè¯•å·¥å…·è¿›è¡Œæµ‹è¯•</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>###
POST http://localhost:10000/product/brand/update
Content-Type: application/json

{&quot;brandId&quot;: 1,&quot;logo&quot;: &quot;xxx&quot;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.5.6.1.png" alt="image-20220504163757244" tabindex="0" loading="lazy"><figcaption>image-20220504163757244</figcaption></figure><p>å¯ä»¥çœ‹åˆ°<code>logo</code>åˆ—å·²æ›´æ–°</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.5.6.2.png" alt="image-20220504164033831" tabindex="0" loading="lazy"><figcaption>image-20220504164033831</figcaption></figure><p>7ã€ä¿®æ”¹<code>updateBrandStatus</code>æ–¹æ³•</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//æ˜¾ç¤ºçŠ¶æ€æŒ‰é’®çš„å›è°ƒå‡½æ•°</span>
<span class="token function">updateBrandStatus</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ˜¾ç¤ºçŠ¶æ€:&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span>brandId<span class="token punctuation">,</span>showStatus<span class="token punctuation">}</span> <span class="token operator">=</span> data<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span><span class="token string">&#39;/product/brand/update&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&#39;post&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>brandId<span class="token punctuation">,</span>showStatus<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æ›´æ–°æˆåŠŸ&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_8ã€æ§åˆ¶å°æŠ¥é”™" tabindex="-1"><a class="header-anchor" href="#_8ã€æ§åˆ¶å°æŠ¥é”™" aria-hidden="true">#</a> 8ã€æ§åˆ¶å°æŠ¥é”™</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.5.8.1.png" alt="image-20220504165445351" tabindex="0" loading="lazy"><figcaption>image-20220504165445351</figcaption></figure><p>æŸ¥çœ‹è¯·æ±‚ä½“çš„å†…å®¹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.5.8.2.png" alt="image-20220504165604410" tabindex="0" loading="lazy"><figcaption>image-20220504165604410</figcaption></figure><p>åç«¯ä¹ŸæŠ¥äº†è­¦å‘Š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>2022-05-04 16:55:41.980  WARN 18564 --- [io-10000-exec-2] .w.s.m.s.DefaultHandlerExceptionResolver : Resolved [org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Cannot deserialize instance of \`java.lang.Integer\` out of VALUE_TRUE token; nested exception is com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize instance of \`java.lang.Integer\` out of VALUE_TRUE token
 at [Source: (PushbackInputStream); line: 1, column: 27] (through reference chain: com.atguigu.gulimall.product.entity.BrandEntity[&quot;showStatus&quot;])]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸èƒ½æŠŠ<code>showStatus</code>çš„å€¼è½¬ä¸º<code>java.lang.Integer</code>ç±»å‹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.5.8.3.png" alt="image-20220504165704201" tabindex="0" loading="lazy"><figcaption>image-20220504165704201</figcaption></figure><p>æ•°æ®åº“æ˜¯ä½¿ç”¨<code>1</code>æˆ–<code>0</code>æ¥è¡¨ç¤º<strong>æ˜¾ç¤º</strong>ä¸<strong>ä¸æ˜¾ç¤º</strong>ï¼Œè€Œä¸æ˜¯<code>true</code>æˆ–<code>false</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.5.8.4.png" alt="image-20220504170055609" tabindex="0" loading="lazy"><figcaption>image-20220504170055609</figcaption></figure><h5 id="_9ã€ä¿®æ”¹showstatuså€¼çš„ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_9ã€ä¿®æ”¹showstatuså€¼çš„ç±»å‹" aria-hidden="true">#</a> 9ã€ä¿®æ”¹<code>showStatus</code>å€¼çš„ç±»å‹</h5><p>æ–¹æ³•ä¸€ï¼š</p><table><thead><tr><th style="text-align:left;">å‚æ•°</th><th style="text-align:left;">è¯´æ˜</th><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">é»˜è®¤å€¼</th></tr></thead><tbody><tr><td style="text-align:left;">active-value</td><td style="text-align:left;">switch æ‰“å¼€æ—¶çš„å€¼</td><td style="text-align:left;">boolean / string / number</td><td style="text-align:left;">true</td></tr><tr><td style="text-align:left;">nactive-value</td><td style="text-align:left;">switch å…³é—­æ—¶çš„å€¼</td><td style="text-align:left;">boolean / string / number</td><td style="text-align:left;">false</td></tr></tbody></table><p>æŒ‡å®šswitch æ‰“å¼€æˆ–å…³é—­çš„å€¼</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-switch</span>
    <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope.row.showStatus<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">active-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#13ce66<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">inactive-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#ff4949<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>updateBrandStatus(scope.row)<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:active-value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:inactive-value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-switch</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><s>æ–¹æ³•äºŒï¼š</s></p><p>ä¸‰å…ƒè¿ç®—ç¬¦åˆ¤æ–­ï¼ˆ<strong>è¿™ç§æ–¹æ³•ä¸è¡Œ</strong>ï¼‰</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//æ˜¾ç¤ºçŠ¶æ€æŒ‰é’®çš„å›è°ƒå‡½æ•°</span>
<span class="token function">updateBrandStatus</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ˜¾ç¤ºçŠ¶æ€:&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span>brandId<span class="token punctuation">,</span>showStatus<span class="token punctuation">}</span> <span class="token operator">=</span> data<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span><span class="token string">&#39;/product/brand/update&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&#39;post&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>brandId<span class="token punctuation">,</span><span class="token literal-property property">showStatus</span><span class="token operator">:</span>showStatus<span class="token operator">?</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æ›´æ–°æˆåŠŸ&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ç§æ–¹æ³•ä¸å¯ä»¥åˆå§‹åŒ–æ­£ç¡®çš„å¼€å…³çŠ¶æ€(é»˜è®¤ä½¿ç”¨<code>true</code>æˆ–<code>false</code>æ¥è¡¨ç¤ºå¼€å…³çŠ¶æ€ï¼Œç”±äºè¿™ç§æ–¹æ³•è¿”å›<code>1</code>æˆ–<code>0</code>ï¼Œæ‰€ä»¥åªèƒ½é»˜è®¤æ˜¾ç¤ºå…³é—­çŠ¶æ€)</p><h6 id="_1ã€å…ˆè®©æ˜¾ç¤ºçŠ¶æ€å¼€å…³æ‰“å¼€" tabindex="-1"><a class="header-anchor" href="#_1ã€å…ˆè®©æ˜¾ç¤ºçŠ¶æ€å¼€å…³æ‰“å¼€" aria-hidden="true">#</a> 1ã€å…ˆè®©æ˜¾ç¤ºçŠ¶æ€å¼€å…³æ‰“å¼€</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.5.9.1.png" alt="image-20220504182321591" tabindex="0" loading="lazy"><figcaption>image-20220504182321591</figcaption></figure><h6 id="_2ã€å½“åˆ·æ–°é¡µé¢å-æ˜¾ç¤ºçŠ¶æ€è¿˜æ˜¯å…³é—­" tabindex="-1"><a class="header-anchor" href="#_2ã€å½“åˆ·æ–°é¡µé¢å-æ˜¾ç¤ºçŠ¶æ€è¿˜æ˜¯å…³é—­" aria-hidden="true">#</a> 2ã€å½“åˆ·æ–°é¡µé¢åï¼Œæ˜¾ç¤ºçŠ¶æ€è¿˜æ˜¯å…³é—­</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.5.9.2.png" alt="image-20220504182757184" tabindex="0" loading="lazy"><figcaption>image-20220504182757184</figcaption></figure><h6 id="_3ã€ä½†æ•°æ®åº“å…¶å®å·²æ›´æ–°ä¸º1äº†" tabindex="-1"><a class="header-anchor" href="#_3ã€ä½†æ•°æ®åº“å…¶å®å·²æ›´æ–°ä¸º1äº†" aria-hidden="true">#</a> 3ã€ä½†æ•°æ®åº“å…¶å®å·²æ›´æ–°ä¸º1äº†</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.5.9.3.png" alt="image-20220504183048856" tabindex="0" loading="lazy"><figcaption>image-20220504183048856</figcaption></figure><h5 id="_10ã€æŸ¥çœ‹æ•ˆæœ" tabindex="-1"><a class="header-anchor" href="#_10ã€æŸ¥çœ‹æ•ˆæœ" aria-hidden="true">#</a> 10ã€æŸ¥çœ‹æ•ˆæœ</h5><p>ä½¿ç”¨æ–¹æ³•ä¸€åˆ·æ–°é¡µé¢åï¼Œæ˜¾ç¤ºçŠ¶æ€ä¾ç„¶å¯ä»¥æ­£ç¡®å±•ç¤ºï¼Œä½†æ–¹æ³•äºŒä¸è¡Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.2.5.10.png" alt="image-20220504171102995" tabindex="0" loading="lazy"><figcaption>image-20220504171102995</figcaption></figure><p>åŒç†ä¿®æ”¹<code>brand-add-or-update.vue</code>æ–‡ä»¶é‡Œ<code>el-switch</code>æ ‡ç­¾é‡Œçš„è¿™ä¸¤ä¸ªå±æ€§</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-switch</span>
    <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataForm.showStatus<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">active-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#13ce66<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">inactive-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#ff4949<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:active-value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:inactive-value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-switch</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-2-3ã€å¯¹è±¡å­˜å‚¨oos" tabindex="-1"><a class="header-anchor" href="#_4-2-3ã€å¯¹è±¡å­˜å‚¨oos" aria-hidden="true">#</a> 4.2.3ã€å¯¹è±¡å­˜å‚¨OOS</h3><p>å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼ˆObject Storage Serviceï¼ŒOSSï¼‰æ˜¯ä¸€ç§æµ·é‡ã€å®‰å…¨ã€ä½æˆæœ¬ã€é«˜å¯é çš„äº‘å­˜å‚¨ æœåŠ¡ï¼Œé€‚åˆå­˜æ”¾ä»»æ„ç±»å‹çš„æ–‡ä»¶ã€‚å®¹é‡å’Œå¤„ç†èƒ½åŠ›å¼¹æ€§æ‰©å±•ï¼Œå¤šç§å­˜å‚¨ç±»å‹ä¾›é€‰æ‹©ï¼Œå…¨é¢ä¼˜åŒ–å­˜å‚¨æˆæœ¬ã€‚</p><p>å¸¸ç”¨çš„æ–‡ä»¶å­˜å‚¨æ–¹å¼ï¼š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.0.1.png" alt="image-20220504231711548" tabindex="0" loading="lazy"><figcaption>image-20220504231711548</figcaption></figure><p>æœ¬é¡¹ç›®é‡‡ç”¨é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨æœåŠ¡</p><p>é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨-æ™®é€šä¸Šä¼ æ–¹å¼</p><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.0.2.png" alt="image-20220721202146252" style="zoom:50%;"><p>é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨-æœåŠ¡ç«¯ç­¾ååç›´ä¼ </p><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.0.3.png" alt="image-20220721202225102" style="zoom:50%;"><h4 id="_1ã€å®åè®¤è¯" tabindex="-1"><a class="header-anchor" href="#_1ã€å®åè®¤è¯" aria-hidden="true">#</a> 1ã€å®åè®¤è¯</h4><h5 id="_1ã€ç™»é™†å-ç‚¹å‡»æ§åˆ¶å°" tabindex="-1"><a class="header-anchor" href="#_1ã€ç™»é™†å-ç‚¹å‡»æ§åˆ¶å°" aria-hidden="true">#</a> 1ã€ç™»é™†åï¼Œç‚¹å‡»æ§åˆ¶å°</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.1.1.png" alt="image-20220504212358467" tabindex="0" loading="lazy"><figcaption>image-20220504212358467</figcaption></figure><h5 id="_2ã€ç‚¹å‡»å®åè®¤è¯æŒ‰é’®" tabindex="-1"><a class="header-anchor" href="#_2ã€ç‚¹å‡»å®åè®¤è¯æŒ‰é’®" aria-hidden="true">#</a> 2ã€ç‚¹å‡»å®åè®¤è¯æŒ‰é’®</h5><p>é¼ æ ‡ç»è¿‡å°äººå¤´åƒï¼Œåœ¨å¼¹å‡ºçš„æ¡†ä¸­ç‚¹å‡»çš„å®åè®¤è¯ï¼ŒæŒ‰æ­¥éª¤æ“ä½œå³å¯</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.1.2.png" alt="image-20220504212450484" tabindex="0" loading="lazy"><figcaption>image-20220504212450484</figcaption></figure><h4 id="_2ã€å¼€å¯osså¯¹è±¡å­˜å‚¨æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_2ã€å¼€å¯osså¯¹è±¡å­˜å‚¨æœåŠ¡" aria-hidden="true">#</a> 2ã€å¼€å¯OSSå¯¹è±¡å­˜å‚¨æœåŠ¡</h4><h5 id="_1ã€ç‚¹å‡»å·¦ä¸Šè§’çš„ä¸‰æ¡æ¨ªæ " tabindex="-1"><a class="header-anchor" href="#_1ã€ç‚¹å‡»å·¦ä¸Šè§’çš„ä¸‰æ¡æ¨ªæ " aria-hidden="true">#</a> 1ã€ç‚¹å‡»å·¦ä¸Šè§’çš„ä¸‰æ¡æ¨ªæ </h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.2.1.png" alt="image-20220504212845267" tabindex="0" loading="lazy"><figcaption>image-20220504212845267</figcaption></figure><h5 id="_2ã€ç‚¹å‡»å¯¹è±¡å­˜å‚¨oss" tabindex="-1"><a class="header-anchor" href="#_2ã€ç‚¹å‡»å¯¹è±¡å­˜å‚¨oss" aria-hidden="true">#</a> 2ã€ç‚¹å‡»å¯¹è±¡å­˜å‚¨OSS</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.2.2.png" alt="image-20220504212952128" tabindex="0" loading="lazy"><figcaption>image-20220504212952128</figcaption></figure><h5 id="_3ã€ç‚¹å‡»ç«‹å³å¼€é€š" tabindex="-1"><a class="header-anchor" href="#_3ã€ç‚¹å‡»ç«‹å³å¼€é€š" aria-hidden="true">#</a> 3ã€ç‚¹å‡»ç«‹å³å¼€é€š</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.2.3.png" alt="image-20220504213041621" tabindex="0" loading="lazy"><figcaption>image-20220504213041621</figcaption></figure><h5 id="_4ã€å‹¾é€‰åè®®-ç„¶åç‚¹å‡»ç«‹å³å¼€é€š" tabindex="-1"><a class="header-anchor" href="#_4ã€å‹¾é€‰åè®®-ç„¶åç‚¹å‡»ç«‹å³å¼€é€š" aria-hidden="true">#</a> 4ã€å‹¾é€‰åè®®ï¼Œç„¶åç‚¹å‡»ç«‹å³å¼€é€š</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.2.4.png" alt="image-20220504213212922" tabindex="0" loading="lazy"><figcaption>image-20220504213212922</figcaption></figure><h5 id="_5ã€ç‚¹å‡»ç®¡ç†æ§åˆ¶å°" tabindex="-1"><a class="header-anchor" href="#_5ã€ç‚¹å‡»ç®¡ç†æ§åˆ¶å°" aria-hidden="true">#</a> 5ã€ç‚¹å‡»ç®¡ç†æ§åˆ¶å°</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.2.5.png" alt="image-20220504213312344" tabindex="0" loading="lazy"><figcaption>image-20220504213312344</figcaption></figure><h5 id="_6ã€æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#_6ã€æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£" aria-hidden="true">#</a> 6ã€æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.2.6.png" alt="image-20220504223019548" tabindex="0" loading="lazy"><figcaption>image-20220504223019548</figcaption></figure><h4 id="_3ã€åˆ›å»ºbucket" tabindex="-1"><a class="header-anchor" href="#_3ã€åˆ›å»ºbucket" aria-hidden="true">#</a> 3ã€åˆ›å»ºBucket</h4><p>å‚è€ƒé“¾æ¥ï¼šhttps://help.aliyun.com/document_detail/31947.html</p>`,117),V=a("thead",null,[a("tr",null,[a("th",{style:{"text-align":"left"}},"ä¸­æ–‡"),a("th",{style:{"text-align":"left"}},"è‹±æ–‡"),a("th",{style:{"text-align":"left"}},"è¯´æ˜")])],-1),F=a("tr",null,[a("td",{style:{"text-align":"left"}},"å­˜å‚¨ç©ºé—´"),a("td",{style:{"text-align":"left"}},"Bucket"),a("td",{style:{"text-align":"left"}},"å­˜å‚¨ç©ºé—´æ˜¯æ‚¨ç”¨äºå­˜å‚¨å¯¹è±¡ï¼ˆObjectï¼‰çš„å®¹å™¨ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½å¿…é¡»éš¶å±äºæŸä¸ªå­˜å‚¨ç©ºé—´ã€‚")],-1),U=a("tr",null,[a("td",{style:{"text-align":"left"}},"å¯¹è±¡/æ–‡ä»¶"),a("td",{style:{"text-align":"left"}},"Object"),a("td",{style:{"text-align":"left"}},"å¯¹è±¡æ˜¯ OSS å­˜å‚¨æ•°æ®çš„åŸºæœ¬å•å…ƒï¼Œä¹Ÿè¢«ç§°ä¸ºOSSçš„æ–‡ä»¶ã€‚å¯¹è±¡ç”±å…ƒä¿¡æ¯ï¼ˆObject Metaï¼‰ã€ç”¨æˆ·æ•°æ®ï¼ˆDataï¼‰å’Œæ–‡ä»¶åï¼ˆKeyï¼‰ç»„æˆã€‚å¯¹è±¡ç”±å­˜å‚¨ç©ºé—´å†…éƒ¨å”¯ä¸€çš„Keyæ¥æ ‡è¯†ã€‚")],-1),W=a("td",{style:{"text-align":"left"}},"åœ°åŸŸ",-1),Q=a("td",{style:{"text-align":"left"}},"Region",-1),H={style:{"text-align":"left"}},$={href:"https://help.aliyun.com/document_detail/31837.htm#concept-zt4-cvy-5db",target:"_blank",rel:"noopener noreferrer"},K=a("td",{style:{"text-align":"left"}},"è®¿é—®åŸŸå",-1),X=a("td",{style:{"text-align":"left"}},"Endpoint",-1),J={style:{"text-align":"left"}},Z={href:"https://help.aliyun.com/document_detail/31837.htm#concept-zt4-cvy-5db",target:"_blank",rel:"noopener noreferrer"},Y=a("tr",null,[a("td",{style:{"text-align":"left"}},"è®¿é—®å¯†é’¥"),a("td",{style:{"text-align":"left"}},"AccessKey"),a("td",{style:{"text-align":"left"}},"AccessKeyï¼Œç®€ç§° AKï¼ŒæŒ‡çš„æ˜¯è®¿é—®èº«ä»½éªŒè¯ä¸­ç”¨åˆ°çš„AccessKeyId å’ŒAccessKeySecretã€‚OSSé€šè¿‡ä½¿ç”¨AccessKeyId å’ŒAccessKeySecretå¯¹ç§°åŠ å¯†çš„æ–¹æ³•æ¥éªŒè¯æŸä¸ªè¯·æ±‚çš„å‘é€è€…èº«ä»½ã€‚AccessKeyIdç”¨äºæ ‡è¯†ç”¨æˆ·ï¼ŒAccessKeySecretæ˜¯ç”¨æˆ·ç”¨äºåŠ å¯†ç­¾åå­—ç¬¦ä¸²å’ŒOSSç”¨æ¥éªŒè¯ç­¾åå­—ç¬¦ä¸²çš„å¯†é’¥ï¼Œå…¶ä¸­AccessKeySecret å¿…é¡»ä¿å¯†ã€‚")],-1),aa=e(`<figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.3.1.png" alt="image-20220504223548831" tabindex="0" loading="lazy"><figcaption>image-20220504223548831</figcaption></figure><h5 id="_1ã€ç‚¹å‡»åˆ›å»ºbucket" tabindex="-1"><a class="header-anchor" href="#_1ã€ç‚¹å‡»åˆ›å»ºbucket" aria-hidden="true">#</a> 1ã€ç‚¹å‡»åˆ›å»ºBucket</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.3.1.png" alt="image-20220504223758657" tabindex="0" loading="lazy"><figcaption>image-20220504223758657</figcaption></figure><h5 id="_2ã€åˆ›å»ºbucket" tabindex="-1"><a class="header-anchor" href="#_2ã€åˆ›å»ºbucket" aria-hidden="true">#</a> 2ã€åˆ›å»ºBucket</h5><p>éšä¾¿è¾“ä¸ªBucketåç§°</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.3.2.1.png" alt="image-20220504225120652" tabindex="0" loading="lazy"><figcaption>image-20220504225120652</figcaption></figure><p>ğŸš€è¯»å†™æƒé™çš„å¯¹è¯æ¡†ä¸­è¦é€‰æ‹©&quot;ç»§ç»­ä¿®æ”¹&quot;</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.3.2.2.png" alt="image-20220504225234319" tabindex="0" loading="lazy"><figcaption>image-20220504225234319</figcaption></figure><h5 id="_3ã€ç‚¹å‡»ä¸Šä¼ æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_3ã€ç‚¹å‡»ä¸Šä¼ æ–‡ä»¶" aria-hidden="true">#</a> 3ã€ç‚¹å‡»ä¸Šä¼ æ–‡ä»¶</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.3.3.png" alt="image-20220504225642860" tabindex="0" loading="lazy"><figcaption>image-20220504225642860</figcaption></figure><h4 id="_4ã€ä½¿ç”¨javaä»£ç ä¸Šä¼ " tabindex="-1"><a class="header-anchor" href="#_4ã€ä½¿ç”¨javaä»£ç ä¸Šä¼ " aria-hidden="true">#</a> 4ã€ä½¿ç”¨Javaä»£ç ä¸Šä¼ </h4><h5 id="_1ã€ä¸Šä¼ ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¸Šä¼ ç­–ç•¥" aria-hidden="true">#</a> 1ã€ä¸Šä¼ ç­–ç•¥</h5><p>ç”¨æˆ·å…ˆå‘åº”ç”¨æœåŠ¡å™¨è·å–ä¸Šä¼ ç­–ç•¥ï¼Œåº”ç”¨æœåŠ¡å™¨æ ¹æ®æœåŠ¡å™¨å†…éƒ¨å­˜å‚¨çš„é˜¿é‡Œäº‘çš„è´¦å·å’Œå¯†ç ç”Ÿæˆä¸€ä¸ªé˜²ä¼ªç­¾åï¼Œé˜²ä¼ªç­¾ååŒ…æ‹¬<strong>æˆæƒä»¤ç‰Œ</strong>ã€é˜¿é‡Œäº‘å“ªä¸ª<strong>åœ°å€</strong>ã€å“ªä¸ª<strong>ä½å€¼</strong>ç­‰ä¿¡æ¯ï¼Œå‰ç«¯å¸¦ç€é˜²ä¼ªç­¾åå’Œè¦ä¸Šä¼ çš„æ–‡ä»¶äº¤ç»™é˜¿é‡Œäº‘ï¼Œé˜¿é‡Œäº‘å¯ä»¥éªŒè¯è¿™äº›ç­¾åæ˜¯å¦æ­£ç¡®ã€‚</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.0.png" alt="image-20220504230801395" tabindex="0" loading="lazy"><figcaption>image-20220504230801395</figcaption></figure><h5 id="_2ã€æŸ¥çœ‹æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹æ–‡æ¡£" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹æ–‡æ¡£</h5><p>å‚è€ƒæ–‡æ¡£ï¼šhttps://help.aliyun.com/document_detail/195870.html</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.2.1.png" alt="image-20220504232317468" tabindex="0" loading="lazy"><figcaption>image-20220504232317468</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.2.2.png" alt="image-20220504232339802" tabindex="0" loading="lazy"><figcaption>image-20220504232339802</figcaption></figure><h5 id="_3ã€æ“ä½œæ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#_3ã€æ“ä½œæ­¥éª¤" aria-hidden="true">#</a> 3ã€æ“ä½œæ­¥éª¤</h5><p>å‚è€ƒæ–‡æ¡£ï¼šhttps://help.aliyun.com/document_detail/32006.html</p><h6 id="_1ã€æ·»åŠ ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ ä¾èµ–" aria-hidden="true">#</a> 1ã€æ·»åŠ ä¾èµ–</h6><p>åœ¨<code>gulimall-product</code>æ¨¡å—å†…æ·»åŠ é˜¿é‡Œäº‘çš„ossä¾èµ–</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.aliyun.oss&lt;/groupId&gt;
    &lt;artifactId&gt;aliyun-sdk-oss&lt;/artifactId&gt;
    &lt;version&gt;3.5.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.3.1.png" alt="image-20220504233153801" tabindex="0" loading="lazy"><figcaption>image-20220504233153801</figcaption></figure><h6 id="_2ã€æ·»åŠ æµ‹è¯•æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ æµ‹è¯•æ–¹æ³•" aria-hidden="true">#</a> 2ã€æ·»åŠ æµ‹è¯•æ–¹æ³•</h6><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * å¯¹è±¡å­˜å‚¨OSSæµ‹è¯•
 * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">FileNotFoundException</span></span>
 */</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testUpload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">FileNotFoundException</span> <span class="token punctuation">{</span>
   <span class="token comment">// Endpointä»¥æ­å·ä¸ºä¾‹ï¼Œå…¶å®ƒRegionè¯·æŒ‰å®é™…æƒ…å†µå¡«å†™ã€‚</span>
   <span class="token class-name">String</span> endpoint <span class="token operator">=</span> <span class="token string">&quot;oss-cn-beijing.aliyuncs.com&quot;</span><span class="token punctuation">;</span>
   <span class="token comment">// äº‘è´¦å·AccessKeyæœ‰æ‰€æœ‰APIè®¿é—®æƒé™ï¼Œå»ºè®®éµå¾ªé˜¿é‡Œäº‘å®‰å…¨æœ€ä½³å®è·µï¼Œåˆ›å»ºå¹¶ä½¿ç”¨RAMå­è´¦å·è¿›è¡ŒAPIè®¿é—®æˆ–æ—¥å¸¸è¿ç»´ï¼Œè¯·ç™»å½• https://ram.console.aliyun.com åˆ›å»ºã€‚</span>
   <span class="token class-name">String</span> accessKeyId <span class="token operator">=</span> <span class="token string">&quot;LTAl4FwfjSycd1APnuG9bjj&quot;</span><span class="token punctuation">;</span>
   <span class="token class-name">String</span> accessKeySecret <span class="token operator">=</span> <span class="token string">&quot;O6xaxyiWfSlitcOkSuK27ju4hXT5HI&quot;</span><span class="token punctuation">;</span>

   <span class="token comment">// åˆ›å»ºOSSClientå®ä¾‹ã€‚</span>
   <span class="token class-name">OSS</span> ossClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OSSClientBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>endpoint<span class="token punctuation">,</span> accessKeyId<span class="token punctuation">,</span> accessKeySecret<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment">// ä¸Šä¼ æ–‡ä»¶æµã€‚</span>
   <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">&quot;C:\\\\1.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   ossClient<span class="token punctuation">.</span><span class="token function">putObject</span><span class="token punctuation">(</span><span class="token string">&quot;gulimall-hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1.png&quot;</span><span class="token punctuation">,</span> inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment">// å…³é—­OSSClientã€‚</span>
   ossClient<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸Šä¼ æˆåŠŸã€‚ã€‚ã€‚&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_3ã€ä¿®æ”¹endpoint" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹endpoint" aria-hidden="true">#</a> 3ã€ä¿®æ”¹<code>endpoint</code></h6><p>ç‚¹å‡»æ¦‚è§ˆï¼ŒæŸ¥çœ‹<code>Endpoint</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.3.3.png" alt="image-20220504235015158" tabindex="0" loading="lazy"><figcaption>image-20220504235015158</figcaption></figure><h6 id="_4ã€æ·»åŠ accesskey" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ accesskey" aria-hidden="true">#</a> 4ã€æ·»åŠ AccessKey</h6><p>1ã€ç‚¹å‡»<strong>AccessKeyç®¡ç†</strong></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.3.4.1.png" alt="image-20220504235453599" tabindex="0" loading="lazy"><figcaption>image-20220504235453599</figcaption></figure><p>2ã€ç‚¹å‡»<strong>å¼€å§‹ä½¿ç”¨å­ç”¨æˆ·AccessKey</strong></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.3.4.2.png" alt="image-20220504235549106" tabindex="0" loading="lazy"><figcaption>image-20220504235549106</figcaption></figure><p>3ã€ç‚¹å‡»<strong>åˆ›å»ºç”¨æˆ·</strong></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.3.4.3.png" alt="image-20220504235623910" tabindex="0" loading="lazy"><figcaption>image-20220504235623910</figcaption></figure><p>4ã€åˆ›å»ºç”¨æˆ·</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.3.4.4.png" alt="image-20220505000109142" tabindex="0" loading="lazy"><figcaption>image-20220505000109142</figcaption></figure><p>5ã€å¤åˆ¶<strong>AccessKey ID</strong> å’Œ <strong>AccessKey Secret</strong></p><p><strong>AccessKey ID</strong> å’Œ <strong>AccessKey Secret</strong>åªä¼šå‡ºç°ä¸€æ¬¡ï¼Œå…³æ‰è¿™ä¸ªé¡µé¢å°±å†ä¹Ÿçœ‹ä¸åˆ°äº†ï¼Œå› æ­¤æµ‹è¯•æˆåŠŸä¹‹å‰ä¸è¦å…³é—­è¯¥é¡µé¢</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.3.4.5.0.png" alt="image-20220505001844577" tabindex="0" loading="lazy"><figcaption>image-20220505001844577</figcaption></figure><p>6ã€ä¸ºè¿™ä¸ªAccessKeyæ·»åŠ æƒé™</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.3.4.5.png" alt="image-20220505000806248" tabindex="0" loading="lazy"><figcaption>image-20220505000806248</figcaption></figure><p>7ã€é€‰æ‹©<strong>ç®¡ç†å¯¹è±¡å­˜å‚¨æœåŠ¡(OSS)æƒé™</strong></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.3.4.6.png" alt="image-20220505001118061" tabindex="0" loading="lazy"><figcaption>image-20220505001118061</figcaption></figure><p>8ã€ç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.3.4.7.png" alt="image-20220505001200826" tabindex="0" loading="lazy"><figcaption>image-20220505001200826</figcaption></figure><p>9ã€ç²˜è´´<strong>AccessKey ID</strong> å’Œ <strong>AccessKey Secret</strong></p><p>æŠŠ<strong>AccessKey ID</strong> å’Œ <strong>AccessKey Secret</strong>ç²˜è´´åˆ°<code>accessKeyId</code>å’Œ<code>accessKeySecret</code></p><h6 id="_5ã€ä¿®æ”¹inputstreamé‡Œé¢çš„æ–‡ä»¶çš„ä½ç½®" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¿®æ”¹inputstreamé‡Œé¢çš„æ–‡ä»¶çš„ä½ç½®" aria-hidden="true">#</a> 5ã€ä¿®æ”¹<strong>inputStream</strong>é‡Œé¢çš„æ–‡ä»¶çš„ä½ç½®</h6><p>ç‚¹å‡»æ–‡ä»¶--&gt;å³é”®--&gt;å±æ€§--&gt;å®‰å…¨--&gt;å¤åˆ¶å¯¹è±¡åç§°</p><p>æŠŠå¤åˆ¶çš„æ–‡ä»¶è·¯å¾„ç²˜è´´åˆ°<code>FileInputStream</code>é‡Œé¢</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.3.5.png" alt="image-20220505161036130" tabindex="0" loading="lazy"><figcaption>image-20220505161036130</figcaption></figure><h6 id="_6ã€ä¿®æ”¹putobjectæ–¹æ³•çš„å‚æ•°" tabindex="-1"><a class="header-anchor" href="#_6ã€ä¿®æ”¹putobjectæ–¹æ³•çš„å‚æ•°" aria-hidden="true">#</a> 6ã€ä¿®æ”¹<code>putObject</code>æ–¹æ³•çš„å‚æ•°</h6><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>ossClient<span class="token punctuation">.</span><span class="token function">putObject</span><span class="token punctuation">(</span><span class="token string">&quot;gulimall-clouds&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1.png&quot;</span><span class="token punctuation">,</span> inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºåˆ›å»ºBucketæ—¶çš„åç§°</p><p>ç¬¬äºŒä¸ªä¸ºä¸Šä¼ çš„æ–‡ä»¶èµ·ä¸€ä¸ªæ–‡ä»¶åï¼Œå¯ä»¥é€šè¿‡<strong>é˜¿é‡Œäº‘æä¾›çš„åŸŸå+è¯¥æ–‡ä»¶å</strong>è®¿é—®è¿™ä¸ªå›¾ç‰‡</p><p>ç¬¬ä¸‰ä¸ªä¸ç”¨æ”¹ï¼Œä¸ºåˆšæ‰å›¾ç‰‡çš„IOæµ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.3.6.png" alt="image-20220505161839620" tabindex="0" loading="lazy"><figcaption>image-20220505161839620</figcaption></figure><h6 id="_7ã€æµ‹è¯•-2" tabindex="-1"><a class="header-anchor" href="#_7ã€æµ‹è¯•-2" aria-hidden="true">#</a> 7ã€æµ‹è¯•</h6><p>å¯ä»¥çœ‹åˆ°ï¼Œæµ‹è¯•å·²ç»é€šè¿‡</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.3.7.1.png" alt="image-20220505162104781" tabindex="0" loading="lazy"><figcaption>image-20220505162104781</figcaption></figure><p>é˜¿é‡Œäº‘ä¸Šå·²ç»çœ‹åˆ°å›¾ç‰‡äº†</p><p>å¤åˆ¶è¿™ä¸ªURLå³å¯ç›´æ¥è®¿é—®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.4.3.7.2.png" alt="image-20220505162407468" tabindex="0" loading="lazy"><figcaption>image-20220505162407468</figcaption></figure><h4 id="_5ã€ossæ•´åˆspring-boot" tabindex="-1"><a class="header-anchor" href="#_5ã€ossæ•´åˆspring-boot" aria-hidden="true">#</a> 5ã€OSSæ•´åˆSpring Boot</h4>`,66),na={href:"https://github.com/alibaba/aliyun-spring-boot/blob/master/aliyun-spring-boot-samples/aliyun-oss-spring-boot-sample/README-zh.md",target:"_blank",rel:"noopener noreferrer"},sa=e(`<p>(<strong>å…ˆåˆ æ‰åˆšæ‰<code>gulimall-product</code>æ¨¡å—çš„<code>aliyun-sdk-oss</code>ä¾èµ–å’Œæµ‹è¯•æ–¹æ³•</strong>)</p><h5 id="_1ã€ä¿®æ”¹-pom-xml-æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿®æ”¹-pom-xml-æ–‡ä»¶" aria-hidden="true">#</a> 1ã€ä¿®æ”¹ pom.xml æ–‡ä»¶</h5><p>ä¿®æ”¹<code>gulimall-common</code>æ¨¡å— pom.xml æ–‡ä»¶ï¼Œå¼•å…¥ aliyun-oss-spring-boot-starter</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alicloud-oss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.5.1.1.png" alt="image-20220505165703522" tabindex="0" loading="lazy"><figcaption>image-20220505165703522</figcaption></figure><p>æœ€æ–°çš„å‚è€ƒæ–‡æ¡£<code>artifactId</code>å·²ç»æ”¹äº†</p><p>ä½¿ç”¨æœ€æ–°ç‰ˆçš„ä¼šæŠ¥<code>Cannot resolve com.alibaba.cloud:aliyun-oss-spring-boot-starter:unknown</code>è¿™ä¸ªé”™è¯¯</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.5.1.2.png" alt="image-20220505165730515" tabindex="0" loading="lazy"><figcaption>image-20220505165730515</figcaption></figure><h5 id="_2ã€åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®oss" tabindex="-1"><a class="header-anchor" href="#_2ã€åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®oss" aria-hidden="true">#</a> 2ã€åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®OSS</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—ä¸­çš„é…ç½®æ–‡ä»¶ä¸­é…ç½®OSS</p><p>ä½¿ç”¨è‡ªå·±çš„<code>access-key</code>å’Œ<code>secret-key</code>ï¼Œé…ç½®è‡ªå·±åœ°åŸŸçš„<code>endpoint</code></p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">alicloud</span><span class="token punctuation">:</span>
      <span class="token key atrule">access-key</span><span class="token punctuation">:</span> LTAl4FwfjSycd1APnuG9bjj
      <span class="token key atrule">secret-key</span><span class="token punctuation">:</span> O6xaxyiWfSlitcOkSuK27ju4hXT5HI
      <span class="token key atrule">oss</span><span class="token punctuation">:</span>
        <span class="token key atrule">endpoint</span><span class="token punctuation">:</span> oss<span class="token punctuation">-</span>cn<span class="token punctuation">-</span>beijing.aliyuncs.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.5.2.png" alt="image-20220505170749948" tabindex="0" loading="lazy"><figcaption>image-20220505170749948</figcaption></figure><h5 id="_3ã€æ·»åŠ æµ‹è¯•æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ æµ‹è¯•æ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ æµ‹è¯•æ–¹æ³•</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">OSSClient</span> ossClient<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testUpload2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">FileNotFoundException</span> <span class="token punctuation">{</span>

   <span class="token comment">// ä¸Šä¼ æ–‡ä»¶æµã€‚</span>
   <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">&quot;C:\\\\2.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   ossClient<span class="token punctuation">.</span><span class="token function">putObject</span><span class="token punctuation">(</span><span class="token string">&quot;gulimall-anonymous&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2.png&quot;</span><span class="token punctuation">,</span> inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment">// å…³é—­OSSClientã€‚</span>
   ossClient<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸Šä¼ æˆåŠŸã€‚ã€‚ã€‚&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„æŠ¥é”™ä¸ç”¨ç®¡ï¼Œè¿™ä¸ªæ˜¯IDEAæ²¡æœ‰è¯†åˆ«å‡ºæ¥</p><p>ä½¿ç”¨<code>@Resource</code>æ³¨è§£ä¸æŠ¥çº¢ï¼Œ<code>@Resource</code>æ³¨è§£å†™åœ¨å­—æ®µä¸ŠæŒ‰åç§°æ³¨å…¥,<code>@Autowired</code>æ³¨è§£å†™åœ¨å­—æ®µä¸ŠæŒ‰ç±»å‹æ³¨å…¥</p><p><code>putObject</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°è¦æ›´æ”¹æˆè‡ªå·±çš„Bucketå</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.5.3.png" alt="image-20220505172414935" tabindex="0" loading="lazy"><figcaption>image-20220505172414935</figcaption></figure><h5 id="_4ã€æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_4ã€æµ‹è¯•" aria-hidden="true">#</a> 4ã€æµ‹è¯•</h5><p>é‡å¯<code>gulimall-common</code>æ¨¡å—å’Œ<code>gulimall-product</code>æ¨¡å—ï¼Œè¿è¡Œæµ‹è¯•æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.3.5.4.png" alt="image-20220505171924124" tabindex="0" loading="lazy"><figcaption>image-20220505171924124</figcaption></figure><h3 id="_4-2-4ã€æ–°å»ºgulimall-third-partyæ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_4-2-4ã€æ–°å»ºgulimall-third-partyæ¨¡å—" aria-hidden="true">#</a> 4.2.4ã€æ–°å»º<code>gulimall-third-party</code>æ¨¡å—</h3><p>(**å…ˆåˆ æ‰åˆšæ‰<code>gulimall-common</code>æ¨¡å— pom.xmlé‡Œé¢çš„spring-cloud-starter-alicloud-ossä¾èµ–ã€åˆ æ‰<code>gulimall-product</code>æ¨¡å—ä¸­åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„OSSã€åˆ æ‰æµ‹è¯•æ–¹æ³• **)</p><h4 id="_1ã€æ–°å»ºæ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_1ã€æ–°å»ºæ¨¡å—" aria-hidden="true">#</a> 1ã€æ–°å»ºæ¨¡å—</h4><h5 id="_1ã€æ–°å»ºgulimall-third-partyæ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_1ã€æ–°å»ºgulimall-third-partyæ¨¡å—" aria-hidden="true">#</a> 1ã€æ–°å»º<code>gulimall-third-party</code>æ¨¡å—</h5><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>com.atguigu.gulimall
gulimall-third-party
ç¬¬ä¸‰æ–¹æœåŠ¡
com.atguigu.gulimall.thirdparty
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.1.1.png" alt="image-20220505173619537" tabindex="0" loading="lazy"><figcaption>image-20220505173619537</figcaption></figure><h5 id="_2ã€é€‰æ‹©webä¸‹çš„spring-web" tabindex="-1"><a class="header-anchor" href="#_2ã€é€‰æ‹©webä¸‹çš„spring-web" aria-hidden="true">#</a> 2ã€é€‰æ‹©Webä¸‹çš„Spring Web</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.1.2.png" alt="image-20220505173727336" tabindex="0" loading="lazy"><figcaption>image-20220505173727336</figcaption></figure><h5 id="_3ã€é€‰æ‹©spring-cloud-routingé‡Œçš„openfeign" tabindex="-1"><a class="header-anchor" href="#_3ã€é€‰æ‹©spring-cloud-routingé‡Œçš„openfeign" aria-hidden="true">#</a> 3ã€é€‰æ‹©Spring Cloud Routingé‡Œçš„OpenFeign</h5><p>å³è¾¹å¯ä»¥æŸ¥çœ‹é€‰æ‹©çš„ä¾èµ–</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.1.3.png" alt="image-20220505173733736" tabindex="0" loading="lazy"><figcaption>image-20220505173733736</figcaption></figure><h5 id="_4ã€ä¿®æ”¹pomæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿®æ”¹pomæ–‡ä»¶" aria-hidden="true">#</a> 4ã€ä¿®æ”¹pomæ–‡ä»¶</h5><p>ä¸ºäº†å’Œè€å¸ˆä½¿ç”¨çš„é…ç½®ä¸€æ ·ï¼Œæˆ‘ä½¿ç”¨äº†è€å¸ˆçš„pomæ–‡ä»¶(è¿™æ ·å¯ä»¥å°‘å¾ˆå¤šé”™è¯¯)</p><p><a href="code/4.2.4.1.4.pom.xml">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´pomæ–‡ä»¶</a></p><h5 id="_5ã€2-2-1-releaseæ²¡æœ‰æ‰¾åˆ°" tabindex="-1"><a class="header-anchor" href="#_5ã€2-2-1-releaseæ²¡æœ‰æ‰¾åˆ°" aria-hidden="true">#</a> 5ã€2.2.1.RELEASEæ²¡æœ‰æ‰¾åˆ°</h5>`,37),ta={href:"https://repo1.maven.org/maven2/org/springframework/boot/spring-boot-parent/2.2.1.RELEASE/",target:"_blank",rel:"noopener noreferrer"},ea=e(`<p>åˆ·æ–°åæŠ¥é”™ï¼Œè¯´<code>org.springframework.boot:spring-boot-starter-parent:2.2.1.RELEASE</code>æ²¡æœ‰å‘ç°</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Project &#39;org.springframework.boot:spring-boot-starter-parent:2.2.1.RELEASE&#39; not found
Project &#39;org.springframework.boot:spring-boot-starter-parent:2.2.1.RELEASE&#39; not found
Dependency &#39;org.springframework.cloud:spring-cloud-dependencies:Hoxton.RC1&#39; not found
Plugin &#39;org.springframework.boot:spring-boot-maven-plugin:&#39; not found
Plugin &#39;org.springframework.boot:spring-boot-maven-plugin:&#39; not found
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.1.5.1.png" alt="image-20220505204534787" tabindex="0" loading="lazy"><figcaption>image-20220505204534787</figcaption></figure><p>å¯ä»¥çœ‹åˆ°<code>2.2.1.RELEASE</code>å’Œ<code>2.1.8.RELEASE</code>çš„ç›®å½•ç»“æ„ä¸€æ ·ï¼Œæ‰€ä»¥åº”è¯¥ä¸æ˜¯mavençš„é—®é¢˜ï¼Œåº”è¯¥æ˜¯IDEAçš„é—®é¢˜</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.1.5.2.png" alt="image-20220505212548886" tabindex="0" loading="lazy"><figcaption>image-20220505212548886</figcaption></figure><p>å¯ä»¥ç‚¹å‡»File--&gt;Invalidate Caches / Restar åˆ é™¤åŸæ¥çš„ç¼“å­˜å’Œç´¢å¼•ï¼Œç­‰å¾…Ideaé‡æ–°æ„å»ºç¼“å­˜å’Œç´¢å¼•</p><p>ç°åœ¨<code>2.2.1.RELEASE</code>å·²ç»ä¸æŠ¥é”™äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.1.5.3.png" alt="image-20220505214331561" tabindex="0" loading="lazy"><figcaption>image-20220505214331561</figcaption></figure><p><code>spring-boot-maven-plugin</code>è¿™é‡ŒæŠ¥é”™</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.1.5.4.png" alt="image-20220505214448720" tabindex="0" loading="lazy"><figcaption>image-20220505214448720</figcaption></figure><p>å¯ä»¥å‘ç°å…¶å®å·²ç»ä¸‹è½½äº†ï¼Œåº”è¯¥åˆæ˜¯IDEAçš„é—®é¢˜ï¼Œä½†æˆ‘é‡æ–°Invalidate Caches / Restar è¿˜æ˜¯æŠ¥é”™ğŸ˜¥</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.1.5.5.png" alt="image-20220505220808846" tabindex="0" loading="lazy"><figcaption>image-20220505220808846</figcaption></figure><p>æœ€åæˆ‘åˆ æ‰è¿™ä¸ª<code>spring-boot-maven-plugin</code>æ’ä»¶å°±å¥½äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.1.5.6.png" alt="image-20220505221657720" tabindex="0" loading="lazy"><figcaption>image-20220505221657720</figcaption></figure><h5 id="_6ã€ä¿®æ”¹æµ‹è¯•ç±»" tabindex="-1"><a class="header-anchor" href="#_6ã€ä¿®æ”¹æµ‹è¯•ç±»" aria-hidden="true">#</a> 6ã€ä¿®æ”¹æµ‹è¯•ç±»</h5><p>ç”±äºä¸åŒ<code>spring-boot-starter-parent</code>ç‰ˆæœ¬çš„æµ‹è¯•ç±»ä¸ä¸€æ ·ï¼Œæ‰€ä»¥ä¿®æ”¹ä¸€ä¸‹æµ‹è¯•ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>thirdparty</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">GulimallThirdPartyApplicationTests</span> <span class="token punctuation">{</span>

   <span class="token annotation punctuation">@Test</span>
   <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>


   <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•æˆåŠŸ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.1.6.1.png" alt="image-20220505222624423" tabindex="0" loading="lazy"><figcaption>image-20220505222624423</figcaption></figure><p>å¦‚æœæµ‹è¯•ç±»ossClentæŠ¥é”™ï¼Œè¯´æ²¡å®šä¹‰&quot;<strong>ossClent</strong>&quot;ç±»è·¯å¾„èµ„æº</p><p>æ˜¯å› ä¸ºæ²¡åˆ <code>gulimall-common</code>æ¨¡å— pom.xmlé‡Œé¢çš„spring-cloud-starter-alicloud-ossä¾èµ–ï¼Œåˆ æ‰å°±è¡Œäº†æˆ–è€…å…ˆæ’é™¤æ‰ï¼ˆåé¢è¿˜æ˜¯è¦åˆ çš„)</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.gulimall<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>gulimall-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.0.1-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alicloud-oss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.1.6.2.png" alt="image-20220505223841319" tabindex="0" loading="lazy"><figcaption>image-20220505223841319</figcaption></figure><p>åŒç†ï¼Œå¦‚æœrenren-fastæŠ¥è¿™ä¸ªé”™ä¹Ÿå¯ä»¥åˆ æ‰è¿™ä¸ªä¾èµ–(åé¢è¿˜æ˜¯è¦åˆ çš„)</p><p>å¦‚æœè¿˜ä¸è¡Œå¯ä»¥ä½¿ç”¨ç›¸åŒçš„<code>spring-boot-starter-parent</code>ç‰ˆæœ¬</p><p>è¿˜æ˜¯ä¸è¡Œçš„è¯ï¼Œå¯ä»¥å…ˆå¤‡ä»½é¡¹ç›®ï¼Œåˆ æ‰å¤‡ä»½çš„<code>.deal</code>æ–‡ä»¶,é‡æ–°å¯¼å…¥å¤‡ä»½çš„çœ‹çœ‹æŠ¥ä¸æŠ¥é”™(è¿™ä¸ªæ“ä½œæ¯”è¾ƒå¾®å±é™©ï¼Œä¸€å®šè¦å¤‡ä»½)</p><h4 id="_2ã€å¯¼å…¥ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_2ã€å¯¼å…¥ä¾èµ–" aria-hidden="true">#</a> 2ã€å¯¼å…¥ä¾èµ–</h4><p><code>gulimall-third-party</code>æ¨¡å—ä¾èµ–<code>gulimall-common</code>æ¨¡å—ï¼Œ<a href="code/4.2.4.2.pom.xml">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´é…ç½®</a></p><p>éœ€è¦æ’é™¤<code>mybatis-plus</code>ä¾èµ–ï¼Œè¯¥æ¨¡å—ä¸æ“ä½œæ•°æ®åº“ï¼Œç”¨ä¸åˆ°</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.gulimall<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>gulimall-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.0.1-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>dependencyManagement</code>æ ‡ç­¾é‡Œæ·»åŠ ä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-alibaba-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.0.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>gulimall-third-party</code>æ¨¡å—ç”¨æ¥å¤„ç†ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œä¸ç”¨æ”¾åœ¨<code>gulimall-common</code>å…¬å…±æ¨¡å—é‡Œ</p><p>åœ¨<code>gulimall-third-party</code>æ¨¡å—æ·»åŠ ä¾èµ–ï¼Œåˆ æ‰<code>gulimall-common</code>çš„è¿™ä¸ªä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alicloud-oss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3ã€æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_3ã€æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ" aria-hidden="true">#</a> 3ã€æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ</h4><h5 id="_1ã€æ–°å»ºå‘½åç©ºé—´" tabindex="-1"><a class="header-anchor" href="#_1ã€æ–°å»ºå‘½åç©ºé—´" aria-hidden="true">#</a> 1ã€æ–°å»ºå‘½åç©ºé—´</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.3.1.png" alt="image-20220505225655873" tabindex="0" loading="lazy"><figcaption>image-20220505225655873</figcaption></figure><h5 id="_2ã€æ·»åŠ é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ é…ç½®" aria-hidden="true">#</a> 2ã€æ·»åŠ é…ç½®</h5><p>ç‚¹å‡»â€œé…ç½®ç®¡ç†â€ä¸‹çš„&quot;é…ç½®åˆ—è¡¨&quot;ï¼Œç‚¹å‡»&quot;third-party&quot;ï¼Œç„¶åç‚¹å‡»**+**</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.3.2.1.png" alt="image-20220505230915820" tabindex="0" loading="lazy"><figcaption>image-20220505230915820</figcaption></figure><p>æ–°å»ºé…ç½®</p><p><code>access-key</code>å’Œ<code>secret-key</code>ä»¥åŠ<code>endpoint</code>å’Œ<code>bucket</code>è¾“å…¥è‡ªå·±çš„</p><p><code>spring.cloud.alicloud.oss.bucket</code>ä¸ºè‡ªå·±å†™çš„é…ç½®ï¼Œä¸æ˜¯å®˜æ–¹æœ‰çš„é…ç½®</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">alicloud</span><span class="token punctuation">:</span>
      <span class="token key atrule">access-key</span><span class="token punctuation">:</span> LTAl4FwfjSycd1APnuG9bjj
      <span class="token key atrule">secret-key</span><span class="token punctuation">:</span> O6xaxyiWfSlitcOkSuK27ju4hXT5HI
      <span class="token key atrule">oss</span><span class="token punctuation">:</span>
        <span class="token key atrule">endpoint</span><span class="token punctuation">:</span> oss<span class="token punctuation">-</span>cn<span class="token punctuation">-</span>beijing.aliyuncs.com
        <span class="token key atrule">bucket</span><span class="token punctuation">:</span> gulimall<span class="token punctuation">-</span>anonymous
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.3.2.2.png" alt="image-20220505231655295" tabindex="0" loading="lazy"><figcaption>image-20220505231655295</figcaption></figure><h5 id="_3ã€é…ç½®é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_3ã€é…ç½®é…ç½®æ–‡ä»¶" aria-hidden="true">#</a> 3ã€é…ç½®é…ç½®æ–‡ä»¶</h5><h6 id="_1ã€å¤åˆ¶å”¯ä¸€æ ‡è¯†" tabindex="-1"><a class="header-anchor" href="#_1ã€å¤åˆ¶å”¯ä¸€æ ‡è¯†" aria-hidden="true">#</a> 1ã€å¤åˆ¶å”¯ä¸€æ ‡è¯†</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.3.3.1.png" alt="image-20220505233148868" tabindex="0" loading="lazy"><figcaption>image-20220505233148868</figcaption></figure><h6 id="_2ã€é…ç½®é…ç½®ä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_2ã€é…ç½®é…ç½®ä¸­å¿ƒ" aria-hidden="true">#</a> 2ã€é…ç½®é…ç½®ä¸­å¿ƒ</h6><p>æ–°å»º&quot;bootstrap.properties&quot;æ–‡ä»¶ï¼Œæ·»åŠ é…ç½®</p><p>namespaceå¡«åˆšåˆšå¤åˆ¶çš„</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>spring.application.name=gulimall<span class="token punctuation">-</span>third<span class="token punctuation">-</span>party
spring.cloud.nacos.config.server<span class="token punctuation">-</span>addr=127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
spring.cloud.nacos.config.namespace=dd540e1b<span class="token punctuation">-</span>ffd6<span class="token punctuation">-</span>43e2<span class="token punctuation">-</span>b9af<span class="token punctuation">-</span>065130d391ec

<span class="token comment">#é…ç½®å¤šé…ç½®æ–‡ä»¶</span>
<span class="token comment">#æ•°æ®é›†id</span>
spring.cloud.nacos.config.ext<span class="token punctuation">-</span>config<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.data<span class="token punctuation">-</span>id=oss.yml
<span class="token comment">#æ•°æ®åˆ†ç»„</span>
spring.cloud.nacos.config.ext<span class="token punctuation">-</span>config<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.group=DEFAULT_GROUP
<span class="token comment">#åŠ¨æ€åˆ·æ–°</span>
spring.cloud.nacos.config.ext<span class="token punctuation">-</span>config<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.refresh=true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.3.3.2.png" alt="image-20220505233837829" tabindex="0" loading="lazy"><figcaption>image-20220505233837829</figcaption></figure><h6 id="_3ã€é…ç½®æ³¨å†Œä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_3ã€é…ç½®æ³¨å†Œä¸­å¿ƒ" aria-hidden="true">#</a> 3ã€é…ç½®æ³¨å†Œä¸­å¿ƒ</h6><p>åœ¨&quot;application.yml&quot;ä¸­æ·»åŠ é…ç½®</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> gulimall<span class="token punctuation">-</span>third<span class="token punctuation">-</span>party
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">30000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.3.3.3.png" alt="image-20220505234015676" tabindex="0" loading="lazy"><figcaption>image-20220505234015676</figcaption></figure><h5 id="_4ã€æ·»åŠ -enablediscoveryclientæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ -enablediscoveryclientæ³¨è§£" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>@EnableDiscoveryClient</code>æ³¨è§£</h5><p><code>gulimall-third-party</code>æ¨¡å—çš„å¯åŠ¨ç±»ä¸Šæ·»åŠ <code>@EnableDiscoveryClient</code>æ³¨è§£</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.3.4.png" alt="image-20220505232327742" tabindex="0" loading="lazy"><figcaption>image-20220505232327742</figcaption></figure><h5 id="_5ã€æ·»åŠ æµ‹è¯•æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€æ·»åŠ æµ‹è¯•æ–¹æ³•" aria-hidden="true">#</a> 5ã€æ·»åŠ æµ‹è¯•æ–¹æ³•</h5><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>@Autowired
OSSClient ossClient;

@Test
public void testUpload2() throws FileNotFoundException <span class="token punctuation">{</span>

   // ä¸Šä¼ æ–‡ä»¶æµã€‚
   InputStream inputStream = new FileInputStream(&quot;C<span class="token punctuation">:</span>\\\\2.png&quot;);

   ossClient.putObject(&quot;gulimall<span class="token punctuation">-</span>anonymous&quot;<span class="token punctuation">,</span> <span class="token string">&quot;2222.png&quot;</span><span class="token punctuation">,</span> inputStream);

   // å…³é—­OSSClientã€‚
   ossClient.shutdown();
   System.out.println(&quot;ä¸Šä¼ æˆåŠŸã€‚ã€‚ã€‚&quot;);
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_6ã€æµ‹è¯•æ˜¯å¦èƒ½ä¸Šä¼ " tabindex="-1"><a class="header-anchor" href="#_6ã€æµ‹è¯•æ˜¯å¦èƒ½ä¸Šä¼ " aria-hidden="true">#</a> 6ã€æµ‹è¯•æ˜¯å¦èƒ½ä¸Šä¼ </h5><p>å¯ä»¥çœ‹åˆ°è¿è¡ŒæˆåŠŸäº†</p><p>ä»£ç æŠ¥çº¢ä¸ç”¨ç®¡ï¼Œé‚£æ˜¯IDEAæ²¡æœ‰æ£€æµ‹åˆ°ï¼Œå…¶å®å¯ä»¥æ³¨å…¥è¿›å»çš„</p><p>ä½¿ç”¨<code>@Resource</code>æ³¨è§£ä¸æŠ¥çº¢ï¼Œ<code>@Resource</code>æ³¨è§£å†™åœ¨å­—æ®µä¸ŠæŒ‰åç§°æ³¨å…¥,<code>@Autowired</code>æ³¨è§£å†™åœ¨å­—æ®µä¸ŠæŒ‰ç±»å‹æ³¨å…¥</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.3.6.1.png" alt="image-20220505235720081" tabindex="0" loading="lazy"><figcaption>image-20220505235720081</figcaption></figure><p>å·²ç»ä¸Šä¼ æˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.3.6.2.png" alt="image-20220506081810670" tabindex="0" loading="lazy"><figcaption>image-20220506081810670</figcaption></figure><h5 id="_7ã€ä¿®æ”¹é…ç½®" tabindex="-1"><a class="header-anchor" href="#_7ã€ä¿®æ”¹é…ç½®" aria-hidden="true">#</a> 7ã€ä¿®æ”¹é…ç½®</h5><p><code>access-key</code>å’Œ<code>secret-key</code>ä»¥åŠ<code>endpoint</code>å’Œ<code>bucket</code>è¾“å…¥è‡ªå·±çš„</p><p>åœ¨å¼€å‘é˜¶æ®µï¼Œå¯ä»¥åœ¨&quot;application.yml&quot;ä¸­ä¿®æ”¹é…ç½®ä»¥æ–¹ä¾¿è°ƒè¯•ï¼Œé¡¹ç›®å®Œæˆåï¼Œå†ä¸Šä¼ åˆ°é…ç½®ä¸­å¿ƒ</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
    <span class="token key atrule">alicloud</span><span class="token punctuation">:</span>
      <span class="token key atrule">access-key</span><span class="token punctuation">:</span> LTAl4FwfjSycd1APnuG9bjj
      <span class="token key atrule">secret-key</span><span class="token punctuation">:</span> O6xaxyiWfSlitcOkSuK27ju4hXT5HI
      <span class="token key atrule">oss</span><span class="token punctuation">:</span>
        <span class="token key atrule">endpoint</span><span class="token punctuation">:</span> oss<span class="token punctuation">-</span>cn<span class="token punctuation">-</span>beijing.aliyuncs.com
        <span class="token key atrule">bucket</span><span class="token punctuation">:</span> gulimall<span class="token punctuation">-</span>anonymous

  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> gulimall<span class="token punctuation">-</span>third<span class="token punctuation">-</span>party

<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">30000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4ã€ç¼–å†™æ–¹æ³•-1" tabindex="-1"><a class="header-anchor" href="#_4ã€ç¼–å†™æ–¹æ³•-1" aria-hidden="true">#</a> 4ã€ç¼–å†™æ–¹æ³•</h4><h5 id="_1ã€æ·»åŠ æ¥å£" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ æ¥å£" aria-hidden="true">#</a> 1ã€æ·»åŠ æ¥å£</h5><p>åœ¨<code>com.atguigu.gulimall.thirdparty.controller</code>ç›®å½•ä¸‹æ–°å»º<code>OssController</code>ç±»,ç¼–å†™è·å–å¯†é’¥çš„å·¥å…·æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>thirdparty<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>oss<span class="token punctuation">.</span></span><span class="token class-name">OSSClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>oss<span class="token punctuation">.</span>common<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">BinaryUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>oss<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">MatchMode</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>oss<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">PolicyConditions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">LinkedHashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/6
 * @Description:
 */</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token comment">//@RefreshScope è‡ªåŠ¨åˆ·æ–°é…ç½®(ä½¿ç”¨æœ€æ–°çš„é…ç½®ä¸­å¿ƒé…ç½®)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OssController</span> <span class="token punctuation">{</span>


    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;\${spring.cloud.alicloud.oss.endpoint}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> endpoint<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;\${spring.cloud.alicloud.oss.bucket}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> bucket<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;\${spring.cloud.alicloud.access-key}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> accessId<span class="token punctuation">;</span>

    <span class="token comment">//@Autowired(required = false)</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">OSSClient</span> ossClient<span class="token punctuation">;</span>


    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/oss/policy&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">policy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//https://gulimall-anonymous.oss-cn-beijing.aliyuncs.com/1.png</span>
        <span class="token class-name">String</span> host <span class="token operator">=</span> <span class="token string">&quot;https://&quot;</span> <span class="token operator">+</span> bucket <span class="token operator">+</span> <span class="token string">&quot;.&quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>endpoint<span class="token punctuation">;</span> <span class="token comment">// hostçš„æ ¼å¼ä¸º bucketname.endpoint</span>
        <span class="token comment">// callbackUrlä¸º ä¸Šä¼ å›è°ƒæœåŠ¡å™¨çš„URLï¼Œè¯·å°†ä¸‹é¢çš„IPå’ŒPorté…ç½®ä¸ºæ‚¨è‡ªå·±çš„çœŸå®ä¿¡æ¯ã€‚</span>
<span class="token comment">//        String callbackUrl = &quot;http://88.88.88.88:8888&quot;;</span>
        <span class="token class-name">String</span> format <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> dir <span class="token operator">=</span> format <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">;</span> <span class="token comment">// ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶æ—¶æŒ‡å®šçš„å‰ç¼€ã€‚</span>

        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> respMap <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">long</span> expireTime <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
            <span class="token keyword">long</span> expireEndTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> expireTime <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span>
            <span class="token class-name">Date</span> expiration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>expireEndTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">PolicyConditions</span> policyConds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PolicyConditions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            policyConds<span class="token punctuation">.</span><span class="token function">addConditionItem</span><span class="token punctuation">(</span><span class="token class-name">PolicyConditions</span><span class="token punctuation">.</span><span class="token constant">COND_CONTENT_LENGTH_RANGE</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1048576000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            policyConds<span class="token punctuation">.</span><span class="token function">addConditionItem</span><span class="token punctuation">(</span><span class="token class-name">MatchMode<span class="token punctuation">.</span>StartWith</span><span class="token punctuation">,</span> <span class="token class-name">PolicyConditions</span><span class="token punctuation">.</span><span class="token constant">COND_KEY</span><span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">String</span> postPolicy <span class="token operator">=</span> ossClient<span class="token punctuation">.</span><span class="token function">generatePostPolicy</span><span class="token punctuation">(</span>expiration<span class="token punctuation">,</span> policyConds<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> binaryData <span class="token operator">=</span> postPolicy<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> encodedPolicy <span class="token operator">=</span> <span class="token class-name">BinaryUtil</span><span class="token punctuation">.</span><span class="token function">toBase64String</span><span class="token punctuation">(</span>binaryData<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> postSignature <span class="token operator">=</span> ossClient<span class="token punctuation">.</span><span class="token function">calculatePostSignature</span><span class="token punctuation">(</span>postPolicy<span class="token punctuation">)</span><span class="token punctuation">;</span>

            respMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            respMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;accessid&quot;</span><span class="token punctuation">,</span> accessId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            respMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;policy&quot;</span><span class="token punctuation">,</span> encodedPolicy<span class="token punctuation">)</span><span class="token punctuation">;</span>
            respMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;signature&quot;</span><span class="token punctuation">,</span> postSignature<span class="token punctuation">)</span><span class="token punctuation">;</span>
            respMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;dir&quot;</span><span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
            respMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;host&quot;</span><span class="token punctuation">,</span> host<span class="token punctuation">)</span><span class="token punctuation">;</span>
            respMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;expire&quot;</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>expireEndTime <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// respMap.put(&quot;expire&quot;, formatISO8601Date(expiration));</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Assert.fail(e.getMessage());</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> respMap<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.4.1.png" alt="image-20220506102103657" tabindex="0" loading="lazy"><figcaption>image-20220506102103657</figcaption></figure><h5 id="_2ã€æµè§ˆå™¨æµ‹è¯•æ¥å£" tabindex="-1"><a class="header-anchor" href="#_2ã€æµè§ˆå™¨æµ‹è¯•æ¥å£" aria-hidden="true">#</a> 2ã€æµè§ˆå™¨æµ‹è¯•æ¥å£</h5><p>æµè§ˆå™¨è¾“å…¥ http://localhost:30000/oss/policy</p><p>å·²ç»æ­£ç¡®è®¿é—®äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.4.2.png" alt="image-20220506102230145" tabindex="0" loading="lazy"><figcaption>image-20220506102230145</figcaption></figure><h5 id="_3ã€æ·»åŠ é…ç½®" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ é…ç½®" aria-hidden="true">#</a> 3ã€æ·»åŠ é…ç½®</h5><p>åœ¨<code>gulimall-gateway</code>æ¨¡å—æ·»åŠ é…ç½®(ä¸€å®šè¦å†™åœ¨<code>admin_route</code>å‰é¢)</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>- id: third_party_route
  uri: lb://gulimall-third-party
  predicates:
    - Path=/api/product/**
  filters:
    #http://localhost:88/api/thirdparty/oss/policy å˜ä¸º http://localhost:30000/oss/policy
    - RewritePath=/api/thirdparty/(?&lt;segment&gt;/?.*),/$\\{segment}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.4.3.png" alt="image-20220506104808034" tabindex="0" loading="lazy"><figcaption>image-20220506104808034</figcaption></figure><h5 id="_4ã€æµ‹è¯•æ˜¯å¦å¯ä»¥é€šè¿‡ç½‘å…³è®¿é—®" tabindex="-1"><a class="header-anchor" href="#_4ã€æµ‹è¯•æ˜¯å¦å¯ä»¥é€šè¿‡ç½‘å…³è®¿é—®" aria-hidden="true">#</a> 4ã€æµ‹è¯•æ˜¯å¦å¯ä»¥é€šè¿‡ç½‘å…³è®¿é—®</h5><h6 id="_1ã€è®¿é—®å¤±è´¥äº†" tabindex="-1"><a class="header-anchor" href="#_1ã€è®¿é—®å¤±è´¥äº†" aria-hidden="true">#</a> 1ã€è®¿é—®å¤±è´¥äº†</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.4.4.1.png" alt="image-20220506105012117" tabindex="0" loading="lazy"><figcaption>image-20220506105012117</figcaption></figure><h6 id="_2ã€æŸ¥çœ‹æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹æ—¥å¿—" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹æ—¥å¿—</h6><p>æ²¡æœ‰è¿™ä¸ªæ—¥å¿—çš„æ˜¯å› ä¸ºæ—¥å¿—çº§åˆ«æ²¡æœ‰è°ƒæˆ<code>debug</code>ï¼Œè°ƒæ•´æ—¥å¿—çº§åˆ«å°±è¡Œäº†</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>logging:
  level:
    root: debug
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥å‘ç°åŒ¹é…åˆ°<code>admin_route</code></p><p>è¿™æ˜¯å› ä¸ºæˆ‘<code>- Path=/api/product/**</code>è¿™é‡Œå†™é”™äº†ï¼Œåº”è¯¥å†™æˆ<code>- Path=/api/thirdparty/**</code></p><p>å› ä¸ºå†™é”™äº†ï¼Œæ‰€ä»¥æ²¡åŒ¹é…çš„,ä½¿ç”¨äº†é»˜è®¤çš„<code>admin_route</code>(æ‰€æœ‰å‰é¢æ²¡åŒ¹é…åˆ°çš„ï¼Œåªè¦æ˜¯pathæ˜¯ä»¥/api/å¼€å¤´çš„éƒ½ä¼šåŒ¹é…åˆ°<code>admin_route</code>)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.4.4.2.png" alt="image-20220506104658815" tabindex="0" loading="lazy"><figcaption>image-20220506104658815</figcaption></figure><h6 id="_3ã€ä¿®æ”¹é…ç½®" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹é…ç½®" aria-hidden="true">#</a> 3ã€ä¿®æ”¹é…ç½®</h6><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>- id: third_party_route
  uri: lb://gulimall-third-party
  predicates:
    - Path=/api/thirdparty/**
  filters:
    #http://localhost:88/api/thirdparty/oss/policy å˜ä¸º http://localhost:30000/oss/policy
    - RewritePath=/api/thirdparty/(?&lt;segment&gt;/?.*),/$\\{segment}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.4.4.3.png" alt="image-20220506110148531" tabindex="0" loading="lazy"><figcaption>image-20220506110148531</figcaption></figure><h6 id="_4ã€é‡æ–°æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_4ã€é‡æ–°æµ‹è¯•" aria-hidden="true">#</a> 4ã€é‡æ–°æµ‹è¯•</h6><p>å·²ç»è®¿é—®æˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.4.4.4.4.png" alt="image-20220506110317459" tabindex="0" loading="lazy"><figcaption>image-20220506110317459</figcaption></figure><h3 id="_4-2-5ã€ç¼–å†™å›¾ç‰‡ä¸Šä¼ å‰ç«¯ä»£ç " tabindex="-1"><a class="header-anchor" href="#_4-2-5ã€ç¼–å†™å›¾ç‰‡ä¸Šä¼ å‰ç«¯ä»£ç " aria-hidden="true">#</a> 4.2.5ã€ç¼–å†™å›¾ç‰‡ä¸Šä¼ å‰ç«¯ä»£ç </h3><h4 id="_1ã€å¤åˆ¶æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_1ã€å¤åˆ¶æ–‡ä»¶" aria-hidden="true">#</a> 1ã€å¤åˆ¶æ–‡ä»¶</h4><p>å¤åˆ¶<code>1.åˆ†å¸ƒå¼åŸºç¡€ï¼ˆå…¨æ ˆå¼€å‘ç¯‡ï¼‰\\èµ„æ–™æºç .zip\\docs\\ä»£ç \\å‰ç«¯</code>ç›®å½•ä¸‹<code>upload</code>æ–‡ä»¶</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.1.png" alt="image-20220506111426347" tabindex="0" loading="lazy"><figcaption>image-20220506111426347</figcaption></figure><h4 id="_2ã€ä¿®æ”¹bucketåŸŸå" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹bucketåŸŸå" aria-hidden="true">#</a> 2ã€ä¿®æ”¹BucketåŸŸå</h4><h5 id="_1ã€å¤åˆ¶bucketå¤–ç½‘è®¿é—®åŸŸå" tabindex="-1"><a class="header-anchor" href="#_1ã€å¤åˆ¶bucketå¤–ç½‘è®¿é—®åŸŸå" aria-hidden="true">#</a> 1ã€å¤åˆ¶Bucketå¤–ç½‘è®¿é—®åŸŸå</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.2.1.png" alt="image-20220506201245636" tabindex="0" loading="lazy"><figcaption>image-20220506201245636</figcaption></figure><h5 id="_2ã€ç²˜è´´åˆ°singleupload-vue" tabindex="-1"><a class="header-anchor" href="#_2ã€ç²˜è´´åˆ°singleupload-vue" aria-hidden="true">#</a> 2ã€ç²˜è´´åˆ°<code>singleUpload.vue</code></h5><p>ç²˜è´´åˆ°<code>src\\components\\upload\\singleUpload.vue</code>é‡Œçš„<code>el-upload</code>æ ‡ç­¾ï¼Œ<code>action</code>å±æ€§é‡Œé¢</p><p>æ³¨æ„ï¼šå‰é¢æœ‰&quot;<strong>http://</strong>&quot;</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.2.2.png" alt="image-20220506201710959" tabindex="0" loading="lazy"><figcaption>image-20220506201710959</figcaption></figure><h5 id="_3ã€ç²˜è´´åˆ°multiupload-vue" tabindex="-1"><a class="header-anchor" href="#_3ã€ç²˜è´´åˆ°multiupload-vue" aria-hidden="true">#</a> 3ã€ç²˜è´´åˆ°<code>multiUpload.vue</code></h5><p>ç²˜è´´åˆ°<code>src\\components\\upload\\multiUpload.vue</code>é‡Œçš„<code>el-upload</code>æ ‡ç­¾ï¼Œ<code>action</code>å±æ€§é‡Œé¢</p><p>æ³¨æ„ï¼šå‰é¢æœ‰&quot;<strong>http://</strong>&quot;</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.2.3.png" alt="image-20220506201943305" tabindex="0" loading="lazy"><figcaption>image-20220506201943305</figcaption></figure><h5 id="é™„å½•" tabindex="-1"><a class="header-anchor" href="#é™„å½•" aria-hidden="true">#</a> é™„å½•</h5><h6 id="_1ã€multiupload-vueæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_1ã€multiupload-vueæ–‡ä»¶" aria-hidden="true">#</a> 1ã€<code>multiUpload.vue</code>æ–‡ä»¶</h6><p><a href="code/4.2.5.2.4.1.multiUpload.vue">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç </a></p><h6 id="_2ã€policy-jsæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2ã€policy-jsæ–‡ä»¶" aria-hidden="true">#</a> 2ã€<code>policy.js</code>æ–‡ä»¶</h6><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> http <span class="token keyword">from</span> <span class="token string">&#39;@/utils/httpRequest.js&#39;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">policy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span>  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">url</span><span class="token operator">:</span> http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/thirdparty/oss/policy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">params</span><span class="token operator">:</span> http<span class="token punctuation">.</span><span class="token function">adornParams</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_3ã€singleupload-vueæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_3ã€singleupload-vueæ–‡ä»¶" aria-hidden="true">#</a> 3ã€<code>singleUpload.vue</code>æ–‡ä»¶</h6><p><a href="code/4.2.5.2.4.3.singleUpload.vue">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç </a></p><h4 id="_3ã€ä½¿ç”¨uploadä¸Šä¼ ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#_3ã€ä½¿ç”¨uploadä¸Šä¼ ç»„ä»¶" aria-hidden="true">#</a> 3ã€ä½¿ç”¨Uploadä¸Šä¼ ç»„ä»¶</h4>`,126),pa=a("code",null,"element-ui",-1),oa=a("strong",null,"Upload ä¸Šä¼ ",-1),ca={href:"https://element.eleme.io/#/zh-CN/component/upload",target:"_blank",rel:"noopener noreferrer"},ia=e(`<p>ä¸Šä¼ ç»„ä»¶å·²ç»å°è£…åœ¨åˆšåˆšå¤åˆ¶åˆ°uploadé‡Œé¢äº†</p><h4 id="_4ã€ä¸Šä¼ å›¾ç‰‡æŠ¥é”™" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¸Šä¼ å›¾ç‰‡æŠ¥é”™" aria-hidden="true">#</a> 4ã€ä¸Šä¼ å›¾ç‰‡æŠ¥é”™</h4><h5 id="_1ã€æŸ¥çœ‹è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹è¯·æ±‚" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹è¯·æ±‚</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.4.1.png" alt="image-20220506203350269" tabindex="0" loading="lazy"><figcaption>image-20220506203350269</figcaption></figure><h5 id="_2ã€æŸ¥çœ‹åŒ¹é…åˆ°çš„è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹åŒ¹é…åˆ°çš„è·¯ç”±" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹åŒ¹é…åˆ°çš„è·¯ç”±</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.4.2.png" alt="image-20220506203432683" tabindex="0" loading="lazy"><figcaption>image-20220506203432683</figcaption></figure><h5 id="_3ã€æŸ¥çœ‹å¯¹åº”è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#_3ã€æŸ¥çœ‹å¯¹åº”è·¯ç”±" aria-hidden="true">#</a> 3ã€æŸ¥çœ‹å¯¹åº”è·¯ç”±</h5><p>å‘ç°æˆ‘<code>gulimall-third-party</code>æ²¡å¯åŠ¨ğŸ˜°</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.4.3.png" alt="image-20220506203844785" tabindex="0" loading="lazy"><figcaption>image-20220506203844785</figcaption></figure><h5 id="_4ã€å¯åŠ¨gulimall-third-party" tabindex="-1"><a class="header-anchor" href="#_4ã€å¯åŠ¨gulimall-third-party" aria-hidden="true">#</a> 4ã€å¯åŠ¨<code>gulimall-third-party</code></h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.4.4.png" alt="image-20220506204230648" tabindex="0" loading="lazy"><figcaption>image-20220506204230648</figcaption></figure><h5 id="_5ã€å·²ç»ä¸Šä¼ æˆåŠŸäº†" tabindex="-1"><a class="header-anchor" href="#_5ã€å·²ç»ä¸Šä¼ æˆåŠŸäº†" aria-hidden="true">#</a> 5ã€å·²ç»ä¸Šä¼ æˆåŠŸäº†</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.4.5.png" alt="image-20220506204119458" tabindex="0" loading="lazy"><figcaption>image-20220506204119458</figcaption></figure><h5 id="_6ã€è·¨åŸŸé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_6ã€è·¨åŸŸé—®é¢˜" aria-hidden="true">#</a> 6ã€è·¨åŸŸé—®é¢˜</h5><p>å¦‚æœè¿˜æ˜¯ä¸Šä¼ ä¸äº†ï¼Œå¯ä»¥çœ‹çœ‹æ˜¯ä¸æ˜¯æŠ¥<strong>403</strong>æˆ–<strong>CROS</strong></p><p>å¦‚æœæ˜¯æŠ¥<strong>403</strong>æˆ–<strong>CROS</strong>å¯ä»¥åœ¨é˜¿é‡Œäº‘OSSé‡Œé¢é…ç½®è·¨åŸŸè§„åˆ™</p><h6 id="_1ã€ç‚¹å‡»è·¨åŸŸè®¾ç½®" tabindex="-1"><a class="header-anchor" href="#_1ã€ç‚¹å‡»è·¨åŸŸè®¾ç½®" aria-hidden="true">#</a> 1ã€ç‚¹å‡»è·¨åŸŸè®¾ç½®</h6><p>è¿›å…¥ä½ çš„Bucketçš„æ§åˆ¶å°ï¼Œç‚¹å‡»**&quot;æƒé™ç®¡ç†**&quot;--&gt;&quot;è·¨åŸŸè®¾ç½®&quot;</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.4.6.1.png" alt="image-20220506205320072" tabindex="0" loading="lazy"><figcaption>image-20220506205320072</figcaption></figure><h6 id="_2ã€ç‚¹å‡»è·¨åŸŸè®¾ç½®é‡Œçš„è®¾ç½®" tabindex="-1"><a class="header-anchor" href="#_2ã€ç‚¹å‡»è·¨åŸŸè®¾ç½®é‡Œçš„è®¾ç½®" aria-hidden="true">#</a> 2ã€ç‚¹å‡»<strong>è·¨åŸŸè®¾ç½®</strong>é‡Œçš„<strong>è®¾ç½®</strong></h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.4.6.2.png" alt="image-20220506205451008" tabindex="0" loading="lazy"><figcaption>image-20220506205451008</figcaption></figure><h6 id="_3ã€åˆ›å»ºè§„åˆ™" tabindex="-1"><a class="header-anchor" href="#_3ã€åˆ›å»ºè§„åˆ™" aria-hidden="true">#</a> 3ã€åˆ›å»ºè§„åˆ™</h6><p>ç‚¹å‡»åˆ›å»ºè§„åˆ™ï¼Œè¾“å…¥è§„åˆ™å°±å¯ä»¥äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.4.6.3.png" alt="image-20220506211944153" tabindex="0" loading="lazy"><figcaption>image-20220506211944153</figcaption></figure><h4 id="_5ã€ä¿®æ”¹ç­¾åæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¿®æ”¹ç­¾åæ–¹æ³•" aria-hidden="true">#</a> 5ã€ä¿®æ”¹ç­¾åæ–¹æ³•</h4><h5 id="_1ã€è·å–æ•°æ®çš„è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#_1ã€è·å–æ•°æ®çš„è·¯å¾„" aria-hidden="true">#</a> 1ã€è·å–æ•°æ®çš„è·¯å¾„</h5><p>å¯ä»¥çœ‹åˆ°è·¯å¾„ä¸ºå“åº”é‡Œçš„<code>data</code>å­—æ®µ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.5.1.png" alt="image-20220506210529130" tabindex="0" loading="lazy"><figcaption>image-20220506210529130</figcaption></figure><h5 id="_2ã€æŸ¥çœ‹è¯·æ±‚å“åº”çš„æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹è¯·æ±‚å“åº”çš„æ•°æ®" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹è¯·æ±‚å“åº”çš„æ•°æ®</h5><p>å¯ä»¥çœ‹åˆ°å“åº”çš„æ•°æ®ç›´æ¥è¿”å›äº†ï¼Œæ²¡æœ‰å°è£…åœ¨dataä¸­</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.5.2.png" alt="image-20220506210632683" tabindex="0" loading="lazy"><figcaption>image-20220506210632683</figcaption></figure><h5 id="_3ã€ä¿®æ”¹è¿”å›ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹è¿”å›ç±»å‹" aria-hidden="true">#</a> 3ã€ä¿®æ”¹è¿”å›ç±»å‹</h5><p>ä¿®æ”¹<code>com.atguigu.gulimall.thirdparty.controller</code>ä¸‹çš„<code>OssController</code>ç±»çš„<code>policy</code>æ–¹æ³•è¿”å›ç±»å‹</p><p>ç„¶åé‡å¯é¡¹ç›®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.5.3.png" alt="image-20220506211124975" tabindex="0" loading="lazy"><figcaption>image-20220506211124975</figcaption></figure><h5 id="_4ã€è·¨åŸŸé”™è¯¯" tabindex="-1"><a class="header-anchor" href="#_4ã€è·¨åŸŸé”™è¯¯" aria-hidden="true">#</a> 4ã€è·¨åŸŸé”™è¯¯</h5><h6 id="_1ã€æŸ¥çœ‹æ§åˆ¶å°" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹æ§åˆ¶å°" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹æ§åˆ¶å°</h6><p>å‘ç°æœ‰è·¨åŸŸé”™è¯¯</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.5.4.1.png" alt="image-20220506211741596" tabindex="0" loading="lazy"><figcaption>image-20220506211741596</figcaption></figure><h6 id="_2ã€ç‚¹å‡»æ¦‚è¦" tabindex="-1"><a class="header-anchor" href="#_2ã€ç‚¹å‡»æ¦‚è¦" aria-hidden="true">#</a> 2ã€ç‚¹å‡»æ¦‚è¦</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.5.4.2.png" alt="image-20220506212310759" tabindex="0" loading="lazy"><figcaption>image-20220506212310759</figcaption></figure><h6 id="_3ã€è·¨åŸŸè®¿é—®" tabindex="-1"><a class="header-anchor" href="#_3ã€è·¨åŸŸè®¿é—®" aria-hidden="true">#</a> 3ã€è·¨åŸŸè®¿é—®</h6><p>å¾€ä¸‹æ»‘ï¼Œæ‰¾åˆ°è·¨åŸŸè®¿é—®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.5.4.3.png" alt="image-20220506212332731" tabindex="0" loading="lazy"><figcaption>image-20220506212332731</figcaption></figure><h6 id="_4ã€åˆ›å»ºè§„åˆ™" tabindex="-1"><a class="header-anchor" href="#_4ã€åˆ›å»ºè§„åˆ™" aria-hidden="true">#</a> 4ã€åˆ›å»ºè§„åˆ™</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.5.4.4.png" alt="image-20220506212515400" tabindex="0" loading="lazy"><figcaption>image-20220506212515400</figcaption></figure><h6 id="_5ã€å†æ¬¡ä¸Šä¼ " tabindex="-1"><a class="header-anchor" href="#_5ã€å†æ¬¡ä¸Šä¼ " aria-hidden="true">#</a> 5ã€å†æ¬¡ä¸Šä¼ </h6><p>å†æ¬¡ä¸Šä¼ ï¼Œå›¾ç‰‡å·²ç»å›æ˜¾å‡ºæ¥äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.5.4.5.png" alt="image-20220506212726224" tabindex="0" loading="lazy"><figcaption>image-20220506212726224</figcaption></figure><h5 id="_5ã€ä¿®æ”¹è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¿®æ”¹è·¯å¾„" aria-hidden="true">#</a> 5ã€ä¿®æ”¹è·¯å¾„</h5><h6 id="_1ã€æ‹¼è·¯å¾„çš„æ—¶å€™å¤šäº†ä¸€æ¡æ " tabindex="-1"><a class="header-anchor" href="#_1ã€æ‹¼è·¯å¾„çš„æ—¶å€™å¤šäº†ä¸€æ¡æ " aria-hidden="true">#</a> 1ã€æ‹¼è·¯å¾„çš„æ—¶å€™å¤šäº†ä¸€æ¡æ </h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.5.5.1.png" alt="image-20220506213014421" tabindex="0" loading="lazy"><figcaption>image-20220506213014421</figcaption></figure><h6 id="_2ã€åˆ é™¤" tabindex="-1"><a class="header-anchor" href="#_2ã€åˆ é™¤" aria-hidden="true">#</a> 2ã€åˆ é™¤&quot;/&quot;</h6><p>æŠŠè¿™ä¸ªåˆ æ‰å°±è¡Œäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.5.5.2.png" alt="image-20220506213238514" tabindex="0" loading="lazy"><figcaption>image-20220506213238514</figcaption></figure><h6 id="_3ã€é‡æ–°ä¸Šä¼ " tabindex="-1"><a class="header-anchor" href="#_3ã€é‡æ–°ä¸Šä¼ " aria-hidden="true">#</a> 3ã€é‡æ–°ä¸Šä¼ </h6><p>å›¾ç‰‡å·²ç»åœ¨æ—¥æœŸå¯¹åº”çš„æ–‡ä»¶å¤¹ä¸‹äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.5.5.5.3.png" alt="image-20220506213419593" tabindex="0" loading="lazy"><figcaption>image-20220506213419593</figcaption></figure><h3 id="_4-2-6ã€å‰ç«¯è¡¨å•æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#_4-2-6ã€å‰ç«¯è¡¨å•æ ¡éªŒ" aria-hidden="true">#</a> 4.2.6ã€å‰ç«¯è¡¨å•æ ¡éªŒ</h3><h4 id="_1ã€ä¿®æ”¹æŒ‰é’®æ¿€æ´»å€¼" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿®æ”¹æŒ‰é’®æ¿€æ´»å€¼" aria-hidden="true">#</a> 1ã€ä¿®æ”¹æŒ‰é’®æ¿€æ´»å€¼</h4><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-switch</span>
    <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataForm.showStatus<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">active-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#13ce66<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">inactive-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#ff4949<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:active-value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:inactive-value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-switch</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.1.png" alt="image-20220506214954428" tabindex="0" loading="lazy"><figcaption>image-20220506214954428</figcaption></figure><h4 id="_2ã€æ–°å¢å•†å“" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å¢å•†å“" aria-hidden="true">#</a> 2ã€æ–°å¢å•†å“</h4><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.2.png" alt="image-20220506215355124" tabindex="0" loading="lazy"><figcaption>image-20220506215355124</figcaption></figure><h4 id="_3ã€ä¿®æ”¹å“ç‰Œlogoåœ°å€" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹å“ç‰Œlogoåœ°å€" aria-hidden="true">#</a> 3ã€ä¿®æ”¹å“ç‰Œlogoåœ°å€</h4><h5 id="_1ã€å“ç‰Œlogoåœ°å€ä¸ºæ–‡å­—" tabindex="-1"><a class="header-anchor" href="#_1ã€å“ç‰Œlogoåœ°å€ä¸ºæ–‡å­—" aria-hidden="true">#</a> 1ã€å“ç‰Œlogoåœ°å€ä¸ºæ–‡å­—</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.3.1.png" alt="image-20220506215446629" tabindex="0" loading="lazy"><figcaption>image-20220506215446629</figcaption></figure><h5 id="_2ã€è‡ªå®šä¹‰åˆ—æ¨¡æ¿" tabindex="-1"><a class="header-anchor" href="#_2ã€è‡ªå®šä¹‰åˆ—æ¨¡æ¿" aria-hidden="true">#</a> 2ã€è‡ªå®šä¹‰åˆ—æ¨¡æ¿</h5>`,68),la=a("strong",null,"Tableè¡¨æ ¼",-1),ua={href:"https://element.eleme.io/#/zh-CN/component/table",target:"_blank",rel:"noopener noreferrer"},ra=e(`<p>é€šè¿‡ <code>Scoped slot</code> å¯ä»¥è·å–åˆ° row, column, $index å’Œ storeï¼ˆtable å†…éƒ¨çš„çŠ¶æ€ç®¡ç†ï¼‰çš„æ•°æ®</p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>el-icon-time<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">margin-left</span><span class="token punctuation">:</span> 10px</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>{{ scope.row.date }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),da=a("strong",null,"Imageå›¾ç‰‡",-1),ka={href:"https://element.eleme.io/#/zh-CN/component/image",target:"_blank",rel:"noopener noreferrer"},ma=e(`<div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-image</span>
  <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 100px</span><span class="token punctuation">&quot;</span></span></span>
  <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">:fit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>contain<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-image</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å› æ­¤ä¿®æ”¹<code>src\\views\\modules\\product\\brand.vue</code>æ–‡ä»¶é‡Œçš„<code>å“ç‰Œlogoåœ°å€</code>åˆ—ä¸º</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span>
  <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>logo<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">header-align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å“ç‰Œlogoåœ°å€<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-image</span>
      <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 80px</span><span class="token punctuation">&quot;</span></span></span>
      <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope.row.logo<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:fit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>contain<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-image</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3ã€æŸ¥çœ‹é¡µé¢" tabindex="-1"><a class="header-anchor" href="#_3ã€æŸ¥çœ‹é¡µé¢" aria-hidden="true">#</a> 3ã€æŸ¥çœ‹é¡µé¢</h5><h6 id="_1ã€å›¾ç‰‡æ˜¾ç¤ºä¸å‡ºæ¥" tabindex="-1"><a class="header-anchor" href="#_1ã€å›¾ç‰‡æ˜¾ç¤ºä¸å‡ºæ¥" aria-hidden="true">#</a> 1ã€å›¾ç‰‡æ˜¾ç¤ºä¸å‡ºæ¥</h6><p>æŸ¥çœ‹æŠ¥é”™å¯ä»¥çœ‹åˆ°ï¼Œ<code>&lt;el-image&gt;</code>ç»„ä»¶æ²¡æœ‰æ­£ç¡®æ³¨å…¥è¿›æ¥</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;el-image&gt; - did you register the component correctlyï¼šæ‚¨æ˜¯å¦æ­£ç¡®æ³¨å†Œäº†&lt;el-image&gt;ç»„ä»¶
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.3.3.1.png" alt="image-20220506223735304" tabindex="0" loading="lazy"><figcaption>image-20220506223735304</figcaption></figure><h6 id="_2ã€æŸ¥çœ‹å¼•å…¥çš„element-uiä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹å¼•å…¥çš„element-uiä¾èµ–" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹å¼•å…¥çš„<code>element-ui</code>ä¾èµ–</h6><p>åœ¨<code>src\\main.js</code>æ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ°ï¼Œ<code>element-ui</code>å¼•å…¥åœ¨<code>src/element-ui</code></p><p><code>@</code>ç¬¦å·ä½è‡ªå®šä¹‰çš„ï¼ŒæŒ‡å‘srcç›®å½•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.3.3.2.1.png" alt="image-20220506225556450" tabindex="0" loading="lazy"><figcaption>image-20220506225556450</figcaption></figure><p>åœ¨<code>src\\element-ui\\index.js</code>æ–‡ä»¶ä¸­æœç´¢&quot;<strong>Image</strong>&quot;,å¯ä»¥çœ‹åˆ°æ²¡æœ‰è¿™ä¸ªç»„ä»¶</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.3.3.2.2.png" alt="image-20220506225431970" tabindex="0" loading="lazy"><figcaption>image-20220506225431970</figcaption></figure><h6 id="_3ã€æ·»åŠ ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ ç»„ä»¶" aria-hidden="true">#</a> 3ã€æ·»åŠ ç»„ä»¶</h6><p>ä¿®æ”¹<code>import</code>å’Œ<code>Vue.use</code>é‡Œé¢çš„å†…å®¹</p>`,16),ga=a("code",null,"element-ui",-1),va={href:"https://element.eleme.io/#/zh-CN/component/quickstart",target:"_blank",rel:"noopener noreferrer"},ba=e(`<p><a href="code/4.2.6.3.3.3.js">ç‚¹å‡»æŸ¥çœ‹é»˜è®¤é…ç½®</a></p><h6 id="_4ã€æ²¡æœ‰å‘ç°è¿™äº›ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_4ã€æ²¡æœ‰å‘ç°è¿™äº›ä¾èµ–" aria-hidden="true">#</a> 4ã€æ²¡æœ‰å‘ç°è¿™äº›ä¾èµ–</h6><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>These dependencies were not found: æœªæ‰¾åˆ°è¿™äº›ä¾èµ–é¡¹
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åˆ æ‰è¿™äº›ä¾èµ–å°±è¡Œäº†</p><p><a href="code/4.2.6.3.3.4.index.js">ç‚¹å‡»æŸ¥çœ‹<code>src\\element-ui\\index.js</code>å®Œæ•´ä»£ç </a></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.3.3.3.png" alt="image-20220506223507564" tabindex="0" loading="lazy"><figcaption>image-20220506223507564</figcaption></figure><h6 id="_5ã€fitæœªå®šä¹‰" tabindex="-1"><a class="header-anchor" href="#_5ã€fitæœªå®šä¹‰" aria-hidden="true">#</a> 5ã€<code>fit</code>æœªå®šä¹‰</h6><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code> Property or method &quot;fit&quot; is not defined on the instance but referenced during render
 å±æ€§æˆ–æ–¹æ³•â€œfitâ€æœªåœ¨å®ä¾‹ä¸Šå®šä¹‰ï¼Œä½†åœ¨æ¸²æŸ“æœŸé—´å¼•ç”¨
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.3.3.5.1.png" alt="image-20220506230513442" tabindex="0" loading="lazy"><figcaption>image-20220506230513442</figcaption></figure><p>å®ä¾‹ç”¨çš„&quot;<code>:</code>&quot;ä¸ºåŠ¨æ€ç»‘å®šï¼Œç”±äº<code>data</code>ä¸­æ²¡è®¾<code>content</code>ï¼Œæ‰€ä»¥åˆ æ‰è¿™ä¸ª&quot;<code>:</code>&quot;å°±è¡Œäº†ï¼Œä¸ä½¿ç”¨åŠ¨æ€ç»‘å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.3.3.5.2.png" alt="image-20220506231648179" tabindex="0" loading="lazy"><figcaption>image-20220506231648179</figcaption></figure><h6 id="_6ã€æŸ¥çœ‹å›¾ç‰‡" tabindex="-1"><a class="header-anchor" href="#_6ã€æŸ¥çœ‹å›¾ç‰‡" aria-hidden="true">#</a> 6ã€æŸ¥çœ‹å›¾ç‰‡</h6><p>å¯ä»¥çœ‹åˆ°å›¾ç‰‡å·²ç»å‡ºæ¥äº†ï¼Œä¸è¿‡æ˜¯æ˜¾ç¤ºçš„é—®é¢˜</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.3.3.6.1.png" alt="image-20220506231408833" tabindex="0" loading="lazy"><figcaption>image-20220506231408833</figcaption></figure><p>æŸ¥çœ‹æ˜¾ç¤ºä½ç½®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.3.3.6.2.png" alt="image-20220506232005751" tabindex="0" loading="lazy"><figcaption>image-20220506232005751</figcaption></figure><p>æœ€åè¿˜æ˜¯ç”¨äº†åŸç”Ÿçš„imgæ ‡ç­¾</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.3.3.6.3.png" alt="image-20220506233108057" tabindex="0" loading="lazy"><figcaption>image-20220506233108057</figcaption></figure><p>å›¾ç‰‡æˆåŠŸæ˜¾ç¤º</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.3.3.6.4.png" alt="image-20220506233245174" tabindex="0" loading="lazy"><figcaption>image-20220506233245174</figcaption></figure><h4 id="_4ã€è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™" tabindex="-1"><a class="header-anchor" href="#_4ã€è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™" aria-hidden="true">#</a> 4ã€è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™</h4>`,21),ha=a("code",null,"Form è¡¨å•",-1),fa={href:"https://element.eleme.io/#/zh-CN/component/form",target:"_blank",rel:"noopener noreferrer"},ya=e(`<h5 id="_1ã€ä¿®æ”¹æ ¡éªŒè§„åˆ™" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿®æ”¹æ ¡éªŒè§„åˆ™" aria-hidden="true">#</a> 1ã€ä¿®æ”¹æ ¡éªŒè§„åˆ™</h5><p>ä¿®æ”¹<code>firstLetter</code>å’Œ<code>sort</code>çš„æ ¡éªŒè§„åˆ™</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token literal-property property">firstLetter</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token function-variable function">validator</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">rule<span class="token punctuation">,</span> value<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">===</span> <span class="token string">&quot;&quot;</span> <span class="token operator">||</span> value <span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;é¦–å­—æ¯å¿…é¡»å¡«å†™&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[a-zA-Z]$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;é¦–å­—æ¯å¿…é¡»ä¸ºå•ä¸ªçš„è‹±æ–‡å¤§å†™æˆ–å°å†™&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">trigger</span><span class="token operator">:</span> <span class="token string">&quot;blur&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token function-variable function">validator</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">rule<span class="token punctuation">,</span> value<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">===</span> <span class="token string">&quot;&quot;</span> <span class="token operator">||</span> value<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;æ’åºå­—æ®µå¿…é¡»å¡«å†™&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span>Number<span class="token punctuation">.</span><span class="token function">isInteger</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">||</span> value<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;æ’åºå­—æ®µå¿…é¡»ä¸ºä¸€ä¸ªå¤§äº0çš„æ•´æ•°&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">trigger</span><span class="token operator">:</span> <span class="token string">&quot;blur&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.4.1.png" alt="image-20220506235834283" tabindex="0" loading="lazy"><figcaption>image-20220506235834283</figcaption></figure><h5 id="_2ã€ä¿®æ”¹æ•°æ®å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹æ•°æ®å­—æ®µ" aria-hidden="true">#</a> 2ã€ä¿®æ”¹æ•°æ®å­—æ®µ</h5><p>ä¿®æ”¹showStatuså­—æ®µé»˜è®¤ä¸º1(æ˜¾ç¤º)</p><p>ä¿®æ”¹<code>sort</code>å­—æ®µé»˜è®¤ä¸º0</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.4.2.png" alt="image-20220506235221089" tabindex="0" loading="lazy"><figcaption>image-20220506235221089</figcaption></figure><h5 id="_3ã€sortæ ‡è¯†ä¸ºæ•°ç»„" tabindex="-1"><a class="header-anchor" href="#_3ã€sortæ ‡è¯†ä¸ºæ•°ç»„" aria-hidden="true">#</a> 3ã€<code>sort</code>æ ‡è¯†ä¸ºæ•°ç»„</h5><p><code>v-moudel</code>æ·»åŠ <code>.number</code>æ ‡è¯†è¯¥æ•°æ®ä¸ºæ•°å­—</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.6.4.3.png" alt="image-20220506235509229" tabindex="0" loading="lazy"><figcaption>image-20220506235509229</figcaption></figure><h3 id="_4-2-7ã€åç«¯æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#_4-2-7ã€åç«¯æ ¡éªŒ" aria-hidden="true">#</a> 4.2.7ã€åç«¯æ ¡éªŒ</h3><h4 id="_1ã€æ·»åŠ ä¾èµ–-1" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ ä¾èµ–-1" aria-hidden="true">#</a> 1ã€æ·»åŠ ä¾èµ–</h4><p>æ–°ç‰ˆæœ¬éœ€è¦åœ¨<code>pom.xml</code>æ–‡ä»¶é‡Œæ·»åŠ ä¾èµ–(è€ç‰ˆæœ¬ä¸éœ€è¦)</p><p>å¼•å…¥</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>javax.validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>validation-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.1.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2ã€æ·»åŠ æ ¡éªŒè§„åˆ™æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ æ ¡éªŒè§„åˆ™æ³¨è§£" aria-hidden="true">#</a> 2ã€æ·»åŠ æ ¡éªŒè§„åˆ™æ³¨è§£</h4><p>åœ¨å®ä½“ç±»é‡Œéœ€è¦æ ¡éªŒçš„å­—æ®µä¸Šæ·»åŠ æ ¡éªŒæ³¨è§£</p><p>éœ€è¦å¯¼å…¥<code>javax.validation.constraints</code>åŒ…ä¸‹çš„æ ¡éªŒè§„åˆ™ï¼Œåœ¨<code>constraints</code>ä¸ŠæŒ‰ctrlé”®å¹¶ç‚¹å‡»å³å¯æŸ¥çœ‹æ‰€æœ‰æ ¡éªŒæ³¨è§£</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.2.png" alt="image-20220507091854747" tabindex="0" loading="lazy"><figcaption>image-20220507091854747</figcaption></figure><h4 id="_3ã€æ ‡è¯†éœ€è¦æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#_3ã€æ ‡è¯†éœ€è¦æ ¡éªŒ" aria-hidden="true">#</a> 3ã€æ ‡è¯†éœ€è¦æ ¡éªŒ</h4><p>åœ¨controllerå±‚éœ€è¦æ ¡éªŒçš„å‚æ•°å¯¹è±¡çš„å·¦è¾¹æ·»åŠ <code>@Valid</code>æ³¨è§£</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.3.png" alt="image-20220507092700948" tabindex="0" loading="lazy"><figcaption>image-20220507092700948</figcaption></figure><h4 id="_4ã€æµ‹è¯•-1" tabindex="-1"><a class="header-anchor" href="#_4ã€æµ‹è¯•-1" aria-hidden="true">#</a> 4ã€æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>é¡¹ç›®åè¿›è¡Œæµ‹è¯•</p><p>url: http://localhost:10000/product/brand/save</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.4.1.png" alt="image-20220507093733971" tabindex="0" loading="lazy"><figcaption>image-20220507093733971</figcaption></figure><p>çŠ¶æ€ä¸º<strong>400</strong>ï¼Œæ¶ˆæ¯ä¸º<strong>ä¸èƒ½ä¸ºç©º</strong>ï¼Œæ ¡éªŒå¤±è´¥çš„å¯¹è±¡ä¸º<code>brandEntity</code>,å­—æ®µä¸º<code>name</code>ï¼Œå¤±è´¥çš„åŸå› æ˜¯<code>name</code>çš„å€¼ä¸ºç©ºä¸²</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.4.2.png" alt="image-20220507094322011" tabindex="0" loading="lazy"><figcaption>image-20220507094322011</figcaption></figure><h4 id="_5ã€è‡ªå®šä¹‰æ˜¾ç¤ºæ ¼å¼" tabindex="-1"><a class="header-anchor" href="#_5ã€è‡ªå®šä¹‰æ˜¾ç¤ºæ ¼å¼" aria-hidden="true">#</a> 5ã€è‡ªå®šä¹‰æ˜¾ç¤ºæ ¼å¼</h4><h5 id="_1ã€æ·»åŠ é”™è¯¯æ¶ˆæ¯æç¤º" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ é”™è¯¯æ¶ˆæ¯æç¤º" aria-hidden="true">#</a> 1ã€æ·»åŠ é”™è¯¯æ¶ˆæ¯æç¤º</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.5.1.png" alt="image-20220507095020241" tabindex="0" loading="lazy"><figcaption>image-20220507095020241</figcaption></figure><h5 id="_2ã€ä¿®æ”¹è¿”å›æ ·å¼" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹è¿”å›æ ·å¼" aria-hidden="true">#</a> 2ã€ä¿®æ”¹è¿”å›æ ·å¼</h5><p>ç»™æ ¡éªŒçš„beanåç´§è·Ÿä¸€ä¸ª<code>org.springframework.validation</code>åŒ…ä¸‹çš„<code>BindingResult</code>,å°±å¯ä»¥è·å–åˆ°æ ¡éªŒçš„ç»“æœ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>  <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/save&quot;</span><span class="token punctuation">)</span>
      <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">BrandEntity</span> brand<span class="token punctuation">,</span> <span class="token class-name">BindingResult</span> result<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">hasErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          result<span class="token punctuation">.</span><span class="token function">getFieldErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span>
              <span class="token comment">//é”™è¯¯æ¶ˆæ¯</span>
              <span class="token class-name">String</span> message <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token comment">//beançš„å­—æ®µå</span>
              <span class="token class-name">String</span> name <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token string">&quot;æäº¤çš„æ•°æ®ä¸åˆæ³•&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
	  brandService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>brand<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.5.2.png" alt="image-20220507100430365" tabindex="0" loading="lazy"><figcaption>image-20220507100430365</figcaption></figure><h4 id="_6ã€é‡æ–°æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_6ã€é‡æ–°æµ‹è¯•" aria-hidden="true">#</a> 6ã€é‡æ–°æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>é¡¹ç›®åé‡æ–°è¿›è¡Œæµ‹è¯•</p><p>å¯ä»¥çœ‹åˆ°å·²ç»æŒ‰ç…§æƒ³è¦çš„æ ¼å¼æ˜¾ç¤ºäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.6.png" alt="image-20220507102736630" tabindex="0" loading="lazy"><figcaption>image-20220507102736630</figcaption></figure><h4 id="_7ã€æ·»åŠ å…¶ä»–æ ¡éªŒè§„åˆ™" tabindex="-1"><a class="header-anchor" href="#_7ã€æ·»åŠ å…¶ä»–æ ¡éªŒè§„åˆ™" aria-hidden="true">#</a> 7ã€æ·»åŠ å…¶ä»–æ ¡éªŒè§„åˆ™</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableName</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>validator<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token class-name">URL</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * å“ç‰Œ
 *
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@email</span> 2185180175@qq.com
 * <span class="token keyword">@date</span> 2022-04-17 18:19:58
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span><span class="token string">&quot;pms_brand&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BrandEntity</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>

   <span class="token doc-comment comment">/**
    * å“ç‰Œid
    */</span>
   <span class="token annotation punctuation">@TableId</span>
   <span class="token keyword">private</span> <span class="token class-name">Long</span> brandId<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * å“ç‰Œå
    * @NotBlank: ä¸èƒ½ä¸ºç©ºï¼Œå¿…é¡»åŒ…å«ä¸€ä¸ªéç©ºç™½å­—ç¬¦
    */</span>
   <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å“ç‰Œåä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * å“ç‰Œlogoåœ°å€
    * @NotEmpty ï¼šThe annotated element must not be <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token keyword">null</span></span></span><span class="token punctuation">}</span> nor empty
    *              å¯ä»¥æ¥æ”¶ CharSequenceã€Collectionã€Mapã€Array ç±»å‹
    * @URL ï¼šå¿…é¡»ä¸ºä¸€ä¸ªåˆæ³•çš„urlåœ°å€
    */</span>
   <span class="token annotation punctuation">@NotEmpty</span>
   <span class="token annotation punctuation">@URL</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;Logoå¿…é¡»ä¸ºä¸€ä¸ªåˆæ³•çš„urlåœ°å€&quot;</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> logo<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * ä»‹ç»
    */</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> descript<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * æ˜¾ç¤ºçŠ¶æ€[0-ä¸æ˜¾ç¤ºï¼›1-æ˜¾ç¤º]
    */</span>
   <span class="token keyword">private</span> <span class="token class-name">Integer</span> showStatus<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * æ£€ç´¢é¦–å­—æ¯
    */</span>
   <span class="token annotation punctuation">@NotEmpty</span>
   <span class="token annotation punctuation">@Pattern</span><span class="token punctuation">(</span>regexp <span class="token operator">=</span> <span class="token string">&quot;^[a-zA-Z]$&quot;</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;é¦–å­—æ¯å¿…é¡»ä¸ºå•ä¸ªçš„å¤§å†™æˆ–å°å†™è‹±æ–‡å­—æ¯&quot;</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> firstLetter<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * æ’åº
    * @NotNull : The annotated element must not be <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token keyword">null</span></span></span><span class="token punctuation">}</span>.
    *        * Accepts any type.
    */</span>
   <span class="token annotation punctuation">@NotNull</span>
   <span class="token annotation punctuation">@Min</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;æ’åºå­—æ®µå¿…é¡»ä¸ºä¸€ä¸ªå¤§äº0çš„æ•´æ•°&quot;</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">Integer</span> sort<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8ã€å†æ¬¡æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_8ã€å†æ¬¡æµ‹è¯•" aria-hidden="true">#</a> 8ã€å†æ¬¡æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>é¡¹ç›®åé‡æ–°è¿›è¡Œæµ‹è¯•</p><h5 id="_1ã€æäº¤é”™è¯¯è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_1ã€æäº¤é”™è¯¯è¯·æ±‚" aria-hidden="true">#</a> 1ã€æäº¤é”™è¯¯è¯·æ±‚</h5><h6 id="_1ã€ä¸ºç©ºåˆ¤æ–­" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¸ºç©ºåˆ¤æ–­" aria-hidden="true">#</a> 1ã€ä¸ºç©ºåˆ¤æ–­</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.8.1.1.png" alt="image-20220507103142585" tabindex="0" loading="lazy"><figcaption>image-20220507103142585</figcaption></figure><h6 id="_2ã€é”™è¯¯å€¼åˆ¤æ–­" tabindex="-1"><a class="header-anchor" href="#_2ã€é”™è¯¯å€¼åˆ¤æ–­" aria-hidden="true">#</a> 2ã€é”™è¯¯å€¼åˆ¤æ–­</h6><p>nameå€¼ä¸ºä¸€ä¸ªç©ºæ ¼å¯ä»¥åˆ¤æ–­ï¼Œä½†sortä¸ºæµ®ç‚¹å‹åˆ¤æ–­ä¸å‡ºæ¥</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;logo&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://www.example.org/1.jpg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;firstLetter&quot;</span><span class="token operator">:</span><span class="token string">&quot;q&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;sort&quot;</span><span class="token operator">:</span><span class="token number">1.1</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.8.1.2.png" alt="image-20220507104541200" tabindex="0" loading="lazy"><figcaption>image-20220507104541200</figcaption></figure><h6 id="_3ã€æµ‹è¯•sortä¸ºæµ®ç‚¹å‹" tabindex="-1"><a class="header-anchor" href="#_3ã€æµ‹è¯•sortä¸ºæµ®ç‚¹å‹" aria-hidden="true">#</a> 3ã€æµ‹è¯•sortä¸ºæµ®ç‚¹å‹</h6><p>å½“å…¶ä»–å€¼åˆæ³•ï¼Œåªæœ‰sortä¸ä¸ºintç±»å‹æ—¶ï¼Œå°½ç„¶æ ¡éªŒé€šè¿‡äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.8.1.3.1.png" alt="image-20220507105030110" tabindex="0" loading="lazy"><figcaption>image-20220507105030110</figcaption></figure><p><code>sort</code>ç›´æ¥è¢«è½¬æˆintäº†ğŸ˜°</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.8.1.3.2.png" alt="image-20220507105222663" tabindex="0" loading="lazy"><figcaption>image-20220507105222663</figcaption></figure><h6 id="_4ã€è¯»å–è¯·æ±‚ä½“ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_4ã€è¯»å–è¯·æ±‚ä½“ä¿¡æ¯" aria-hidden="true">#</a> 4ã€è¯»å–è¯·æ±‚ä½“ä¿¡æ¯</h6><p>sortç¡®å®ä¸º1.1</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/save&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;sort&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    request<span class="token punctuation">.</span><span class="token function">getParameterMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token string">&quot; : &quot;</span> <span class="token operator">+</span> v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">StringBuffer</span> stringBuffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BufferedReader</span> reader <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> temp<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>temp <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        stringBuffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stringBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

    brandService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>brand<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.8.1.4.1.png" alt="image-20220507120100556" tabindex="0" loading="lazy"><figcaption>image-20220507120100556</figcaption></figure><p>ä¸è¦åŠ ä¸Š<code>@RequestBody BrandEntity brand</code>ï¼Œå¦‚æœåŠ ä¸Šè¿™äº›å‚æ•°springä¼šè¯»å–requestè¾“å…¥æµ</p><p>è€Œrequestçš„è¾“å…¥æµåªå…è®¸è¢«è¯»å–ä¸€æ¬¡</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/save&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">BrandEntity</span> brand<span class="token punctuation">,</span> <span class="token class-name">BindingResult</span> result<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    request<span class="token punctuation">.</span><span class="token function">getParameterMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;111&quot;</span> <span class="token operator">+</span> k <span class="token operator">+</span> <span class="token string">&quot; : &quot;</span> <span class="token operator">+</span> v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">StringBuffer</span> stringBuffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BufferedReader</span> reader <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> temp<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>temp <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        stringBuffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stringBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">hasErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">getFieldErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">//é”™è¯¯æ¶ˆæ¯</span>
            <span class="token class-name">String</span> message <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//beançš„å­—æ®µå</span>
            <span class="token class-name">String</span> name <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token string">&quot;æäº¤çš„æ•°æ®ä¸åˆæ³•&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    brandService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>brand<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.8.1.4.2.png" alt="image-20220507122011532" tabindex="0" loading="lazy"><figcaption>image-20220507122011532</figcaption></figure><h6 id="_5ã€ä¸å…è®¸å¼ºè½¬" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¸å…è®¸å¼ºè½¬" aria-hidden="true">#</a> 5ã€ä¸å…è®¸å¼ºè½¬</h6><p>è®¾ç½®jsonååºåˆ—åŒ–ä¸å…è®¸<code>float</code>å¼ºè½¬æˆ<code>int</code></p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">jackson</span><span class="token punctuation">:</span>
    <span class="token key atrule">deserialization</span><span class="token punctuation">:</span>
      <span class="token key atrule">ACCEPT_FLOAT_AS_INT</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.8.1.5.1.png" alt="image-20220507144358777" tabindex="0" loading="lazy"><figcaption>image-20220507144358777</figcaption></figure><p>å¯ä»¥çœ‹åˆ°å·²ç»ä¸å…è®¸å¼ºè½¬äº†</p><p>Cannot coerce a floating-point value (&#39;1.1&#39;) into Integerï¼šæ— æ³•å°†æµ®ç‚¹å€¼ (&#39;1.1&#39;) å¼ºåˆ¶è½¬æ¢ä¸ºæ•´æ•°</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.8.1.5.2.png" alt="image-20220507144324665" tabindex="0" loading="lazy"><figcaption>image-20220507144324665</figcaption></figure><h5 id="_2ã€æäº¤æ­£ç¡®è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_2ã€æäº¤æ­£ç¡®è¯·æ±‚" aria-hidden="true">#</a> 2ã€æäº¤æ­£ç¡®è¯·æ±‚</h5><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;logo&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://www.example.org/1.jpg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;firstLetter&quot;</span><span class="token operator">:</span><span class="token string">&quot;q&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;sort&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.8.2.1.png" alt="image-20220507103754722" tabindex="0" loading="lazy"><figcaption>image-20220507103754722</figcaption></figure><p>å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.8.2.2.png" alt="image-20220507103937140" tabindex="0" loading="lazy"><figcaption>image-20220507103937140</figcaption></figure><h4 id="_9ã€æ‰¹é‡æ•è·å¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#_9ã€æ‰¹é‡æ•è·å¼‚å¸¸" aria-hidden="true">#</a> 9ã€æ‰¹é‡æ•è·å¼‚å¸¸</h4><h5 id="_1ã€ç¼–å†™å¼‚å¸¸æ•è·ç±»" tabindex="-1"><a class="header-anchor" href="#_1ã€ç¼–å†™å¼‚å¸¸æ•è·ç±»" aria-hidden="true">#</a> 1ã€ç¼–å†™å¼‚å¸¸æ•è·ç±»</h5><p>åœ¨<code>com.atguigu.gulimall.product</code>ä¸‹æ–°å»º<code>exception</code>æ–‡ä»¶å¤¹</p><p>åœ¨<code>com.atguigu.gulimall.product.exception</code>ä¸‹æ–°å»º<code> GulimallExceptionControllerAdvice</code>ç±»è‡ªå®šä¹‰æ•è·å¼‚å¸¸</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>exception</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>common<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">R</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ExceptionHandler</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestControllerAdvice</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/7
 * @Description: è‡ªå®šä¹‰å¼‚å¸¸æ•è·ç±»
 *
 * @RestControllerAdvice =  @ControllerAdvice + @ResponseBody
 */</span>

<span class="token annotation punctuation">@Slf4j</span>  <span class="token comment">//lombokæ—¥å¿—</span>
<span class="token annotation punctuation">@RestControllerAdvice</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">&quot;com.atguigu.gulimall.product.controller&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GulimallExceptionControllerAdvice</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * æ•è·å¼‚å¸¸
     * @ExceptionHandler: æ•è·å¼‚å¸¸çš„ç±»å‹
     * <span class="token keyword">@param</span> <span class="token parameter">e</span> è¯¥å¼‚å¸¸ç±»
     * <span class="token keyword">@return</span>  è¿”å›å‰ç«¯çš„ç»“æœ
     */</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">handleValidException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;æ•°æ®æ ¡éªŒå‡ºç°é—®é¢˜:{},å¼‚å¸¸ç±»å‹:{}&quot;</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.9.1.png" alt="image-20220507153231608" tabindex="0" loading="lazy"><figcaption>image-20220507153231608</figcaption></figure><h5 id="_2ã€æµ‹è¯•uploadæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æµ‹è¯•uploadæ–¹æ³•" aria-hidden="true">#</a> 2ã€æµ‹è¯•<code>upload</code>æ–¹æ³•</h5><p>é‡å¯<code>gulimall-product</code>é¡¹ç›®åæµ‹è¯•</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://localhost:10000/product/brand/update

{&quot;id&quot;:1,&quot;name&quot;: &quot; &quot;,&quot;logo&quot;:&quot;www.example.org/1.jpg&quot;,&quot;firstLetter&quot;:&quot;qq&quot;,&quot;sort&quot;:-1}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_1ã€æœªçŸ¥é”™è¯¯" tabindex="-1"><a class="header-anchor" href="#_1ã€æœªçŸ¥é”™è¯¯" aria-hidden="true">#</a> 1ã€æœªçŸ¥é”™è¯¯</h6><p>å¯ä»¥çœ‹åˆ°æ˜¾ç¤ºçš„æ˜¯æœªçŸ¥é”™è¯¯</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.9.2.1.png" alt="image-20220507151321841" tabindex="0" loading="lazy"><figcaption>image-20220507151321841</figcaption></figure><h6 id="_2ã€æ§åˆ¶å°æŸ¥çœ‹å¼‚å¸¸ç±»" tabindex="-1"><a class="header-anchor" href="#_2ã€æ§åˆ¶å°æŸ¥çœ‹å¼‚å¸¸ç±»" aria-hidden="true">#</a> 2ã€æ§åˆ¶å°æŸ¥çœ‹å¼‚å¸¸ç±»</h6><p>å¼‚å¸¸ç±»ä¸ºï¼š<code>org.springframework.web.bind.MethodArgumentNotValidException</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.9.2.2.png" alt="image-20220507153339775" tabindex="0" loading="lazy"><figcaption>image-20220507153339775</figcaption></figure><h5 id="_3ã€ä¿®æ”¹æ•è·å¼‚å¸¸ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹æ•è·å¼‚å¸¸ç±»å‹" aria-hidden="true">#</a> 3ã€ä¿®æ”¹æ•è·å¼‚å¸¸ç±»å‹</h5><p>ä¿®æ”¹<code> GulimallExceptionControllerAdvice</code>ç±»çš„<code>handleValidException</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">MethodArgumentNotValidException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">handleValidException</span><span class="token punctuation">(</span><span class="token class-name">MethodArgumentNotValidException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;æ•°æ®æ ¡éªŒå‡ºç°é—®é¢˜:{},å¼‚å¸¸ç±»å‹:{}&quot;</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> errMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    e<span class="token punctuation">.</span><span class="token function">getBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFieldErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span>
        <span class="token comment">//å®ä½“ç±»çš„å­—æ®µåå’Œå¯¹åº”çš„é”™è¯¯æ¶ˆæ¯</span>
        errMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>item<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token string">&quot;æ•°æ®æ ¡éªŒå¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span>errMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.9.3.png" alt="image-20220507152807842" tabindex="0" loading="lazy"><figcaption>image-20220507152807842</figcaption></figure><p>4ã€æµ‹è¯•<code>upload</code>æ–¹æ³•</p><p>æµ‹è¯•<code>upload</code>æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°æŒ‰æƒ³è¦çš„æ ¼å¼æ˜¾ç¤ºå‡ºæ¥äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.9.4.png" alt="image-20220507152532267" tabindex="0" loading="lazy"><figcaption>image-20220507152532267</figcaption></figure><h4 id="_10ã€æ•è·æ‰€æœ‰ç±»å‹å¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#_10ã€æ•è·æ‰€æœ‰ç±»å‹å¼‚å¸¸" aria-hidden="true">#</a> 10ã€æ•è·æ‰€æœ‰ç±»å‹å¼‚å¸¸</h4><p>åœ¨<code> GulimallExceptionControllerAdvice</code>ç±»ä¸­æ·»åŠ æ–¹æ³•</p><p>æ‰€æœ‰å‰é¢æ²¡æœ‰è¢«åŒ¹é…çš„å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œè¿™ä¸ªæ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">Throwable</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> throwable<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.10.png" alt="image-20220507154355873" tabindex="0" loading="lazy"><figcaption>image-20220507154355873</figcaption></figure><h4 id="_11ã€é”™è¯¯ç±»å‹æšä¸¾" tabindex="-1"><a class="header-anchor" href="#_11ã€é”™è¯¯ç±»å‹æšä¸¾" aria-hidden="true">#</a> 11ã€é”™è¯¯ç±»å‹æšä¸¾</h4><h5 id="_1ã€æ–°å»ºæšä¸¾ç±»" tabindex="-1"><a class="header-anchor" href="#_1ã€æ–°å»ºæšä¸¾ç±»" aria-hidden="true">#</a> 1ã€æ–°å»ºæšä¸¾ç±»</h5><p>åœ¨<code>gulimall-common</code>æ¨¡å—çš„<code>com.atguigu.common.exception</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»º<code>BizCodeException</code>æšä¸¾ç±»</p><p>å®šä¹‰å¯èƒ½çš„é”™è¯¯ä¿¡æ¯</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>common<span class="token punctuation">.</span>exception</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/7
 * @Description:
 * é”™è¯¯ç å’Œé”™è¯¯ä¿¡æ¯å®šä¹‰ç±»
 * 1. é”™è¯¯ç å®šä¹‰è§„åˆ™ä¸º 5 ä¸ºæ•°å­—
 * 2. å‰ä¸¤ä½è¡¨ç¤ºä¸šåŠ¡åœºæ™¯ï¼Œæœ€åä¸‰ä½è¡¨ç¤ºé”™è¯¯ç ã€‚ä¾‹å¦‚ï¼š100001ã€‚10:é€šç”¨ 001:ç³»ç»ŸæœªçŸ¥å¼‚å¸¸
 * 3. ç»´æŠ¤é”™è¯¯ç åéœ€è¦ç»´æŠ¤é”™è¯¯æè¿°ï¼Œå°†ä»–ä»¬å®šä¹‰ä¸ºæšä¸¾å½¢å¼
 * é”™è¯¯ç åˆ—è¡¨ï¼š
 * 10: é€šç”¨
 * 001ï¼šå‚æ•°æ ¼å¼æ ¡éªŒ
 * 11: å•†å“
 * 12: è®¢å•
 * 13: è´­ç‰©è½¦
 * 14: ç‰©æµ
 */</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">BizCodeException</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * ç³»ç»ŸæœªçŸ¥å¼‚å¸¸
     */</span>
    <span class="token function">UNKNOW_EXCEPTION</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token string">&quot;ç³»ç»ŸæœªçŸ¥å¼‚å¸¸&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token doc-comment comment">/**
     * å‚æ•°æ ¼å¼æ ¡éªŒå¤±è´¥
     */</span>
    <span class="token function">VALID_EXCEPTION</span><span class="token punctuation">(</span><span class="token number">10001</span><span class="token punctuation">,</span><span class="token string">&quot;å‚æ•°æ ¼å¼æ ¡éªŒå¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> code<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> msg<span class="token punctuation">;</span>

    <span class="token class-name">BizCodeException</span><span class="token punctuation">(</span><span class="token keyword">int</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> code<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> msg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.11.1.png" alt="image-20220507155929408" tabindex="0" loading="lazy"><figcaption>image-20220507155929408</figcaption></figure><h5 id="_2ã€rç±»æ·»åŠ æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€rç±»æ·»åŠ æ–¹æ³•" aria-hidden="true">#</a> 2ã€<code>R</code>ç±»æ·»åŠ æ–¹æ³•</h5><p>åœ¨<code>gulimall-common</code>æ¨¡å—çš„<code>com.atguigu.common.utils</code>æ–‡ä»¶å¤¹ä¸‹çš„<code>R</code>ç±»é‡Œæ·»åŠ æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">R</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token class-name">BizCodeException</span> bizCodeException<span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token function">error</span><span class="token punctuation">(</span>bizCodeException<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>bizCodeException<span class="token punctuation">.</span><span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.11.2.png" alt="image-20220507161305656" tabindex="0" loading="lazy"><figcaption>image-20220507161305656</figcaption></figure><h5 id="_3ã€ä¿®æ”¹è¿”å›å‚æ•°" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹è¿”å›å‚æ•°" aria-hidden="true">#</a> 3ã€ä¿®æ”¹è¿”å›å‚æ•°</h5><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—<code>com.atguigu.gulimall.product.exception</code>åŒ…ä¸‹çš„</p><p><code> GulimallExceptionControllerAdvice</code>ç±»çš„æ–¹æ³•è¿”å›å‚æ•°</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.11.3.png" alt="image-20220507161815782" tabindex="0" loading="lazy"><figcaption>image-20220507161815782</figcaption></figure><h4 id="_12ã€åˆ†ç»„æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#_12ã€åˆ†ç»„æ ¡éªŒ" aria-hidden="true">#</a> 12ã€åˆ†ç»„æ ¡éªŒ</h4><blockquote><p>é»˜è®¤æ²¡æœ‰æŒ‡å®šåˆ†ç»„çš„æ ¡éªŒæ³¨è§£@NotBlankï¼Œåœ¨åˆ†ç»„æ ¡éªŒæƒ…å†µ@Validated({AddGroup.class})ä¸‹ä¸ç”Ÿæ•ˆï¼Œåªä¼šåœ¨@Validatedç”Ÿæ•ˆï¼›</p><p>é»˜è®¤æŒ‡å®šåˆ†ç»„çš„æ ¡éªŒæ³¨è§£@NotBlank(groups = AddGroup.class)ï¼Œåœ¨@Validatedä¸‹ä¸ç”Ÿæ•ˆï¼Œåªä¼šåœ¨åˆ†ç»„æ ¡éªŒ@Validated({AddGroup.class})ä¸‹ç”Ÿæ•ˆ</p></blockquote><p>å¯ä»¥çœ‹åˆ°groupsçš„å‚æ•°ä¸ºæ¥å£æ•°ç»„</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.12.0.png" alt="image-20220507175045352" tabindex="0" loading="lazy"><figcaption>image-20220507175045352</figcaption></figure><h5 id="_1ã€æ–°å»ºæ¥å£" tabindex="-1"><a class="header-anchor" href="#_1ã€æ–°å»ºæ¥å£" aria-hidden="true">#</a> 1ã€æ–°å»ºæ¥å£</h5><p>åœ¨<code>gulimall-common</code>æ¨¡å—çš„<code>com.atguigu.common</code>åŒ…ä¸‹æ–°å»º<code>valid</code>æ–‡ä»¶å¤¹</p><p>åœ¨<code>gulimall-common</code>æ¨¡å—çš„<code>com.atguigu.common.valid</code>åŒ…ä¸‹åˆ›å»º<code>AddGroup</code>å’Œ<code>UpdateGroup</code>æ¥å£</p><p>è¿™äº›æ¥å£åªåšæ ‡è¯†ï¼Œä¸ç”¨ä¹¦å†™ä»»ä½•æ–¹æ³•å’Œå­—æ®µ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.12.1.1.png" alt="image-20220507175647905" tabindex="0" loading="lazy"><figcaption>image-20220507175647905</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.12.1.2.png" alt="image-20220507175702832" tabindex="0" loading="lazy"><figcaption>image-20220507175702832</figcaption></figure><h5 id="_2ã€æ·»åŠ åˆ†ç»„" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ åˆ†ç»„" aria-hidden="true">#</a> 2ã€æ·»åŠ åˆ†ç»„</h5><p>idæ·»åŠ æ ¡éªŒæ³¨è§£ï¼Œä½¿ç”¨<code>groups</code>å±æ€§è¿›è¡Œåˆ†ç»„,ä¼ å…¥çš„ç±»åªåšä¸€ä¸ªæ ‡è¯†</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Null</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;æ·»åŠ ä¸èƒ½æŒ‡å®šå“ç‰Œid&quot;</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">AddGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;ä¿®æ”¹å¿…é¡»æŒ‡å®šå“ç‰Œid&quot;</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">UpdateGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.12.2.png" alt="image-20220507182831588" tabindex="0" loading="lazy"><figcaption>image-20220507182831588</figcaption></figure><h5 id="_3ã€æŒ‰ç»„æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#_3ã€æŒ‰ç»„æ ¡éªŒ" aria-hidden="true">#</a> 3ã€æŒ‰ç»„æ ¡éªŒ</h5><p>ä½¿ç”¨<code>org.springframework.validation.annotation</code>åŒ…ä¸‹çš„<code>Validated</code>æ³¨è§£ï¼ŒæŒ‡å®šåˆ†ç»„çš„ç±»</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.12.3.png" alt="image-20220507183447890" tabindex="0" loading="lazy"><figcaption>image-20220507183447890</figcaption></figure><h5 id="_4ã€æµ‹è¯•-2" tabindex="-1"><a class="header-anchor" href="#_4ã€æµ‹è¯•-2" aria-hidden="true">#</a> 4ã€æµ‹è¯•</h5><p>é‡å¯<code>gulimall-product</code>æ¨¡å—</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;brandId&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">,</span><span class="token property">&quot;logo&quot;</span><span class="token operator">:</span><span class="token string">&quot;www.example.org/1.jpg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;firstLetter&quot;</span><span class="token operator">:</span><span class="token string">&quot;qq&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;sort&quot;</span><span class="token operator">:</span><span class="token number">-1</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹åˆ°<code>brandId</code>å­—æ®µå·²ç»åˆ†ç»„æ ¡éªŒäº†ï¼Œå…¶ä»–æ²¡æœ‰åˆ†ç»„çš„å­—æ®µåœ¨ä½¿ç”¨<code>Validated</code>æ³¨è§£è¿›è¡Œåˆ†ç»„æ ¡éªŒçš„æƒ…å†µä¸‹ä¸ç”Ÿæ•ˆ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.12.4.1.png" alt="image-20220507193841877" tabindex="0" loading="lazy"><figcaption>image-20220507193841877</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.12.4.2.png" alt="image-20220507193934405" tabindex="0" loading="lazy"><figcaption>image-20220507193934405</figcaption></figure><h5 id="_5ã€å…¶ä»–å­—æ®µæ·»åŠ åˆ†ç»„æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#_5ã€å…¶ä»–å­—æ®µæ·»åŠ åˆ†ç»„æ ¡éªŒ" aria-hidden="true">#</a> 5ã€å…¶ä»–å­—æ®µæ·»åŠ åˆ†ç»„æ ¡éªŒ</h5><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—ä¸‹çš„<code>com.atguigu.gulimall.product.entity.BrandEntity</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>common<span class="token punctuation">.</span>valid<span class="token punctuation">.</span></span><span class="token class-name">AddGroup</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>common<span class="token punctuation">.</span>valid<span class="token punctuation">.</span></span><span class="token class-name">UpdateGroup</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableName</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>validator<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token class-name">URL</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * å“ç‰Œ
 *
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@email</span> 2185180175@qq.com
 * <span class="token keyword">@date</span> 2022-04-17 18:19:58
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span><span class="token string">&quot;pms_brand&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BrandEntity</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>

   <span class="token doc-comment comment">/**
    * å“ç‰Œid
    * UpdateGroupä¸èƒ½æŒ‡å®šå“ç‰Œ
    * AddGroupå¿…é¡»æŒ‡å®šå“ç‰Œid
    */</span>
   <span class="token annotation punctuation">@Null</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;æ·»åŠ ä¸èƒ½æŒ‡å®šå“ç‰Œid&quot;</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">AddGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;ä¿®æ”¹å¿…é¡»æŒ‡å®šå“ç‰Œid&quot;</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">UpdateGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token annotation punctuation">@TableId</span>
   <span class="token keyword">private</span> <span class="token class-name">Long</span> brandId<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * å“ç‰Œå
    * @NotBlank: ä¸èƒ½ä¸ºç©ºï¼Œå¿…é¡»åŒ…å«ä¸€ä¸ªéç©ºç™½å­—ç¬¦
    */</span>
   <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å“ç‰Œåä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token class-name">AddGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * å“ç‰Œlogoåœ°å€
    * @NotEmpty ï¼šThe annotated element must not be <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token keyword">null</span></span></span><span class="token punctuation">}</span> nor empty
    *              å¯ä»¥æ¥æ”¶ CharSequenceã€Collectionã€Mapã€Array ç±»å‹
    * @URL ï¼šå¿…é¡»ä¸ºä¸€ä¸ªåˆæ³•çš„urlåœ°å€
    *
    * æ·»åŠ å“ç‰Œæ—¶logoä¸èƒ½ä¸ºç©ºï¼Œå¹¶ä¸”éœ€è¦æ˜¯ä¸€ä¸ªURL
    * ä¿®æ”¹å¯ä»¥ä¸ºç©ºï¼Œä½†å¦‚æœä¸ä¸ºç©ºåˆ™å¿…é¡»ä¸ºä¸€ä¸ªURL
    */</span>
   <span class="token annotation punctuation">@NotEmpty</span><span class="token punctuation">(</span>groups <span class="token operator">=</span> <span class="token class-name">AddGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
   <span class="token annotation punctuation">@URL</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;Logoå¿…é¡»ä¸ºä¸€ä¸ªåˆæ³•çš„urlåœ°å€&quot;</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">AddGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token class-name">UpdateGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> logo<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * ä»‹ç»
    */</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> descript<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * æ˜¾ç¤ºçŠ¶æ€[0-ä¸æ˜¾ç¤ºï¼›1-æ˜¾ç¤º]
    */</span>
   <span class="token keyword">private</span> <span class="token class-name">Integer</span> showStatus<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * æ£€ç´¢é¦–å­—æ¯
    */</span>
   <span class="token annotation punctuation">@NotEmpty</span><span class="token punctuation">(</span>groups <span class="token operator">=</span> <span class="token class-name">AddGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
   <span class="token annotation punctuation">@Pattern</span><span class="token punctuation">(</span>regexp <span class="token operator">=</span> <span class="token string">&quot;^[a-zA-Z]$&quot;</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;é¦–å­—æ¯å¿…é¡»ä¸ºå•ä¸ªçš„å¤§å†™æˆ–å°å†™è‹±æ–‡å­—æ¯&quot;</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">AddGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token class-name">UpdateGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> firstLetter<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * æ’åº
    * @NotNull : The annotated element must not be <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token keyword">null</span></span></span><span class="token punctuation">}</span>.
    *        * Accepts any type.
    */</span>
   <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>groups <span class="token operator">=</span> <span class="token class-name">AddGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
   <span class="token annotation punctuation">@Min</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;æ’åºå­—æ®µå¿…é¡»ä¸ºä¸€ä¸ªå¤§äº0çš„æ•´æ•°&quot;</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">AddGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token class-name">UpdateGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">Integer</span> sort<span class="token punctuation">;</span>



<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_13ã€è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_13ã€è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£" aria-hidden="true">#</a> 13ã€è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£</h4><p>éœ€æ±‚ï¼š<code>showStatus</code>åªèƒ½ä¸º0æˆ–1</p><p>Integerå’ŒLongç±»å‹ä¸èƒ½ä½¿ç”¨æ­£åˆ™</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/**
 * æ˜¾ç¤ºçŠ¶æ€[0-ä¸æ˜¾ç¤ºï¼›1-æ˜¾ç¤º]
 * @Patternä¸èƒ½ç”¨åœ¨Integerå’ŒLongä¸Š
 * No validator could be found for constraint &#39;javax.validation.constraints.Pattern&#39; validating type &#39;java.lang.Integer&#39;
 * @Pattern æ³¨è§£å¯ä»¥æ ‡æ³¨åœ¨ CharSequence å’Œ null ä¸Š
 */
//@Pattern(regexp = &quot;^[01]$&quot;,message = &quot;æ˜¾ç¤ºçŠ¶æ€å¼‚å¸¸&quot;,groups = AddGroup.class) ä¸èƒ½ä½¿ç”¨è¯¥æ³¨è§£æ¥æ ¡éªŒ
private Integer showStatus;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸è¿‡å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸‰ä¸ªæ³¨è§£æ¥å®ŒæˆåŠŸèƒ½</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>@NotNull(groups = AddGroup.class)
@Max(value = 1,groups = {AddGroup.class,UpdateGroup.class})
@Min(value = 0,groups = {AddGroup.class,UpdateGroup.class})
private Integer showStatus;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæœ‰æ›´å¤æ‚çš„éœ€æ±‚,æ¯”æ–¹è¯´åªèƒ½ä¸º[1,4,7]ä¸­çš„ä¸€ä¸ªï¼Œè¿™äº›æ³¨è§£å°±ä¸èƒ½å®ç°è¿™ä¸ªéœ€æ±‚äº†</p><p>å› æ­¤å¯ä»¥è‡ªå®šä¹‰æ³¨è§£</p><h5 id="_1ã€ç¼–å†™è‡ªå®šä¹‰æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_1ã€ç¼–å†™è‡ªå®šä¹‰æ³¨è§£" aria-hidden="true">#</a> 1ã€ç¼–å†™è‡ªå®šä¹‰æ³¨è§£</h5><p>åœ¨<code>gulimall-common</code>æ¨¡å—çš„<code>com.atguigu.common.valid</code>åŒ…ä¸‹åˆ›å»º<code>ListValue</code>æ³¨è§£</p><p>åœ¨<code>jsr303</code>è§„èŒƒä¸­ï¼Œæ ¡éªŒæ³¨è§£å¿…é¡»æ·»åŠ è¿™ä¸‰ä¸ªå±æ€§</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>common<span class="token punctuation">.</span>valid</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Documented</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Retention</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Target</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token import static"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token import static"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token static">TYPE_USE</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token import static"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token static">RUNTIME</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/7
 * @Description: åªèƒ½ä¸ºåˆ—è¡¨å†…çš„å€¼
 */</span>
<span class="token comment">//ç”Ÿæˆæ–‡æ¡£</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token comment">//ä½¿ç”¨å“ªä¸ªæ ¡éªŒå™¨è¿›è¡Œæ ¡éªŒ(å¦‚æœä¸æŒ‡å®šï¼Œéœ€è¦åœ¨åˆå§‹åŒ–çš„æ—¶å€™æŒ‡å®š)</span>
<span class="token annotation punctuation">@Constraint</span><span class="token punctuation">(</span>validatedBy <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//æ³¨è§£å¯ä»¥æ ‡æ³¨åœ¨å“ªä¸ªä½ç½®</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token constant">METHOD</span><span class="token punctuation">,</span> <span class="token constant">FIELD</span><span class="token punctuation">,</span> <span class="token constant">ANNOTATION_TYPE</span><span class="token punctuation">,</span> <span class="token constant">CONSTRUCTOR</span><span class="token punctuation">,</span> <span class="token constant">PARAMETER</span><span class="token punctuation">,</span> <span class="token constant">TYPE_USE</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//æ ¡éªŒæ—¶æœºï¼Œåœ¨è¿è¡Œæ—¶è·å–</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">ListValue</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * æ ¡éªŒå‡ºé”™ä»¥åï¼Œé”™è¯¯ä¿¡æ¯å»å“ªå–
     * é»˜è®¤ä½¿ç”¨com.atguigu.common.valid.ListValue.messageå±æ€§å»
     * org/hibernate/validator/ValidationMessages.propertiesé…ç½®æ–‡ä»¶ä¸­å»å–
     *
     * ä¸€èˆ¬ä¸º (æ³¨è§£å…¨ç±»å + .message)
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token class-name">String</span> <span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;{com.atguigu.common.valid.ListValue.message}&quot;</span><span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * æ”¯æŒåˆ†ç»„æ ¡éªŒ
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">groups</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * è‡ªå®šä¹‰è´Ÿè½½ä¿¡æ¯
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Payload</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">payload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * å¯ä»¥ä¸ºå“ªäº›å€¼
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">vals</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.13.1.png" alt="image-20220507212345254" tabindex="0" loading="lazy"><figcaption>image-20220507212345254</figcaption></figure><h5 id="_2ã€æ·»åŠ åæ ‡" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ åæ ‡" aria-hidden="true">#</a> 2ã€æ·»åŠ åæ ‡</h5><p>åœ¨<code>gulimall-common</code>æ¨¡å—çš„<code>pom.xml</code>æ–‡ä»¶ä¸­æ·»åŠ validationåæ ‡ï¼Œç‚¹å‡»åˆ·æ–°ï¼Œç„¶ååœ¨<code>ListValue</code>æ³¨è§£ç±»ä¸­å¯¼åŒ…å°±ä¸æŠ¥é”™</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>javax.validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>validation-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.1.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.13.2.png" alt="image-20220507215105090" tabindex="0" loading="lazy"><figcaption>image-20220507215105090</figcaption></figure><h5 id="_3ã€åˆ›å»ºé…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_3ã€åˆ›å»ºé…ç½®æ–‡ä»¶" aria-hidden="true">#</a> 3ã€åˆ›å»ºé…ç½®æ–‡ä»¶</h5><p>åœ¨<code>jsr303</code>è§„èŒƒä¸­ï¼Œåœ¨<code>ValidationMessages.properties</code>æ–‡ä»¶ä¸­è·å–<code>message</code>ä¸­é”®å¯¹åº”çš„å€¼ä½œä¸ºæ¶ˆæ¯</p><h6 id="_1ã€æœç´¢validationmessages-properties" tabindex="-1"><a class="header-anchor" href="#_1ã€æœç´¢validationmessages-properties" aria-hidden="true">#</a> 1ã€æœç´¢<code>ValidationMessages.properties</code></h6><p>åŒå‡»<strong>shift</strong>é”®,åœ¨å¼¹å‡ºçš„æ¡†ä¸­æœç´¢<code>ValidationMessages.properties</code>å³å¯çœ‹åˆ°</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.13.3.1.png" alt="image-20220507212629762" tabindex="0" loading="lazy"><figcaption>image-20220507212629762</figcaption></figure><h6 id="_2ã€æ–°å»ºé…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å»ºé…ç½®æ–‡ä»¶" aria-hidden="true">#</a> 2ã€æ–°å»ºé…ç½®æ–‡ä»¶</h6><p>åœ¨<code>gulimall-common</code>æ¨¡å—çš„<code>resources</code>ç›®å½•ä¸‹æ–°å»º<code>ValidationMessages.properties</code>é…ç½®æ–‡ä»¶</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">com.atguigu.common.valid.ListValue.message</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;å¿…é¡»æäº¤æŒ‡å®šçš„å€¼&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¿™é‡Œå†™é”™äº†ï¼Œæµ‹è¯•çš„æ—¶å€™å‘ç°å®ƒæŠŠä¸¤ä¸ªåŒå¼•å·ä¹Ÿæ˜¾ç¤ºå‡ºæ¥äº†(åˆ«äººå†™çš„ä¹Ÿæ²¡æœ‰åŒå¼•å·),å…¶å®ä¸º</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">com.atguigu.common.valid.ListValue.message</span> <span class="token punctuation">=</span> <span class="token value attr-value">å¿…é¡»æäº¤æŒ‡å®šçš„å€¼</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ³¨æ„ç¼–ç ä¸º&quot;<strong>UTF-8</strong>&quot;</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.13.3.2.png" alt="image-20220507213536293" tabindex="0" loading="lazy"><figcaption>image-20220507213536293</figcaption></figure><h6 id="_3ã€è®¾ç½®å­—ç¬¦ç¼–ç " tabindex="-1"><a class="header-anchor" href="#_3ã€è®¾ç½®å­—ç¬¦ç¼–ç " aria-hidden="true">#</a> 3ã€è®¾ç½®å­—ç¬¦ç¼–ç </h6><p>å¦‚æœç¼–ç ä¸ä¸º&quot;<strong>UTF-8</strong>&quot;å¯ä»¥<strong>è®¾ç½®å­—ç¬¦ç¼–ç </strong></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.13.3.3.png" alt="image-20220507214152772" tabindex="0" loading="lazy"><figcaption>image-20220507214152772</figcaption></figure><h5 id="_4ã€è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™-1" tabindex="-1"><a class="header-anchor" href="#_4ã€è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™-1" aria-hidden="true">#</a> 4ã€è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™</h5><p>æ ¡éªŒç±»å¿…é¡»å®ç°<code>ConstraintValidator</code>æ¥å£</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.13.4.1.png" alt="image-20220507215413611" tabindex="0" loading="lazy"><figcaption>image-20220507215413611</figcaption></figure><p><code>ConstraintValidator</code>æ¥å£æœ‰ä¸¤ä¸ªæ³›å‹,ç¬¬ä¸€ä¸ªæ³›å‹ç”¨æ¥<strong>æŒ‡å®šæ³¨è§£</strong>ï¼Œç¬¬äºŒä¸ªæ³›å‹ç”¨æ¥æŒ‡å®š<strong>éœ€è¦æ ¡éªŒçš„æ•°æ®ç±»å‹</strong></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.13.4.2.png" alt="image-20220507215539055" tabindex="0" loading="lazy"><figcaption>image-20220507215539055</figcaption></figure><p>åœ¨<code>com.atguigu.common.valid</code>åŒ…ä¸‹æ–°å»º<code>ListValueConstraintValidator</code>ç±»ï¼Œå®ç°<code>ConstraintValidator</code>æ¥å£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>common<span class="token punctuation">.</span>valid</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">ConstraintValidator</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">ConstraintValidatorContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashSet</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Set</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/7
 * @Description:
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ListValueConstraintValidator</span> <span class="token keyword">implements</span> <span class="token class-name">ConstraintValidator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ListValue</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * åˆå§‹åŒ–ä¿¡æ¯
     * å¯ä»¥è·å–æ³¨è§£çš„è¯¦ç»†ä¿¡æ¯
     * <span class="token keyword">@param</span> <span class="token parameter">constraintAnnotation</span>
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token class-name">ListValue</span> constraintAnnotation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//@ListValueæ³¨è§£ä¸­ vals å±æ€§çš„å€¼</span>
        <span class="token comment">//å€¼å¿…é¡»ä¸ºè¿™å‡ ä¸ªä¸­çš„ä¸€ä¸ª</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> vals <span class="token operator">=</span> constraintAnnotation<span class="token punctuation">.</span><span class="token function">vals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> val <span class="token operator">:</span> vals<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * åˆ¤æ–­æ˜¯å¦æ ¡éªŒæˆåŠŸ
     * <span class="token keyword">@param</span> <span class="token parameter">value</span>
     * <span class="token keyword">@param</span> <span class="token parameter">context</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isValid</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> value<span class="token punctuation">,</span> <span class="token class-name">ConstraintValidatorContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">return</span> set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.13.4.3.png" alt="image-20220507222417417" tabindex="0" loading="lazy"><figcaption>image-20220507222417417</figcaption></figure><h5 id="_5ã€æŒ‡å®šæ ¡éªŒå™¨" tabindex="-1"><a class="header-anchor" href="#_5ã€æŒ‡å®šæ ¡éªŒå™¨" aria-hidden="true">#</a> 5ã€æŒ‡å®šæ ¡éªŒå™¨</h5><p>å¯ä»¥æŒ‡å®šå¤šä¸ªæ ¡éªŒå™¨ï¼Œèƒ½å¤Ÿæ ¹æ®æ³›å‹è‡ªåŠ¨åŒ¹é…æ­£ç¡®çš„æ ¡éªŒå™¨</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.13.5.png" alt="image-20220507222719730" tabindex="0" loading="lazy"><figcaption>image-20220507222719730</figcaption></figure><h5 id="_6ã€ä½¿ç”¨è¯¥æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_6ã€ä½¿ç”¨è¯¥æ³¨è§£" aria-hidden="true">#</a> 6ã€ä½¿ç”¨è¯¥æ³¨è§£</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.entity.BrandEntity</code>ç±»çš„<code>showStatus</code>å­—æ®µä¸Šä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>groups <span class="token operator">=</span> <span class="token class-name">AddGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ListValue</span><span class="token punctuation">(</span>vals <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">AddGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token class-name">UpdateGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.13.6.png" alt="image-20220507225522195" tabindex="0" loading="lazy"><figcaption>image-20220507225522195</figcaption></figure><h5 id="_7ã€æµ‹è¯•-3" tabindex="-1"><a class="header-anchor" href="#_7ã€æµ‹è¯•-3" aria-hidden="true">#</a> 7ã€æµ‹è¯•</h5><p>é‡å¯<code>gulimall-product</code>æ¨¡å—</p><h6 id="_1ã€å¤šäº†ä¸¤ä¸ªåŒå¼•å·" tabindex="-1"><a class="header-anchor" href="#_1ã€å¤šäº†ä¸¤ä¸ªåŒå¼•å·" aria-hidden="true">#</a> 1ã€å¤šäº†ä¸¤ä¸ªåŒå¼•å·</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.13.7.1.png" alt="image-20220507223836326" tabindex="0" loading="lazy"><figcaption>image-20220507223836326</figcaption></figure><h6 id="_2ã€å»æ‰åŒå¼•å·" tabindex="-1"><a class="header-anchor" href="#_2ã€å»æ‰åŒå¼•å·" aria-hidden="true">#</a> 2ã€å»æ‰åŒå¼•å·</h6><p>å»æ‰åŒå¼•å·åé‡å¯<code>gulimall-product</code>æ¨¡å—</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.13.7.2.png" alt="image-20220507223924267" tabindex="0" loading="lazy"><figcaption>image-20220507223924267</figcaption></figure><h6 id="_3ã€é‡æ–°æµ‹è¯•-1" tabindex="-1"><a class="header-anchor" href="#_3ã€é‡æ–°æµ‹è¯•-1" aria-hidden="true">#</a> 3ã€é‡æ–°æµ‹è¯•</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.2.7.13.7.3.png" alt="image-20220507224020853" tabindex="0" loading="lazy"><figcaption>image-20220507224020853</figcaption></figure><h3 id="_4-2-8ã€æ ¡éªŒæ³¨è§£æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#_4-2-8ã€æ ¡éªŒæ³¨è§£æ€»ç»“" aria-hidden="true">#</a> 4.2.8ã€æ ¡éªŒæ³¨è§£æ€»ç»“</h3><h4 id="_1-mavenä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_1-mavenä¾èµ–" aria-hidden="true">#</a> 1 Mavenä¾èµ–</h4><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--ç¬¬ä¸€ç§æ–¹å¼å¯¼å…¥æ ¡éªŒä¾èµ–--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>javax.validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>validation-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.1.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--ç¬¬äºŒç§æ–¹å¼å¯¼å…¥æ ¡éªŒä¾èµ–--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.hibernate.validator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hibernate-validator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-å€¼æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#_2-å€¼æ ¡éªŒ" aria-hidden="true">#</a> 2 å€¼æ ¡éªŒ</h4><h5 id="_2-1-nullæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_2-1-nullæ³¨è§£" aria-hidden="true">#</a> 2.1 @Nullæ³¨è§£</h5><p>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ºnull</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Null</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»ä¸ºnull&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-2-notnullæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_2-2-notnullæ³¨è§£" aria-hidden="true">#</a> 2.2 @NotNullæ³¨è§£</h5><p>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ä¸ºnull</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»ä¸ä¸ºnull&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-3-notblankæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_2-3-notblankæ³¨è§£" aria-hidden="true">#</a> 2.3 @NotBlankæ³¨è§£</h5><p>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼ä¸ä¸ºç©ºï¼ˆä¸ä¸ºnullã€å»é™¤é¦–ä½ç©ºæ ¼åé•¿åº¦ä¸º0ï¼‰ ï¼Œå¹¶ä¸”ç±»å‹ä¸ºStringã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»ä¸ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-4-notemptyæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_2-4-notemptyæ³¨è§£" aria-hidden="true">#</a> 2.4 @NotEmptyæ³¨è§£</h5><p>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼ä¸ä¸ºnullä¸”ä¸ä¸ºç©ºï¼ˆå­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º0ã€é›†åˆå¤§å°ä¸ä¸º0ï¼‰ ï¼Œå¹¶ä¸”ç±»å‹ä¸ºStringã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@NotEmpty</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»ä¸ä¸ºnullä¸”ä¸ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-5-asserttrueæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_2-5-asserttrueæ³¨è§£" aria-hidden="true">#</a> 2.5 @AssertTrueæ³¨è§£</h5><p>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ºtrueï¼Œå¹¶ä¸”ç±»å‹ä¸ºbooleanã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@AssertTrue</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»ä¸ºtrue&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token keyword">boolean</span> status<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-6-assertfalseæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_2-6-assertfalseæ³¨è§£" aria-hidden="true">#</a> 2.6 @AssertFalseæ³¨è§£</h5><p>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ºfalseï¼Œå¹¶ä¸”ç±»å‹ä¸ºbooleanã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@AssertFalse</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»ä¸ºfalse&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token keyword">boolean</span> status<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-èŒƒå›´æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#_3-èŒƒå›´æ ¡éªŒ" aria-hidden="true">#</a> 3 èŒƒå›´æ ¡éªŒ</h4><h5 id="_3-1-minæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_3-1-minæ³¨è§£" aria-hidden="true">#</a> 3.1 @Minæ³¨è§£</h5><p>è¢«æ³¨è§£çš„å…ƒç´ å…¶å€¼å¿…é¡»å¤§äºç­‰äºæœ€å°å€¼ï¼Œå¹¶ä¸”ç±»å‹ä¸ºintï¼Œlongï¼Œfloatï¼Œdoubleã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Min</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»å¤§äºç­‰äº18&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-2-maxæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_3-2-maxæ³¨è§£" aria-hidden="true">#</a> 3.2 @Maxæ³¨è§£</h5><p>è¢«æ³¨è§£çš„å…ƒç´ å…¶å€¼å¿…é¡»å°äºç­‰äºæœ€å°å€¼ï¼Œå¹¶ä¸”ç±»å‹ä¸ºintï¼Œlongï¼Œfloatï¼Œdoubleã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Max</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»å°äºç­‰äº18&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-3-decimalminæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_3-3-decimalminæ³¨è§£" aria-hidden="true">#</a> 3.3 @DecimalMinæ³¨è§£</h5><p>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼å¤§äºç­‰äº@DecimalMinæŒ‡å®šçš„valueå€¼ï¼Œå¹¶ä¸”ç±»å‹ä¸ºBigDecimalã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@DecimalMin</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;150&quot;</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»å¤§äºç­‰äº150&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> height<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-4-decimalmaxæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_3-4-decimalmaxæ³¨è§£" aria-hidden="true">#</a> 3.4 @DecimalMaxæ³¨è§£</h5><p>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼å°äºç­‰äº@DecimalMaxæŒ‡å®šçš„valueå€¼ ï¼Œå¹¶ä¸”ç±»å‹ä¸ºBigDecimalã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@DecimalMax</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;300&quot;</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»å¤§äºç­‰äº300&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> height<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-5-rangeæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_3-5-rangeæ³¨è§£" aria-hidden="true">#</a> 3.5 @Rangeæ³¨è§£</h5><p>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼åœ¨æœ€å°å€¼å’Œæœ€å¤§å€¼ä¹‹é—´ï¼Œå¹¶ä¸”ç±»å‹ä¸ºBigDecimalï¼ŒBigIntegerï¼ŒCharSequenceï¼Œbyteï¼Œshortï¼Œintï¼Œlongã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Range</span><span class="token punctuation">(</span>max <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">,</span> min <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»å¤§äºç­‰äº18ä¸”å°äºç­‰äº80&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-6-pastæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_3-6-pastæ³¨è§£" aria-hidden="true">#</a> 3.6 @Pastæ³¨è§£</h5><p>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ºè¿‡å»çš„ä¸€ä¸ªæ—¶é—´ï¼Œå¹¶ä¸”ç±»å‹ä¸ºjava.util.Dateã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@DateTimeFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Past</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»ä¸ºè¿‡å»çš„æ—¶é—´&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Date</span> createDate<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-7-futureæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_3-7-futureæ³¨è§£" aria-hidden="true">#</a> 3.7 @Futureæ³¨è§£</h5><p>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ºæœªæ¥çš„ä¸€ä¸ªæ—¶é—´ï¼Œå¹¶ä¸”ç±»å‹ä¸ºjava.util.Dateã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@DateTimeFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Future</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»ä¸ºæœªæ¥çš„æ—¶é—´&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Date</span> createDate<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-é•¿åº¦æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#_4-é•¿åº¦æ ¡éªŒ" aria-hidden="true">#</a> 4 é•¿åº¦æ ¡éªŒ</h4><h5 id="_4-1-sizeæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_4-1-sizeæ³¨è§£" aria-hidden="true">#</a> 4.1 @Sizeæ³¨è§£</h5><p>è¢«æ³¨è§£çš„å…ƒç´ çš„é•¿åº¦å¿…é¡»åœ¨æŒ‡å®šèŒƒå›´å†…ï¼Œå¹¶ä¸”ç±»å‹ä¸ºStringï¼ŒArrayï¼ŒListï¼ŒMapã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>max <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">,</span> min <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;é•¿åº¦å¿…é¡»å¤§äºç­‰äº7æˆ–å°äºç­‰äº11&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> mobile<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_4-2-lengthæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_4-2-lengthæ³¨è§£" aria-hidden="true">#</a> 4.2 @Lengthæ³¨è§£</h5><p>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼é•¿åº¦åœ¨minå’ŒmaxåŒºé—´å†… ï¼Œå¹¶ä¸”ç±»å‹ä¸ºStringã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Length</span><span class="token punctuation">(</span>max <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">,</span> min <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;é•¿åº¦å¿…é¡»å¤§äºç­‰äº7æˆ–å°äºç­‰äº11&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> mobile<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-æ ¼å¼æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#_5-æ ¼å¼æ ¡éªŒ" aria-hidden="true">#</a> 5 æ ¼å¼æ ¡éªŒ</h4><h5 id="_5-1-digitsæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_5-1-digitsæ³¨è§£" aria-hidden="true">#</a> 5.1 @Digitsæ³¨è§£</h5><p>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼çš„æ•´æ•°ä½æ•°å’Œå°æ•°ä½æ•°ä¸Šé™ ï¼Œå¹¶ä¸”ç±»å‹ä¸ºfloatï¼Œdoubleï¼ŒBigDecimalã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Digits</span><span class="token punctuation">(</span>integer<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>fraction <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;æ•´æ•°ä½ä¸Šé™ä¸º3ä½ï¼Œå°æ•°ä½ä¸Šé™ä¸º2ä½&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> height<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_5-2-patternæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_5-2-patternæ³¨è§£" aria-hidden="true">#</a> 5.2 @Patternæ³¨è§£</h5><p>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶ä¸”ç±»å‹ä¸ºStringã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Pattern</span><span class="token punctuation">(</span>regexp <span class="token operator">=</span> <span class="token string">&quot;\\\\d{11}&quot;</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»ä¸ºæ•°å­—ï¼Œå¹¶ä¸”é•¿åº¦ä¸º11&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> mobile<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_5-3-emailæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_5-3-emailæ³¨è§£" aria-hidden="true">#</a> 5.3 @Emailæ³¨è§£</h5><p>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼æ˜¯Emailï¼Œä¹Ÿå¯ä»¥é€šè¿‡regexpå’ŒflagæŒ‡å®šè‡ªå®šä¹‰çš„emailæ ¼å¼ï¼Œç±»å‹ä¸ºStringã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token annotation punctuation">@Email</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å¿…é¡»æ˜¯é‚®ç®±&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-3ã€å•†å“æœåŠ¡-api-å±æ€§åˆ†ç»„" tabindex="-1"><a class="header-anchor" href="#_4-3ã€å•†å“æœåŠ¡-api-å±æ€§åˆ†ç»„" aria-hidden="true">#</a> 4.3ã€å•†å“æœåŠ¡-API-å±æ€§åˆ†ç»„</h2><h3 id="_4-3-1ã€å‰ç«¯ç»„ä»¶å¯¼å…¥" tabindex="-1"><a class="header-anchor" href="#_4-3-1ã€å‰ç«¯ç»„ä»¶å¯¼å…¥" aria-hidden="true">#</a> 4.3.1ã€å‰ç«¯ç»„ä»¶å¯¼å…¥</h3><h4 id="_1ã€å¯¼å…¥æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_1ã€å¯¼å…¥æ•°æ®" aria-hidden="true">#</a> 1ã€å¯¼å…¥æ•°æ®</h4><h5 id="_1ã€æ‰§è¡Œsqlè¯­å¥" tabindex="-1"><a class="header-anchor" href="#_1ã€æ‰§è¡Œsqlè¯­å¥" aria-hidden="true">#</a> 1ã€æ‰§è¡Œsqlè¯­å¥</h5><p>æ‰“å¼€<code>1.åˆ†å¸ƒå¼åŸºç¡€ï¼ˆå…¨æ ˆå¼€å‘ç¯‡ï¼‰\\èµ„æ–™æºç .zip\\docs\\ä»£ç \\sql</code>æ–‡ä»¶å¤¹ä¸‹çš„<code>sys_menus.sql</code>ï¼Œå…¨é€‰å¤åˆ¶</p><p>ç‚¹å‡»<code>gulimall_admin</code>ç„¶åå³é”®é€‰æ‹©<code>å‘½ä»¤è¡Œç•Œé¢</code> ï¼Œç²˜è´´åˆ°é‡Œé¢ï¼Œå›è½¦æ‰§è¡Œsqlè¯­å¥</p><p>(ä¸è¦ç‚¹å‡»<code>è¿è¡ŒSQLæ–‡ä»¶</code>,è¿™æ ·ä¼šæœ‰ä¸­æ–‡ä¹±ç é—®é¢˜)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.1.1.1.png" alt="image-20220508090404565" tabindex="0" loading="lazy"><figcaption>image-20220508090404565</figcaption></figure><h5 id="_2ã€æŸ¥çœ‹ç»“æœ" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹ç»“æœ" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹ç»“æœ</h5><p>url: http://localhost:8001/#/product-brand</p><p>åˆ·æ–°å‰ç«¯é¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ°è¿™äº›ç³»ç»Ÿå·²ç»æ˜¾ç¤ºå‡ºæ¥äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.1.1.2.png" alt="image-20220508091348831" tabindex="0" loading="lazy"><figcaption>image-20220508091348831</figcaption></figure><h4 id="_2ã€æ–°å»ºæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å»ºæ–‡ä»¶" aria-hidden="true">#</a> 2ã€æ–°å»ºæ–‡ä»¶</h4><h5 id="_1ã€æ–°å»ºcategory-vueæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_1ã€æ–°å»ºcategory-vueæ–‡ä»¶" aria-hidden="true">#</a> 1ã€æ–°å»º<code>category.vue</code>æ–‡ä»¶</h5><p>åœ¨<code>src\\views\\modules</code>æ–‡ä»¶å¤¹é‡Œæ–°å»º<code>common</code>æ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜å‚¨å…¬å…±ç»„ä»¶</p><p>åœ¨<code>src\\views\\modules</code>æ–‡ä»¶å¤¹ä¸‹çš„<code>common</code>æ–‡ä»¶å¤¹é‡Œæ–°å»º<code>category.vue</code>æ–‡ä»¶,è¾“å…¥vueç”Ÿæˆæ¨¡æ¿</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.1.2.1.png" alt="image-20220508092805251" tabindex="0" loading="lazy"><figcaption>image-20220508092805251</figcaption></figure><h5 id="_2ã€æ–°å»ºattrgroup-vueæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å»ºattrgroup-vueæ–‡ä»¶" aria-hidden="true">#</a> 2ã€æ–°å»º<code>attrgroup.vue</code>æ–‡ä»¶</h5><h6 id="_1ã€æŸ¥çœ‹ä½ç½®" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹ä½ç½®" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹ä½ç½®</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.1.2.2.1.png" alt="image-20220508092955297" tabindex="0" loading="lazy"><figcaption>image-20220508092955297</figcaption></figure><h6 id="_2ã€æ–°å»ºattrgroup-vueæ–‡ä»¶-1" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å»ºattrgroup-vueæ–‡ä»¶-1" aria-hidden="true">#</a> 2ã€æ–°å»º<code>attrgroup.vue</code>æ–‡ä»¶</h6><p>åœ¨<code>src\\views\\modules</code>æ–‡ä»¶å¤¹ä¸‹çš„<code>product</code>æ–‡ä»¶å¤¹é‡Œæ–°å»º<code>attrgroup.vue</code>æ–‡ä»¶,è¾“å…¥vueç”Ÿæˆæ¨¡æ¿</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.1.2.2.2.png" alt="image-20220508095359481" tabindex="0" loading="lazy"><figcaption>image-20220508095359481</figcaption></figure><h4 id="_3ã€æ·»åŠ ä»£ç " tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ ä»£ç " aria-hidden="true">#</a> 3ã€æ·»åŠ ä»£ç </h4><h5 id="_1ã€æ·»åŠ category-vueä»£ç " tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ category-vueä»£ç " aria-hidden="true">#</a> 1ã€æ·»åŠ <code>category.vue</code>ä»£ç </h5><p>ä¿®æ”¹<code>src\\views\\modules\\common\\category.vue</code>æ–‡ä»¶ï¼Œ<a href="code/4.3.1.3.1.category.vue">ç‚¹å‡»æŸ¥çœ‹<code>category.vue</code>å®Œæ•´ä»£ç </a></p><h5 id="_2ã€æ·»åŠ attrgroup-vueä»£ç " tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ attrgroup-vueä»£ç " aria-hidden="true">#</a> 2ã€æ·»åŠ <code>attrgroup.vue</code>ä»£ç </h5>`,289),wa=a("code",null,"element-ui",-1),xa=a("strong",null,"Layout å¸ƒå±€",-1),_a=a("strong",null,"åˆ†æ é—´éš”",-1),za={href:"https://element.eleme.io/#/zh-CN/component/layout",target:"_blank",rel:"noopener noreferrer"},qa=e('<p>å¼•å…¥ç»„ä»¶æ­¥éª¤ï¼š</p><ol><li>import Category from &quot;../common/category.vue&quot;; æŠŠç»„ä»¶å¯¼è¿›æ¥</li><li>components: { Category:Category }, æŒ‡æ˜éœ€è¦çš„ç»„ä»¶</li><li><code>&lt;category&gt;&lt;/category&gt;</code> ä½¿ç”¨è¯¥æ ‡ç­¾</li></ol><p>ä¿®æ”¹<code>src\\views\\modules\\product\\attrgroup.vue</code>æ–‡ä»¶ï¼Œ<a href="code/4.3.1.3.2.attrgroup.vue">ç‚¹å‡»æŸ¥çœ‹<code>attrgroup.vue</code>å®Œæ•´å†…å®¹</a></p><h5 id="_3ã€ç»“æ„å·²ç»å‡ºæ¥äº†" tabindex="-1"><a class="header-anchor" href="#_3ã€ç»“æ„å·²ç»å‡ºæ¥äº†" aria-hidden="true">#</a> 3ã€ç»“æ„å·²ç»å‡ºæ¥äº†</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.1.3.3.png" alt="image-20220508100902403" tabindex="0" loading="lazy"><figcaption>image-20220508100902403</figcaption></figure><h5 id="_4ã€æ·»åŠ è¡¨æ ¼" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ è¡¨æ ¼" aria-hidden="true">#</a> 4ã€æ·»åŠ è¡¨æ ¼</h5><p>å°†<code>&lt;div&gt;</code>æ ‡ç­¾é‡Œé¢çš„å†…å®¹æ›¿æ¢æ‰&quot;è¡¨æ ¼&quot;</p><p>ç„¶åæŠŠå…¶ä»–é™¤<code>&lt;template&gt;</code>æ ‡ç­¾é‡Œçš„å†…å®¹ä¸<code>attrgroup.vue</code>é‡Œé¢çš„å†…å®¹åˆå¹¶</p><p><a href="code/4.3.1.3.4.attrgroup.vue">ç‚¹å‡»æŸ¥çœ‹<code>attrgroup.vue</code>å®Œæ•´ä»£ç </a></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.1.3.4.png" alt="image-20220508101443870" tabindex="0" loading="lazy"><figcaption>image-20220508101443870</figcaption></figure><h5 id="_5ã€å¼•å…¥attrgroup-add-or-update-vueæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_5ã€å¼•å…¥attrgroup-add-or-update-vueæ–‡ä»¶" aria-hidden="true">#</a> 5ã€å¼•å…¥<code>attrgroup-add-or-update.vue</code>æ–‡ä»¶</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.1.3.5.png" alt="image-20220508103547839" tabindex="0" loading="lazy"><figcaption>image-20220508103547839</figcaption></figure><h5 id="_6ã€æ•ˆæœ" tabindex="-1"><a class="header-anchor" href="#_6ã€æ•ˆæœ" aria-hidden="true">#</a> 6ã€æ•ˆæœ</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.1.3.6.png" alt="image-20220508104040518" tabindex="0" loading="lazy"><figcaption>image-20220508104040518</figcaption></figure><h4 id="_4ã€å®Œæ•´ä»£ç " tabindex="-1"><a class="header-anchor" href="#_4ã€å®Œæ•´ä»£ç " aria-hidden="true">#</a> 4ã€å®Œæ•´ä»£ç </h4><h5 id="_1ã€category-vue" tabindex="-1"><a class="header-anchor" href="#_1ã€category-vue" aria-hidden="true">#</a> 1ã€<code>category.vue</code></h5><p><a href="code/4.3.1.4.1.category.vue">ç‚¹å‡»æŸ¥çœ‹<code>category.vue</code>å®Œæ•´ä»£ç </a></p><h5 id="_2ã€attrgroup-vue" tabindex="-1"><a class="header-anchor" href="#_2ã€attrgroup-vue" aria-hidden="true">#</a> 2ã€<code>attrgroup.vue</code></h5><p><a href="code/4.3.1.4.2.attrgroup.vue">ç‚¹å‡»æŸ¥çœ‹<code>attrgroup.vue</code>å®Œæ•´ä»£ç </a></p><h3 id="_4-3-2ã€çˆ¶å­ç»„ä»¶äº¤äº’" tabindex="-1"><a class="header-anchor" href="#_4-3-2ã€çˆ¶å­ç»„ä»¶äº¤äº’" aria-hidden="true">#</a> 4.3.2ã€çˆ¶å­ç»„ä»¶äº¤äº’</h3><h4 id="_1ã€å‘é€æ¶ˆæ¯" tabindex="-1"><a class="header-anchor" href="#_1ã€å‘é€æ¶ˆæ¯" aria-hidden="true">#</a> 1ã€å‘é€æ¶ˆæ¯</h4><h5 id="_1ã€ç»‘å®šäº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#_1ã€ç»‘å®šäº‹ä»¶" aria-hidden="true">#</a> 1ã€ç»‘å®šäº‹ä»¶</h5>',22),Sa=a("strong",null,"Treeæ ‘å½¢æ§ä»¶",-1),Ia=a("strong",null,"Events",-1),Ea={href:"https://element.eleme.io/#/zh-CN/component/tree",target:"_blank",rel:"noopener noreferrer"},ja=e(`<table><thead><tr><th style="text-align:left;">äº‹ä»¶åç§°</th><th style="text-align:left;">è¯´æ˜</th><th style="text-align:left;">å›è°ƒå‚æ•°</th></tr></thead><tbody><tr><td style="text-align:left;">node-click</td><td style="text-align:left;">èŠ‚ç‚¹è¢«ç‚¹å‡»æ—¶çš„å›è°ƒ</td><td style="text-align:left;">å…±ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºï¼šä¼ é€’ç»™ <code>data</code> å±æ€§çš„æ•°ç»„ä¸­è¯¥èŠ‚ç‚¹æ‰€å¯¹åº”çš„å¯¹è±¡ã€èŠ‚ç‚¹å¯¹åº”çš„ Nodeã€èŠ‚ç‚¹ç»„ä»¶æœ¬èº«ã€‚</td></tr></tbody></table><p>åœ¨<code>src\\views\\modules\\common\\category.vue</code>æ–‡ä»¶çš„<code>el-tree</code>æ ‡ç­¾å†…æ·»åŠ å±æ€§</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>@node-click=&quot;nodeClick&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_2ã€æ·»åŠ æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ æ–¹æ³•" aria-hidden="true">#</a> 2ã€æ·»åŠ æ–¹æ³•</h5><p>åœ¨<code>src\\views\\modules\\common\\category.vue</code>æ–‡ä»¶çš„<code>methods</code>é‡Œé¢æ·»åŠ æ–¹æ³•</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">nodeClick</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span>node<span class="token punctuation">,</span>component</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;å­ç»„ä»¶çš„categoryé‡Œçš„èŠ‚ç‚¹è¢«ç‚¹å‡»ï¼š&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">,</span>node<span class="token punctuation">,</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//å‘çˆ¶ç»„ä»¶å‘é€äº‹ä»¶</span>
  <span class="token comment">//ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºäº‹ä»¶çš„åç§°,åé¢çš„éƒ½ä¸ºå‘é€çš„æ•°æ®</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;tree-node-click&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">,</span>node<span class="token punctuation">,</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2ã€æ¥æ”¶äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#_2ã€æ¥æ”¶äº‹ä»¶" aria-hidden="true">#</a> 2ã€æ¥æ”¶äº‹ä»¶</h4><h5 id="_1ã€æ·»åŠ äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ äº‹ä»¶" aria-hidden="true">#</a> 1ã€æ·»åŠ äº‹ä»¶</h5><p>åœ¨<code>src\\views\\modules\\product\\attrgroup.vue</code>æ–‡ä»¶ä¸­çš„<code>category</code>æ ‡ç­¾é‡Œæ·»åŠ å±æ€§</p><p>æ ¼å¼ï¼š @äº‹ä»¶åç§°=â€çˆ¶ç»„ä»¶æ–¹æ³•â€œ</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>@tree-node-click=&quot;treeNodeClick&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.2.2.1.png" alt="image-20220508111126728" tabindex="0" loading="lazy"><figcaption>image-20220508111126728</figcaption></figure><h5 id="_2ã€æ·»åŠ æ–¹æ³•-1" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ æ–¹æ³•-1" aria-hidden="true">#</a> 2ã€æ·»åŠ æ–¹æ³•</h5><p>åœ¨<code>src\\views\\modules\\product\\attrgroup.vue</code>æ–‡ä»¶ä¸­çš„<code>methods</code>é‡Œé¢æ·»åŠ æ–¹æ³•</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//å‚æ•°ä¸ºå­ç»„ä»¶ä¼ é€’çš„å‚æ•°</span>
<span class="token function">treeNodeClick</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span>node<span class="token punctuation">,</span>component</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;çˆ¶ç»„ä»¶attrgroupæ„ŸçŸ¥åˆ°å­ç»„ä»¶categoryçš„èŠ‚ç‚¹è¢«ç‚¹å‡»ï¼š&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">,</span>node<span class="token punctuation">,</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;è¢«ç‚¹å‡»çš„èŠ‚ç‚¹åï¼š&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3ã€æŸ¥çœ‹æ•ˆæœ" tabindex="-1"><a class="header-anchor" href="#_3ã€æŸ¥çœ‹æ•ˆæœ" aria-hidden="true">#</a> 3ã€æŸ¥çœ‹æ•ˆæœ</h4><p>ç‚¹å‡»&quot;æ•°ç ç›¸æœº&quot;,å¯ä»¥çœ‹åˆ°çˆ¶ç»„ä»¶attrgroupå·²ç»æ„ŸçŸ¥åˆ°å­ç»„ä»¶categoryçš„èŠ‚ç‚¹è¢«ç‚¹å‡»äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.2.3.png" alt="image-20220508112504211" tabindex="0" loading="lazy"><figcaption>image-20220508112504211</figcaption></figure><h3 id="_4-3-3ã€è·å–åˆ†ç±»å±æ€§åˆ†ç»„" tabindex="-1"><a class="header-anchor" href="#_4-3-3ã€è·å–åˆ†ç±»å±æ€§åˆ†ç»„" aria-hidden="true">#</a> 4.3.3ã€è·å–åˆ†ç±»å±æ€§åˆ†ç»„</h3><h4 id="_1ã€åç«¯" tabindex="-1"><a class="header-anchor" href="#_1ã€åç«¯" aria-hidden="true">#</a> 1ã€åç«¯</h4><h5 id="_1ã€æ›´æ”¹listæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€æ›´æ”¹listæ–¹æ³•" aria-hidden="true">#</a> 1ã€æ›´æ”¹<code>list</code>æ–¹æ³•</h5><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—ä¸‹<code>com.atguigu.gulimall.product.service.impl.AttrGroupServiceImpl</code>ç±»çš„<code>list</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/list/{catelogId}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">,</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;catelogId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> catelogId<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//PageUtils page = attrGroupService.queryPage(params);</span>
    <span class="token class-name">PageUtils</span> page <span class="token operator">=</span> attrGroupService<span class="token punctuation">.</span><span class="token function">queryPage</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span>catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">,</span> page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>alt+enter</code>åœ¨æç¤ºé‡Œé¢é€‰ç¬¬äºŒä¸ª<code>Create method</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.3.1.1.png" alt="image-20220508165717823" tabindex="0" loading="lazy"><figcaption>image-20220508165717823</figcaption></figure><h5 id="_2ã€æ·»åŠ æŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ æŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 2ã€æ·»åŠ æŠ½è±¡æ–¹æ³•</h5><p><code>com.atguigu.gulimall.product.service</code>åŒ…ä¸‹çš„<code>AttrGroupService</code>æ¥å£æ·»åŠ æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">PageUtils</span> <span class="token function">queryPage</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">,</span> <span class="token class-name">Long</span> catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_3ã€æ·»åŠ å®ç°ç±»" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ å®ç°ç±»" aria-hidden="true">#</a> 3ã€æ·»åŠ å®ç°ç±»</h5><p><code>com.atguigu.gulimall.product.service.impl</code>åŒ…ä¸‹çš„<code>AttrGroupServiceImpl</code>ç±»æ·»åŠ å®ç°æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">queryPage</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">,</span> <span class="token class-name">Long</span> catelogId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>catelogId <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">queryPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//select * from attr_group where catelogId = ? and ( attr_group_id = key or attr_group_name like %key%)</span>
        <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span> queryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getCatelogId</span><span class="token punctuation">,</span>catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            queryWrapper<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span>
                obj<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getAttrGroupId</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getAttrGroupName</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span>queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_4ã€æµ‹è¯•-3" tabindex="-1"><a class="header-anchor" href="#_4ã€æµ‹è¯•-3" aria-hidden="true">#</a> 4ã€æµ‹è¯•</h5><p>ä½¿ç”¨Postmanæµ‹è¯•</p><p>url: http://localhost:88/api/product/attrgroup/list/1?page=1&amp;key=aa</p><p>é€‰æ‹©<strong>get</strong>æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.3.1.4.1.png" alt="image-20220508165944731" tabindex="0" loading="lazy"><figcaption>image-20220508165944731</figcaption></figure><p>å¯ä»¥çœ‹åˆ°å·²æ­£ç¡®æ‰“å°sqlè¯­å¥</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.3.1.4.2.png" alt="image-20220508165149621" tabindex="0" loading="lazy"><figcaption>image-20220508165149621</figcaption></figure><h4 id="_2ã€å‰ç«¯" tabindex="-1"><a class="header-anchor" href="#_2ã€å‰ç«¯" aria-hidden="true">#</a> 2ã€å‰ç«¯</h4><h5 id="_1ã€ä¿®æ”¹treenodeclickæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿®æ”¹treenodeclickæ–¹æ³•" aria-hidden="true">#</a> 1ã€ä¿®æ”¹<code>treeNodeClick</code>æ–¹æ³•</h5><p>ä¿®æ”¹<code>src\\views\\modules\\product\\attrgroup.vue</code>çš„<code>treeNodeClic</code>æ–¹æ³•ï¼Œä¸ºç¬¬ä¸‰çº§æ—¶æŸ¥è¯¢è¯¥catelogIdçš„ä¿¡æ¯</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//å‚æ•°ä¸ºå­ç»„ä»¶ä¼ é€’çš„å‚æ•°</span>
<span class="token function">treeNodeClick</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span>node<span class="token punctuation">,</span>component</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;çˆ¶ç»„ä»¶attrgroupæ„ŸçŸ¥åˆ°å­ç»„ä»¶categoryçš„èŠ‚ç‚¹è¢«ç‚¹å‡»ï¼š&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">,</span>node<span class="token punctuation">,</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;è¢«ç‚¹å‡»çš„èŠ‚ç‚¹åï¼š&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token comment">//ä¸ºç¬¬ä¸‰çº§æ—¶æŸ¥è¯¢è¯¥catelogIdçš„ä¿¡æ¯</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>level<span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>catelogId <span class="token operator">=</span> data<span class="token punctuation">.</span>catId<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2ã€æ·»åŠ catelogidå­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ catelogidå­—æ®µ" aria-hidden="true">#</a> 2ã€æ·»åŠ <code>catelogId</code>å­—æ®µ</h5><p>åœ¨<code>data</code>é‡Œçš„<code>return</code>é‡Œæ·»åŠ <code>catelogId</code>æ•°æ®å­—æ®µ</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>catelogId : 0,
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_3ã€ä¿®æ”¹url" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹url" aria-hidden="true">#</a> 3ã€ä¿®æ”¹url</h5><p>ä¿®æ”¹<code>getDataList</code>æ–¹æ³•é‡Œé¢ä¼ é€’çš„url</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>url: this.$http.adornUrl(\`/product/attrgroup/list/\${this.catelogId}\`),
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_3ã€æµ‹è¯•-1" tabindex="-1"><a class="header-anchor" href="#_3ã€æµ‹è¯•-1" aria-hidden="true">#</a> 3ã€æµ‹è¯•</h4><h5 id="_1ã€æŸ¥è¯¢å…¨éƒ¨" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥è¯¢å…¨éƒ¨" aria-hidden="true">#</a> 1ã€æŸ¥è¯¢å…¨éƒ¨</h5><p>ç‚¹å‡» æ‰‹æœº--&gt;æ‰‹æœºé€šè®¯--&gt;æ‰‹æœº ,æ‰€æœ‰æ•°æ®éƒ½æŸ¥è¯¢å‡ºæ¥äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.3.3.1.png" alt="image-20220508173023284" tabindex="0" loading="lazy"><figcaption>image-20220508173023284</figcaption></figure><h5 id="_2ã€æ ¹æ®idæŸ¥" tabindex="-1"><a class="header-anchor" href="#_2ã€æ ¹æ®idæŸ¥" aria-hidden="true">#</a> 2ã€æ ¹æ®idæŸ¥</h5><p>è¾“å…¥<code>1</code>ç‚¹å‡»æŸ¥è¯¢</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.3.3.2.png" alt="image-20220508173218019" tabindex="0" loading="lazy"><figcaption>image-20220508173218019</figcaption></figure><h5 id="_3ã€æ ¹æ®ç»„åæŸ¥" tabindex="-1"><a class="header-anchor" href="#_3ã€æ ¹æ®ç»„åæŸ¥" aria-hidden="true">#</a> 3ã€æ ¹æ®ç»„åæŸ¥</h5><p>è¾“å…¥<code>åŸºæœ¬</code>ç‚¹å‡»æŸ¥è¯¢</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.3.3.3.png" alt="image-20220508173329517" tabindex="0" loading="lazy"><figcaption>image-20220508173329517</figcaption></figure><h3 id="_4-3-4ã€å±æ€§åˆ†ç»„æ–°å¢åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#_4-3-4ã€å±æ€§åˆ†ç»„æ–°å¢åŠŸèƒ½" aria-hidden="true">#</a> 4.3.4ã€å±æ€§åˆ†ç»„æ–°å¢åŠŸèƒ½</h3><h4 id="_1ã€æ·»åŠ çº§è”é€‰æ‹©å™¨" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ çº§è”é€‰æ‹©å™¨" aria-hidden="true">#</a> 1ã€æ·»åŠ çº§è”é€‰æ‹©å™¨</h4><p>åˆ‡æ¢åˆ°<code>src\\views\\modules\\product\\attrgroup-add-or-update.vue</code>æ–‡ä»¶</p><p>åœ¨<code>label=&quot;æ‰€å±åˆ†ç±»id&quot;</code>çš„<code>el-form-item </code>æ ‡ç­¾å†…ï¼Œåˆ é™¤<code>el-input</code>æ ‡ç­¾</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataForm.catelogId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ‰€å±åˆ†ç±»id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ·»åŠ <code>Cascaderçº§è”é€‰æ‹©å™¨</code></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-cascader</span>
  <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataForm.catelogId<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">:options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>categorys<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">:props</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>props<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-cascader</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2ã€æ·»åŠ å±æ€§" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ å±æ€§" aria-hidden="true">#</a> 2ã€æ·»åŠ å±æ€§</h4><p>åœ¨<code>data</code>é‡Œé¢çš„<code>return</code>é‡Œæ·»åŠ å±æ€§</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&#39;catId&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token string">&#39;children&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token literal-property property">categorys</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3ã€æ·»åŠ æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ æ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ æ–¹æ³•</h4><p>æ·»åŠ <code>getCategorys</code>æ–¹æ³•ï¼Œè·å–åˆ†ç±»æ•°æ®</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">getCategorys</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">adornUrl</span><span class="token punctuation">(</span><span class="token string">&quot;/product/category/list/tree&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>categorys <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4ã€è°ƒç”¨æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€è°ƒç”¨æ–¹æ³•" aria-hidden="true">#</a> 4ã€è°ƒç”¨æ–¹æ³•</h4><p>åœ¨åˆ›å»ºå®Œæˆï¼ˆå¯ä»¥è®¿é—®å½“å‰ this å®ä¾‹ï¼‰çš„æ—¶å€™è°ƒç”¨<code>getCategorys</code>æ–¹æ³•ï¼Œè·å–åˆ†ç±»æ•°æ®</p><p><code>created</code>æ–¹æ³•å†™åœ¨ä¸â€œ<strong>data</strong>&quot;å’Œâ€<strong>methods</strong>â€œåŒçº§çš„ä½ç½®</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCategorys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.4.png" alt="image-20220508200114324" tabindex="0" loading="lazy"><figcaption>image-20220508200114324</figcaption></figure><h4 id="_5ã€æµ‹è¯•-1" tabindex="-1"><a class="header-anchor" href="#_5ã€æµ‹è¯•-1" aria-hidden="true">#</a> 5ã€æµ‹è¯•</h4><h5 id="_1ã€æ§åˆ¶å°æŠ¥é”™" tabindex="-1"><a class="header-anchor" href="#_1ã€æ§åˆ¶å°æŠ¥é”™" aria-hidden="true">#</a> 1ã€æ§åˆ¶å°æŠ¥é”™</h5><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Invalid prop: type check failed for prop &quot;value&quot;. Expected Array, got String
æ— æ•ˆçš„å±æ€§ï¼šå±æ€§â€œvalueâ€çš„ç±»å‹æ£€æŸ¥å¤±è´¥ã€‚ é¢„æœŸæ•°ç»„ï¼Œå¾—åˆ°å­—ç¬¦ä¸²ã€‚
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.1.1.png" alt="image-20220508201217559" tabindex="0" loading="lazy"><figcaption>image-20220508201217559</figcaption></figure><p>æŠŠ<code>src\\views\\modules\\product</code>ä¸‹çš„<code>attrgroup-add-or-update.vue</code>é‡Œçš„</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>catelogId: &quot;&quot;,
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ”¹æˆ</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>catelogId: [],
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å°±è¡Œäº†ï¼Œç°åœ¨å·²ç»ä¸æŠ¥é”™äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.1.2.png" alt="image-20220509210341350" tabindex="0" loading="lazy"><figcaption>image-20220509210341350</figcaption></figure><h5 id="_2ã€æŸ¥çœ‹æ•°æ®-ä½†å¤šå‡ºä¸€çº§" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹æ•°æ®-ä½†å¤šå‡ºä¸€çº§" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹æ•°æ®ï¼Œä½†å¤šå‡ºä¸€çº§</h5><p>æ•°æ®å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†ï¼Œä½†æ˜¯åœ¨ç‚¹å‡»ç¬¬ä¸‰çº§åˆ†ç±»æ—¶ï¼Œåˆå‡ºæ¥äº†ä¸€çº§</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.2.1.png" alt="image-20220508200249772" tabindex="0" loading="lazy"><figcaption>image-20220508200249772</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.2.2.png" alt="image-20220508202500776" tabindex="0" loading="lazy"><figcaption>image-20220508202500776</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.2.3.png" alt="image-20220508202714332" tabindex="0" loading="lazy"><figcaption>image-20220508202714332</figcaption></figure><h5 id="_3ã€åç«¯æ·»åŠ æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_3ã€åç«¯æ·»åŠ æ³¨è§£" aria-hidden="true">#</a> 3ã€åç«¯æ·»åŠ æ³¨è§£</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.entity.CategoryEntity</code>æ–‡ä»¶é‡Œçš„<code>children</code>å­—æ®µä¸Šæ·»åŠ æ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span><span class="token class-name">JsonInclude<span class="token punctuation">.</span>Include</span><span class="token punctuation">.</span><span class="token constant">NON_EMPTY</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.3.png" alt="image-20220508203003106" tabindex="0" loading="lazy"><figcaption>image-20220508203003106</figcaption></figure><h5 id="_4ã€é‡æ–°æµ‹è¯•-1" tabindex="-1"><a class="header-anchor" href="#_4ã€é‡æ–°æµ‹è¯•-1" aria-hidden="true">#</a> 4ã€é‡æ–°æµ‹è¯•</h5><p>æ˜¾ç¤ºå·²ç»æˆåŠŸäº†ï¼Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.4.1.png" alt="image-20220509211116839" tabindex="0" loading="lazy"><figcaption>image-20220509211116839</figcaption></figure><p>ä¹Ÿæ²¡æœ‰<code>children</code>ä¸ºç©ºçš„å­—æ®µäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.4.2.png" alt="image-20220509211356536" tabindex="0" loading="lazy"><figcaption>image-20220509211356536</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.4.3.png" alt="image-20220509211717999" tabindex="0" loading="lazy"><figcaption>image-20220509211717999</figcaption></figure><h5 id="_5ã€æäº¤çš„catelogidä¸ºæ•°ç»„" tabindex="-1"><a class="header-anchor" href="#_5ã€æäº¤çš„catelogidä¸ºæ•°ç»„" aria-hidden="true">#</a> 5ã€æäº¤çš„<code>catelogId</code>ä¸ºæ•°ç»„</h5><p>æäº¤çš„<code>catelogId</code>ä¸ºæ•°ç»„ï¼Œè€Œæƒ³è¦çš„<code>catelogId</code>åªæ˜¯æœ€åä¸€çº§(ä¸ä¸€å®šæ˜¯ç¬¬ä¸‰çº§)åˆ†ç±»çš„id</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.4.png" alt="image-20220508204402893" tabindex="0" loading="lazy"><figcaption>image-20220508204402893</figcaption></figure><h5 id="_6ã€ä¿®æ”¹æäº¤çš„æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_6ã€ä¿®æ”¹æäº¤çš„æ•°æ®" aria-hidden="true">#</a> 6ã€ä¿®æ”¹æäº¤çš„æ•°æ®</h5><p>æŠŠ<code>src\\views\\modules\\product</code>ä¸‹çš„<code>attrgroup-add-or-update.vue</code>é‡Œçš„</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>catelogId: [],
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ”¹ä¸º</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>catelogIds: [],
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¹¶æ·»åŠ <code>catelogId</code>å­—æ®µï¼Œæ­¤æ—¶çš„<code>catelogId</code>ä¸ºè¦æäº¤çš„æœ€åä¸€çº§(ä¸ä¸€å®šæ˜¯ç¬¬ä¸‰çº§)åˆ†ç±»çš„id</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>catelogId: 0,
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><hr><p>æŠŠ<code>el-cascader</code>æ ‡ç­¾å†…çš„å±æ€§</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>v-model=&quot;dataForm.catelogId&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ”¹ä¸º</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>v-model=&quot;dataForm.catelogIds&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä½¿å…¶ç»§ç»­ç»‘å®šä»¥å‰çš„<code>catelogId</code></p><hr><p>æŠŠ<code>dataFormSubmit</code>æ–¹æ³•é‡Œ<code>data</code>å­—æ®µé‡Œçš„</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>catelogId: this.dataForm.catelogId,
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ”¹æˆ</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>catelogId: this.dataForm.catelogIds[this.dataForm.catelogIds.length-1],
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä½¿å…¶ç»‘å®šæœ€åä¸€çº§(ä¸ä¸€å®šæ˜¯ç¬¬ä¸‰çº§)åˆ†ç±»çš„id</p><h5 id="_7ã€ç»§ç»­æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_7ã€ç»§ç»­æµ‹è¯•" aria-hidden="true">#</a> 7ã€ç»§ç»­æµ‹è¯•</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.7.1.png" alt="image-20220509213100721" tabindex="0" loading="lazy"><figcaption>image-20220509213100721</figcaption></figure><p>æäº¤åï¼Œé¡µé¢è‡ªåŠ¨åˆ·æ–°ï¼Œè·å–æœ€æ–°æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.7.2.png" alt="image-20220509213118005" tabindex="0" loading="lazy"><figcaption>image-20220509213118005</figcaption></figure><p>ğŸ“Œè¿™ä¸ªåˆ·æ–°çš„åŠŸèƒ½å°±æ˜¯é€šè¿‡åˆšæ‰çˆ¶å­ç»„ä»¶äº¤æ¢å®ç°çš„</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.7.3.png" alt="image-20220509213451960" tabindex="0" loading="lazy"><figcaption>image-20220509213451960</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.7.4.png" alt="image-20220509213506714" tabindex="0" loading="lazy"><figcaption>image-20220509213506714</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.7.5.png" alt="image-20220509213521855" tabindex="0" loading="lazy"><figcaption>image-20220509213521855</figcaption></figure><h5 id="_8ã€æ‰€å±åˆ†ç±»idä¸åœ¨ä¸€è¡Œæ˜¾ç¤º" tabindex="-1"><a class="header-anchor" href="#_8ã€æ‰€å±åˆ†ç±»idä¸åœ¨ä¸€è¡Œæ˜¾ç¤º" aria-hidden="true">#</a> 8ã€<code>æ‰€å±åˆ†ç±»id</code>ä¸åœ¨ä¸€è¡Œæ˜¾ç¤º</h5><p><code>src\\views\\modules\\product\\attrgroup-add-or-update.vue</code>æ–‡ä»¶é‡Œçš„<code>el-form</code>æ ‡ç­¾é‡Œä¿®æ”¹å±æ€§</p><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code>label-width=<span class="token string">&quot;100px&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.8.1.png" alt="image-20220509214406434" tabindex="0" loading="lazy"><figcaption>image-20220509214406434</figcaption></figure><p>è¿™æ ·æ‰€å±åˆ†ç±»idå°±æ˜¾ç¤ºåœ¨ä¸€è¡Œäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.4.5.8.2.png" alt="image-20220509214549516" tabindex="0" loading="lazy"><figcaption>image-20220509214549516</figcaption></figure><h4 id="_6ã€å®Œæ•´ä»£ç -1" tabindex="-1"><a class="header-anchor" href="#_6ã€å®Œæ•´ä»£ç -1" aria-hidden="true">#</a> 6ã€å®Œæ•´ä»£ç </h4><h5 id="_1ã€commonä¸‹çš„category-vueæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_1ã€commonä¸‹çš„category-vueæ–‡ä»¶" aria-hidden="true">#</a> 1ã€<code>common</code>ä¸‹çš„<code>category.vue</code>æ–‡ä»¶</h5><p><a href="code/4.3.4.6.1.category.vue">ç‚¹å‡»æŸ¥çœ‹<code>src\\views\\modules\\common\\category.vue</code>æ–‡ä»¶å®Œæ•´ä»£ç </a></p><h5 id="_2ã€attrgroup-vueæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2ã€attrgroup-vueæ–‡ä»¶" aria-hidden="true">#</a> 2ã€<code>attrgroup.vue</code>æ–‡ä»¶</h5><p><a href="code/4.3.4.6.2.attrgroup.vue">ç‚¹å‡»æŸ¥çœ‹<code>src\\views\\modules\\product\\attrgroup.vue</code>æ–‡ä»¶å®Œæ•´ä»£ç </a></p><h5 id="_3ã€attrgroup-add-or-update-vueæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_3ã€attrgroup-add-or-update-vueæ–‡ä»¶" aria-hidden="true">#</a> 3ã€<code>attrgroup-add-or-update.vue</code>æ–‡ä»¶</h5><p><a href="code/4.3.4.6.3.attrgroup-add-or-update.vue">ç‚¹å‡»æŸ¥çœ‹<code>src\\views\\modules\\product\\attrgroup-add-or-update.vue</code>æ–‡ä»¶å®Œæ•´ä»£ç </a></p><h3 id="_4-3-5ã€å›æ˜¾æ‰€å±åˆ†ç±»id" tabindex="-1"><a class="header-anchor" href="#_4-3-5ã€å›æ˜¾æ‰€å±åˆ†ç±»id" aria-hidden="true">#</a> 4.3.5ã€å›æ˜¾<code>æ‰€å±åˆ†ç±»id</code></h3><p>å½“ç‚¹å‡»ä¿®æ”¹æŒ‰é’®å</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.0.1.png" alt="image-20220509222434388" tabindex="0" loading="lazy"><figcaption>image-20220509222434388</figcaption></figure><p><code>æ‰€å±åˆ†ç±»id</code>æ²¡æœ‰å›æ˜¾</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.0.2.png" alt="image-20220509222509610" tabindex="0" loading="lazy"><figcaption>image-20220509222509610</figcaption></figure><h4 id="_1ã€æŸ¥çœ‹ç‚¹å‡»ä¿®æ”¹æŒ‰é’®è°ƒç”¨çš„æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹ç‚¹å‡»ä¿®æ”¹æŒ‰é’®è°ƒç”¨çš„æ–¹æ³•" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹ç‚¹å‡»ä¿®æ”¹æŒ‰é’®è°ƒç”¨çš„æ–¹æ³•</h4><p>æŸ¥çœ‹<code>src\\views\\modules\\product\\attrgroup.vue</code>æ–‡ä»¶çš„<code>addOrUpdateHandle</code>æ–¹æ³•ï¼Œåˆ†æç‚¹å‡»ä¿®æ”¹æŒ‰é’®å<code>æ‰€å±åˆ†ç±»id</code>æ²¡æœ‰å›æ˜¾çš„åŸå› </p><hr><p><code> this.$nextTick()</code>ï¼šå½“è¦æ˜¾ç¤ºçš„ç»„ä»¶(ä¸Šé¢è¿™ä¸ªå¯¹è¯æ¡†)å®Œå…¨æ¸²æŸ“åï¼Œå†è°ƒç”¨é‡Œé¢çš„lambdaè¡¨è¾¾å¼</p><p><code>this.$refs</code>ä¼šè·å–å½“å‰vueæ–‡ä»¶æ‰€æœ‰ç»„ä»¶</p><p><code>this.$refs.addOrUpdate</code>è·å–å½“å‰vueæ–‡ä»¶æ‰€æœ‰æ ‡ç­¾ä¸­<code>ref</code>å±æ€§ä¸º<code>addOrUpdate</code>æˆ–<code>components{}</code>é‡Œé¢ä¸º<code>addOrUpdate</code>çš„ç»„ä»¶</p><p>ç„¶åå†è°ƒç”¨è¯¥ç»„ä»¶çš„æ–¹æ³•</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// æ–°å¢ / ä¿®æ”¹</span>
<span class="token function">addOrUpdateHandle</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//æ‰“å¼€å¯¹è¯æ¡†</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>addOrUpdateVisible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token comment">//å½“è¦æ˜¾ç¤ºçš„ç»„ä»¶(ä¸Šé¢è¿™ä¸ªå¯¹è¯æ¡†)å®Œå…¨æ¸²æŸ“åï¼Œå†è°ƒç”¨ä¸€ä¸ªæ–¹æ³•</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>addOrUpdate<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹åˆ°è°ƒç”¨äº†<code>addOrUpdate</code>ç»„ä»¶çš„<code>init</code>æ–¹æ³•</p><p>å½“å‰vueæ–‡ä»¶å¼•äº†åŒæ–‡ä»¶å¤¹ä¸‹çš„<code>attrgroup-add-or-update.vue</code>æ–‡ä»¶</p><p>å¹¶æŠŠå®ƒå‘½åä¸º<code>addOrUpdate</code>ï¼Œå¹¶ä½¿ç”¨è¿™ä¸ªåå­—æ·»åŠ åˆ°è¯¥vueæ–‡ä»¶çš„ç»„ä»¶é‡Œ</p><p>å› æ­¤å…¶è°ƒç”¨äº†<code>attrgroup-add-or-update.vue</code>æ–‡ä»¶çš„<code>init</code>æ–¹æ³•ï¼Œå¹¶ä¼ å…¥äº†<code>attrGroup</code>çš„<code>Id</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.1.png" alt="image-20220509223330783" tabindex="0" loading="lazy"><figcaption>image-20220509223330783</figcaption></figure><h4 id="_2ã€æŸ¥çœ‹initæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹initæ–¹æ³•" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹<code>init</code>æ–¹æ³•</h4><p><code>src\\views\\modules\\product\\attrgroup-add-or-update.vue</code>æ–‡ä»¶<code>init</code>æ–¹æ³•å¾—åˆ°çš„<code>catelogId</code>åªæ˜¯ä¸€ä¸ªå€¼(æœ€åä¸€çº§åˆ†ç±»çš„id)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.2.png" alt="image-20220509224447118" tabindex="0" loading="lazy"><figcaption>image-20220509224447118</figcaption></figure><p>è€Œ<code>æ‰€å±åˆ†ç±»id</code>éœ€è¦çš„å‚æ•°æ˜¯<strong>å®Œæ•´åˆ†ç±»id</strong>(æœ€åä¸€çº§åˆ†ç±»çš„æ‰€æœ‰çˆ¶åˆ†ç±»id+æœ€åä¸€çº§åˆ†ç±»çš„id)</p><p>å› æ­¤å¯ä»¥æ·»åŠ è¿”å›çš„æ•°æ®</p><h4 id="_3ã€ä¿®æ”¹å‰ç«¯ä»£ç " tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹å‰ç«¯ä»£ç " aria-hidden="true">#</a> 3ã€ä¿®æ”¹å‰ç«¯ä»£ç </h4><p>åœ¨<code>src\\views\\modules\\product\\attrgroup-add-or-update.vue</code>çš„<code>init</code>æ–¹æ³•é‡Œæ·»åŠ è¿™ä¸€è¡Œ</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//æœ€åä¸€çº§åˆ†ç±»çš„æ‰€æœ‰çˆ¶åˆ†ç±»id+æœ€åä¸€çº§åˆ†ç±»id</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>dataForm<span class="token punctuation">.</span>catelogPath <span class="token operator">=</span> data<span class="token punctuation">.</span>attrGroup<span class="token punctuation">.</span>catelogPath<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æŒ‰&quot;ctrl+H&quot;å¿«æ·é”®è°ƒå‡ºæ›¿æ¢,æŠŠ&quot;catelogIds&quot;æ›¿æ¢æˆ&quot;catelogPath&quot;,ç‚¹å‡»æ›¿æ¢æ‰€æœ‰</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.3.png" alt="image-20220509225211670" tabindex="0" loading="lazy"><figcaption>image-20220509225211670</figcaption></figure><h4 id="_4ã€ä¿®æ”¹åç«¯ä»£ç " tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿®æ”¹åç«¯ä»£ç " aria-hidden="true">#</a> 4ã€ä¿®æ”¹åç«¯ä»£ç </h4><h5 id="_1ã€ä¿®æ”¹attrgroupcontrollerçš„infoæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿®æ”¹attrgroupcontrollerçš„infoæ–¹æ³•" aria-hidden="true">#</a> 1ã€ä¿®æ”¹<code>AttrGroupController</code>çš„<code>info</code>æ–¹æ³•</h5><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.AttrGroupController</code>ç±»çš„<code>info</code>æ–¹æ³•</p><p>æ³¨å…¥<code>categoryService</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">CategoryService</span> categoryService<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è°ƒç”¨å…¶<code>getCatelogPath</code>æ–¹æ³•,æ ¹æ®<strong>æœ€åä¸€çº§åˆ†ç±»çš„id</strong>æŸ¥å‡º<strong>å®Œæ•´åˆ†ç±»id</strong>(æœ€åä¸€çº§åˆ†ç±»çš„æ‰€æœ‰çˆ¶åˆ†ç±»id+æœ€åä¸€çº§åˆ†ç±»id)</p><p>å¹¶å°†æŸ¥å¤„çš„ç»“æœèµ‹ç»™<code>AttrGroupEntity</code>çš„<code>catelogPath</code>å­—æ®µ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/info/{attrGroupId}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">info</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;attrGroupId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> attrGroupId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AttrGroupEntity</span> attrGroup <span class="token operator">=</span> attrGroupService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>attrGroupId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Long</span> catelogId <span class="token operator">=</span> attrGroup<span class="token punctuation">.</span><span class="token function">getCatelogId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ ¹æ®æœ€åä¸€çº§åˆ†ç±»çš„idæŸ¥å‡ºå®Œæ•´åˆ†ç±»id(æœ€åä¸€çº§åˆ†ç±»çš„æ‰€æœ‰çˆ¶åˆ†ç±»id+æœ€åä¸€çº§åˆ†ç±»id)</span>
    <span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> catelogPath <span class="token operator">=</span> categoryService<span class="token punctuation">.</span><span class="token function">findCatelogPath</span><span class="token punctuation">(</span>catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//èµ‹ç»™AttrGroupEntityçš„catelogPathå­—æ®µ</span>
    attrGroup<span class="token punctuation">.</span><span class="token function">setCatelogPath</span><span class="token punctuation">(</span>catelogPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;attrGroup&quot;</span><span class="token punctuation">,</span> attrGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.4.1.png" alt="image-20220509233808743" tabindex="0" loading="lazy"><figcaption>image-20220509233808743</figcaption></figure><h5 id="_2ã€attrgroupentityç±»æ·»åŠ catelogpathå­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_2ã€attrgroupentityç±»æ·»åŠ catelogpathå­—æ®µ" aria-hidden="true">#</a> 2ã€<code>AttrGroupEntity</code>ç±»æ·»åŠ <code>catelogPath</code>å­—æ®µ</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ­¤å­—æ®µåœ¨æ•°æ®åº“ä¸­ä¸å­˜åœ¨
 */</span>
<span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>exist <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> catelogPath<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.4.2.png" alt="image-20220509231524255" tabindex="0" loading="lazy"><figcaption>image-20220509231524255</figcaption></figure><h5 id="_3ã€æ·»åŠ getcatelogpathæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ getcatelogpathæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>getCatelogPath</code>æŠ½è±¡æ–¹æ³•</h5><p>ç”±äºä½¿ç”¨äº†<code>lombok</code>æ’ä»¶ï¼Œæ·»åŠ äº†<code>lombok</code>ä¾èµ–ï¼Œå¹¶æ·»åŠ äº†<code>@Data</code>æ³¨è§£ï¼Œæ‰€ä»¥ä¼šåœ¨ç¼–è¯‘æ—¶ç»™å­—æ®µè‡ªåŠ¨æ·»åŠ <code>get</code>å’Œ<code>set</code>æ–¹æ³•ï¼Œ</p><p>å› æ­¤<code>attrGroup.setCatelogPath(catelogPath);</code>ä¸æŠ¥é”™äº†</p><p>é¼ æ ‡æ‚¬åœåœ¨<code>getCatelogPath</code>ä¸Š(æˆ–è€…ä½¿ç”¨<code>alt+enter</code>å¿«æ·é”®)ï¼Œç‚¹å‡»<code>Create method</code>ï¼Œåˆ›å»ºæ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.4.3.1.png" alt="image-20220509233935848" tabindex="0" loading="lazy"><figcaption>image-20220509233935848</figcaption></figure><p>æ·»åŠ æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ ¹æ®æœ€åä¸€çº§åˆ†ç±»çš„idæŸ¥å‡ºå®Œæ•´åˆ†ç±»id(æœ€åä¸€çº§åˆ†ç±»çš„æ‰€æœ‰çˆ¶åˆ†ç±»id+æœ€åä¸€çº§åˆ†ç±»id)
 * <span class="token keyword">@return</span>
 */</span>
<span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">findCatelogPath</span><span class="token punctuation">(</span><span class="token class-name">Long</span> catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åç‚¹å‡»<code>1 related problem</code>æˆ–æ¥å£ç±»å·¦è¾¹çš„<code>Iå’Œå‘ä¸‹ç®­å¤´</code>çš„é‚£ä¸ªæŒ‰é’®æˆ–ä½¿ç”¨<code>ctrl+alt+B</code>å¿«æ·é”®è½¬åˆ°å…¶å®ç°ç±»</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.4.3.2.png" alt="image-20220509234029398" tabindex="0" loading="lazy"><figcaption>image-20220509234029398</figcaption></figure><p>ä½¿ç”¨<code>alt+enter</code>å¿«æ·é”®ï¼Œç‚¹å‡»&quot;<strong>Implement methods</strong>&quot;,å®ç°æœªå®ç°çš„æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.4.3.3.png" alt="image-20220509234117877" tabindex="0" loading="lazy"><figcaption>image-20220509234117877</figcaption></figure><h5 id="_4ã€å®ç°getcatelogpathæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€å®ç°getcatelogpathæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€å®ç°<code>getCatelogPath</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>com.atguigu.gulimall.product.service.impl.CategoryServiceImpl</code>ç±»é‡Œæ·»åŠ æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">findCatelogPath</span><span class="token punctuation">(</span><span class="token class-name">Long</span> catelogId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> paths <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> parentPath <span class="token operator">=</span> <span class="token function">findParentPath</span><span class="token punctuation">(</span>catelogId<span class="token punctuation">,</span>paths<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//å…ˆåŠ å…¥èŠ‚ç‚¹idåå†é€’å½’æ±‚è§£å…¶çˆ¶åˆ†ç±»ï¼Œæ‰€æœ‰æ±‚å‡ºçš„å®Œæ•´è·¯å¾„æ˜¯åçš„ï¼Œéœ€è¦è½¬ç½®ä¸€ä¸‹</span>
    <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span>parentPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> parentPath<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * ä¾‹å¦‚ï¼š[413,50,5]
 * æ ¹æ®æœ€åä¸€çº§åˆ†ç±»çš„idé€’å½’æ±‚è§£å®Œæ•´åˆ†ç±»id(æœ€åä¸€çº§åˆ†ç±»çš„æ‰€æœ‰çˆ¶åˆ†ç±»id+æœ€åä¸€çº§åˆ†ç±»id)
 * <span class="token keyword">@param</span> <span class="token parameter">catelogId</span> å½“å‰åˆ†ç±»id
 * <span class="token keyword">@param</span> <span class="token parameter">paths</span> åˆ†ç±»idæ•°ç»„
 * <span class="token keyword">@return</span>  å®Œæ•´åˆ†ç±»id
 */</span>
<span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> <span class="token function">findParentPath</span><span class="token punctuation">(</span><span class="token class-name">Long</span> catelogId<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> paths<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    paths<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">CategoryEntity</span> categoryEntity <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Long</span> parentCid <span class="token operator">=</span> categoryEntity<span class="token punctuation">.</span><span class="token function">getParentCid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>parentCid<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">findParentPath</span><span class="token punctuation">(</span>parentCid<span class="token punctuation">,</span>paths<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> paths<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_5ã€å•å…ƒæµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_5ã€å•å…ƒæµ‹è¯•" aria-hidden="true">#</a> 5ã€å•å…ƒæµ‹è¯•</h5><p>åœ¨<code>test\\java</code>çš„<code>com.atguigu.gulimall.product.GulimallProductApplicationTests</code>ç±»é‡Œæ·»åŠ æ–¹æ³•ï¼Œç‚¹å‡»æ–¹æ³•å·¦ä¾§çš„è¿è¡ŒæŒ‰é’®</p><p>ğŸ“Œå¦‚æœæŠ¥ç©ºæŒ‡é’ˆï¼Œè¯´æ˜ä½ <code>gulimall_pms</code>æ•°æ®åº“çš„<code>pms_category</code>è¡¨é‡Œé¢ä¸å­˜åœ¨<code>cat_id</code>ä¸ºä½ å†™çš„é‚£ä¸ªid</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">CategoryService</span> categoryService<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> catelogPath <span class="token operator">=</span> categoryService<span class="token punctuation">.</span><span class="token function">findCatelogPath</span><span class="token punctuation">(</span><span class="token number">413L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>catelogPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[Ljava.lang.Object; cannot be cast to [Ljava.lang.Long;
Object[]ç±»å‹ä¸èƒ½å¼ºè½¬æˆLong[]ç±»å‹
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.4.5.1.png" alt="image-20220510113030426" tabindex="0" loading="lazy"><figcaption>image-20220510113030426</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.4.5.2.png" alt="image-20220510114911801" tabindex="0" loading="lazy"><figcaption>image-20220510114911801</figcaption></figure><h5 id="_6ã€ä¿®æ”¹findcatelogpathæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_6ã€ä¿®æ”¹findcatelogpathæ–¹æ³•" aria-hidden="true">#</a> 6ã€ä¿®æ”¹<code>findCatelogPath</code>æ–¹æ³•</h5><p>ä¿®æ”¹<code>com.atguigu.gulimall.product.service.impl.CategoryServiceImpl</code>ç±»çš„<code>findCatelogPath</code>æ–¹æ³•</p><p>æŠŠ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> parentPath<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ”¹æˆ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">return</span> parentPath<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Long</span><span class="token punctuation">[</span>parentPath<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æµ‹è¯•æˆåŠŸï¼Œä½†åˆæç¤º<code>Call to &#39;toArray()&#39; with pre-sized array argument &#39;new Long[parentPath.size()]&#39; </code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.4.6.1.png" alt="image-20220510115355135" tabindex="0" loading="lazy"><figcaption>image-20220510115355135</figcaption></figure><p>å¯ä»¥æ”¹æˆ</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>return parentPath.toArray(new Long[0]);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¿™æ ·å†™æµ‹è¯•ä¹Ÿæ²¡æœ‰é—®é¢˜</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.4.6.2.png" alt="image-20220510115533565" tabindex="0" loading="lazy"><figcaption>image-20220510115533565</figcaption></figure><p>ğŸ“Œå…¶å®<code>findParentPath</code>æ–¹æ³•çš„è¿”å›å€¼æœ‰ç‚¹å¤šä½™</p><p>ğŸ“Œ<code>findCatelogPath</code>æ–¹æ³•ä¹Ÿå¯ä»¥ç›´æ¥è¿”å›<code>List&lt;Long&gt;</code>ç±»å‹ï¼Œè¿”å›åˆ°å‰ç«¯çš„å†…å®¹<code>Long[]</code>å’Œ<code>List&lt;Long&gt;</code>éƒ½æ˜¯ä¸€æ ·çš„</p><h4 id="_5ã€æµ‹è¯•-2" tabindex="-1"><a class="header-anchor" href="#_5ã€æµ‹è¯•-2" aria-hidden="true">#</a> 5ã€æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>é¡¹ç›®åæµ‹è¯•</p><h5 id="_1ã€ç‚¹å‡»ä¿®æ”¹æŒ‰é’®" tabindex="-1"><a class="header-anchor" href="#_1ã€ç‚¹å‡»ä¿®æ”¹æŒ‰é’®" aria-hidden="true">#</a> 1ã€ç‚¹å‡»<code>ä¿®æ”¹</code>æŒ‰é’®</h5><p>ç‚¹å‡»<code>æµ‹è¯•æ•°æ®</code>çš„<code>ä¿®æ”¹</code>æŒ‰é’®ï¼Œå¯ä»¥çœ‹åˆ°<code>æ‰€å±åˆ†ç±»id</code>å·²æ­£ç¡®å›æ˜¾</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.5.1.png" alt="image-20220510123323627" tabindex="0" loading="lazy"><figcaption>image-20220510123323627</figcaption></figure><h5 id="_2ã€ç‚¹å‡»æ–°å¢æŒ‰é’®" tabindex="-1"><a class="header-anchor" href="#_2ã€ç‚¹å‡»æ–°å¢æŒ‰é’®" aria-hidden="true">#</a> 2ã€ç‚¹å‡»<code>æ–°å¢</code>æŒ‰é’®</h5><p>ç‚¹å‡»<code>æ–°å¢</code>æŒ‰é’®ï¼Œå‘ç°<code>æ‰€å±åˆ†ç±»id</code>æ²¡æœ‰åˆ é™¤</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.5.2.png" alt="image-20220510123145766" tabindex="0" loading="lazy"><figcaption>image-20220510123145766</figcaption></figure><h5 id="_3ã€æ·»åŠ closedå›è°ƒ" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ closedå›è°ƒ" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>closed</code>å›è°ƒ</h5>`,228),Aa=a("code",null,"element-ui",-1),Pa=a("code",null,"Dialogå¯¹è¯æ¡†",-1),Ra={href:"https://element.eleme.io/#/zh-CN/component/dialog",target:"_blank",rel:"noopener noreferrer"},Ca=e(`<table><thead><tr><th style="text-align:left;">äº‹ä»¶åç§°</th><th style="text-align:left;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;">closed</td><td style="text-align:left;">Dialog å…³é—­åŠ¨ç”»ç»“æŸæ—¶çš„å›è°ƒ</td></tr></tbody></table><p><code>src\\views\\modules\\product\\attrgroup-add-or-update.vue</code>ä¸­<code>el-dialog</code>æ ‡ç­¾æ·»åŠ å±æ€§</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name"> @closed</span><span class="token punctuation">=</span><span class="token value attr-value">&quot;dialogClose&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¹¶å†<code>method</code>é‡Œé¢æ·»åŠ æ–¹æ³•ï¼Œæ¸…ç©º<code>catelogPath</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">dialogClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dataForm<span class="token punctuation">.</span>catelogPath <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_4ã€æŸ¥çœ‹æ˜¯å¦æ¸…é™¤" tabindex="-1"><a class="header-anchor" href="#_4ã€æŸ¥çœ‹æ˜¯å¦æ¸…é™¤" aria-hidden="true">#</a> 4ã€æŸ¥çœ‹æ˜¯å¦æ¸…é™¤</h5><p>åˆ·æ–°é¡µé¢ï¼Œå…ˆç‚¹å‡»<code>ä¿®æ”¹</code>ï¼Œå†ç‚¹å‡»<code>æ–°å¢</code>å¯ä»¥çœ‹åˆ°å·²ç»æ²¡æœ‰ä¸Šæ¬¡<code>ä¿®æ”¹</code>å›æ˜¾æ‰§è¡Œåç•™ä¸‹çš„<code>æ‰€å±åˆ†ç±»id</code>çš„ä¿¡æ¯äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.5.4.png" alt="image-20220510125315522" tabindex="0" loading="lazy"><figcaption>image-20220510125315522</figcaption></figure><h5 id="_5ã€å¯æœç´¢çº§è”é€‰æ‹©å™¨" tabindex="-1"><a class="header-anchor" href="#_5ã€å¯æœç´¢çº§è”é€‰æ‹©å™¨" aria-hidden="true">#</a> 5ã€å¯æœç´¢çº§è”é€‰æ‹©å™¨</h5><p>ä¿®æ”¹<code>src\\views\\modules\\product\\attrgroup-add-or-update.vue</code>é‡Œçš„<code>el-cascader</code>æ ‡ç­¾</p>`,10),Da=a("code",null,"elememt-ui",-1),Ba=a("code",null,"Cascader çº§è”é€‰æ‹©å™¨",-1),Ta=a("code",null,"å¯æœç´¢",-1),La={href:"https://element.eleme.io/#/zh-CN/component/cascader",target:"_blank",rel:"noopener noreferrer"},Ga=e(`<p>æ·»åŠ <code>filterable</code>å°±å˜æˆå¯æœç´¢çš„äº†ï¼Œæ·»åŠ <code>placeholder</code>å±æ€§å¯ä»¥ç»™äºˆæç¤º</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-cascader</span>
  <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataForm.catelogPath<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">:options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>categorys<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">:props</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>props<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>è¯•è¯•æœç´¢ï¼šæ‰‹æœº<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">filterable</span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-cascader</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å…¥æ‰‹æœºåï¼Œä¸‹é¢å¯ä»¥æä¾›é€‰æ‹©</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.3.5.5.5.png" alt="image-20220510130049823" tabindex="0" loading="lazy"><figcaption>image-20220510130049823</figcaption></figure><h2 id="_4-4ã€å•†å“æœåŠ¡-api-å“ç‰Œç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_4-4ã€å•†å“æœåŠ¡-api-å“ç‰Œç®¡ç†" aria-hidden="true">#</a> 4.4ã€å•†å“æœåŠ¡-API-å“ç‰Œç®¡ç†</h2><h3 id="_4-4-1ã€å®Œå–„å“ç‰Œç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_4-4-1ã€å®Œå–„å“ç‰Œç®¡ç†" aria-hidden="true">#</a> 4.4.1ã€å®Œå–„å“ç‰Œç®¡ç†</h3><h4 id="_1ã€é‡æ–°æ‰§è¡Œsql" tabindex="-1"><a class="header-anchor" href="#_1ã€é‡æ–°æ‰§è¡Œsql" aria-hidden="true">#</a> 1ã€é‡æ–°æ‰§è¡Œsql</h4><p>é‡æ–°æ‰“å¼€<code>1.åˆ†å¸ƒå¼åŸºç¡€ï¼ˆå…¨æ ˆå¼€å‘ç¯‡ï¼‰\\èµ„æ–™æºç .zip\\docs\\ä»£ç \\sql</code>ä¸‹çš„<code>pms_catelog.sql</code>æ–‡ä»¶ï¼Œå¤åˆ¶å†…å®¹</p><p>ç‚¹å‡»<code>gulimall_pms</code>æ•°æ®åº“ï¼Œå³é”®é€‰æ‹©<code>å‘½ä»¤è¡Œç•Œé¢</code>ï¼Œç²˜è´´åˆšåˆšå¤åˆ¶çš„å†…å®¹ï¼Œç‚¹å‡»å›è½¦ï¼Œæ‰§è¡Œsqlè¯­å¥</p><p>(ä¸è¦ç‚¹å‡»<code>è¿è¡ŒSQLæ–‡ä»¶</code>,è¿™æ ·ä¼šæœ‰ä¸­æ–‡ä¹±ç é—®é¢˜)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.1.png" alt="image-20220510145629313" tabindex="0" loading="lazy"><figcaption>image-20220510145629313</figcaption></figure><h4 id="_2ã€æ·»åŠ åˆ†é¡µæ’ä»¶" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ åˆ†é¡µæ’ä»¶" aria-hidden="true">#</a> 2ã€æ·»åŠ åˆ†é¡µæ’ä»¶</h4><h5 id="_1ã€æ€»æ¡æ•°é”™è¯¯" tabindex="-1"><a class="header-anchor" href="#_1ã€æ€»æ¡æ•°é”™è¯¯" aria-hidden="true">#</a> 1ã€æ€»æ¡æ•°é”™è¯¯</h5><p>urlï¼šhttp://localhost:8001/#/product-brand</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.2.1.png" alt="image-20220510150440811" tabindex="0" loading="lazy"><figcaption>image-20220510150440811</figcaption></figure><h5 id="_2ã€æ·»åŠ åˆ†é¡µæ’ä»¶-1" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ åˆ†é¡µæ’ä»¶-1" aria-hidden="true">#</a> 2ã€æ·»åŠ åˆ†é¡µæ’ä»¶</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»º<code>config</code>æ–‡ä»¶å¤¹</p><p>åœ¨<code>config</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»º<code>MyBatisConfig</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>extension<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span></span><span class="token class-name">PaginationInterceptor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">MapperScan</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">EnableTransactionManagement</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/10
 * @Description:
 * @EnableTransactionManagement ï¼šå¼€å¯äº‹åŠ¡åŠŸèƒ½
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableTransactionManagement</span>
<span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token string">&quot;com.atguigu.gulimall.product.dao&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBatisConfig</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * å¼•å…¥åˆ†é¡µæ’ä»¶
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">PaginationInterceptor</span> <span class="token function">paginationInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">PaginationInterceptor</span> paginationInterceptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PaginationInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®è¯·æ±‚çš„é¡µé¢å¤§äºæœ€å¤§é¡µåæ“ä½œï¼Œtrueè°ƒå›åˆ°é¦–é¡µï¼Œfalse ç»§ç»­è¯·æ±‚ é»˜è®¤false</span>
        paginationInterceptor<span class="token punctuation">.</span><span class="token function">setOverflow</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®æœ€å¤§å•é¡µé™åˆ¶æ•°é‡ï¼Œé»˜è®¤500æ¡ï¼Œ-1 ä¸å—é™åˆ¶</span>
        paginationInterceptor<span class="token punctuation">.</span><span class="token function">setLimit</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> paginationInterceptor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.2.2.png" alt="image-20220510151731315" tabindex="0" loading="lazy"><figcaption>image-20220510151731315</figcaption></figure><h5 id="_3ã€æŸ¥çœ‹æ¡æ•°" tabindex="-1"><a class="header-anchor" href="#_3ã€æŸ¥çœ‹æ¡æ•°" aria-hidden="true">#</a> 3ã€æŸ¥çœ‹æ¡æ•°</h5><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°æ€»æ¡æ•°æ˜¾ç¤ºæ­£ç¡®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.2.3.png" alt="image-20220510151901745" tabindex="0" loading="lazy"><figcaption>image-20220510151901745</figcaption></figure><h4 id="_3ã€ä¿®æ”¹æŸ¥è¯¢é€»è¾‘" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹æŸ¥è¯¢é€»è¾‘" aria-hidden="true">#</a> 3ã€ä¿®æ”¹æŸ¥è¯¢é€»è¾‘</h4><h5 id="_1ã€æ¨¡ç³ŠæŸ¥è¯¢å¤±è´¥" tabindex="-1"><a class="header-anchor" href="#_1ã€æ¨¡ç³ŠæŸ¥è¯¢å¤±è´¥" aria-hidden="true">#</a> 1ã€æ¨¡ç³ŠæŸ¥è¯¢å¤±è´¥</h5><p>æ ¹æ®<code>å“ç‰Œid</code>æŸ¥è¯¢</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.3.1.1.png" alt="image-20220510154018496" tabindex="0" loading="lazy"><figcaption>image-20220510154018496</figcaption></figure><p>æ ¹æ®<code>å“ç‰Œå</code>æ¨¡ç³ŠæŸ¥è¯¢</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.3.1.2.png" alt="image-20220510154130509" tabindex="0" loading="lazy"><figcaption>image-20220510154130509</figcaption></figure><h5 id="_2ã€æ ¹æ®å“ç‰Œidå’Œå“ç‰ŒåæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_2ã€æ ¹æ®å“ç‰Œidå’Œå“ç‰ŒåæŸ¥è¯¢" aria-hidden="true">#</a> 2ã€æ ¹æ®<code>å“ç‰Œid</code>å’Œ<code>å“ç‰Œå</code>æŸ¥è¯¢</h5><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—é‡Œ<code>com.atguigu.gulimall.product.service.impl.BrandServiceImpl</code>ç±»ä¸‹çš„<code>queryPage</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">queryPage</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BrandEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BrandEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token operator">!=</span><span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">BrandEntity</span><span class="token operator">::</span><span class="token function">getBrandId</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">BrandEntity</span><span class="token operator">::</span><span class="token function">getName</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BrandEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BrandEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span>
           lambdaQueryWrapper
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.3.2.png" alt="image-20220510154241194" tabindex="0" loading="lazy"><figcaption>image-20220510154241194</figcaption></figure><h5 id="_3ã€æµ‹è¯•-2" tabindex="-1"><a class="header-anchor" href="#_3ã€æµ‹è¯•-2" aria-hidden="true">#</a> 3ã€æµ‹è¯•</h5><p>é‡æ–°è¿è¡Œ<code>gulimall-product</code>æ¨¡å—ï¼Œè¿›è¡Œæµ‹è¯•</p><p>æ ¹æ®<code>å“ç‰Œid</code>æŸ¥è¯¢</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.3.3.1.png" alt="image-20220510153551322" tabindex="0" loading="lazy"><figcaption>image-20220510153551322</figcaption></figure><p>æ ¹æ®<code>å“ç‰Œå</code>æ¨¡ç³ŠæŸ¥è¯¢</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.3.3.2.png" alt="image-20220510153617854" tabindex="0" loading="lazy"><figcaption>image-20220510153617854</figcaption></figure><p>éƒ½æ²¡æœ‰ä»€ä¹ˆé—®é¢˜</p><h4 id="_4ã€æ·»åŠ æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ æ•°æ®" aria-hidden="true">#</a> 4ã€æ·»åŠ æ•°æ®</h4><h5 id="_1ã€åˆ é™¤å“ç‰Œç®¡ç†æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_1ã€åˆ é™¤å“ç‰Œç®¡ç†æ•°æ®" aria-hidden="true">#</a> 1ã€åˆ é™¤<code>å“ç‰Œç®¡ç†</code>æ•°æ®</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.4.1.1.png" alt="image-20220510201428448" tabindex="0" loading="lazy"><figcaption>image-20220510201428448</figcaption></figure><p>å¯ä»¥åœ¨æ•°æ®åº“æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œæ¸…ç©º<code>gulimall_pms.pms_brand</code>è¡¨æ•°æ®ï¼Œå¹¶è®©ä¸»é”®é‡æ–°ä»1å¼€å§‹</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">truncate</span> gulimall_pms<span class="token punctuation">.</span>pms_brand<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¹Ÿå¯ä»¥é€‰ä¸­è¡¨--&gt;å³é”®--&gt;æˆªæ–­è¡¨</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.4.1.2.png" alt="image-20220511151930445" tabindex="0" loading="lazy"><figcaption>image-20220511151930445</figcaption></figure><h5 id="_2ã€æ·»åŠ æœ‰ç”¨æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ æœ‰ç”¨æ•°æ®" aria-hidden="true">#</a> 2ã€æ·»åŠ æœ‰ç”¨æ•°æ®</h5><p>å›¾ç‰‡åœ¨<code>1.åˆ†å¸ƒå¼åŸºç¡€ï¼ˆå…¨æ ˆå¼€å‘ç¯‡ï¼‰\\èµ„æ–™æºç .zip\\docs\\pics</code>æ–‡ä»¶å¤¹é‡Œé¢</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.4.2.1.png" alt="image-20220510223618376" tabindex="0" loading="lazy"><figcaption>image-20220510223618376</figcaption></figure><p>æ·»åŠ åä¸ºå“ç‰Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.4.2.2.png" alt="image-20220510223418633" tabindex="0" loading="lazy"><figcaption>image-20220510223418633</figcaption></figure><p>æ·»åŠ å°ç±³å“ç‰Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.4.2.3.png" alt="image-20220510223456458" tabindex="0" loading="lazy"><figcaption>image-20220510223456458</figcaption></figure><p>æ·»åŠ oppoå“ç‰Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.4.2.4.png" alt="image-20220510223906193" tabindex="0" loading="lazy"><figcaption>image-20220510223906193</figcaption></figure><p>æ·»åŠ Appleå“ç‰Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.4.2.5.png" alt="image-20220510224046126" tabindex="0" loading="lazy"><figcaption>image-20220510224046126</figcaption></figure><p>æ‰€æœ‰å“ç‰Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.4.2.6.png" alt="image-20220510224352810" tabindex="0" loading="lazy"><figcaption>image-20220510224352810</figcaption></figure><h5 id="_3ã€å¤åˆ¶æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_3ã€å¤åˆ¶æ–‡ä»¶" aria-hidden="true">#</a> 3ã€å¤åˆ¶æ–‡ä»¶</h5><p>ğŸ“Œæœ€å¥½å…ˆ<strong>æäº¤åˆ°è¿œç¨‹ä»“åº“</strong>å¹¶<strong>å¤åˆ¶å‰ç«¯é¡¹ç›®</strong>å†æ“ä½œ,æœ€å°‘ä¹Ÿè¦å¤åˆ¶<code>renren-fast-vue\\src\\views\\modules</code>ä¸‹çš„<code>common</code>å’Œ<code>product</code>æ–‡ä»¶å¤¹</p><ol><li>å¤åˆ¶<code>1.åˆ†å¸ƒå¼åŸºç¡€ï¼ˆå…¨æ ˆå¼€å‘ç¯‡ï¼‰\\èµ„æ–™æºç .zip\\docs\\ä»£ç \\å‰ç«¯\\modules</code>é‡Œçš„<code>common</code>å’Œ<code>product</code>æ–‡ä»¶å¤¹</li><li>ç‚¹å‡»<code>src</code>ä¸‹çš„&quot;views&quot;ï¼Œç„¶åå³é”®</li><li>é€‰æ‹©<code>åœ¨æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­æ˜¾ç¤º</code></li><li>è¿›å…¥åˆ°<code>view</code>ä¸‹çš„<code>modules</code>é‡Œé¢</li><li>å³é”®ï¼Œé€‰æ‹©ç²˜è´´</li><li>é€‰æ‹©<code>æ›¿æ¢ç›®æ ‡ä¸­çš„æ–‡ä»¶</code></li></ol><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.1.4.3.png" alt="image-20220510201443183" tabindex="0" loading="lazy"><figcaption>image-20220510201443183</figcaption></figure><h3 id="_4-4-2ã€æ ¹æ®å“ç‰ŒidæŸ¥è¯¢å“ç‰Œå’Œä¸‰çº§åˆ†ç±»çš„å…³è”å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_4-4-2ã€æ ¹æ®å“ç‰ŒidæŸ¥è¯¢å“ç‰Œå’Œä¸‰çº§åˆ†ç±»çš„å…³è”å…³ç³»" aria-hidden="true">#</a> 4.4.2ã€æ ¹æ®<code>å“ç‰Œid</code>æŸ¥è¯¢<code>å“ç‰Œå’Œä¸‰çº§åˆ†ç±»çš„å…³è”å…³ç³»</code></h3><p>ã€å±æ€§åˆ†ç»„-è§„æ ¼å‚æ•°-é”€å”®å±æ€§-ä¸‰çº§åˆ†ç±»ã€‘å…³è”å…³ç³»</p><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.2.0.1.png" alt="image-20220721202638445" style="zoom:50%;"><p>SPU-SKU-å±æ€§</p><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.2.0.2.png" alt="image-20220721202802806" style="zoom:67%;"><p>SPU-SKU-å±æ€§è¡¨</p><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.2.0.3.png" alt="image-20220721202830773" style="zoom:67%;"><h4 id="_1ã€æ·»åŠ cateloglistæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ cateloglistæ–¹æ³•" aria-hidden="true">#</a> 1ã€æ·»åŠ <code>catelogList</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.CategoryBrandRelationController</code>ç±»é‡Œæ·»åŠ æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * åˆ—è¡¨
 * @GetMapping = @RequestMapping(method = RequestMethod.GET)
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/catelog/list&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">catelogList</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;brandId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> brandId<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryBrandRelationEntity</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> categoryBrandRelationService<span class="token punctuation">.</span><span class="token function">listByBrandId</span><span class="token punctuation">(</span>brandId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.2.1.png" alt="image-20220510213324100" tabindex="0" loading="lazy"><figcaption>image-20220510213324100</figcaption></figure><h4 id="_2ã€æ·»åŠ listbybrandidæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ listbybrandidæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 2ã€æ·»åŠ <code>listByBrandId</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>com.atguigu.gulimall.product.service.CategoryBrandRelationService</code>æ¥å£é‡Œæ·»åŠ <code>listByBrandId</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryBrandRelationEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">listByBrandId</span><span class="token punctuation">(</span><span class="token class-name">Long</span> brandId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.2.2.png" alt="image-20220510213901065" tabindex="0" loading="lazy"><figcaption>image-20220510213901065</figcaption></figure><h4 id="_3ã€å®ç°listbybrandidæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€å®ç°listbybrandidæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 3ã€å®ç°<code>listByBrandId</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>com.atguigu.gulimall.product.service.impl.CategoryBrandRelationServiceImpl</code>ç±»é‡Œ</p><p>å®ç°<code>CategoryBrandRelationService</code>æ¥å£æœªå®ç°çš„<code>listByBrandId</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryBrandRelationEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">listByBrandId</span><span class="token punctuation">(</span><span class="token class-name">Long</span> brandId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryBrandRelationEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span>lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">CategoryBrandRelationEntity</span><span class="token operator">::</span><span class="token function">getBrandId</span><span class="token punctuation">,</span> brandId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.2.3.png" alt="image-20220510214006492" tabindex="0" loading="lazy"><figcaption>image-20220510214006492</figcaption></figure><h3 id="_4-4-3ã€ä¿å­˜å“ç‰Œå’Œåˆ†ç±»å®Œæ•´ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_4-4-3ã€ä¿å­˜å“ç‰Œå’Œåˆ†ç±»å®Œæ•´ä¿¡æ¯" aria-hidden="true">#</a> 4.4.3ã€ä¿å­˜å“ç‰Œå’Œåˆ†ç±»å®Œæ•´ä¿¡æ¯</h3><h4 id="_1ã€ä¿®æ”¹saveæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿®æ”¹saveæ–¹æ³•" aria-hidden="true">#</a> 1ã€ä¿®æ”¹<code>save</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.CategoryBrandRelationController</code>ç±»é‡Œ</p><p>ä¿®æ”¹<code>save</code>æ–¹æ³•ï¼Œä¿å­˜å…¶<code>brand_idã€catelog_idã€brand_nameã€catelog_name</code></p><p>ä¼ æ¥çš„æ•°æ®åªæœ‰<code>brand_idã€catelog_id</code>ï¼Œè°ƒç”¨<code>categoryBrandRelationService</code>çš„<code>saveDetail</code>æŸ¥å‡º<code>brand_name</code>å’Œ<code>catelog_name</code></p><p>å¹¶å°†å®Œæ•´çš„<code>brand_idã€catelog_idã€brand_nameã€catelog_name</code>ä¿å­˜åˆ°æ•°æ®åº“</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/save&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">CategoryBrandRelationEntity</span> categoryBrandRelation<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// ä¿å­˜ brand_idã€catelog_idã€brand_nameã€catelog_name</span>
    categoryBrandRelationService<span class="token punctuation">.</span><span class="token function">saveDetail</span><span class="token punctuation">(</span>categoryBrandRelation<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.3.1.png" alt="image-20220510215925645" tabindex="0" loading="lazy"><figcaption>image-20220510215925645</figcaption></figure><h4 id="_2ã€æ·»åŠ savedetailæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ savedetailæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 2ã€æ·»åŠ <code>saveDetail</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>com.atguigu.gulimall.product.service.CategoryBrandRelationService</code>æ¥å£é‡Œæ·»åŠ <code>saveDetail</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">saveDetail</span><span class="token punctuation">(</span><span class="token class-name">CategoryBrandRelationEntity</span> categoryBrandRelation<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.3.2.png" alt="image-20220510215959515" tabindex="0" loading="lazy"><figcaption>image-20220510215959515</figcaption></figure><h4 id="_3ã€å®ç°savedetailæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€å®ç°savedetailæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 3ã€å®ç°<code>saveDetail</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>com.atguigu.gulimall.product.service.impl.CategoryBrandRelationServiceImpl</code>ç±»é‡Œ</p><p>å®ç°<code>CategoryBrandRelationService</code>æ¥å£æœªå®ç°çš„<code>saveDetail</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">BrandDao</span> brandDao<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">CategoryDao</span> categoryDao<span class="token punctuation">;</span>
    
<span class="token doc-comment comment">/**
 *åŸæœ¬çš„saveæ–¹æ³•åªèƒ½ä¿å­˜ brand_id å’Œ catelog_id çš„å…³è”å…³ç³»,ä¸èƒ½ä¿å­˜ brand_name å’Œ catelog_name
 * ä¿å­˜ brand_idã€catelog_idã€brand_nameã€catelog_name
 * <span class="token keyword">@param</span> <span class="token parameter">categoryBrandRelation</span>
 */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveDetail</span><span class="token punctuation">(</span><span class="token class-name">CategoryBrandRelationEntity</span> categoryBrandRelation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Long</span> brandId <span class="token operator">=</span> categoryBrandRelation<span class="token punctuation">.</span><span class="token function">getBrandId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Long</span> catelogId <span class="token operator">=</span> categoryBrandRelation<span class="token punctuation">.</span><span class="token function">getCatelogId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//æ ¹æ®brandId æŸ¥è¯¢ brandName</span>
    <span class="token class-name">BrandEntity</span> brandEntity <span class="token operator">=</span> brandDao<span class="token punctuation">.</span><span class="token function">selectById</span><span class="token punctuation">(</span>brandId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ ¹æ® categoryId æŸ¥è¯¢ categoryName</span>
    <span class="token class-name">CategoryEntity</span> categoryEntity <span class="token operator">=</span> categoryDao<span class="token punctuation">.</span><span class="token function">selectById</span><span class="token punctuation">(</span>catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    categoryBrandRelation<span class="token punctuation">.</span><span class="token function">setBrandName</span><span class="token punctuation">(</span>brandEntity<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    categoryBrandRelation<span class="token punctuation">.</span><span class="token function">setCatelogName</span><span class="token punctuation">(</span>categoryEntity<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>categoryBrandRelation<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡ŒæŠ¥çº¢ä¸ç”¨ç®¡,ä½¿ç”¨MyBatisæ—¶daoæ¥å£æ²¡æœ‰å®ç°ç±»ï¼Œæ¥å£æ˜¯æ²¡æœ‰åŠæ³•åˆ›å»ºå®ä¾‹çš„ï¼Œå› æ­¤ä¹Ÿå°±æ— æ³•æ³¨å…¥åˆ°iocå®¹å™¨</p><p>IDEAæ£€æµ‹åˆ°æ²¡æœ‰æ³¨å…¥åˆ°iocå®¹å™¨ï¼Œæ‰€æœ‰å°±æŠ¥çº¢äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.3.3.png" alt="image-20220510220108353" tabindex="0" loading="lazy"><figcaption>image-20220510220108353</figcaption></figure><h4 id="_4ã€è§£å†³ideaæŠ¥çº¢" tabindex="-1"><a class="header-anchor" href="#_4ã€è§£å†³ideaæŠ¥çº¢" aria-hidden="true">#</a> 4ã€è§£å†³IDEAæŠ¥çº¢</h4><p>æŒ‰ä½<code>ctrl</code>é”®ï¼Œç‚¹å‡»<code>BrandDao</code>è¿›å…¥<code>BrandDao</code>ç±»</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.3.4.1.png" alt="image-20220510222434101" tabindex="0" loading="lazy"><figcaption>image-20220510222434101</figcaption></figure><p>æ·»åŠ <code>@Repository</code>æ³¨è§£ï¼Œæ˜¾å¼çš„æŠŠ<code>BrandDao</code>æ·»åŠ åˆ°iocå®¹å™¨</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.3.4.2.png" alt="image-20220510222612590" tabindex="0" loading="lazy"><figcaption>image-20220510222612590</figcaption></figure><p>æ·»åŠ <code>@Repository</code>æ³¨è§£ï¼Œæ˜¾å¼çš„æŠŠ<code>CategoryDao</code>æ·»åŠ åˆ°iocå®¹å™¨</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.3.4.3.png" alt="image-20220510222727987" tabindex="0" loading="lazy"><figcaption>image-20220510222727987</figcaption></figure><p>å·²ç»ä¸æŠ¥çº¢äº†(å…¶å®ä¸ä¿®æ”¹ä¹Ÿè¡Œ)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.3.4.4.png" alt="image-20220510223032990" tabindex="0" loading="lazy"><figcaption>image-20220510223032990</figcaption></figure><h4 id="_5ã€æµ‹è¯•-3" tabindex="-1"><a class="header-anchor" href="#_5ã€æµ‹è¯•-3" aria-hidden="true">#</a> 5ã€æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢</p><h5 id="_1ã€æ·»åŠ å…³è”åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ å…³è”åˆ†ç±»" aria-hidden="true">#</a> 1ã€æ·»åŠ å…³è”åˆ†ç±»</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.3.5.1.gif" alt="3" tabindex="0" loading="lazy"><figcaption>3</figcaption></figure><h5 id="_2ã€æŸ¥çœ‹å›æ˜¾æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹å›æ˜¾æ•°æ®" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹å›æ˜¾æ•°æ®</h5><p>URL: http://localhost:88/api/product/categorybrandrelation/catelog/list?t=1652197270780&amp;brandId=1</p><p>å›æ˜¾æ­£å¸¸ï¼Œè¯æ˜<code>catelogList</code>æ–¹æ³•å’Œ<code>save</code>æ–¹æ³•æ­£ç¡®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.3.5.2.png" alt="image-20220510234520024" tabindex="0" loading="lazy"><figcaption>image-20220510234520024</figcaption></figure><h5 id="_3ã€æŸ¥çœ‹æ•°æ®åº“" tabindex="-1"><a class="header-anchor" href="#_3ã€æŸ¥çœ‹æ•°æ®åº“" aria-hidden="true">#</a> 3ã€æŸ¥çœ‹æ•°æ®åº“</h5><p>å¯ä»¥çœ‹åˆ°å·²ç»<code>brand_idã€catelog_idã€brand_nameã€catelog_name</code>å…¨éƒ¨æ·»åŠ åˆ°æ•°æ®åº“äº†ï¼Œæ‰€æœ‰<code>save</code>æ–¹æ³•æ­£ç¡®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.3.5.3.png" alt="image-20220510233840276" tabindex="0" loading="lazy"><figcaption>image-20220510233840276</figcaption></figure><h3 id="_4-4-4ã€ä¿è¯æ•°æ®ä¸€è‡´æ€§" tabindex="-1"><a class="header-anchor" href="#_4-4-4ã€ä¿è¯æ•°æ®ä¸€è‡´æ€§" aria-hidden="true">#</a> 4.4.4ã€ä¿è¯æ•°æ®ä¸€è‡´æ€§</h3><p>å½“ä¿®æ”¹<code>brand_name</code>æˆ–<code>catelog_name</code>æ—¶,ä¸ä»…è¦æ›´æ–°<code>pms_category</code>æˆ–<code>pms_brand</code>è¡¨</p><p>åŒæ—¶ä¹Ÿè¦æ›´æ–°<code>pms_category_brand_relation</code>è¡¨ï¼Œç”¨æ¥ä¿è¯å†—ä½™å­—æ®µçš„ä¸€è‡´æ€§</p><h4 id="_1ã€ä¿®æ”¹updateæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿®æ”¹updateæ–¹æ³•" aria-hidden="true">#</a> 1ã€ä¿®æ”¹<code>update</code>æ–¹æ³•</h4><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—ä¸‹çš„<code>com.atguigu.gulimall.product.controller.BrandController</code>ç±»çš„<code>update</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/update&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Validated</span><span class="token punctuation">(</span><span class="token class-name">UpdateGroup</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">BrandEntity</span> brand<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    brandService<span class="token punctuation">.</span><span class="token function">updateDetail</span><span class="token punctuation">(</span>brand<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.4.1.png" alt="image-20220510235115019" tabindex="0" loading="lazy"><figcaption>image-20220510235115019</figcaption></figure><h4 id="_2ã€æ·»åŠ updatedetailæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ updatedetailæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 2ã€æ·»åŠ <code>updateDetail</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>com.atguigu.gulimall.product.service.BrandService</code>æ¥å£é‡Œæ·»åŠ <code>updateDetail</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">updateDetail</span><span class="token punctuation">(</span><span class="token class-name">BrandEntity</span> brand<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.4.2.png" alt="image-20220510235219096" tabindex="0" loading="lazy"><figcaption>image-20220510235219096</figcaption></figure><h4 id="_3ã€å®ç°updatedetailæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€å®ç°updatedetailæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 3ã€å®ç°<code>updateDetail</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>com.atguigu.gulimall.product.service.impl.BrandServiceImpl</code>ç±»é‡Œå®ç°<code>updateDetail</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">CategoryBrandRelationService</span> categoryBrandRelationService<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateDetail</span><span class="token punctuation">(</span><span class="token class-name">BrandEntity</span> brand<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//ä¿è¯å†—ä½™å­—æ®µçš„æ•°æ®ä¸€è‡´</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>brand<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>brand<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//åŒæ­¥æ›´æ–°å…¶ä»–å…³è”è¡¨ä¸­çš„æ•°æ®</span>
        categoryBrandRelationService<span class="token punctuation">.</span><span class="token function">updateBrand</span><span class="token punctuation">(</span>brand<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//TODO æ›´æ–°å…¶ä»–å…³è”</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.4.3.png" alt="image-20220511000527982" tabindex="0" loading="lazy"><figcaption>image-20220511000527982</figcaption></figure><h4 id="_4ã€æ·»åŠ updatebrandæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ updatebrandæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>updateBrand</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>com.atguigu.gulimall.product.service.CategoryBrandRelationService</code>æ¥å£é‡Œæ·»åŠ <code>updateBrand</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">updateBrand</span><span class="token punctuation">(</span><span class="token class-name">BrandEntity</span> brand<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.4.4.png" alt="image-20220511000607317" tabindex="0" loading="lazy"><figcaption>image-20220511000607317</figcaption></figure><h4 id="_5ã€å®ç°updatebrandæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€å®ç°updatebrandæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 5ã€å®ç°<code>updateBrand</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>com.atguigu.gulimall.product.service.impl.CategoryBrandRelationServiceImpl</code>ç±»é‡Œå®ç°<code>updateBrand</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateBrand</span><span class="token punctuation">(</span><span class="token class-name">BrandEntity</span> brand<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">CategoryBrandRelationEntity</span> categoryBrandRelationEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CategoryBrandRelationEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    categoryBrandRelationEntity<span class="token punctuation">.</span><span class="token function">setBrandId</span><span class="token punctuation">(</span>brand<span class="token punctuation">.</span><span class="token function">getBrandId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    categoryBrandRelationEntity<span class="token punctuation">.</span><span class="token function">setBrandName</span><span class="token punctuation">(</span>brand<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">LambdaUpdateWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryBrandRelationEntity</span><span class="token punctuation">&gt;</span></span> lambdaUpdateWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaUpdateWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaUpdateWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">CategoryBrandRelationEntity</span><span class="token operator">::</span><span class="token function">getBrandId</span><span class="token punctuation">,</span>brand<span class="token punctuation">.</span><span class="token function">getBrandId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>categoryBrandRelationEntity<span class="token punctuation">,</span>lambdaUpdateWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.4.5.png" alt="image-20220511001114986" tabindex="0" loading="lazy"><figcaption>image-20220511001114986</figcaption></figure><h4 id="_6ã€æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_6ã€æµ‹è¯•" aria-hidden="true">#</a> 6ã€æµ‹è¯•</h4><h5 id="_1ã€é‡å¯é¡¹ç›®å‰" tabindex="-1"><a class="header-anchor" href="#_1ã€é‡å¯é¡¹ç›®å‰" aria-hidden="true">#</a> 1ã€é‡å¯é¡¹ç›®å‰</h5><p>å¯ä»¥çœ‹åˆ°å½“ä¿®æ”¹å“ç‰Œååï¼Œå…³è”å…³ç³»è¡¨å¹¶æ²¡æœ‰æ›´æ–°ï¼Œå› æ­¤æ²¡æœ‰æ­£ç¡®å›æ˜¾</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.4.6.1.1.gif" alt="GIF 2022-5-11 0-14-16" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-11 0-14-16</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.4.6.1.2.png" alt="image-20220511001742563" tabindex="0" loading="lazy"><figcaption>image-20220511001742563</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.4.6.1.3.png" alt="image-20220511001759165" tabindex="0" loading="lazy"><figcaption>image-20220511001759165</figcaption></figure><h5 id="_2ã€é‡å¯é¡¹ç›®å" tabindex="-1"><a class="header-anchor" href="#_2ã€é‡å¯é¡¹ç›®å" aria-hidden="true">#</a> 2ã€é‡å¯é¡¹ç›®å</h5><p>å°†<code>åä¸º1</code>æ”¹ä¸º<code>åä¸º</code>,é‡å¯<code>gulimall-product</code>é¡¹ç›®åï¼Œå†æ¬¡æµ‹è¯•</p><p>å¯ä»¥çœ‹åˆ°å½“ä¿®æ”¹å“ç‰Œååï¼Œå…³è”å…³ç³»è¡¨å·²ç»æ›´æ–°ï¼Œå¹¶ä¸”æ­£ç¡®å›æ˜¾</p><p>ï¼ˆæˆåŠŸåè¦æ¢å¤ä¸ºåŸå§‹æ•°æ®ï¼‰</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.4.6.2.1.gif" alt="GIF 2022-5-11 0-20-17" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-11 0-20-17</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.4.6.2.2.png" alt="image-20220511002213445" tabindex="0" loading="lazy"><figcaption>image-20220511002213445</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.4.6.2.3.png" alt="image-20220511002226070" tabindex="0" loading="lazy"><figcaption>image-20220511002226070</figcaption></figure><h3 id="_4-4-5ã€ä¿è¯categoryæ•°æ®ä¸€è‡´æ€§" tabindex="-1"><a class="header-anchor" href="#_4-4-5ã€ä¿è¯categoryæ•°æ®ä¸€è‡´æ€§" aria-hidden="true">#</a> 4.4.5ã€ä¿è¯<code>Category</code>æ•°æ®ä¸€è‡´æ€§</h3><h4 id="_1ã€ä¿®æ”¹categoryçš„updateæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿®æ”¹categoryçš„updateæ–¹æ³•" aria-hidden="true">#</a> 1ã€ä¿®æ”¹<code>Category</code>çš„<code>update</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.CategoryController</code>ç±»é‡Œä¿®æ”¹<code>update</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/update&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">CategoryEntity</span> category<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//çº§è”æ›´æ–°</span>
    categoryService<span class="token punctuation">.</span><span class="token function">updateCascade</span><span class="token punctuation">(</span>category<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.5.1.png" alt="image-20220511002457753" tabindex="0" loading="lazy"><figcaption>image-20220511002457753</figcaption></figure><h4 id="_2ã€æ·»åŠ updatecascadeæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ updatecascadeæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 2ã€æ·»åŠ <code>updateCascade</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.CategoryService</code>ç±»é‡Œæ·»åŠ <code>updateCascade</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">updateCascade</span><span class="token punctuation">(</span><span class="token class-name">CategoryEntity</span> category<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.5.2.png" alt="image-20220511002632061" tabindex="0" loading="lazy"><figcaption>image-20220511002632061</figcaption></figure><h4 id="_3ã€å®ç°updatecascadeæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€å®ç°updatecascadeæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 3ã€å®ç°<code>updateCascade</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>com.atguigu.gulimall.product.service.impl.CategoryServiceImpl</code>ç±»é‡Œå®ç°<code>updateCascade</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">CategoryBrandRelationService</span> categoryBrandRelationService<span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * çº§è”æ›´æ–°æ‰€æœ‰çš„æ•°æ®
 * <span class="token keyword">@param</span> <span class="token parameter">category</span>
 */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateCascade</span><span class="token punctuation">(</span><span class="token class-name">CategoryEntity</span> category<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>category<span class="token punctuation">)</span><span class="token punctuation">;</span>
    categoryBrandRelationService<span class="token punctuation">.</span><span class="token function">updateCategory</span><span class="token punctuation">(</span>category<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.5.3.png" alt="image-20220511003343110" tabindex="0" loading="lazy"><figcaption>image-20220511003343110</figcaption></figure><h4 id="_4ã€æ·»åŠ updatecategoryæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ updatecategoryæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>updateCategory</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>com.atguigu.gulimall.product.service.CategoryBrandRelationService</code>æ¥å£é‡Œæ·»åŠ <code>updateCategory</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">updateCategory</span><span class="token punctuation">(</span><span class="token class-name">CategoryEntity</span> category<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.5.4.png" alt="image-20220511003421670" tabindex="0" loading="lazy"><figcaption>image-20220511003421670</figcaption></figure><h4 id="_5ã€å®ç°updatecategoryæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€å®ç°updatecategoryæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 5ã€å®ç°<code>updateCategory</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>com.atguigu.gulimall.product.service.impl.CategoryBrandRelationServiceImpl</code>ç±»é‡Œå®ç°<code>updateCategory</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateCategory</span><span class="token punctuation">(</span><span class="token class-name">CategoryEntity</span> category<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span>baseMapper<span class="token punctuation">.</span><span class="token function">updateCategory</span><span class="token punctuation">(</span>category<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.5.5..png" alt="image-20220511113803364" tabindex="0" loading="lazy"><figcaption>image-20220511113803364</figcaption></figure><h4 id="_6ã€æ·»åŠ updatecategoryæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_6ã€æ·»åŠ updatecategoryæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 6ã€æ·»åŠ <code>updateCategory</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>com.atguigu.gulimall.product.dao.CategoryBrandRelationDao</code>ç±»æ·»åŠ <code>updateCategory</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">updateCategory</span><span class="token punctuation">(</span><span class="token class-name">CategoryEntity</span> category<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>é¼ æ ‡æ‚¬æµ®åœ¨<code>updateCategory</code>ä¸Šæˆ–ä½¿ç”¨<code>alt+enter</code>å¿«æ·é”®ç‚¹å‡»<code>Generater statement</code>ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªé€‰é¡¹è¯´æ˜æ²¡æœ‰å®‰è£…<strong>MyBatisæ’ä»¶</strong></p><p>æ²¡æœ‰å°é¸Ÿå›¾æ ‡ä¹Ÿå¯ä»¥è¯æ˜æ²¡æœ‰å®‰è£…<strong>MyBatisæ’ä»¶</strong></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.5.6.1.png" alt="image-20220511123714784" tabindex="0" loading="lazy"><figcaption>image-20220511123714784</figcaption></figure><h5 id="mybatisä¼ é€’å¤šä¸ªå‚æ•°çš„4ç§æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#mybatisä¼ é€’å¤šä¸ªå‚æ•°çš„4ç§æ–¹å¼" aria-hidden="true">#</a> ğŸš€Mybatisä¼ é€’å¤šä¸ªå‚æ•°çš„4ç§æ–¹å¼</h5><h6 id="æ–¹æ³•1-é¡ºåºä¼ å‚æ³•" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•1-é¡ºåºä¼ å‚æ³•" aria-hidden="true">#</a> æ–¹æ³•1ï¼šé¡ºåºä¼ å‚æ³•</h6><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>public User selectUser<span class="token punctuation">(</span>String name, int deptId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectUser&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;UserResultMap&quot;</span><span class="token operator">&gt;</span>
    <span class="token keyword">select</span> * from user
    where user_name <span class="token operator">=</span> <span class="token comment">#{0} and dept_id = #{1}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
<span class="token number">123456</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>#{}é‡Œé¢çš„æ•°å­—ä»£è¡¨ä½ ä¼ å…¥å‚æ•°çš„é¡ºåºã€‚</p><p>è¿™ç§æ–¹æ³•ä¸å»ºè®®ä½¿ç”¨ï¼Œsqlå±‚è¡¨è¾¾ä¸ç›´è§‚ï¼Œä¸”ä¸€æ—¦é¡ºåºè°ƒæ•´å®¹æ˜“å‡ºé”™ã€‚</p><h6 id="æ–¹æ³•2-paramæ³¨è§£ä¼ å‚æ³•" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•2-paramæ³¨è§£ä¼ å‚æ³•" aria-hidden="true">#</a> æ–¹æ³•2ï¼š@Paramæ³¨è§£ä¼ å‚æ³•</h6><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>public User selectUser<span class="token punctuation">(</span>@Param<span class="token punctuation">(</span><span class="token string">&quot;userName&quot;</span><span class="token punctuation">)</span> String name, int @Param<span class="token punctuation">(</span><span class="token string">&quot;deptId&quot;</span><span class="token punctuation">)</span> deptId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectUser&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;UserResultMap&quot;</span><span class="token operator">&gt;</span>
    <span class="token keyword">select</span> * from user
    where user_name <span class="token operator">=</span> <span class="token comment">#{userName} and dept_id = #{deptId}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
<span class="token number">123456</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>#{}é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯æ³¨è§£ @Paramæ‹¬å·é‡Œé¢ä¿®é¥°çš„åç§°ã€‚ è¿™ç§æ–¹æ³•åœ¨å‚æ•°ä¸å¤šçš„æƒ…å†µè¿˜æ˜¯æ¯”è¾ƒç›´è§‚çš„ï¼Œæ¨èä½¿ç”¨ã€‚</p><h6 id="æ–¹æ³•3-mapä¼ å‚æ³•" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•3-mapä¼ å‚æ³•" aria-hidden="true">#</a> æ–¹æ³•3ï¼šMapä¼ å‚æ³•</h6><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>public User selectUser<span class="token punctuation">(</span>Map<span class="token operator">&lt;</span>String, Object<span class="token operator">&gt;</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectUser&quot;</span> <span class="token assign-left variable">parameterType</span><span class="token operator">=</span><span class="token string">&quot;java.util.Map&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;UserResultMap&quot;</span><span class="token operator">&gt;</span>
    <span class="token keyword">select</span> * from user
    where user_name <span class="token operator">=</span> <span class="token comment">#{userName} and dept_id = #{deptId}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
<span class="token number">123456</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>#{}é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯ Mapé‡Œé¢çš„keyåç§°ã€‚</p><p>è¿™ç§æ–¹æ³•é€‚åˆä¼ é€’å¤šä¸ªå‚æ•°ï¼Œä¸”å‚æ•°æ˜“å˜èƒ½çµæ´»ä¼ é€’çš„æƒ…å†µã€‚</p><h6 id="æ–¹æ³•4-java-beanä¼ å‚æ³•" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•4-java-beanä¼ å‚æ³•" aria-hidden="true">#</a> æ–¹æ³•4ï¼šJava Beanä¼ å‚æ³•</h6><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>public User selectUser<span class="token punctuation">(</span>User params<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">&lt;</span>select <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;selectUser&quot;</span> <span class="token assign-left variable">parameterType</span><span class="token operator">=</span><span class="token string">&quot;com.test.User&quot;</span> <span class="token assign-left variable">resultMap</span><span class="token operator">=</span><span class="token string">&quot;UserResultMap&quot;</span><span class="token operator">&gt;</span>
    <span class="token keyword">select</span> * from user
    where user_name <span class="token operator">=</span> <span class="token comment">#{userName} and dept_id = #{deptId}</span>
<span class="token operator">&lt;</span>/select<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>#{}é‡Œé¢çš„åç§°å¯¹åº”çš„æ˜¯ Userç±»é‡Œé¢çš„æˆå‘˜å±æ€§ã€‚</p><p>è¿™ç§æ–¹æ³•å¾ˆç›´è§‚ï¼Œä½†éœ€è¦å»ºä¸€ä¸ªå®ä½“ç±»ï¼Œæ‰©å±•ä¸å®¹æ˜“ï¼Œéœ€è¦åŠ å±æ€§ï¼Œçœ‹æƒ…å†µä½¿ç”¨ã€‚</p><h5 id="æ·»åŠ mybatisæ’ä»¶" tabindex="-1"><a class="header-anchor" href="#æ·»åŠ mybatisæ’ä»¶" aria-hidden="true">#</a> ğŸš€æ·»åŠ MyBatisæ’ä»¶</h5><p>ç‚¹å‡»<code>File</code>--&gt;<code>Settings...</code>--&gt;<code>Plugins</code>--&gt;æœç´¢<code>MyBatisX</code>--&gt;ç‚¹å‡»<code>install</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.5.6.2.png" alt="image-20220511145711068" tabindex="0" loading="lazy"><figcaption>image-20220511145711068</figcaption></figure><h4 id="_7ã€æ·»åŠ updatecategoryçš„sqlè¯­å¥" tabindex="-1"><a class="header-anchor" href="#_7ã€æ·»åŠ updatecategoryçš„sqlè¯­å¥" aria-hidden="true">#</a> 7ã€æ·»åŠ <code>updateCategory</code>çš„sqlè¯­å¥</h4><p>åœ¨<code>src/main/resources/mapper/product/CategoryBrandRelationDao.xml</code>ä¸­æ·»åŠ <code>updateCategory</code>çš„sqlè¯­å¥</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token operator">&lt;</span>update <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">&quot;updateCategory&quot;</span> <span class="token assign-left variable">parameterType</span><span class="token operator">=</span><span class="token string">&quot;categoryEntity&quot;</span><span class="token operator">&gt;</span>
    update gulimall_pms.pms_category_brand_relation
    <span class="token builtin class-name">set</span> <span class="token assign-left variable">catelog_name</span><span class="token operator">=</span><span class="token comment">#{name}</span>
    where <span class="token assign-left variable">catelog_id</span><span class="token operator">=</span><span class="token comment">#{catId}</span>
<span class="token operator">&lt;</span>/update<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.5.7.png" alt="image-20220511124930457" tabindex="0" loading="lazy"><figcaption>image-20220511124930457</figcaption></figure><h4 id="_8ã€ä¸ºå®ä½“ç±»èµ·åˆ«å" tabindex="-1"><a class="header-anchor" href="#_8ã€ä¸ºå®ä½“ç±»èµ·åˆ«å" aria-hidden="true">#</a> 8ã€ä¸ºå®ä½“ç±»èµ·åˆ«å</h4><p>åœ¨<code>src/main/resources/application.yml</code>é‡Œæ·»åŠ é…ç½®ï¼Œä¸º<code>com.atguigu.gulimall.product.entity</code>åŒ…ä¸‹çš„å®ä½“ç±»èµ·åˆ«å</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">mybatis-plus</span><span class="token punctuation">:</span>
  <span class="token comment">#èµ·åˆ«å</span>
  <span class="token key atrule">type-aliases-package</span><span class="token punctuation">:</span> com.atguigu.gulimall.product.entity
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.5.8.png" alt="image-20220511125048450" tabindex="0" loading="lazy"><figcaption>image-20220511125048450</figcaption></figure><h4 id="_9ã€å•å…ƒæµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_9ã€å•å…ƒæµ‹è¯•" aria-hidden="true">#</a> 9ã€å•å…ƒæµ‹è¯•</h4><p>åœ¨<code>src/test/java/com/atguigu/gulimall/product/GulimallProductApplicationTests.java</code>é‡Œæ·»åŠ æµ‹è¯•æ–¹æ³•</p><p>ä½¿ç”¨MyBatisæ—¶daoæ¥å£æ²¡æœ‰å®ç°ç±»ï¼Œæ¥å£æ˜¯æ²¡æœ‰åŠæ³•åˆ›å»ºå®ä¾‹çš„ï¼Œå› æ­¤ä¹Ÿå°±æ— æ³•æ³¨å…¥åˆ°iocå®¹å™¨</p><p>IDEAæ£€æµ‹åˆ°æ²¡æœ‰æ³¨å…¥åˆ°iocå®¹å™¨ï¼Œæ‰€æœ‰å°±æŠ¥çº¢äº†</p><p>å¯ä»¥æŒ‰<code>ctrl</code>é”®å¹¶ç‚¹å‡»<code>CategoryBrandRelationDao</code>,åœ¨è¯¥ç±»ä¸Šæ·»åŠ <code>@Repository</code>æ³¨è§£ï¼Œæ˜¾å¼çš„æŠŠ<code>BrandDao</code>æ·»åŠ åˆ°iocå®¹å™¨ï¼Œå°±ä¸æŠ¥çº¢äº†</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">CategoryBrandRelationDao</span> categoryBrandRelationDao<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testCategoryBrandRelationDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token class-name">CategoryEntity</span> categoryEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CategoryEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   categoryEntity<span class="token punctuation">.</span><span class="token function">setCatId</span><span class="token punctuation">(</span><span class="token number">225L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   categoryEntity<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰‹æœº2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   categoryBrandRelationDao<span class="token punctuation">.</span><span class="token function">updateCategory</span><span class="token punctuation">(</span>categoryEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.5.9.1.png" alt="image-20220511151116797" tabindex="0" loading="lazy"><figcaption>image-20220511151116797</figcaption></figure><p>æ•°æ®åº“å·²ç»æ›´æ–°</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.5.9.2.png" alt="image-20220511125255539" tabindex="0" loading="lazy"><figcaption>image-20220511125255539</figcaption></figure><h4 id="_10ã€å‰ç«¯æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_10ã€å‰ç«¯æµ‹è¯•" aria-hidden="true">#</a> 10ã€å‰ç«¯æµ‹è¯•</h4><p>æŠŠæ•°æ®åœ¨æ”¹å›æ¥(æŠŠ<code>brand_name</code>ä¸º<code>åä¸º1</code>çš„ä¿®æ”¹ä¸º<code>åä¸º</code>ã€æŠŠ<code>catelog_name</code>ä¸º<code>æ‰‹æœº2</code>çš„ä¿®æ”¹ä¸º<code>æ‰‹æœº</code>)</p><p>ç„¶åé‡å¯<code>gulimall-product</code>é¡¹ç›®ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢è¿›è¡Œæµ‹è¯•ï¼Œå¯ä»¥çœ‹åˆ°å†—ä½™å­—æ®µå·²ç»æ›´æ–°äº†</p><p>ï¼ˆæˆåŠŸåè¦æ¢å¤ä¸ºåŸå§‹æ•°æ®ï¼‰</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.5.10.gif" alt="GIF 2022-5-11 15-30-12" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-11 15-30-12</figcaption></figure><h3 id="_4-4-6ã€å¼€å¯äº‹åŠ¡åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#_4-4-6ã€å¼€å¯äº‹åŠ¡åŠŸèƒ½" aria-hidden="true">#</a> 4.4.6ã€å¼€å¯äº‹åŠ¡åŠŸèƒ½</h3><h4 id="_1ã€å¼€å¯äº‹åŠ¡åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#_1ã€å¼€å¯äº‹åŠ¡åŠŸèƒ½" aria-hidden="true">#</a> 1ã€å¼€å¯äº‹åŠ¡åŠŸèƒ½</h4><p>åœ¨<code>com.atguigu.gulimall.product.config.MyBatisConfig</code>é…ç½®ç±»é‡Œå¼€å¯äº‹åŠ¡åŠŸèƒ½(å·²ç»å¼€å¯è¿‡äº†)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableTransactionManagement</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.6.1.png" alt="image-20220511004119519" tabindex="0" loading="lazy"><figcaption>image-20220511004119519</figcaption></figure><h4 id="_2ã€updatecascadeæ–¹æ³•ä¸Šæ·»åŠ äº‹åŠ¡æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_2ã€updatecascadeæ–¹æ³•ä¸Šæ·»åŠ äº‹åŠ¡æ³¨è§£" aria-hidden="true">#</a> 2ã€<code>updateCascade</code>æ–¹æ³•ä¸Šæ·»åŠ äº‹åŠ¡æ³¨è§£</h4><p>åœ¨<code>com.atguigu.gulimall.product.service.impl.CategoryServiceImpl</code>ç±»çš„<code>updateCascade</code>æ–¹æ³•ä¸Šæ·»åŠ <code>@Transactional</code>æ³¨è§£</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.6.2.png" alt="image-20220511004035837" tabindex="0" loading="lazy"><figcaption>image-20220511004035837</figcaption></figure><h4 id="_3ã€updatedetailæ–¹æ³•ä¸Šæ·»åŠ äº‹åŠ¡æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_3ã€updatedetailæ–¹æ³•ä¸Šæ·»åŠ äº‹åŠ¡æ³¨è§£" aria-hidden="true">#</a> 3ã€<code>updateDetail</code>æ–¹æ³•ä¸Šæ·»åŠ äº‹åŠ¡æ³¨è§£</h4><p>åœ¨<code>com.atguigu.gulimall.product.service.impl.BrandServiceImpl</code>ç±»çš„<code>updateDetail</code>æ–¹æ³•ä¸Šæ·»åŠ <code>@Transactional</code>æ³¨è§£</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.4.6.3.png" alt="image-20220511004000692" tabindex="0" loading="lazy"><figcaption>image-20220511004000692</figcaption></figure><h2 id="_4-5ã€å•†å“æœåŠ¡-api-å¹³å°å±æ€§" tabindex="-1"><a class="header-anchor" href="#_4-5ã€å•†å“æœåŠ¡-api-å¹³å°å±æ€§" aria-hidden="true">#</a> 4.5ã€å•†å“æœåŠ¡-API-å¹³å°å±æ€§</h2><h3 id="_4-5-1ã€è§„æ ¼å‚æ•°æ–°å¢ä¸vo" tabindex="-1"><a class="header-anchor" href="#_4-5-1ã€è§„æ ¼å‚æ•°æ–°å¢ä¸vo" aria-hidden="true">#</a> 4.5.1ã€è§„æ ¼å‚æ•°æ–°å¢ä¸VO</h3><h4 id="_1ã€ä¿®æ”¹querypageæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿®æ”¹querypageæ–¹æ³•" aria-hidden="true">#</a> 1ã€ä¿®æ”¹<code>queryPage</code>æ–¹æ³•</h4><h5 id="_1ã€æŸ¥è¯¢å…¨éƒ¨æ—¶æœ‰æŸ¥è¯¢æ¡ä»¶" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥è¯¢å…¨éƒ¨æ—¶æœ‰æŸ¥è¯¢æ¡ä»¶" aria-hidden="true">#</a> 1ã€æŸ¥è¯¢å…¨éƒ¨æ—¶æœ‰æŸ¥è¯¢æ¡ä»¶</h5><p>url: http://localhost:88/api/product/attrgroup/list/0?t=1652341878270&amp;page=1&amp;limit=10&amp;key=%E4%B8%BB</p><p>ä»¥å‰å†™çš„åªæœ‰<code>catelogId != 0</code>æ—¶æ‰å¸¦æŸ¥è¯¢æ¡ä»¶,å› æ­¤è¾“å…¥æŸ¥è¯¢æ¡ä»¶ï¼Œç„¶åç‚¹å‡»<code>æŸ¥è¯¢å…¨éƒ¨</code>ï¼Œå¹¶æ²¡æœ‰æ ¹æ®æ¡ä»¶æŸ¥è¯¢å…¨éƒ¨</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.1.1.png" alt="image-20220512160738015" tabindex="0" loading="lazy"><figcaption>image-20220512160738015</figcaption></figure><h5 id="_2ã€ä»¥å‰å†™çš„åªæœ‰catelogid-0æ—¶æ‰å¸¦æŸ¥è¯¢æ¡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2ã€ä»¥å‰å†™çš„åªæœ‰catelogid-0æ—¶æ‰å¸¦æŸ¥è¯¢æ¡ä»¶" aria-hidden="true">#</a> 2ã€ä»¥å‰å†™çš„åªæœ‰<code>catelogId != 0</code>æ—¶æ‰å¸¦æŸ¥è¯¢æ¡ä»¶</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">queryPage</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">,</span> <span class="token class-name">Long</span> catelogId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>catelogId <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">queryPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//select * from attr_group where catelogId = ? and ( attr_group_id = key or attr_group_name like %key%)</span>
        <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span> queryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getCatelogId</span><span class="token punctuation">,</span>catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            queryWrapper<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span>
                obj<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getAttrGroupId</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getAttrGroupName</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span>queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.1.2.png" alt="image-20220512155755111" tabindex="0" loading="lazy"><figcaption>image-20220512155755111</figcaption></figure><h5 id="_3ã€ä¿®æ”¹querypageæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹querypageæ–¹æ³•" aria-hidden="true">#</a> 3ã€ä¿®æ”¹<code>queryPage</code>æ–¹æ³•</h5><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrGroupServiceImpl</code>é‡Œçš„<code>queryPage</code>æ–¹æ³•ï¼Œ</p><p>ä½¿å¾—ä¸ç®¡<code>catelogId</code>æ˜¯å¦ç­‰äº0ï¼Œéƒ½å¸¦ä¸ŠæŸ¥è¯¢æ¡ä»¶</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">queryPage</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">,</span> <span class="token class-name">Long</span> catelogId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span> queryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        queryWrapper<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>obj <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            obj<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getAttrGroupId</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getAttrGroupName</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">if</span> <span class="token punctuation">(</span>catelogId <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//select * from attr_group where ( attr_group_id = key or attr_group_name like %key%)</span>
        <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span> queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">//select * from attr_group where ( attr_group_id = key or attr_group_name like %key%) and catelogId = ?</span>
        queryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getCatelogId</span><span class="token punctuation">,</span> catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span> queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>SELECT attr_group_id,icon,catelog_id,sort,descript,attr_group_name FROM pms_attr_group 
WHERE (( (attr_group_id = ? OR attr_group_name LIKE ?) ) AND catelog_id = ?) LIMIT ?,? 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.1.3.png" alt="image-20220512000235143" tabindex="0" loading="lazy"><figcaption>image-20220512000235143</figcaption></figure><h5 id="_4ã€é”™è¯¯å†™æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€é”™è¯¯å†™æ³•" aria-hidden="true">#</a> 4ã€é”™è¯¯å†™æ³•</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">queryPage</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">,</span> <span class="token class-name">Long</span> catelogId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span> queryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        queryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getAttrGroupId</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getAttrGroupName</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">if</span> <span class="token punctuation">(</span>catelogId <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//select * from attr_group where ( attr_group_id = key or attr_group_name like %key%)</span>
        <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span> queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">//select * from attr_group where ( attr_group_id = key or attr_group_name like %key%) and catelogId = ?</span>
        queryWrapper<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>obj<span class="token operator">-&gt;</span>obj<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getCatelogId</span><span class="token punctuation">,</span> catelogId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span> queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·å†™çš„<code>queryWrapper.and(obj-&gt;obj.eq(AttrGroupEntity::getCatelogId, catelogId));</code>ä½¿ç”¨<code>and</code>å°±æ²¡æ„ä¹‰äº†</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>SELECT attr_group_id,icon,catelog_id,sort,descript,attr_group_name FROM pms_attr_group WHERE (attr_group_id = ? OR attr_group_name LIKE ? AND ( (catelog_id = ?) )) LIMIT ?,? 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.1.4.png" alt="image-20220512000844124" tabindex="0" loading="lazy"><figcaption>image-20220512000844124</figcaption></figure><h5 id="_5ã€æµ‹è¯•-4" tabindex="-1"><a class="header-anchor" href="#_5ã€æµ‹è¯•-4" aria-hidden="true">#</a> 5ã€æµ‹è¯•</h5><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œç„¶ååˆ·æ–°å‰ç«¯é¡µé¢</p><p>é‡æ–°è¾“å…¥æŸ¥è¯¢æ¡ä»¶ï¼Œç„¶åç‚¹å‡»<code>æŸ¥è¯¢å…¨éƒ¨</code>ï¼Œå·²ç»æ ¹æ®æ¡ä»¶æŸ¥è¯¢å…¨éƒ¨äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.1.5.png" alt="image-20220512161159756" tabindex="0" loading="lazy"><figcaption>image-20220512161159756</figcaption></figure><h4 id="_2ã€æµ‹è¯•æ–°å¢å±æ€§" tabindex="-1"><a class="header-anchor" href="#_2ã€æµ‹è¯•æ–°å¢å±æ€§" aria-hidden="true">#</a> 2ã€æµ‹è¯•æ–°å¢å±æ€§</h4><h5 id="_1ã€åŸºç¡€å±æ€§" tabindex="-1"><a class="header-anchor" href="#_1ã€åŸºç¡€å±æ€§" aria-hidden="true">#</a> 1ã€åŸºç¡€å±æ€§</h5><p>å½“ç‚¹å‡»<code>å•†å“ç³»ç»Ÿ</code>ä¸‹çš„<code>å¹³å°å±æ€§</code>ä¸‹çš„<code>è§„æ ¼å‚æ•°</code>æ—¶ï¼Œä¼šè·å–<code>åŸºç¡€å±æ€§</code>(è§„æ ¼å‚æ•°ï¼Œå¦‚æœºèº«é¢œè‰²ç­‰)çš„åˆ—è¡¨</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.2.1.png" alt="image-20220512161328451" tabindex="0" loading="lazy"><figcaption>image-20220512161328451</figcaption></figure><h5 id="_2ã€æ–°å»ºå±æ€§-è§„æ ¼å‚æ•°" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å»ºå±æ€§-è§„æ ¼å‚æ•°" aria-hidden="true">#</a> 2ã€æ–°å»ºå±æ€§(è§„æ ¼å‚æ•°)</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.2.2.png" alt="image-20220512162502623" tabindex="0" loading="lazy"><figcaption>image-20220512162502623</figcaption></figure><h5 id="_3ã€ä¿å­˜æˆåŠŸäº†" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿å­˜æˆåŠŸäº†" aria-hidden="true">#</a> 3ã€ä¿å­˜æˆåŠŸäº†</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.2.3.png" alt="image-20220512162518487" tabindex="0" loading="lazy"><figcaption>image-20220512162518487</figcaption></figure><h5 id="_4ã€ä½†æ˜¯åªæ˜¯åŸºæœ¬ä¿å­˜" tabindex="-1"><a class="header-anchor" href="#_4ã€ä½†æ˜¯åªæ˜¯åŸºæœ¬ä¿å­˜" aria-hidden="true">#</a> 4ã€ä½†æ˜¯åªæ˜¯åŸºæœ¬ä¿å­˜</h5><p>åªæ˜¯åŸºæœ¬ä¿å­˜ï¼Œåªæ˜¯ä¿å­˜äº†æ˜¯å“ªä¸ªåˆ†ç±»çš„ï¼Œå¹¶æ²¡æœ‰ä¿å­˜æ˜¯å“ªä¸ªåˆ†ç»„</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.2.4.1.png" alt="image-20220512162814832" tabindex="0" loading="lazy"><figcaption>image-20220512162814832</figcaption></figure><p>åˆ†ç±»å±æ€§ä¿å­˜è¿›æ¥äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.2.4.2.png" alt="image-20220512163039683" tabindex="0" loading="lazy"><figcaption>image-20220512163039683</figcaption></figure><p>ä½†æ˜¯å…³è”å…³ç³»æ²¡ä¿å­˜</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.2.4.3.png" alt="image-20220512163053494" tabindex="0" loading="lazy"><figcaption>image-20220512163053494</figcaption></figure><h4 id="_3ã€ä¿®æ”¹æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹æ–¹æ³•" aria-hidden="true">#</a> 3ã€ä¿®æ”¹æ–¹æ³•</h4><h5 id="_1ã€æ·»åŠ attrvoç±»" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ attrvoç±»" aria-hidden="true">#</a> 1ã€æ·»åŠ <code>AttrVo</code>ç±»</h5><p>ç”±äºåœ¨å®ä½“ç±»é‡Œæ·»åŠ å­—æ®µï¼Œç„¶åå†æ ‡æ³¨<code>@TableField(exist = false)</code>æ³¨è§£ï¼Œå‘Šè¯‰<code>MyBatis</code>è¯¥å­—æ®µä¸å­˜åœ¨æ˜¯å¾ˆä¸è§„èŒƒçš„ï¼Œ</p><p>æ‰€ä»¥å¯ä»¥ä½¿ç”¨Voå¯¹è±¡ï¼ŒVoæ˜¯ç”¨æ¥å°è£…è¯·æ±‚å’Œå“åº”æ•°æ®çš„ï¼Œä¸å»ºè®®ç»§æ‰¿å®ä½“ç±»ï¼Œå› éµå¾ªå¤šå®ç°ï¼Œå°‘ç»§æ‰¿çš„åŸåˆ™</p><p><code>AttrVo</code>ç±»é‡Œé¢è·Ÿæ•°æ®åº“ç›¸å…³çš„æ³¨è§£å°±ä¸éœ€è¦äº†</p><p>åœ¨\`\`gulimall-product<code>æ¨¡å—çš„</code>com.atguigu.gulimall.product<code>åŒ…ä¸‹æ–°å»º</code>vo\`æ–‡ä»¶å¤¹</p><p>åœ¨<code>com.atguigu.gulimall.product.vo</code>åŒ…ä¸‹æ–°å»º<code>AttrVo</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/12
 * @Description:
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AttrVo</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * å±æ€§id
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> attrId<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * å±æ€§å
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> attrName<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * æ˜¯å¦éœ€è¦æ£€ç´¢[0-ä¸éœ€è¦ï¼Œ1-éœ€è¦]
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> searchType<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * å±æ€§å›¾æ ‡
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> icon<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * å¯é€‰å€¼åˆ—è¡¨[ç”¨é€—å·åˆ†éš”]
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> valueSelect<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * å±æ€§ç±»å‹[0-é”€å”®å±æ€§ï¼Œ1-åŸºæœ¬å±æ€§ï¼Œ2-æ—¢æ˜¯é”€å”®å±æ€§åˆæ˜¯åŸºæœ¬å±æ€§]
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> attrType<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * å¯ç”¨çŠ¶æ€[0 - ç¦ç”¨ï¼Œ1 - å¯ç”¨]
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> enable<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * æ‰€å±åˆ†ç±»
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> catelogId<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * å¿«é€Ÿå±•ç¤ºã€æ˜¯å¦å±•ç¤ºåœ¨ä»‹ç»ä¸Šï¼›0-å¦ 1-æ˜¯ã€‘ï¼Œåœ¨skuä¸­ä»ç„¶å¯ä»¥è°ƒæ•´
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> showDesc<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> attrGroupId<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.3.1.png" alt="image-20220512164302169" tabindex="0" loading="lazy"><figcaption>image-20220512164302169</figcaption></figure><p><strong>æ‰©å±•ï¼š</strong></p><p><strong>Object åˆ’åˆ†</strong></p><h6 id="_1-po-persistant-object-æŒä¹…å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_1-po-persistant-object-æŒä¹…å¯¹è±¡" aria-hidden="true">#</a> 1.PO(persistant object) æŒä¹…å¯¹è±¡</h6><p>PO å°±æ˜¯å¯¹åº”æ•°æ®åº“ä¸­æŸä¸ªè¡¨ä¸­çš„ä¸€æ¡è®°å½•ï¼Œå¤šä¸ªè®°å½•å¯ä»¥ç”¨ PO çš„é›†åˆã€‚ PO ä¸­åº”è¯¥ä¸åŒ…å«ä»»ä½•å¯¹æ•°æ®åº“çš„æ“ä½œã€‚</p><h6 id="_2-do-domain-object-é¢†åŸŸå¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_2-do-domain-object-é¢†åŸŸå¯¹è±¡" aria-hidden="true">#</a> 2.DOï¼ˆDomain Objectï¼‰é¢†åŸŸå¯¹è±¡</h6><p>å°±æ˜¯ä»ç°å®ä¸–ç•Œä¸­æŠ½è±¡å‡ºæ¥çš„æœ‰å½¢æˆ–æ— å½¢çš„ä¸šåŠ¡å®ä½“ã€‚</p><h6 id="_3-to-transfer-object-æ•°æ®ä¼ è¾“å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_3-to-transfer-object-æ•°æ®ä¼ è¾“å¯¹è±¡" aria-hidden="true">#</a> 3.TO(Transfer Object) ï¼Œæ•°æ®ä¼ è¾“å¯¹è±¡</h6><p>ä¸åŒçš„åº”ç”¨ç¨‹åºä¹‹é—´ä¼ è¾“çš„å¯¹è±¡</p><h6 id="_4-dto-data-transfer-object-æ•°æ®ä¼ è¾“å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_4-dto-data-transfer-object-æ•°æ®ä¼ è¾“å¯¹è±¡" aria-hidden="true">#</a> 4.DTOï¼ˆData Transfer Objectï¼‰æ•°æ®ä¼ è¾“å¯¹è±¡</h6><p>è¿™ä¸ªæ¦‚å¿µæ¥æºäº J2EE çš„è®¾è®¡æ¨¡å¼ï¼ŒåŸæ¥çš„ç›®çš„æ˜¯ä¸ºäº† EJB çš„åˆ†å¸ƒå¼åº”ç”¨æä¾›ç²—ç²’åº¦çš„æ•°æ®å®ä½“ï¼Œä»¥å‡å°‘åˆ†å¸ƒå¼è°ƒç”¨çš„æ¬¡æ•°ï¼Œ</p><p>ä»è€Œæé«˜åˆ†å¸ƒå¼è°ƒç”¨çš„æ€§èƒ½å’Œé™ä½ç½‘ç»œè´Ÿè½½ï¼Œä½†åœ¨è¿™é‡Œï¼Œæ³›æŒ‡ç”¨äºå±•ç¤ºå±‚ä¸æœåŠ¡å±‚ä¹‹é—´çš„æ•°æ®ä¼ è¾“å¯¹è±¡ã€‚</p><h6 id="_5-vo-value-object-å€¼å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_5-vo-value-object-å€¼å¯¹è±¡" aria-hidden="true">#</a> 5.VO(value object) å€¼å¯¹è±¡</h6><p>é€šå¸¸ç”¨äºä¸šåŠ¡å±‚ä¹‹é—´çš„æ•°æ®ä¼ é€’ï¼Œå’Œ PO ä¸€æ ·ä¹Ÿæ˜¯ä»…ä»…åŒ…å«æ•°æ®è€Œå·²ã€‚ä½†åº”æ˜¯æŠ½è±¡å‡ºçš„ä¸šåŠ¡å¯¹è±¡ , å¯ä»¥å’Œè¡¨å¯¹åº” , ä¹Ÿå¯ä»¥ä¸ ,</p><p>è¿™æ ¹æ®ä¸šåŠ¡çš„éœ€è¦ ã€‚ç”¨ new å…³é”®å­—åˆ›å»ºï¼Œç”±GC å›æ”¶çš„ã€‚ View objectï¼šè§†å›¾å¯¹è±¡ï¼› æ¥å—é¡µé¢ä¼ é€’æ¥çš„æ•°æ®ï¼Œå°è£…å¯¹è±¡ å°†ä¸šåŠ¡å¤„ç†å®Œæˆçš„å¯¹è±¡ï¼Œå°è£…æˆé¡µé¢è¦ç”¨çš„æ•°æ®</p><h6 id="_6-bo-business-object-ä¸šåŠ¡å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_6-bo-business-object-ä¸šåŠ¡å¯¹è±¡" aria-hidden="true">#</a> 6.BO(business object) ä¸šåŠ¡å¯¹è±¡</h6><p>ä»ä¸šåŠ¡æ¨¡å‹çš„è§’åº¦çœ‹ , è§ UML å…ƒä»¶é¢†åŸŸæ¨¡å‹ä¸­çš„é¢†åŸŸå¯¹è±¡ã€‚å°è£…ä¸šåŠ¡é€»è¾‘çš„ java å¯¹è±¡ , é€šè¿‡è°ƒç”¨ DAO æ–¹æ³• ,</p><p>ç»“åˆ PO,VO è¿›è¡Œä¸šåŠ¡æ“ä½œã€‚business object: ä¸šåŠ¡å¯¹è±¡ ä¸»è¦ä½œç”¨æ˜¯æŠŠä¸šåŠ¡é€»è¾‘å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ã€‚</p><p>è¿™ä¸ªå¯¹è±¡å¯ä»¥åŒ…æ‹¬ä¸€ä¸ªæˆ–å¤šä¸ªå…¶å®ƒçš„å¯¹è±¡ã€‚ æ¯”å¦‚ä¸€ä¸ªç®€å†ï¼Œæœ‰æ•™è‚²ç»å†ã€å·¥ä½œç»å†ã€ç¤¾ä¼šå…³ç³»ç­‰ç­‰ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æŠŠæ•™è‚²ç»å†å¯¹åº”ä¸€ä¸ª PO ï¼Œå·¥ä½œç»å†å¯¹åº”ä¸€ä¸ª PO ï¼Œç¤¾ä¼šå…³ç³»å¯¹åº”ä¸€ä¸ª PO ã€‚</p><p>å»ºç«‹ä¸€ä¸ªå¯¹åº”ç®€å†çš„ BO å¯¹è±¡å¤„ç†ç®€å†ï¼Œæ¯ä¸ª BO åŒ…å«è¿™äº› PO ã€‚ è¿™æ ·å¤„ç†ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹ BO å»å¤„ç†ã€‚</p><h6 id="_7-pojo-plain-ordinary-java-object-ç®€å•æ— è§„åˆ™-java-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_7-pojo-plain-ordinary-java-object-ç®€å•æ— è§„åˆ™-java-å¯¹è±¡" aria-hidden="true">#</a> 7.POJO(plain ordinary java object) ç®€å•æ— è§„åˆ™ java å¯¹è±¡</h6><p>ä¼ ç»Ÿæ„ä¹‰çš„ java å¯¹è±¡ã€‚å°±æ˜¯è¯´åœ¨ä¸€äº› Object/Relation Mapping å·¥å…·ä¸­ï¼Œèƒ½å¤Ÿåšåˆ°ç»´æŠ¤æ•°æ®åº“è¡¨è®°å½•çš„ persisent object å®Œå…¨æ˜¯ä¸€ä¸ªç¬¦åˆ Java Bean è§„èŒƒçš„çº¯ Java å¯¹è±¡ï¼Œæ²¡æœ‰å¢åŠ åˆ«çš„å±æ€§å’Œæ–¹æ³•ã€‚æˆ‘çš„ç†è§£å°±æ˜¯æœ€åŸºæœ¬çš„ java Bean ï¼Œåªæœ‰å±æ€§å­—æ®µåŠ setter å’Œ getteræ–¹æ³•ï¼ POJO æ˜¯ DO/DTO/BO/VO çš„ç»Ÿç§°ã€‚</p><h6 id="_8-dao-data-access-object-æ•°æ®è®¿é—®å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_8-dao-data-access-object-æ•°æ®è®¿é—®å¯¹è±¡" aria-hidden="true">#</a> 8.DAO(data access object) æ•°æ®è®¿é—®å¯¹è±¡</h6><p>æ˜¯ä¸€ä¸ª sun çš„ä¸€ä¸ªæ ‡å‡† j2ee è®¾è®¡æ¨¡å¼ï¼Œ è¿™ä¸ªæ¨¡å¼ä¸­æœ‰ä¸ªæ¥å£å°±æ˜¯ DAO ï¼Œå®ƒè´ŸæŒä¹…å±‚çš„æ“ä½œã€‚ä¸ºä¸šåŠ¡å±‚æä¾›æ¥å£ã€‚</p><p>æ­¤å¯¹è±¡ç”¨äºè®¿é—®æ•°æ®åº“ã€‚é€šå¸¸å’Œ PO ç»“åˆä½¿ç”¨ï¼Œ DAO ä¸­åŒ…å«äº†å„ç§æ•°æ®åº“çš„æ“ä½œæ–¹æ³•ã€‚é€šè¿‡å®ƒçš„æ–¹æ³• ,</p><p>ç»“åˆ PO å¯¹æ•°æ®åº“è¿›è¡Œç›¸å…³çš„æ“ä½œã€‚å¤¹åœ¨ä¸šåŠ¡é€»è¾‘ä¸æ•°æ®åº“èµ„æºä¸­é—´ã€‚é…åˆ VO, æä¾›æ•°æ®åº“çš„ CRUD æ“ä½œ</p><h5 id="_2ã€ä¿®æ”¹saveæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹saveæ–¹æ³•" aria-hidden="true">#</a> 2ã€ä¿®æ”¹<code>save</code>æ–¹æ³•</h5><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.AttrController</code>ç±»çš„<code>save</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/save&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">AttrVo</span> attr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    attrService<span class="token punctuation">.</span><span class="token function">saveAttr</span><span class="token punctuation">(</span>attr<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.3.2.png" alt="image-20220512165118105" tabindex="0" loading="lazy"><figcaption>image-20220512165118105</figcaption></figure><h5 id="_3ã€æ·»åŠ saveattræŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ saveattræŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>saveAttr</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.AttrService</code>æ¥å£é‡Œæ·»åŠ <code>saveAttr</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">saveAttr</span><span class="token punctuation">(</span><span class="token class-name">AttrVo</span> attr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.3.3.png" alt="image-20220512165526385" tabindex="0" loading="lazy"><figcaption>image-20220512165526385</figcaption></figure><h5 id="_4ã€å®ç°saveattræŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€å®ç°saveattræŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€å®ç°<code>saveAttr</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œå®ç°<code>saveAttr</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveAttr</span><span class="token punctuation">(</span><span class="token class-name">AttrVo</span> attr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AttrEntity</span> attrEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//å°†atträ¸­çš„æ•°æ®å¤åˆ¶åˆ°attrEntityå¯¹åº”çš„å­—æ®µé‡Œ</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>attr<span class="token punctuation">,</span>attrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//1ã€ä¿å­˜åŸºæœ¬æ•°æ®</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//2ã€ä¿å­˜å…³è”å…³ç³»</span>
    <span class="token class-name">AttrAttrgroupRelationEntity</span> attrAttrgroupRelationEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">setAttrGroupId</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è°ƒç”¨this.save(attrEntity);æ–¹æ³•åï¼Œä¼šå°†æ•°æ®åº“ç”Ÿæˆçš„attrIdå°è£…åˆ°AttrEntityé‡Œé¢</span>
    attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">setAttrId</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.3.4.png" alt="image-20220512171158059" tabindex="0" loading="lazy"><figcaption>image-20220512171158059</figcaption></figure><h5 id="_5ã€æµ‹è¯•-5" tabindex="-1"><a class="header-anchor" href="#_5ã€æµ‹è¯•-5" aria-hidden="true">#</a> 5ã€æµ‹è¯•</h5><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œé‡æ–°æ·»åŠ è§„æ ¼å‚æ•°</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.3.5.1.png" alt="image-20220512171458466" tabindex="0" loading="lazy"><figcaption>image-20220512171458466</figcaption></figure><p>å…³è”å…³ç³»å·²ç»æˆåŠŸä¿å­˜äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.1.3.5.2.png" alt="image-20220512171744173" tabindex="0" loading="lazy"><figcaption>image-20220512171744173</figcaption></figure><h3 id="_4-5-2ã€è§„æ ¼å‚æ•°åˆ—è¡¨æ˜¾ç¤º" tabindex="-1"><a class="header-anchor" href="#_4-5-2ã€è§„æ ¼å‚æ•°åˆ—è¡¨æ˜¾ç¤º" aria-hidden="true">#</a> 4.5.2ã€è§„æ ¼å‚æ•°åˆ—è¡¨æ˜¾ç¤º</h3><h4 id="_1ã€æ·»åŠ æŸ¥è¯¢è§„æ ¼å‚æ•°åˆ—è¡¨åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ æŸ¥è¯¢è§„æ ¼å‚æ•°åˆ—è¡¨åŠŸèƒ½" aria-hidden="true">#</a> 1ã€æ·»åŠ æŸ¥è¯¢è§„æ ¼å‚æ•°åˆ—è¡¨åŠŸèƒ½</h4><h5 id="_1ã€æŸ¥çœ‹è¯·æ±‚-1" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹è¯·æ±‚-1" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹è¯·æ±‚</h5><p>å½“ç‚¹å‡»<code>è§„æ ¼å‚æ•°</code>é‡Œçš„<code>æ‰‹æœº\\æ‰‹æœºé€šè®¯\\æ‰‹æœº</code>åï¼Œä¼šå‘é€è¿™ä¸ªè¯·æ±‚</p><p>http://localhost:88/api/product/attr/base/list/225?t=1652347219117&amp;page=1&amp;limit=10&amp;key=</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.1.1.1.png" alt="image-20220512172045858" tabindex="0" loading="lazy"><figcaption>image-20220512172045858</figcaption></figure>`,336),Ma={href:"https://easydoc.net/s/78237135/ZUqEdvA4/Ld1Vfkcd",target:"_blank",rel:"noopener noreferrer"},Oa=e(`<figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.1.1.2.png" alt="image-20220518194247523" tabindex="0" loading="lazy"><figcaption>image-20220518194247523</figcaption></figure><h5 id="_2ã€æ·»åŠ baseattrlistæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ baseattrlistæ–¹æ³•" aria-hidden="true">#</a> 2ã€æ·»åŠ <code>baseAttrList</code>æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.AttrController</code>ç±»é‡Œæ·»åŠ <code>baseAttrList</code>æ–¹æ³•</p><p>è¿™é‡Œçš„ä»£ç æœ‰é—®é¢˜ï¼Œåº”è¯¥ä¸º<code>@GetMapping(&quot;/base/list/{categoryId}&quot;)</code>ï¼Œå¤šå†™äº†ä¸ª<code>$</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/base/list/\${categoryId}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">baseAttrList</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">,</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;categoryId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> categoryId<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">PageUtils</span> page <span class="token operator">=</span> attrService<span class="token punctuation">.</span><span class="token function">queryBaseAttrPage</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span>categoryId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">,</span> page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.1.2.png" alt="image-20220512173043820" tabindex="0" loading="lazy"><figcaption>image-20220512173043820</figcaption></figure><h5 id="_3ã€æ·»åŠ querybaseattrpageæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ querybaseattrpageæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>queryBaseAttrPage</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.AttrService</code>æ¥å£é‡Œæ·»åŠ <code>queryBaseAttrPage</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">PageUtils</span> <span class="token function">queryBaseAttrPage</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">,</span> <span class="token class-name">Long</span> categoryId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.1.3.png" alt="image-20220512173145318" tabindex="0" loading="lazy"><figcaption>image-20220512173145318</figcaption></figure><h5 id="_4ã€å®ç°querybaseattrpageæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€å®ç°querybaseattrpageæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€å®ç°<code>queryBaseAttrPage</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œå®ç°<code>queryBaseAttrPage</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">queryBaseAttrPage</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">,</span> <span class="token class-name">Long</span> categoryId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>categoryId <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getCatelogId</span><span class="token punctuation">,</span> categoryId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span>
           obj<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getAttrId</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getAttrName</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span> lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.1.4.png" alt="image-20220512174710768" tabindex="0" loading="lazy"><figcaption>image-20220512174710768</figcaption></figure><h5 id="_5ã€æµ‹è¯•-6" tabindex="-1"><a class="header-anchor" href="#_5ã€æµ‹è¯•-6" aria-hidden="true">#</a> 5ã€æµ‹è¯•</h5><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯ç•Œé¢</p><p>æŠ¥é”™äº†</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Could not resolve placeholder &#39;categoryId&#39; in value &quot;/base/list/\${categoryId}&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.1.5.1.png" alt="image-20220512175657245" tabindex="0" loading="lazy"><figcaption>image-20220512175657245</figcaption></figure><p>ä¿®æ”¹ä»£ç ï¼Œåˆ æ‰<code>@GetMapping(&quot;/base/list/{categoryId}&quot;)</code>é‡Œé¢å¤šå†™çš„<code>$</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/base/list/{categoryId}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">baseAttrList</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">,</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;categoryId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> categoryId<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">PageUtils</span> page <span class="token operator">=</span> attrService<span class="token punctuation">.</span><span class="token function">queryBaseAttrPage</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span>categoryId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">,</span> page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.1.5.2.png" alt="image-20220512231037337" tabindex="0" loading="lazy"><figcaption>image-20220512231037337</figcaption></figure><p>é‡æ–°å¯åŠ¨<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯ç•Œé¢</p><p>å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†ï¼Œä½†æ˜¯<strong>æ‰€å±åˆ†ç±»</strong>å’Œ<strong>æ‰€å±åˆ†ç»„</strong>æ²¡æœ‰æ˜¾ç¤º</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.1.5.3.png" alt="image-20220512231242187" tabindex="0" loading="lazy"><figcaption>image-20220512231242187</figcaption></figure><h4 id="_2ã€æ˜¾ç¤ºæ‰€å±åˆ†ç±»å’Œæ‰€å±åˆ†ç»„" tabindex="-1"><a class="header-anchor" href="#_2ã€æ˜¾ç¤ºæ‰€å±åˆ†ç±»å’Œæ‰€å±åˆ†ç»„" aria-hidden="true">#</a> 2ã€æ˜¾ç¤ºæ‰€å±åˆ†ç±»å’Œæ‰€å±åˆ†ç»„</h4><h5 id="_1ã€æ–°å»ºattrrespvoç±»" tabindex="-1"><a class="header-anchor" href="#_1ã€æ–°å»ºattrrespvoç±»" aria-hidden="true">#</a> 1ã€æ–°å»º<code>AttrRespVo</code>ç±»</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—ä¸‹çš„<code>com.atguigu.gulimall.product.vo</code>åŒ…å†…æ–°å»º<code>AttrRespVo</code>ç±»ï¼Œç»§æ‰¿<code>AttrVo</code>ç±»</p><p><strong>è¿™é‡Œçš„<code>categoryName</code>æ˜¯é”™çš„ï¼Œåº”è¯¥ä¸º<code>catelogName</code></strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/12
 * @Description:
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AttrRespVo</span> <span class="token keyword">extends</span> <span class="token class-name">AttrVo</span><span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * æ‰€å±åˆ†ç±»å   /æ‰‹æœº/æ•°ç /æ‰‹æœº
     */</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> categoryName<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * æ‰€å±åˆ†ç»„å  ä¸»æœº
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> groupName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.2.1.png" alt="image-20220513000203162" tabindex="0" loading="lazy"><figcaption>image-20220513000203162</figcaption></figure><h5 id="_2ã€ä¿®æ”¹querybaseattrpageæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹querybaseattrpageæ–¹æ³•" aria-hidden="true">#</a> 2ã€ä¿®æ”¹<code>queryBaseAttrPage</code>æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œä¿®æ”¹<code>queryBaseAttrPage</code>æ–¹æ³•</p><p>åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œè¿è¡¨æŸ¥è¯¢å¾ˆå±é™©ï¼Œåš<strong>ç¬›å¡å„¿ç§¯</strong>ä¼šä½¿æ•°æ®é‡éå¸¸å¤§ï¼Œå› æ­¤ä¹Ÿä¸æ¨èä½¿ç”¨<strong>å¤–é”®</strong>ï¼Œä½¿ç”¨<code>service</code>æ¥å¤„ç†è¡¨ä¹‹é—´çš„å…³ç³»</p><p>åœ¨<code>streat</code>çš„<code>map</code>é‚£ï¼ŒIDEAæç¤ºå»ºè®®ä½¿ç”¨<code>peek</code>æ¥ä»£æ›¿<code>map</code>ï¼›<code>java.util.Stream.peek()</code>ä¸»è¦ç”¨äºæ”¯æŒè°ƒè¯•ã€‚å¦‚æœæµç®¡é“ä¸åŒ…å«ç»ˆç«¯æ“ä½œï¼Œåˆ™ä¸ä¼šä½¿ç”¨ä»»ä½•å…ƒç´ ï¼Œå¹¶ä¸”æ ¹æœ¬ä¸ä¼šè°ƒç”¨peek()æ“ä½œã€‚æ‰€ä»¥æœ€å¥½ä¸è¦ä½¿ç”¨<code>peek</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">CategoryDao</span> categoryDao<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">AttrGroupDao</span> attrGroupDao<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">queryBaseAttrPage</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">,</span> <span class="token class-name">Long</span> categoryId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>categoryId <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//å¦‚æœæœ‰categoryIdï¼Œåˆ™æŸ¥è¯¥categoryIdçš„æ•°æ®</span>
        lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getCatelogId</span><span class="token punctuation">,</span> categoryId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">//å¦‚æœæœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œåˆ™åˆ¤æ–­è¯¥æ¡ä»¶æ˜¯å¦ ä¸attrIdç›¸ç­‰ æˆ– åå­—åŒ…å«è¯¥æ¡ä»¶</span>
            obj<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getAttrId</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getAttrName</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span> lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//æŸ¥è¯¢categoryNameå­—æ®µå’ŒgroupNameå­—æ®µ</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrRespVo</span><span class="token punctuation">&gt;</span></span> respVos <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>attrEntity <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">AttrRespVo</span> attrRespVo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrRespVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">,</span> attrRespVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ ¹æ®attrIdåˆ°attrå’Œattrgroupçš„ä¸­é—´è¡¨æŸ¥è¯¢ attrgroupId</span>
        <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">&gt;</span></span> attrAttrgroupRelationQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        attrAttrgroupRelationQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token operator">::</span><span class="token function">getAttrId</span><span class="token punctuation">,</span> attrEntity<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ ¹æ®attrgroupIdæŸ¥è¯¢ä¸­é—´è¡¨çš„è¯¥è¡Œæ•°æ®ï¼Œå¹¶å°è£…åˆ°å¯¹è±¡</span>
        <span class="token class-name">AttrAttrgroupRelationEntity</span> attrAttrgroupRelationEntity <span class="token operator">=</span> attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>attrAttrgroupRelationQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>attrAttrgroupRelationEntity <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//å¦‚æœæŸ¥åˆ°attrgroupIdï¼Œåˆ™æ ¹æ®attrgroupIdæŸ¥è¯¢attrgroupNameï¼Œå¹¶æ·»åŠ åˆ°attrRespVoä¸­</span>
            <span class="token class-name">AttrGroupEntity</span> attrGroupEntity <span class="token operator">=</span> attrGroupDao<span class="token punctuation">.</span><span class="token function">selectById</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">getAttrGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            attrRespVo<span class="token punctuation">.</span><span class="token function">setGroupName</span><span class="token punctuation">(</span>attrGroupEntity<span class="token punctuation">.</span><span class="token function">getAttrGroupName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryEntity</span><span class="token punctuation">&gt;</span></span> categoryQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        categoryQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">CategoryEntity</span><span class="token operator">::</span><span class="token function">getCatId</span><span class="token punctuation">,</span> attrEntity<span class="token punctuation">.</span><span class="token function">getCatelogId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ ¹æ®catelogIdæŸ¥è¯¢è¯¥è¡Œæ•°æ®ï¼Œå¹¶å°è£…åˆ°å¯¹è±¡</span>
        <span class="token class-name">CategoryEntity</span> categoryEntity <span class="token operator">=</span> categoryDao<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>categoryQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>categoryEntity <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            attrRespVo<span class="token punctuation">.</span><span class="token function">setCategoryName</span><span class="token punctuation">(</span>categoryEntity<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> attrRespVo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">PageUtils</span> pageUtils <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//é‡æ–°ç»™æ•°æ®</span>
    pageUtils<span class="token punctuation">.</span><span class="token function">setList</span><span class="token punctuation">(</span>respVos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> pageUtils<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3ã€æµ‹è¯•-3" tabindex="-1"><a class="header-anchor" href="#_3ã€æµ‹è¯•-3" aria-hidden="true">#</a> 3ã€æµ‹è¯•</h5><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢</p><h6 id="_1ã€æ‰€å±åˆ†ç±»æ²¡æœ‰æ•°æ®-æ‰€å±åˆ†ç»„æœ‰æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_1ã€æ‰€å±åˆ†ç±»æ²¡æœ‰æ•°æ®-æ‰€å±åˆ†ç»„æœ‰æ•°æ®" aria-hidden="true">#</a> 1ã€æ‰€å±åˆ†ç±»æ²¡æœ‰æ•°æ®ï¼Œæ‰€å±åˆ†ç»„æœ‰æ•°æ®</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.2.3.1.png" alt="image-20220513102104224" tabindex="0" loading="lazy"><figcaption>image-20220513102104224</figcaption></figure><h6 id="_2ã€æŸ¥çœ‹æ‰€å±åˆ†ç±»ç»‘å®šçš„åå­—" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹æ‰€å±åˆ†ç±»ç»‘å®šçš„åå­—" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹æ‰€å±åˆ†ç±»ç»‘å®šçš„åå­—</h6><p>å¯ä»¥çœ‹åˆ°ç»‘å®šçš„åå­—ä¸º<code>catelogName</code>ï¼Œè€Œåç«¯ä¼ è¿‡æ¥çš„ä¸º<code>categoryName</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.2.3.2.1.png" alt="image-20220513102522427" tabindex="0" loading="lazy"><figcaption>image-20220513102522427</figcaption></figure><p>ä¸ºä»€ä¹ˆæ˜¯è¿™ä¸ªæ–‡ä»¶å‘¢?</p><p>å¯ä»¥æŸ¥çœ‹å°±æ˜¯è¿™ä¸ªæ–¹æ³•å‘é€çš„è¯·æ±‚</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.2.3.2.2.png" alt="image-20220513102715896" tabindex="0" loading="lazy"><figcaption>image-20220513102715896</figcaption></figure><h6 id="_3ã€ä¿®æ”¹å­—æ®µåç§°" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹å­—æ®µåç§°" aria-hidden="true">#</a> 3ã€ä¿®æ”¹å­—æ®µåç§°</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—<code>com.atguigu.gulimall.product.vo.AttrRespVo</code>ç±»çš„å­—æ®µ</p><p>å°†<code>categoryName</code>æ”¹ä¸º<code>catelogName</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.2.3.3.1.png" alt="image-20220513102854084" tabindex="0" loading="lazy"><figcaption>image-20220513102854084</figcaption></figure><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»çš„<code>queryBaseAttrPage</code>æ–¹æ³•</p><p>å°†</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>attrRespVo<span class="token punctuation">.</span><span class="token function">setCategoryName</span><span class="token punctuation">(</span>categoryEntity<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ”¹ä¸º</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>attrRespVo<span class="token punctuation">.</span><span class="token function">setCatelogName</span><span class="token punctuation">(</span>categoryEntity<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.2.3.3.2.png" alt="image-20220513102940156" tabindex="0" loading="lazy"><figcaption>image-20220513102940156</figcaption></figure><h5 id="_4ã€é‡æ–°æµ‹è¯•-2" tabindex="-1"><a class="header-anchor" href="#_4ã€é‡æ–°æµ‹è¯•-2" aria-hidden="true">#</a> 4ã€é‡æ–°æµ‹è¯•</h5><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢ï¼Œå·²æˆåŠŸæ˜¾ç¤ºæ‰€å±åˆ†ç±»</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.2.2.4.png" alt="image-20220513103829286" tabindex="0" loading="lazy"><figcaption>image-20220513103829286</figcaption></figure><h3 id="_4-5-3ã€è§„æ ¼å‚æ•°ä¿®æ”¹å›æ˜¾" tabindex="-1"><a class="header-anchor" href="#_4-5-3ã€è§„æ ¼å‚æ•°ä¿®æ”¹å›æ˜¾" aria-hidden="true">#</a> 4.5.3ã€è§„æ ¼å‚æ•°ä¿®æ”¹å›æ˜¾</h3><h4 id="_1ã€æŸ¥çœ‹éœ€è¦å›æ˜¾çš„æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹éœ€è¦å›æ˜¾çš„æ•°æ®" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹éœ€è¦å›æ˜¾çš„æ•°æ®</h4><p>ç‚¹å‡»<code>ä¿®æ”¹</code>æŒ‰é’®ï¼Œå¯ä»¥çœ‹åˆ°è¿˜éœ€è¦ä¼šå…ˆæ‹¿<code>å±æ€§åˆ†ç±»</code>å’Œ<code>æ‰€å±åˆ†ç»„</code>,è€Œä¸”æˆ‘ç‚¹çš„æ˜¯<code>ä¿®æ”¹</code>ï¼Œè¿™ä¸ªè¡¨å•å´æ˜¾ç¤ºçš„æ˜¯ä¿®æ”¹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.3.1.png" alt="image-20220513104507146" tabindex="0" loading="lazy"><figcaption>image-20220513104507146</figcaption></figure><h4 id="_2ã€å¡«åŠ catelogpathå­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_2ã€å¡«åŠ catelogpathå­—æ®µ" aria-hidden="true">#</a> 2ã€å¡«åŠ <code>catelogPath</code>å­—æ®µ</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo.AttrRespVo</code>ç±»é‡Œæ·»åŠ <code>catelogPath</code>å­—æ®µ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> catelogPath<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.3.2.png" alt="image-20220513104838259" tabindex="0" loading="lazy"><figcaption>image-20220513104838259</figcaption></figure><h4 id="_3ã€ä¿®æ”¹infoæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹infoæ–¹æ³•" aria-hidden="true">#</a> 3ã€ä¿®æ”¹<code>info</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—é‡Œï¼Œä¿®æ”¹<code>com.atguigu.gulimall.product.controller.AttrController</code>ç±»çš„<code>info</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/info/{attrId}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">info</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;attrId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> attrId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//AttrEntity attr = attrService.getById(attrId);</span>
    <span class="token class-name">AttrRespVo</span> respVo <span class="token operator">=</span> attrService<span class="token punctuation">.</span><span class="token function">getAttrInfo</span><span class="token punctuation">(</span>attrId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;attr&quot;</span><span class="token punctuation">,</span> respVo
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.3.3.png" alt="image-20220513105158303" tabindex="0" loading="lazy"><figcaption>image-20220513105158303</figcaption></figure><h4 id="_4ã€æ·»åŠ getattrinfoæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ getattrinfoæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>getAttrInfo</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.AttrService</code>æ¥å£é‡Œæ·»åŠ <code>getAttrInfo</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">AttrRespVo</span> <span class="token function">getAttrInfo</span><span class="token punctuation">(</span><span class="token class-name">Long</span> attrId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.3.4.png" alt="image-20220513105520512" tabindex="0" loading="lazy"><figcaption>image-20220513105520512</figcaption></figure><h4 id="_5ã€å®ç°getattrinfoæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€å®ç°getattrinfoæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 5ã€å®ç°<code>getAttrInfo</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œå®ç°<code>getAttrInfo</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">AttrRespVo</span> <span class="token function">getAttrInfo</span><span class="token punctuation">(</span><span class="token class-name">Long</span> attrId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AttrRespVo</span> attrRespVo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrRespVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ ¹æ®attrIdåˆ°attrè¡¨ä¸­æŸ¥è¯¥è¡Œæ•°æ®</span>
    <span class="token class-name">AttrEntity</span> attrEntity <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>attrId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">,</span> attrRespVo<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">&gt;</span></span> attrAttrgroupRelationQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    attrAttrgroupRelationQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token operator">::</span><span class="token function">getAttrId</span><span class="token punctuation">,</span> attrId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ ¹æ®attrIdåˆ°attrAttrgroupRelationå…³è”å…³ç³»è¡¨é‡ŒæŸ¥attrGroupId</span>
    <span class="token class-name">AttrAttrgroupRelationEntity</span> attrAttrgroupRelationEntity <span class="token operator">=</span> attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>attrAttrgroupRelationQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>attrAttrgroupRelationEntity <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        attrRespVo<span class="token punctuation">.</span><span class="token function">setAttrGroupId</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">getAttrGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ ¹æ®attrGroupIdåˆ°attrGroupè¡¨é‡ŒæŸ¥groupName</span>
        <span class="token class-name">AttrGroupEntity</span> attrGroupEntity <span class="token operator">=</span> attrGroupDao<span class="token punctuation">.</span><span class="token function">selectById</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">getAttrGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>attrGroupEntity <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            attrRespVo<span class="token punctuation">.</span><span class="token function">setGroupName</span><span class="token punctuation">(</span>attrGroupEntity<span class="token punctuation">.</span><span class="token function">getAttrGroupName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//æ ¹æ®æœ€åä¸€çº§åˆ†ç±»idåˆ°categoryServiceä¸­æŸ¥è¯¢å®Œæ•´ä¸‰çº§åˆ†ç±»id</span>
    <span class="token class-name">Long</span> catelogId <span class="token operator">=</span> attrEntity<span class="token punctuation">.</span><span class="token function">getCatelogId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> catelogPath <span class="token operator">=</span> categoryService<span class="token punctuation">.</span><span class="token function">findCatelogPath</span><span class="token punctuation">(</span>catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>catelogPath<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        attrRespVo<span class="token punctuation">.</span><span class="token function">setCatelogPath</span><span class="token punctuation">(</span>catelogPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> attrRespVo<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.3.5.png" alt="image-20220513111825693" tabindex="0" loading="lazy"><figcaption>image-20220513111825693</figcaption></figure><h4 id="_6ã€æµ‹è¯•-1" tabindex="-1"><a class="header-anchor" href="#_6ã€æµ‹è¯•-1" aria-hidden="true">#</a> 6ã€æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢ï¼Œå·²æˆåŠŸæ˜¾ç¤º<code>å±æ€§åˆ†ç±»</code>å’Œ<code>æ‰€å±åˆ†ç»„</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.3.6.1.png" alt="image-20220513112029811" tabindex="0" loading="lazy"><figcaption>image-20220513112029811</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.3.6.2.png" alt="image-20220513112042807" tabindex="0" loading="lazy"><figcaption>image-20220513112042807</figcaption></figure><h3 id="_4-5-4ã€è§„æ ¼å‚æ•°ä¿®æ”¹å‘é€è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_4-5-4ã€è§„æ ¼å‚æ•°ä¿®æ”¹å‘é€è¯·æ±‚" aria-hidden="true">#</a> 4.5.4ã€è§„æ ¼å‚æ•°ä¿®æ”¹å‘é€è¯·æ±‚</h3><h4 id="_1ã€å‰ç«¯æäº¤æ—¶è§„åˆ™æ ¡éªŒå¤±è´¥" tabindex="-1"><a class="header-anchor" href="#_1ã€å‰ç«¯æäº¤æ—¶è§„åˆ™æ ¡éªŒå¤±è´¥" aria-hidden="true">#</a> 1ã€å‰ç«¯æäº¤æ—¶è§„åˆ™æ ¡éªŒå¤±è´¥</h4><h5 id="_1ã€å€¼ç±»å‹ä¸èƒ½ä¸ºç©º" tabindex="-1"><a class="header-anchor" href="#_1ã€å€¼ç±»å‹ä¸èƒ½ä¸ºç©º" aria-hidden="true">#</a> 1ã€å€¼ç±»å‹ä¸èƒ½ä¸ºç©º</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.1.png" alt="image-20220513114101205" tabindex="0" loading="lazy"><figcaption>image-20220513114101205</figcaption></figure><h5 id="_2ã€æŸ¥çœ‹æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹æ•°æ®" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹æ•°æ®</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.2.png" alt="image-20220513114127890" tabindex="0" loading="lazy"><figcaption>image-20220513114127890</figcaption></figure><h5 id="_3ã€å¯»æ‰¾åŸå› " tabindex="-1"><a class="header-anchor" href="#_3ã€å¯»æ‰¾åŸå› " aria-hidden="true">#</a> 3ã€å¯»æ‰¾åŸå› </h5><h6 id="_1ã€ç»‘å®švaluetype" tabindex="-1"><a class="header-anchor" href="#_1ã€ç»‘å®švaluetype" aria-hidden="true">#</a> 1ã€ç»‘å®š<code>valueType</code></h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.3.1.png" alt="image-20220513114746867" tabindex="0" loading="lazy"><figcaption>image-20220513114746867</figcaption></figure><h6 id="_2ã€valuetypeæ•°æ®å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_2ã€valuetypeæ•°æ®å­—æ®µ" aria-hidden="true">#</a> 2ã€<code>valueType</code>æ•°æ®å­—æ®µ</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.3.2.png" alt="image-20220513115002459" tabindex="0" loading="lazy"><figcaption>image-20220513115002459</figcaption></figure><h6 id="_3ã€valuetypeæ ¡éªŒå­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_3ã€valuetypeæ ¡éªŒå­—æ®µ" aria-hidden="true">#</a> 3ã€<code>valueType</code>æ ¡éªŒå­—æ®µ</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.3.3.png" alt="image-20220513115126361" tabindex="0" loading="lazy"><figcaption>image-20220513115126361</figcaption></figure><h6 id="_4ã€åˆå§‹åŒ–æ–¹æ³•é‡æ–°ç»™valuetypeèµ‹å€¼" tabindex="-1"><a class="header-anchor" href="#_4ã€åˆå§‹åŒ–æ–¹æ³•é‡æ–°ç»™valuetypeèµ‹å€¼" aria-hidden="true">#</a> 4ã€åˆå§‹åŒ–æ–¹æ³•é‡æ–°ç»™<code>valueType</code>èµ‹å€¼</h6><p>åˆå§‹åŒ–çš„æ—¶å€™é‡æ–°ç»™&quot;valueType&quot;èµ‹å€¼äº† å¾ˆæœ‰å¯èƒ½æ˜¯åœ¨è¿™ä¸ªæ—¶å€™æ²¡æœ‰è·å–åˆ°&quot;valueType&quot;</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.3.4.png" alt="image-20220513115444277" tabindex="0" loading="lazy"><figcaption>image-20220513115444277</figcaption></figure><h6 id="_5ã€è¡¨å•æäº¤åé‡æ–°ç»™valuetypeèµ‹å€¼" tabindex="-1"><a class="header-anchor" href="#_5ã€è¡¨å•æäº¤åé‡æ–°ç»™valuetypeèµ‹å€¼" aria-hidden="true">#</a> 5ã€è¡¨å•æäº¤åé‡æ–°ç»™<code>valueType</code>èµ‹å€¼</h6><p>è¡¨å•æäº¤çš„æ—¶å€™ä¹Ÿé‡æ–°èµ‹å€¼äº† ä½†ç°åœ¨è¡¨å•è¿˜æ²¡æäº¤ï¼Œåº”è¯¥ä¸æ˜¯è¿™é‡Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.3.5.png" alt="image-20220513115757511" tabindex="0" loading="lazy"><figcaption>image-20220513115757511</figcaption></figure><h6 id="_6ã€æŸ¥çœ‹åˆå§‹åŒ–è¯·æ±‚è¿”å›çš„æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_6ã€æŸ¥çœ‹åˆå§‹åŒ–è¯·æ±‚è¿”å›çš„æ•°æ®" aria-hidden="true">#</a> 6ã€æŸ¥çœ‹åˆå§‹åŒ–è¯·æ±‚è¿”å›çš„æ•°æ®</h6><p>å¯ä»¥çœ‹åˆ°æ²¡æœ‰<code>valueType</code>å­—æ®µ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.3.6.png" alt="image-20220513120136532" tabindex="0" loading="lazy"><figcaption>image-20220513120136532</figcaption></figure><h6 id="_7ã€è¿”å›å¯¹è±¡æ²¡æœ‰valuetypeå­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_7ã€è¿”å›å¯¹è±¡æ²¡æœ‰valuetypeå­—æ®µ" aria-hidden="true">#</a> 7ã€è¿”å›å¯¹è±¡æ²¡æœ‰<code>valueType</code>å­—æ®µ</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.3.7.png" alt="image-20220513120635878" tabindex="0" loading="lazy"><figcaption>image-20220513120635878</figcaption></figure><h6 id="_8ã€æ•°æ®åº“ä¹Ÿæ²¡æœ‰valuetypeå­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_8ã€æ•°æ®åº“ä¹Ÿæ²¡æœ‰valuetypeå­—æ®µ" aria-hidden="true">#</a> 8ã€æ•°æ®åº“ä¹Ÿæ²¡æœ‰<code>valueType</code>å­—æ®µ</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.3.8.png" alt="image-20220513120831498" tabindex="0" loading="lazy"><figcaption>image-20220513120831498</figcaption></figure><h5 id="_4ã€æ•°æ®åº“æ·»åŠ valuetypeå­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_4ã€æ•°æ®åº“æ·»åŠ valuetypeå­—æ®µ" aria-hidden="true">#</a> 4ã€æ•°æ®åº“æ·»åŠ <code>valueType</code>å­—æ®µ</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.4.png" alt="image-20220513121750821" tabindex="0" loading="lazy"><figcaption>image-20220513121750821</figcaption></figure><h5 id="_5ã€pojoå¯¹è±¡æ·»åŠ å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_5ã€pojoå¯¹è±¡æ·»åŠ å­—æ®µ" aria-hidden="true">#</a> 5ã€<code>pojo</code>å¯¹è±¡æ·»åŠ å­—æ®µ</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.entity.AttrEntity</code>ç±»é‡Œæ·»åŠ å­—æ®µ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * å€¼ç±»å‹ã€0-åªèƒ½å•ä¸ªå€¼ï¼Œ1-å…è®¸å¤šä¸ªå€¼ã€‘
 */</span>
<span class="token keyword">private</span> <span class="token class-name">Integer</span> valueType<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.5.1.png" alt="image-20220513122050410" tabindex="0" loading="lazy"><figcaption>image-20220513122050410</figcaption></figure><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo.AttrVo</code>ç±»é‡Œæ·»åŠ å­—æ®µ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.5.2.png" alt="image-20220513122208202" tabindex="0" loading="lazy"><figcaption>image-20220513122208202</figcaption></figure><p>ç”±äº<code>attrRespVo</code>ç»§æ‰¿äº†<code>attrVo</code>,æ‰€ä»¥ä¹Ÿæœ‰<code>valueType</code>å­—æ®µ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.5.3.png" alt="image-20220513122301927" tabindex="0" loading="lazy"><figcaption>image-20220513122301927</figcaption></figure><p>ç”±äºä½¿ç”¨çš„æ˜¯MyBatisPulsï¼Œæ‰€ä»¥<strong>å¢åˆ æŸ¥æ”¹</strong>ä¼šè‡ªåŠ¨å°†<code>entity</code>ç±»çš„æ‰€æœ‰éœ€è¦çš„å­—æ®µéƒ½å¸¦ä¸Šï¼Œå› æ­¤ä¸éœ€è¦ä¿®æ”¹ä¸šåŠ¡ä»£ç </p><h5 id="_6ã€é‡æ–°æµ‹è¯•-1" tabindex="-1"><a class="header-anchor" href="#_6ã€é‡æ–°æµ‹è¯•-1" aria-hidden="true">#</a> 6ã€é‡æ–°æµ‹è¯•</h5><p>ç°åœ¨æäº¤å·²ç»æ ¡éªŒæˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.1.6.png" alt="image-20220513122505664" tabindex="0" loading="lazy"><figcaption>image-20220513122505664</figcaption></figure><h4 id="_2ã€æŸ¥çœ‹è¯·æ±‚çš„url" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹è¯·æ±‚çš„url" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹è¯·æ±‚çš„URL</h4><p>è¯·æ±‚çš„URLä¸ºï¼šhttp://localhost:88/api/product/attr/update</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.2.png" alt="image-20220513222311216" tabindex="0" loading="lazy"><figcaption>image-20220513222311216</figcaption></figure><h4 id="_3ã€ä¿®æ”¹" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹" aria-hidden="true">#</a> 3ã€ä¿®æ”¹</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—é‡Œä¿®æ”¹<code>com.atguigu.gulimall.product.controller.AttrController</code>ç±»çš„<code>update</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/update&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">AttrVo</span> attr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    attrService<span class="token punctuation">.</span><span class="token function">updateAttr</span><span class="token punctuation">(</span>attr<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.3.png" alt="image-20220513222402532" tabindex="0" loading="lazy"><figcaption>image-20220513222402532</figcaption></figure><h4 id="_4ã€æ·»åŠ updateattræŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ updateattræŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>updateAttr</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.AttrService</code>æ¥å£é‡Œæ·»åŠ <code>updateAttr</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">updateAttr</span><span class="token punctuation">(</span><span class="token class-name">AttrVo</span> attr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.4.png" alt="image-20220513222606908" tabindex="0" loading="lazy"><figcaption>image-20220513222606908</figcaption></figure><h4 id="_5ã€å®ç°updateattræŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€å®ç°updateattræŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 5ã€å®ç°<code>updateAttr</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œå®ç°<code>updateAttr</code>æŠ½è±¡æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.5.png" alt="image-20220513224031536" tabindex="0" loading="lazy"><figcaption>image-20220513224031536</figcaption></figure><h4 id="_6ã€æµ‹è¯•-2" tabindex="-1"><a class="header-anchor" href="#_6ã€æµ‹è¯•-2" aria-hidden="true">#</a> 6ã€æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢</p><p>å¯ä»¥çœ‹åˆ°å½“æ²¡æœ‰è®¾ç½®æ‰€å±åˆ†ç»„æ—¶ï¼Œä¿®æ”¹å¤±è´¥äº†ï¼ŒåŸå› å°±æ˜¯æ²¡æœ‰æŸ¥åˆ°<code>attrId</code>ä¸ºè¯¥å€¼çš„æ•°æ®ï¼Œå› æ­¤å½“æŸ¥ä¸åˆ°æ•°æ®æ—¶åº”è¯¥å¢åŠ è¯¥æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.6.1.gif" alt="GIF 2022-5-13 22-45-38" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-13 22-45-38</figcaption></figure><p>å½“è®¾ç½®äº†æ‰€å±åˆ†ç»„åï¼Œä¿®æ”¹æ­£å¸¸</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.6.2.gif" alt="GIF 2022-5-13 22-53-56" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-13 22-53-56</figcaption></figure><h4 id="_7ã€ä¿®æ”¹updateattræ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_7ã€ä¿®æ”¹updateattræ–¹æ³•" aria-hidden="true">#</a> 7ã€ä¿®æ”¹<code>updateAttr</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—é‡Œä¿®æ”¹<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»çš„<code>updateAttr</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateAttr</span><span class="token punctuation">(</span><span class="token class-name">AttrVo</span> attr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AttrEntity</span> attrEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>attr<span class="token punctuation">,</span>attrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token class-name">AttrAttrgroupRelationEntity</span> attrAttrgroupRelationEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">setAttrGroupId</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token operator">::</span><span class="token function">getAttrId</span><span class="token punctuation">,</span>attr<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> count <span class="token operator">=</span> attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">selectCount</span><span class="token punctuation">(</span>lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//å¦‚æœæœ‰attrå’Œattrgroupçš„å…³è”å…³ç³»å°±ä¿®æ”¹è¯¥ï¼Œæ²¡æœ‰å°±æ–°å¢</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>count<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//æ ¹æ®attr_idä¿®æ”¹ pms_attr_attrgroup_relation é‡Œçš„attr_group_id å­—æ®µ</span>
        attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">,</span> lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">//æ·»åŠ attrå’Œattrgroupçš„å…³è”å…³ç³»</span>
        attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">setAttrId</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.7.png" alt="image-20220513230716943" tabindex="0" loading="lazy"><figcaption>image-20220513230716943</figcaption></figure><h4 id="_8ã€é‡æ–°æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_8ã€é‡æ–°æµ‹è¯•" aria-hidden="true">#</a> 8ã€é‡æ–°æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.4.8.gif" alt="GIF 2022-5-13 23-02-23" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-13 23-02-23</figcaption></figure><h3 id="_4-5-5ã€é”€å”®å±æ€§ç»´æŠ¤" tabindex="-1"><a class="header-anchor" href="#_4-5-5ã€é”€å”®å±æ€§ç»´æŠ¤" aria-hidden="true">#</a> 4.5.5ã€é”€å”®å±æ€§ç»´æŠ¤</h3><h4 id="_1ã€æŸ¥çœ‹url" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹url" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹<code>url</code></h4><p>ç‚¹å‡»<code>å•†å“ç³»ç»Ÿ</code>ä¸‹çš„<code>å¹³å°å±æ€§</code>ä¸‹çš„<code>é”€å”®å±æ€§</code>ï¼Œä¼šå‘é€ä¸€ä¸ªè¯·æ±‚ï¼ŒæŸ¥çœ‹é”€å”®å±æ€§åˆ—è¡¨</p><p>urlï¼šhttp://localhost:88/api/product/attr/sale/list/0?t=1652454755415&amp;page=1&amp;limit=10&amp;key=</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.1.1.png" alt="image-20220513231338361" tabindex="0" loading="lazy"><figcaption>image-20220513231338361</figcaption></figure><p>å½“<code>pms_attr</code>è¡¨çš„<code>attr_type</code>å­—æ®µä¸º<code>0</code>,åˆ™è¡¨ç¤ºçš„æ˜¯é”€å”®å±æ€§</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.1.2.png" alt="image-20220513232155146" tabindex="0" loading="lazy"><figcaption>image-20220513232155146</figcaption></figure>`,157),Na={href:"https://easydoc.net/s/78237135/ZUqEdvA4/FTx6LRbR",target:"_blank",rel:"noopener noreferrer"},Va=e(`<figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.1.3.png" alt="image-20220518194022173" tabindex="0" loading="lazy"><figcaption>image-20220518194022173</figcaption></figure><h4 id="_2ã€ä¿®æ”¹baseattrlistæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹baseattrlistæ–¹æ³•" aria-hidden="true">#</a> 2ã€ä¿®æ”¹<code>baseAttrList</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—é‡Œä¿®æ”¹<code>com.atguigu.gulimall.product.controller.AttrController</code>ç±»çš„<code>baseAttrList</code>æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.2.1.png" alt="image-20220513233818883" tabindex="0" loading="lazy"><figcaption>image-20220513233818883</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.2.2.png" alt="image-20220513233835501" tabindex="0" loading="lazy"><figcaption>image-20220513233835501</figcaption></figure><h4 id="_3ã€è½¬åˆ°æ¥å£æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€è½¬åˆ°æ¥å£æ–¹æ³•" aria-hidden="true">#</a> 3ã€è½¬åˆ°æ¥å£æ–¹æ³•</h4><p>æŒ‰ä½<code>ctrl</code>é”®ï¼Œç„¶åç‚¹å‡»<code>queryBaseAttrPage</code>ï¼Œè·³è½¬åˆ°<code>com.atguigu.gulimall.product.service.AttrService</code>ç±»çš„<code>queryBaseAttrPage</code>æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.3.1.png" alt="image-20220513233933096" tabindex="0" loading="lazy"><figcaption>image-20220513233933096</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.3.2.png" alt="image-20220513233956714" tabindex="0" loading="lazy"><figcaption>image-20220513233956714</figcaption></figure><h4 id="_4ã€ä¿®æ”¹querybaseattrpageæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿®æ”¹querybaseattrpageæ–¹æ³•" aria-hidden="true">#</a> 4ã€ä¿®æ”¹<code>queryBaseAttrPage</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»çš„<code>queryBaseAttrPage</code>æ–¹æ³•é‡Œæ·»åŠ æ¯”è¾ƒæ¡ä»¶</p><p><a href="code/4.5.5.4.queryBaseAttrPage.java">ç‚¹å‡»æŸ¥çœ‹<code>queryBaseAttrPage</code>æ–¹æ³•å®Œæ•´ä»£ç </a></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getAttrType</span><span class="token punctuation">,</span><span class="token string">&quot;base&quot;</span><span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span>attrType<span class="token punctuation">)</span><span class="token operator">?</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.4.png" alt="image-20220513234038547" tabindex="0" loading="lazy"><figcaption>image-20220513234038547</figcaption></figure><h4 id="_5ã€æµ‹è¯•-7" tabindex="-1"><a class="header-anchor" href="#_5ã€æµ‹è¯•-7" aria-hidden="true">#</a> 5ã€æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢</p><h5 id="_1ã€æ–°å¢é”€å”®å±æ€§" tabindex="-1"><a class="header-anchor" href="#_1ã€æ–°å¢é”€å”®å±æ€§" aria-hidden="true">#</a> 1ã€æ–°å¢<code>é”€å”®å±æ€§</code></h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.5.1.png" alt="image-20220513234339081" tabindex="0" loading="lazy"><figcaption>image-20220513234339081</figcaption></figure><h5 id="_2ã€ç‚¹å‡»æŸ¥è¯¢å…¨éƒ¨" tabindex="-1"><a class="header-anchor" href="#_2ã€ç‚¹å‡»æŸ¥è¯¢å…¨éƒ¨" aria-hidden="true">#</a> 2ã€ç‚¹å‡»<code>æŸ¥è¯¢å…¨éƒ¨</code></h5><p>ç‚¹å‡»æŸ¥è¯¢å…¨éƒ¨ï¼Œå¯ä»¥çœ‹åˆ°è¯·æ±‚çš„url</p><p>url: http://localhost:88/api/product/attr/sale/list/0?t=1652456634834&amp;page=1&amp;limit=10&amp;key=</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.5.2.png" alt="image-20220513234412544" tabindex="0" loading="lazy"><figcaption>image-20220513234412544</figcaption></figure><h5 id="_3ã€æŠ¥ç©ºæŒ‡é’ˆ" tabindex="-1"><a class="header-anchor" href="#_3ã€æŠ¥ç©ºæŒ‡é’ˆ" aria-hidden="true">#</a> 3ã€æŠ¥ç©ºæŒ‡é’ˆ</h5><p><code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»çš„<code>queryBaseAttrPage</code>æ–¹æ³•é‡Œçš„è¿™ä¸€è¡ŒæŠ¥ç©ºæŒ‡é’ˆ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.5.3.png" alt="image-20220513234555986" tabindex="0" loading="lazy"><figcaption>image-20220513234555986</figcaption></figure><h5 id="_4ã€åŠ ä¸ªåˆ¤æ–­" tabindex="-1"><a class="header-anchor" href="#_4ã€åŠ ä¸ªåˆ¤æ–­" aria-hidden="true">#</a> 4ã€åŠ ä¸ªåˆ¤æ–­</h5><p>åœ¨<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»çš„<code>queryBaseAttrPage</code>æ–¹æ³•é‡Œè¿™ä¸ªä½ç½®åŠ ä¸ªåˆ¤æ–­</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.5.4.png" alt="image-20220513234720363" tabindex="0" loading="lazy"><figcaption>image-20220513234720363</figcaption></figure><h5 id="_5ã€é‡æ–°æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_5ã€é‡æ–°æµ‹è¯•" aria-hidden="true">#</a> 5ã€é‡æ–°æµ‹è¯•</h5><p>é‡å¯<code>gulimall-product</code>é¡¹ç›®ï¼Œå·²ç»æ­£å¸¸æ˜¾ç¤ºäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.5.5.png" alt="image-20220513234805564" tabindex="0" loading="lazy"><figcaption>image-20220513234805564</figcaption></figure><h4 id="_6ã€ä¿®æ”¹é”€å”®å±æ€§æŠ¥é”™" tabindex="-1"><a class="header-anchor" href="#_6ã€ä¿®æ”¹é”€å”®å±æ€§æŠ¥é”™" aria-hidden="true">#</a> 6ã€ä¿®æ”¹<code>é”€å”®å±æ€§</code>æŠ¥é”™</h4><h5 id="_1ã€ä¿®æ”¹é”€å”®å±æ€§" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿®æ”¹é”€å”®å±æ€§" aria-hidden="true">#</a> 1ã€ä¿®æ”¹<code>é”€å”®å±æ€§</code></h5><p>å¯é€‰å€¼é‡Œæ·»åŠ <code>è“è‰²</code>,ç„¶åç‚¹å‡»ç¡®å®šï¼ŒæˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.1.1.png" alt="image-20220516230532173" tabindex="0" loading="lazy"><figcaption>image-20220516230532173</figcaption></figure><p>å†æ¬¡æç¤ºï¼Œç³»ç»ŸæœªçŸ¥å¼‚å¸¸</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.1.2.png" alt="image-20220516215335766" tabindex="0" loading="lazy"><figcaption>image-20220516215335766</figcaption></figure><h5 id="_2ã€æŸ¥çœ‹æŠ¥é”™" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹æŠ¥é”™" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹æŠ¥é”™</h5><p>åœ¨<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»çš„<code>updateAttr</code>æ–¹æ³•é‡Œçš„<code>172</code>è¡Œæœ‰ä¸€ä¸ªsqlè¯­æ³•é”™è¯¯</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>UPDATE pms_attr_attrgroup_relation WHERE (attr_id = ?) 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.2.png" alt="image-20220516215659753" tabindex="0" loading="lazy"><figcaption>image-20220516215659753</figcaption></figure><h5 id="_3ã€attrgroupæ²¡æœ‰è·å–åˆ°" tabindex="-1"><a class="header-anchor" href="#_3ã€attrgroupæ²¡æœ‰è·å–åˆ°" aria-hidden="true">#</a> 3ã€<code>attrGroup</code>æ²¡æœ‰è·å–åˆ°</h5><p>å¯ä»¥çœ‹åˆ°ä¼ è¿‡æ¥çš„<code>attr</code>é‡Œé¢æ²¡æœ‰å°è£…<code>attrGroup</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.3.1.png" alt="image-20220516220802079" tabindex="0" loading="lazy"><figcaption>image-20220516220802079</figcaption></figure><p>æŸ¥çœ‹å‰ç«¯è¯·æ±‚ï¼Œå‘ç°ä¿®æ”¹ï¼Œæ²¡æœ‰æ¶‰åŠåˆ°<code>æ‰€å±åˆ†ç»„</code>ï¼Œå› æ­¤æ²¡æœ‰<code>attrGroup</code>å±æ€§</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.3.2.png" alt="image-20220516221537247" tabindex="0" loading="lazy"><figcaption>image-20220516221537247</figcaption></figure><h5 id="_4ã€æŸ¥çœ‹è°ƒç”¨å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_4ã€æŸ¥çœ‹è°ƒç”¨å…³ç³»" aria-hidden="true">#</a> 4ã€æŸ¥çœ‹è°ƒç”¨å…³ç³»</h5><p>ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æŸ¥çœ‹è°ƒç”¨å…³ç³»(æˆ–æŒ‰<code>alt+F7</code>)</p><ol><li>åŒå‡»<code>updateAttr</code>æ–¹æ³•</li><li>å³é”®ï¼Œé€‰æ‹©<code>Find Usages</code></li><li>æŸ¥çœ‹è°ƒç”¨</li></ol><p>å¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰<code>AttrController</code>çš„<code>update</code>æ–¹æ³•è°ƒç”¨äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.4.1.png" alt="image-20220516223003550" tabindex="0" loading="lazy"><figcaption>image-20220516223003550</figcaption></figure><p>ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æŸ¥çœ‹è°ƒç”¨å…³ç³»é“¾(æˆ–æŒ‰å¿«æ·é”®<code>ctrl+alt+H</code>)</p><ol><li>åŒå‡»<code>updateAttr</code>æ–¹æ³•</li><li>ç‚¹å‡»<code>Navigate</code></li><li>é€‰æ‹©<code>Call Hierarchy</code></li><li>æŸ¥çœ‹è¢«è°ƒç”¨å…³ç³»é“¾</li></ol><p>å¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰<code>AttrController</code>çš„<code>update</code>æ–¹æ³•è°ƒç”¨äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.4.2.png" alt="image-20220516223538909" tabindex="0" loading="lazy"><figcaption>image-20220516223538909</figcaption></figure><h5 id="_5ã€åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_5ã€åˆ†æ" aria-hidden="true">#</a> 5ã€åˆ†æ</h5><h6 id="_1ã€æŸ¥çœ‹æ•°æ®åº“" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹æ•°æ®åº“" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹æ•°æ®åº“</h6><p>æŸ¥çœ‹æ•°æ®åº“å‘ç°ï¼Œ<s>å·²ç»æ–°å¢äº†ä¸€æ¡è®°å½•</s>ï¼Œä½†æ˜¯<code>attr_group_id</code>ä¸ºnull</p><p>(å…¶å®è¿™æ¡æ•°æ®ä¸æ˜¯åœ¨è°ƒç”¨ä¿®æ”¹æ–¹æ³•æ–°å¢çš„æ•°æ®ï¼Œè€Œæ˜¯è°ƒç”¨<code>save</code>æ–¹æ³•æ–°å¢çš„æ•°æ®ï¼Œè°ƒç”¨<code>save</code>æ–¹æ³•å¯ä»¥çœ‹åˆ°ä¼šæ‰§è¡Œ</p><p><code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»çš„<code>saveAttr</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveAttr</span><span class="token punctuation">(</span><span class="token class-name">AttrVo</span> attr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">AttrEntity</span> attrEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å°†atträ¸­çš„æ•°æ®å¤åˆ¶åˆ°attrEntityå¯¹åº”çš„å­—æ®µé‡Œ</span>
        <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>attr<span class="token punctuation">,</span> attrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//1ã€ä¿å­˜åŸºæœ¬æ•°æ®</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2ã€ä¿å­˜å…³è”å…³ç³»</span>
        <span class="token class-name">AttrAttrgroupRelationEntity</span> attrAttrgroupRelationEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">setAttrGroupId</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è°ƒç”¨this.save(attrEntity);æ–¹æ³•åï¼Œä¼šå°†æ•°æ®åº“ç”Ÿæˆçš„attrIdå°è£…åˆ°AttrEntityé‡Œé¢</span>
        attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">setAttrId</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶ä¼šåœ¨<code>attr_attrgroup_relation</code>è¡¨é‡Œæ·»åŠ æ•°æ®ï¼Œæ­¤æ—¶ä¹Ÿåªæœ‰<code>attr_id</code>æœ‰å€¼ï¼Œ<code>attr_group_id</code>ä¹Ÿä¸º<code>null</code>)</p><p><strong>å…ˆåˆ é™¤è¿™æ¡æ•°æ®ï¼Œå†è¿›è¡Œè°ƒè¯•</strong></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.5.1.png" alt="image-20220516231712740" tabindex="0" loading="lazy"><figcaption>image-20220516231712740</figcaption></figure><h6 id="_2ã€æ‰§è¡Œäº†insertæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ‰§è¡Œäº†insertæ–¹æ³•" aria-hidden="true">#</a> 2ã€æ‰§è¡Œäº†<code>insert</code>æ–¹æ³•</h6><p>ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶ï¼Œåœ¨<code>attr_attrgroup_relation</code>æŸ¥ä¸åˆ°æ•°æ®(æœ€åˆå†™ä¿®æ”¹<code>è§„æ ¼å‚æ•°</code>æ—¶ï¼Œä»£è¡¨çš„æ˜¯æ–°å¢<code>è§„æ ¼å‚æ•°</code>æ²¡æœ‰è®¾ç½®<code>æ‰€å±åˆ†ç»„</code>çš„æƒ…å†µ)</p><p>ï¼Œæ‰€ä»¥å°±æ’å…¥äº†ä¸€æ¡æ•°æ®ï¼Œä½†æ˜¯ç”±äºæ˜¯ä¿®æ”¹<code>é”€å”®å±æ€§</code>ï¼Œæ²¡æœ‰<code>æ‰€å±åˆ†ç»„</code>é€‰é¡¹ï¼Œè‡ªç„¶å°±æ²¡æœ‰<code>attrGroupId</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.5.2.png" alt="image-20220516230926422" tabindex="0" loading="lazy"><figcaption>image-20220516230926422</figcaption></figure><h6 id="_3ã€æŸ¥çœ‹insertçš„sqlè¯­å¥" tabindex="-1"><a class="header-anchor" href="#_3ã€æŸ¥çœ‹insertçš„sqlè¯­å¥" aria-hidden="true">#</a> 3ã€æŸ¥çœ‹<code>insert</code>çš„sqlè¯­å¥</h6><p>å¯ä»¥çœ‹åˆ°åªæ’å…¥äº†<code>attr_id</code>å­—æ®µ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.5.3.png" alt="image-20220516231035665" tabindex="0" loading="lazy"><figcaption>image-20220516231035665</figcaption></figure><h6 id="_4ã€æŸ¥çœ‹æ•°æ®åº“" tabindex="-1"><a class="header-anchor" href="#_4ã€æŸ¥çœ‹æ•°æ®åº“" aria-hidden="true">#</a> 4ã€æŸ¥çœ‹æ•°æ®åº“</h6><p>å¯ä»¥çœ‹åˆ°<code>attr_group_id</code>å­—æ®µä¸ºç©º</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.5.4.png" alt="image-20220516231851424" tabindex="0" loading="lazy"><figcaption>image-20220516231851424</figcaption></figure><h6 id="_5ã€å†æ¬¡å‘é€ä¿®æ”¹é”€å”®å±æ€§è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_5ã€å†æ¬¡å‘é€ä¿®æ”¹é”€å”®å±æ€§è¯·æ±‚" aria-hidden="true">#</a> 5ã€å†æ¬¡å‘é€ä¿®æ”¹<code>é”€å”®å±æ€§</code>è¯·æ±‚</h6><p>å†æ¬¡å‘é€ä¿®æ”¹<code>é”€å”®å±æ€§</code>è¯·æ±‚,å¯ä»¥çœ‹åˆ°å·²ç»æŸ¥åˆ°äº†ä¸€æ¡æ•°æ®ï¼Œèµ°åˆ°äº†<code>update</code>æ–¹æ³•é‡Œé¢å»äº†</p><p>æ­¤æ—¶åŒæ ·æ²¡æœ‰<code>attrGroupId</code>å­—æ®µ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.5.5.png" alt="image-20220516231421001" tabindex="0" loading="lazy"><figcaption>image-20220516231421001</figcaption></figure><h6 id="_6ã€æ­¤æ—¶å‡ºç°äº†sqlè¯­å¥å¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#_6ã€æ­¤æ—¶å‡ºç°äº†sqlè¯­å¥å¼‚å¸¸" aria-hidden="true">#</a> 6ã€æ­¤æ—¶å‡ºç°äº†sqlè¯­å¥å¼‚å¸¸</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.5.6.png" alt="image-20220516231604459" tabindex="0" loading="lazy"><figcaption>image-20220516231604459</figcaption></figure><h5 id="_6ã€è§£å†³é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_6ã€è§£å†³é—®é¢˜" aria-hidden="true">#</a> 6ã€è§£å†³é—®é¢˜</h5><h6 id="_1ã€è§„æ ¼å‚æ•°å’Œé”€å”®å±æ€§çš„è¯·æ±‚å‚æ•°ä¸€æ ·" tabindex="-1"><a class="header-anchor" href="#_1ã€è§„æ ¼å‚æ•°å’Œé”€å”®å±æ€§çš„è¯·æ±‚å‚æ•°ä¸€æ ·" aria-hidden="true">#</a> 1ã€<code>è§„æ ¼å‚æ•°</code>å’Œ<code>é”€å”®å±æ€§</code>çš„è¯·æ±‚å‚æ•°ä¸€æ ·</h6><p>ç‚¹å‡»<code>è§„æ ¼å‚æ•°</code>é‡Œçš„<code>ä¿®æ”¹</code>æŒ‰é’®ï¼Œå¯ä»¥çœ‹åˆ°urlä¸º: http://localhost:88/api/product/attr/update</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.6.1.1.png" alt="image-20220516233308432" tabindex="0" loading="lazy"><figcaption>image-20220516233308432</figcaption></figure><p>æ­¤æ—¶æœ‰<code>æ‰€å±åˆ†ç»„</code>ï¼Œå› æ­¤æœ‰<code>attrGroup</code>å±æ€§</p><p>æ­¤æ—¶çš„<code>attrType</code>ä¸º<code>1</code>ï¼Œè¡¨ç¤ºçš„æ˜¯<code>è§„æ ¼å‚æ•°</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.6.1.2.png" alt="image-20220516233334265" tabindex="0" loading="lazy"><figcaption>image-20220516233334265</figcaption></figure><p>ç‚¹å‡»<code>é”€å”®å±æ€§</code>é‡Œçš„<code>ä¿®æ”¹</code>æŒ‰é’®ï¼Œå¯ä»¥çœ‹åˆ°urlä¸º: http://localhost:88/api/product/attr/update</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.6.1.3.png" alt="image-20220516233824438" tabindex="0" loading="lazy"><figcaption>image-20220516233824438</figcaption></figure><p>æ­¤æ—¶æ²¡æœ‰æœ‰<code>æ‰€å±åˆ†ç»„</code>ï¼Œå› æ­¤æ²¡æœ‰<code>attrGroup</code>å±æ€§</p><p>æ­¤æ—¶çš„<code>attrType</code>ä¸º<code>0</code>ï¼Œè¡¨ç¤ºçš„æ˜¯<code>é”€å”®å±æ€§</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.6.1.4.png" alt="image-20220516233859672" tabindex="0" loading="lazy"><figcaption>image-20220516233859672</figcaption></figure><h6 id="_2ã€updateattræ–¹æ³•æ·»åŠ å…³è”å…³ç³»å‰åŠ ä¸€ä¸ªåˆ¤æ–­" tabindex="-1"><a class="header-anchor" href="#_2ã€updateattræ–¹æ³•æ·»åŠ å…³è”å…³ç³»å‰åŠ ä¸€ä¸ªåˆ¤æ–­" aria-hidden="true">#</a> 2ã€<code>updateAttr</code>æ–¹æ³•æ·»åŠ å…³è”å…³ç³»å‰åŠ ä¸€ä¸ªåˆ¤æ–­</h6><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateAttr</span><span class="token punctuation">(</span><span class="token class-name">AttrVo</span> attr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AttrEntity</span> attrEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>attr<span class="token punctuation">,</span>attrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token class-name">AttrAttrgroupRelationEntity</span> attrAttrgroupRelationEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">setAttrGroupId</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token operator">::</span><span class="token function">getAttrId</span><span class="token punctuation">,</span>attr<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> count <span class="token operator">=</span> attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">selectCount</span><span class="token punctuation">(</span>lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//å¦‚æœæœ‰attrå’Œattrgroupçš„å…³è”å…³ç³»å°±ä¿®æ”¹è¯¥ï¼Œæ²¡æœ‰å°±æ–°å¢</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>count<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//æ ¹æ®attr_idä¿®æ”¹ pms_attr_attrgroup_relation é‡Œçš„attr_group_id å­—æ®µ</span>
        attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">,</span> lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//æ·»åŠ attrå’Œattrgroupçš„å…³è”å…³ç³»</span>
            attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">setAttrId</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.6.2.1.png" alt="image-20220517000120934" tabindex="0" loading="lazy"><figcaption>image-20220517000120934</figcaption></figure><p>æ­¤æ—¶çš„<code>attrType</code>ä¸º<code>0</code>ï¼Œè¡¨ç¤ºçš„æ˜¯<code>é”€å”®å±æ€§</code>ï¼Œæ²¡æœ‰<code>attr</code>å’Œ<code>attrGroup</code>çš„<code>å…³è”å…³ç³»</code>,ä¸éœ€è¦æ·»åŠ </p><p>å› æ­¤ä¹Ÿå¯ä»¥è¿™æ ·åˆ¤æ–­ï¼Œå¦‚æœæ˜¯<strong>åŸºæœ¬å±æ€§</strong>æ‰æ·»åŠ <code>attr</code>å’Œ<code>attrGroup</code>çš„<code>å…³è”å…³ç³»</code></p><p>è¿™æ ·æƒ³å…¶å®ä¸è§„èŒƒï¼Œå¦‚æœæ˜¯<strong>é”€å”®å±æ€§</strong>ï¼Œåº”è¯¥ç›´æ¥ä¸æŸ¥<code>attr</code>å’Œ<code>attrGroup</code>çš„<code>å…³è”å…³ç³»</code>ï¼Œå› ä¸º<strong>é”€å”®å±æ€§</strong>æ²¡æœ‰åˆ†ç»„ï¼Œè‡ªç„¶æ²¡æœ‰å®ƒä»¬çš„å…³è”å…³ç³»</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.6.2.2.png" alt="image-20220518125355814" tabindex="0" loading="lazy"><figcaption>image-20220518125355814</figcaption></figure><h6 id="_3ã€ä½¿ç”¨æšä¸¾" tabindex="-1"><a class="header-anchor" href="#_3ã€ä½¿ç”¨æšä¸¾" aria-hidden="true">#</a> 3ã€ä½¿ç”¨æšä¸¾</h6><p>åœ¨<code>gulimall-common</code>æ¨¡å—çš„<code>src/main/java/com/atguigu/common</code>æ–‡ä»¶ä¸‹æ–°å»º<code>constant</code>æ–‡ä»¶å¤¹</p><p>åœ¨<code>com.atguigu.common.constant</code>åŒ…ä¸‹æ–°å»º<code>ProductConstant</code>æšä¸¾ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>common<span class="token punctuation">.</span>constant</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/17
 * @Description:
 */</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">ProductConstant</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * åŸºæœ¬å±æ€§
     */</span>
    <span class="token function">ATTR_TYPE_BASE</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;åŸºæœ¬å±æ€§&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token doc-comment comment">/**
     * é”€å”®å±æ€§
     */</span>
    <span class="token function">ATTR_TYPES_SALE</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;é”€å”®å±æ€§&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> code<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> msg<span class="token punctuation">;</span>

    <span class="token class-name">ProductConstant</span><span class="token punctuation">(</span><span class="token keyword">int</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> code<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> msg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.6.3.png" alt="image-20220518115507158" tabindex="0" loading="lazy"><figcaption>image-20220518115507158</figcaption></figure><h6 id="_4ã€ä¿®æ”¹updateattræ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿®æ”¹updateattræ–¹æ³•" aria-hidden="true">#</a> 4ã€ä¿®æ”¹<code>updateAttr</code>æ–¹æ³•</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—ä¸‹çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œçš„<code>updateAttr</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateAttr</span><span class="token punctuation">(</span><span class="token class-name">AttrVo</span> attr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AttrEntity</span> attrEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>attr<span class="token punctuation">,</span>attrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token class-name">AttrAttrgroupRelationEntity</span> attrAttrgroupRelationEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">setAttrGroupId</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token operator">::</span><span class="token function">getAttrId</span><span class="token punctuation">,</span>attr<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> count <span class="token operator">=</span> attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">selectCount</span><span class="token punctuation">(</span>lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//å¦‚æœæœ‰attrå’Œattrgroupçš„å…³è”å…³ç³»å°±ä¿®æ”¹è¯¥ï¼Œæ²¡æœ‰å°±æ–°å¢</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>count<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//æ ¹æ®attr_idä¿®æ”¹ pms_attr_attrgroup_relation é‡Œçš„attr_group_id å­—æ®µ</span>
        attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">,</span> lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">//åŸºæœ¬å±æ€§</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token class-name">ProductConstant</span><span class="token punctuation">.</span><span class="token constant">ATTR_TYPE_BASE</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//æ·»åŠ attrå’Œattrgroupçš„å…³è”å…³ç³»</span>
            attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">setAttrId</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.6.4.1.png" alt="image-20220518124449446" tabindex="0" loading="lazy"><figcaption>image-20220518124449446</figcaption></figure><p>æœ€å¥½è¿™æ ·å†™</p><p>å¦‚æœæ˜¯åŸºæœ¬å±æ€§ï¼Œæ‰<code>æ›´æ–°</code>æˆ–<code>æ·»åŠ </code>å…³è”å…³ç³»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateAttr</span><span class="token punctuation">(</span><span class="token class-name">AttrVo</span> attr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AttrEntity</span> attrEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>attr<span class="token punctuation">,</span> attrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//å¦‚æœæ˜¯åŸºæœ¬å±æ€§ï¼Œå°±æ›´æ–°æˆ–æ·»åŠ å…³è”å…³ç³»</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">ProductConstant</span><span class="token punctuation">.</span><span class="token constant">ATTR_TYPE_BASE</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">AttrAttrgroupRelationEntity</span> attrAttrgroupRelationEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">setAttrGroupId</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token operator">::</span><span class="token function">getAttrId</span><span class="token punctuation">,</span> attr<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Integer</span> count <span class="token operator">=</span> attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">selectCount</span><span class="token punctuation">(</span>lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å¦‚æœæœ‰attrå’Œattrgroupçš„å…³è”å…³ç³»å°±ä¿®æ”¹è¯¥ï¼Œæ²¡æœ‰å°±æ–°å¢</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//æ ¹æ®attr_idä¿®æ”¹ pms_attr_attrgroup_relation é‡Œçš„attr_group_id å­—æ®µ</span>
            attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">,</span> lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">//æ·»åŠ attrå’Œattrgroupçš„å…³è”å…³ç³»</span>
            attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">setAttrId</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.6.4.2.png" alt="image-20220518130019768" tabindex="0" loading="lazy"><figcaption>image-20220518130019768</figcaption></figure><h6 id="_5ã€ä¿®æ”¹saveattræ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¿®æ”¹saveattræ–¹æ³•" aria-hidden="true">#</a> 5ã€ä¿®æ”¹<code>saveAttr</code>æ–¹æ³•</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—ä¸‹çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œçš„<code>saveAttr</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveAttr</span><span class="token punctuation">(</span><span class="token class-name">AttrVo</span> attr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AttrEntity</span> attrEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//å°†atträ¸­çš„æ•°æ®å¤åˆ¶åˆ°attrEntityå¯¹åº”çš„å­—æ®µé‡Œ</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>attr<span class="token punctuation">,</span> attrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//1ã€ä¿å­˜åŸºæœ¬æ•°æ®</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//2ã€å¦‚æœæ˜¯åŸºæœ¬å±æ€§,åˆ™è¿˜è¦ä¿å­˜å…³è”å…³ç³»</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">ProductConstant</span><span class="token punctuation">.</span><span class="token constant">ATTR_TYPE_BASE</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">AttrAttrgroupRelationEntity</span> attrAttrgroupRelationEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">setAttrGroupId</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è°ƒç”¨this.save(attrEntity);æ–¹æ³•åï¼Œä¼šå°†æ•°æ®åº“ç”Ÿæˆçš„attrIdå°è£…åˆ°AttrEntityé‡Œé¢</span>
        attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">setAttrId</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.6.5.png" alt="image-20220518123217004" tabindex="0" loading="lazy"><figcaption>image-20220518123217004</figcaption></figure><h6 id="_6ã€ä¿®æ”¹querybaseattrpageæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_6ã€ä¿®æ”¹querybaseattrpageæ–¹æ³•" aria-hidden="true">#</a> 6ã€ä¿®æ”¹<code>queryBaseAttrPage</code>æ–¹æ³•</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—ä¸‹çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œçš„<code>queryBaseAttrPage</code>æ–¹æ³•ï¼Œä¹Ÿä½¿ç”¨<strong>æšä¸¾</strong>æ¥ä»£è¡¨<code>0</code>ï¼Œæˆ–è€…<code>1</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">queryBaseAttrPage</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">,</span> <span class="token class-name">Long</span> categoryId<span class="token punctuation">,</span> <span class="token class-name">String</span> attrType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//åˆ¤æ–­æ˜¯&quot;åŸºæœ¬å±æ€§&quot;è¿˜æ˜¯&quot;é”€å”®å±æ€§&quot;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getAttrType</span><span class="token punctuation">,</span>
            <span class="token string">&quot;base&quot;</span><span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span>attrType<span class="token punctuation">)</span><span class="token operator">?</span>
                    <span class="token class-name">ProductConstant</span><span class="token punctuation">.</span><span class="token constant">ATTR_TYPE_BASE</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
                    <span class="token class-name">ProductConstant</span><span class="token punctuation">.</span><span class="token constant">ATTR_TYPES_SALE</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>categoryId <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//å¦‚æœæœ‰categoryIdï¼Œåˆ™æŸ¥è¯¥categoryIdçš„æ•°æ®</span>
        lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getCatelogId</span><span class="token punctuation">,</span> categoryId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">//å¦‚æœæœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œåˆ™åˆ¤æ–­è¯¥æ¡ä»¶æ˜¯å¦ ä¸attrIdç›¸ç­‰ æˆ– åå­—åŒ…å«è¯¥æ¡ä»¶</span>
            obj<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getAttrId</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getAttrName</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span> lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//æŸ¥è¯¢categoryNameå­—æ®µå’ŒgroupNameå­—æ®µ</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrRespVo</span><span class="token punctuation">&gt;</span></span> respVos <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>attrEntity <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">AttrRespVo</span> attrRespVo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrRespVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">,</span> attrRespVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ ¹æ®attrIdåˆ°attrå’Œattrgroupçš„ä¸­é—´è¡¨æŸ¥è¯¢ attrgroupId</span>
        <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">&gt;</span></span> attrAttrgroupRelationQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        attrAttrgroupRelationQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token operator">::</span><span class="token function">getAttrId</span><span class="token punctuation">,</span> attrEntity<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ ¹æ®attrgroupIdæŸ¥è¯¢ä¸­é—´è¡¨çš„è¯¥è¡Œæ•°æ®ï¼Œå¹¶å°è£…åˆ°å¯¹è±¡</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;base&quot;</span><span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span>attrType<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">AttrAttrgroupRelationEntity</span> attrAttrgroupRelationEntity <span class="token operator">=</span> attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>attrAttrgroupRelationQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>attrAttrgroupRelationEntity <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//å¦‚æœæŸ¥åˆ°attrgroupIdï¼Œåˆ™æ ¹æ®attrgroupIdæŸ¥è¯¢attrgroupNameï¼Œå¹¶æ·»åŠ åˆ°attrRespVoä¸­</span>
                <span class="token class-name">AttrGroupEntity</span> attrGroupEntity <span class="token operator">=</span> attrGroupDao<span class="token punctuation">.</span><span class="token function">selectById</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">getAttrGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                attrRespVo<span class="token punctuation">.</span><span class="token function">setGroupName</span><span class="token punctuation">(</span>attrGroupEntity<span class="token punctuation">.</span><span class="token function">getAttrGroupName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryEntity</span><span class="token punctuation">&gt;</span></span> categoryQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        categoryQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">CategoryEntity</span><span class="token operator">::</span><span class="token function">getCatId</span><span class="token punctuation">,</span> attrEntity<span class="token punctuation">.</span><span class="token function">getCatelogId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ ¹æ®catelogIdæŸ¥è¯¢è¯¥è¡Œæ•°æ®ï¼Œå¹¶å°è£…åˆ°å¯¹è±¡</span>
        <span class="token class-name">CategoryEntity</span> categoryEntity <span class="token operator">=</span> categoryDao<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>categoryQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>categoryEntity <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            attrRespVo<span class="token punctuation">.</span><span class="token function">setCatelogName</span><span class="token punctuation">(</span>categoryEntity<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> attrRespVo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">PageUtils</span> pageUtils <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//é‡æ–°ç»™æ•°æ®</span>
    pageUtils<span class="token punctuation">.</span><span class="token function">setList</span><span class="token punctuation">(</span>respVos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> pageUtils<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.6.6.png" alt="image-20220518121753838" tabindex="0" loading="lazy"><figcaption>image-20220518121753838</figcaption></figure><h6 id="_7ã€ä¿®æ”¹getattrinfoæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_7ã€ä¿®æ”¹getattrinfoæ–¹æ³•" aria-hidden="true">#</a> 7ã€ä¿®æ”¹<code>getAttrInfo</code>æ–¹æ³•</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—ä¸‹çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œçš„<code>getAttrInfo</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">AttrRespVo</span> <span class="token function">getAttrInfo</span><span class="token punctuation">(</span><span class="token class-name">Long</span> attrId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AttrRespVo</span> attrRespVo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrRespVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ ¹æ®attrIdåˆ°attrè¡¨ä¸­æŸ¥è¯¥è¡Œæ•°æ®</span>
    <span class="token class-name">AttrEntity</span> attrEntity <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>attrId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">,</span> attrRespVo<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//å¦‚æœæ˜¯åŸºæœ¬å±æ€§ï¼Œéœ€è¦è®¾ç½®åˆ†ç»„ä¿¡æ¯</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>attrEntity<span class="token punctuation">.</span><span class="token function">getAttrType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token class-name">ProductConstant</span><span class="token punctuation">.</span><span class="token constant">ATTR_TYPE_BASE</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">&gt;</span></span> attrAttrgroupRelationQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        attrAttrgroupRelationQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token operator">::</span><span class="token function">getAttrId</span><span class="token punctuation">,</span> attrId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ ¹æ®attrIdåˆ°attrAttrgroupRelationå…³è”å…³ç³»è¡¨é‡ŒæŸ¥attrGroupId</span>
        <span class="token class-name">AttrAttrgroupRelationEntity</span> attrAttrgroupRelationEntity <span class="token operator">=</span> attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>attrAttrgroupRelationQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>attrAttrgroupRelationEntity <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            attrRespVo<span class="token punctuation">.</span><span class="token function">setAttrGroupId</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">getAttrGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//æ ¹æ®attrGroupIdåˆ°attrGroupè¡¨é‡ŒæŸ¥groupName</span>
            <span class="token class-name">AttrGroupEntity</span> attrGroupEntity <span class="token operator">=</span> attrGroupDao<span class="token punctuation">.</span><span class="token function">selectById</span><span class="token punctuation">(</span>attrAttrgroupRelationEntity<span class="token punctuation">.</span><span class="token function">getAttrGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>attrGroupEntity <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                attrRespVo<span class="token punctuation">.</span><span class="token function">setGroupName</span><span class="token punctuation">(</span>attrGroupEntity<span class="token punctuation">.</span><span class="token function">getAttrGroupName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//æ ¹æ®æœ€åä¸€çº§åˆ†ç±»idåˆ°categoryServiceä¸­æŸ¥è¯¢å®Œæ•´ä¸‰çº§åˆ†ç±»id</span>
    <span class="token class-name">Long</span> catelogId <span class="token operator">=</span> attrEntity<span class="token punctuation">.</span><span class="token function">getCatelogId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> catelogPath <span class="token operator">=</span> categoryService<span class="token punctuation">.</span><span class="token function">findCatelogPath</span><span class="token punctuation">(</span>catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>catelogPath<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        attrRespVo<span class="token punctuation">.</span><span class="token function">setCatelogPath</span><span class="token punctuation">(</span>catelogPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> attrRespVo<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.6.6.7.png" alt="image-20220518122837889" tabindex="0" loading="lazy"><figcaption>image-20220518122837889</figcaption></figure><h4 id="_7ã€æµ‹è¯•-4" tabindex="-1"><a class="header-anchor" href="#_7ã€æµ‹è¯•-4" aria-hidden="true">#</a> 7ã€æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢ï¼Œç‚¹å‡»<code>é”€å”®å±æ€§</code>é‡Œçš„æ–°å¢</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.7.1.png" alt="image-20220518130652375" tabindex="0" loading="lazy"><figcaption>image-20220518130652375</figcaption></figure><p>å·²ç»æ–°å¢æˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.7.2.png" alt="image-20220518130752310" tabindex="0" loading="lazy"><figcaption>image-20220518130752310</figcaption></figure><p>æŸ¥çœ‹æ–°å¢çš„å±æ€§çš„<code>attrId</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.7.3.png" alt="image-20220518150614220" tabindex="0" loading="lazy"><figcaption>image-20220518150614220</figcaption></figure><p>å¯ä»¥çœ‹åˆ°å·²ç»ä¸å†<code>pms_attr_attrgroup_relation</code>è¡¨é‡Œæ·»åŠ å…³è”å…³ç³»äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.5.7.4.png" alt="image-20220518150726876" tabindex="0" loading="lazy"><figcaption>image-20220518150726876</figcaption></figure><h3 id="_4-5-6ã€å±æ€§åˆ†ç»„æŸ¥è¯¢-åˆ é™¤åˆ†ç»„å…³è”" tabindex="-1"><a class="header-anchor" href="#_4-5-6ã€å±æ€§åˆ†ç»„æŸ¥è¯¢-åˆ é™¤åˆ†ç»„å…³è”" aria-hidden="true">#</a> 4.5.6ã€<code>å±æ€§åˆ†ç»„</code>æŸ¥è¯¢&amp;åˆ é™¤åˆ†ç»„å…³è”</h3><h4 id="_1ã€å±æ€§åˆ†ç»„æŸ¥è¯¢åˆ†ç»„å…³è”" tabindex="-1"><a class="header-anchor" href="#_1ã€å±æ€§åˆ†ç»„æŸ¥è¯¢åˆ†ç»„å…³è”" aria-hidden="true">#</a> 1ã€<code>å±æ€§åˆ†ç»„</code>æŸ¥è¯¢åˆ†ç»„å…³è”</h4><h5 id="_1ã€æŸ¥çœ‹è¯·æ±‚-2" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹è¯·æ±‚-2" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹è¯·æ±‚</h5><p>ç‚¹å‡»<code>å•†å“ç³»ç»Ÿ</code>ä¸‹çš„<code>å¹³å°å±æ€§</code>ä¸‹çš„<code>å±æ€§åˆ†ç»„</code>,ç‚¹å‡»æ“ä½œä¸‹çš„<code>å…³è”</code>,ä¼šå‘é€ä¸€ä¸ªè¯·æ±‚,æ¥æŸ¥è¯¢<code>å±æ€§åˆ†ç»„</code>å…³è”çš„<code>é”€å”®å±æ€§(åŸºæœ¬å±æ€§)</code></p><p>url: http://localhost:88/api/product/attrgroup/1/attr/relation?t=1652858166118</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.1.1.1.png" alt="image-20220518151725272" tabindex="0" loading="lazy"><figcaption>image-20220518151725272</figcaption></figure>`,139),Fa={href:"https://easydoc.net/s/78237135/ZUqEdvA4/LnjzZHPj",target:"_blank",rel:"noopener noreferrer"},Ua=e(`<figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.1.1.2.png" alt="image-20220518193749778" tabindex="0" loading="lazy"><figcaption>image-20220518193749778</figcaption></figure><h5 id="_2ã€æ·»åŠ attrrelationæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ attrrelationæ–¹æ³•" aria-hidden="true">#</a> 2ã€æ·»åŠ <code>attrRelation</code>æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.AttrGroupController</code>ç±»é‡Œæ·»åŠ <code>attrRelation</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">AttrService</span> attrService<span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 *  localhost:88/api/product/attrgroup/1/attr/relation?t=1652858166118
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/{attrgroupId}/attr/relation&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">attrRelation</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;attrgroupId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> attrgroupId<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> attrService<span class="token punctuation">.</span><span class="token function">getRelationAttr</span><span class="token punctuation">(</span>attrgroupId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.1.2.png" alt="image-20220518154325812" tabindex="0" loading="lazy"><figcaption>image-20220518154325812</figcaption></figure><h5 id="_3ã€æ·»åŠ getrelationattræŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ getrelationattræŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>getRelationAttr</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.AttrService</code>æ¥å£é‡Œæ·»åŠ <code>getRelationAttr</code>æŠ½è±¡æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.1.3.png" alt="image-20220518154451842" tabindex="0" loading="lazy"><figcaption>image-20220518154451842</figcaption></figure><h5 id="_4ã€å®ç°getrelationattræŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€å®ç°getrelationattræŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€å®ç°<code>getRelationAttr</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œæ·»åŠ æ–¹æ³•</p><p>å®ç°æœªå®ç°çš„<code>getRelationAttr</code>æŠ½è±¡æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.1.4.png" alt="image-20220518154507704" tabindex="0" loading="lazy"><figcaption>image-20220518154507704</figcaption></figure><h5 id="_5ã€æµ‹è¯•-8" tabindex="-1"><a class="header-anchor" href="#_5ã€æµ‹è¯•-8" aria-hidden="true">#</a> 5ã€æµ‹è¯•</h5><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢ï¼Œé‡æ–°ç‚¹å‡»<code>å…³è”</code>,å¯ä»¥çœ‹åˆ°å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.1.5.png" alt="image-20220518154635843" tabindex="0" loading="lazy"><figcaption>image-20220518154635843</figcaption></figure><h4 id="_2ã€å±æ€§åˆ†ç»„åˆ é™¤åˆ†ç»„å…³è”" tabindex="-1"><a class="header-anchor" href="#_2ã€å±æ€§åˆ†ç»„åˆ é™¤åˆ†ç»„å…³è”" aria-hidden="true">#</a> 2ã€<code>å±æ€§åˆ†ç»„</code>åˆ é™¤åˆ†ç»„å…³è”</h4><h5 id="_1ã€æŸ¥çœ‹è¯·æ±‚-3" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹è¯·æ±‚-3" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹è¯·æ±‚</h5><p>ç‚¹å‡»ç§»é™¤æŒ‰é’®ï¼ŒæŸ¥çœ‹è¯·æ±‚çš„url</p><p>url: http://localhost:88/api/product/attrgroup/attr/relation/delete</p><p>ä¼ é€’çš„å‚æ•°ä¸º: <code>attrId</code>å’Œ<code>attrGroupId</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.2.1.1.png" alt="image-20220518155321920" tabindex="0" loading="lazy"><figcaption>image-20220518155321920</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.2.1.2.png" alt="image-20220518155457971" tabindex="0" loading="lazy"><figcaption>image-20220518155457971</figcaption></figure>`,22),Wa={href:"https://easydoc.net/s/78237135/ZUqEdvA4/qn7A2Fht",target:"_blank",rel:"noopener noreferrer"},Qa=e(`<figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.2.1.3.png" alt="image-20220518194431585" tabindex="0" loading="lazy"><figcaption>image-20220518194431585</figcaption></figure><h5 id="_2ã€æ–°å»ºattrgrouprelationvoç±»" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å»ºattrgrouprelationvoç±»" aria-hidden="true">#</a> 2ã€æ–°å»º<code>AttrGroupRelationVo</code>ç±»</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—ä¸‹çš„<code>com.atguigu.gulimall.product.vo</code>åŒ…ä¸‹æ–°å»º<code>AttrGroupRelationVo</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/18
 * @Description:
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AttrGroupRelationVo</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> attrId<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> attrGroupId<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.2.2.png" alt="image-20220518194549006" tabindex="0" loading="lazy"><figcaption>image-20220518194549006</figcaption></figure><h5 id="_3ã€æ·»åŠ deleterelationæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ deleterelationæ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>deleteRelation</code>æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.AttrGroupController</code>ç±»é‡Œæ·»åŠ <code>deleteRelation</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * localhost:88/api/product/attrgroup/attr/relation/delete
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/attr/relation/delete&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">deleteRelation</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupRelationVo</span><span class="token punctuation">[</span><span class="token punctuation">]</span> attrGroupRelationVos<span class="token punctuation">)</span><span class="token punctuation">{</span>
    attrService<span class="token punctuation">.</span><span class="token function">deleteRelation</span><span class="token punctuation">(</span>attrGroupRelationVos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.2.3.png" alt="image-20220518194834132" tabindex="0" loading="lazy"><figcaption>image-20220518194834132</figcaption></figure><h5 id="_4ã€æ·»åŠ deleterelationæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ deleterelationæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>deleteRelation</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—ä¸‹çš„<code>com.atguigu.gulimall.product.service.AttrService</code>ç±»é‡Œæ·»åŠ <code>deleteRelation</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">deleteRelation</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupRelationVo</span><span class="token punctuation">[</span><span class="token punctuation">]</span> attrGroupRelationVos<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.2.4.png" alt="image-20220518195422431" tabindex="0" loading="lazy"><figcaption>image-20220518195422431</figcaption></figure><h5 id="_5ã€å®ç°deleterelationæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€å®ç°deleterelationæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 5ã€å®ç°<code>deleteRelation</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—ä¸‹çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œå®ç°æœªå®ç°çš„<code>deleteRelation</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * delete from gulimall_pms.pms_attr_attrgroup_relation
 * where (attr_id = 1 and attr_group_id=1)
 * or (attr_id = 2 and attr_group_id=2)
 * or (attr_id = 3 and attr_group_id=3);
 * <span class="token keyword">@param</span> <span class="token parameter">attrGroupRelationVos</span>
 */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteRelation</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupRelationVo</span><span class="token punctuation">[</span><span class="token punctuation">]</span> attrGroupRelationVos<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">&gt;</span></span> attrAttrgroupRelationEntities <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>attrGroupRelationVos<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>attrGroupRelationVo <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">AttrAttrgroupRelationEntity</span> attrAttrgroupRelationEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>attrGroupRelationVo<span class="token punctuation">,</span> attrAttrgroupRelationEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> attrAttrgroupRelationEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">deleteBatchRelation</span><span class="token punctuation">(</span>attrAttrgroupRelationEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.2.5.png" alt="image-20220518200544137" tabindex="0" loading="lazy"><figcaption>image-20220518200544137</figcaption></figure><h5 id="_6ã€æ·»åŠ deletebatchrelationæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_6ã€æ·»åŠ deletebatchrelationæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 6ã€æ·»åŠ <code>deleteBatchRelation</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—é‡Œçš„<code>com.atguigu.gulimall.product.dao.AttrAttrgroupRelationDao</code>ç±»é‡Œ</p><p>æ·»åŠ <code>deleteBatchRelation</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">deleteBatchRelation</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;entities&quot;</span><span class="token punctuation">)</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">&gt;</span></span> attrAttrgroupRelationEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.2.6.png" alt="image-20220518201025915" tabindex="0" loading="lazy"><figcaption>image-20220518201025915</figcaption></figure><h5 id="_7ã€æ·»åŠ deletebatchrelationæŠ½è±¡æ–¹æ³•çš„sqlè¯­å¥" tabindex="-1"><a class="header-anchor" href="#_7ã€æ·»åŠ deletebatchrelationæŠ½è±¡æ–¹æ³•çš„sqlè¯­å¥" aria-hidden="true">#</a> 7ã€æ·»åŠ <code>deleteBatchRelation</code>æŠ½è±¡æ–¹æ³•çš„sqlè¯­å¥</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>src/main/resources/mapper/product/AttrAttrgroupRelationDao.xml</code>æ–‡ä»¶é‡Œæ·»åŠ sqlè¯­å¥</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--æ‰¹é‡åˆ é™¤attr_attrgroup_relation--&gt;</span>
<span class="token comment">&lt;!--
    delete from gulimall_pms.pms_attr_attrgroup_relation
    where (attr_id = 1 and attr_group_id=1)
    or (attr_id = 2 and attr_group_id=2)
    or (attr_id = 3 and attr_group_id=3);
--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>delete</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>deleteBatchRelation<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    delete from gulimall_pms.pms_attr_attrgroup_relation where
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>entities<span class="token punctuation">&quot;</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> or <span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        (attr_id = #{item.attrId} and attr_group_id=#{item.attrGroupId})
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>delete</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.2.7.png" alt="image-20220518201815102" tabindex="0" loading="lazy"><figcaption>image-20220518201815102</figcaption></figure><h5 id="_8ã€æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_8ã€æµ‹è¯•" aria-hidden="true">#</a> 8ã€æµ‹è¯•</h5><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢</p><p>ç‚¹å‡»<code>å±æ€§åˆ†ç»„</code>ä¸‹<code>æ“ä½œ</code>ä¸‹é‡Œçš„<code>å…³è”</code>,ç‚¹å‡»<code>åˆ é™¤</code>ï¼Œæ˜¾ç¤º<code>ç³»ç»ŸæœªçŸ¥å¼‚å¸¸</code></p><h6 id="_1ã€ç³»ç»ŸæœªçŸ¥å¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#_1ã€ç³»ç»ŸæœªçŸ¥å¼‚å¸¸" aria-hidden="true">#</a> 1ã€ç³»ç»ŸæœªçŸ¥å¼‚å¸¸</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.2.8.1.png" alt="image-20220518202518600" tabindex="0" loading="lazy"><figcaption>image-20220518202518600</figcaption></figure><h6 id="_2ã€æŸ¥çœ‹æŠ¥é”™ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹æŠ¥é”™ä¿¡æ¯" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹æŠ¥é”™ä¿¡æ¯</h6><p>æŸ¥çœ‹<code>gulimall-product</code>æ¨¡å—çš„æ§åˆ¶å°çš„æŠ¥é”™ä¿¡æ¯</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>No primary or default constructor found for class [Lcom.atguigu.gulimall.product.vo.AttrGroupRelationVo;
æ²¡æœ‰æ‰¾åˆ°ç±» [Lcom.atguigu.gulimall.product.vo.AttrGroupRelationVo; çš„ä¸»è¦æˆ–é»˜è®¤æ„é€ å‡½æ•°ï¼›
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.2.8.2.png" alt="image-20220518202535851" tabindex="0" loading="lazy"><figcaption>image-20220518202535851</figcaption></figure><h6 id="_3ã€åŠ -requestbodyæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_3ã€åŠ -requestbodyæ³¨è§£" aria-hidden="true">#</a> 3ã€åŠ <code>@RequestBody</code>æ³¨è§£</h6><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.AttrGroupController</code>ç±»é‡Œä¿®æ”¹<code>deleteRelation</code>æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.2.8.3.png" alt="image-20220518202629893" tabindex="0" loading="lazy"><figcaption>image-20220518202629893</figcaption></figure><h6 id="_4ã€é‡æ–°æµ‹è¯•-3" tabindex="-1"><a class="header-anchor" href="#_4ã€é‡æ–°æµ‹è¯•-3" aria-hidden="true">#</a> 4ã€é‡æ–°æµ‹è¯•</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.6.2.8.4.png" alt="image-20220518202749246" tabindex="0" loading="lazy"><figcaption>image-20220518202749246</figcaption></figure><h3 id="_4-5-7ã€å±æ€§åˆ†ç»„æŸ¥è¯¢åˆ†ç»„æœªå…³è”çš„å±æ€§" tabindex="-1"><a class="header-anchor" href="#_4-5-7ã€å±æ€§åˆ†ç»„æŸ¥è¯¢åˆ†ç»„æœªå…³è”çš„å±æ€§" aria-hidden="true">#</a> 4.5.7ã€<code>å±æ€§åˆ†ç»„</code>æŸ¥è¯¢åˆ†ç»„æœªå…³è”çš„å±æ€§</h3><h4 id="_1ã€æŸ¥çœ‹è¯·æ±‚-4" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹è¯·æ±‚-4" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹è¯·æ±‚</h4><p>ç‚¹å‡»<code>æ–°å»ºå…³è”</code>ä¼šå‘é€ä¸€ä¸ªè¯·æ±‚ï¼ŒæŸ¥è¯¢<strong>æœ¬åˆ†ç±»ä¸‹ï¼Œæ²¡æœ‰è¢«å…¶ä»–åˆ†ç»„å…³è”çš„å±æ€§</strong></p><p>(æ¯”æ–¹è¯´<code>ä¸»æœº</code><strong>å±æ€§åˆ†ç»„</strong>æŸ¥è¯¢ <code>æ‰‹æœº/æ‰‹æœºé€šè®¯/æ‰‹æœº</code>ä¸‹çš„æœªè¢«å…¶ä»–<strong>å±æ€§åˆ†ç»„</strong>å…³è”çš„<strong>åŸºæœ¬å±æ€§</strong>)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.1.1.png" alt="image-20220518204930720" tabindex="0" loading="lazy"><figcaption>image-20220518204930720</figcaption></figure>`,45),Ha={href:"https://easydoc.net/s/78237135/ZUqEdvA4/d3EezLdO",target:"_blank",rel:"noopener noreferrer"},$a=e(`<figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.1.2.png" alt="image-20220520093458443" tabindex="0" loading="lazy"><figcaption>image-20220520093458443</figcaption></figure><h4 id="_2ã€æ·»åŠ attrnorelationæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ attrnorelationæ–¹æ³•" aria-hidden="true">#</a> 2ã€æ·»åŠ <code>attrNoRelation</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.AttrGroupController</code>ç±»é‡Œæ·»åŠ <code>attrNoRelation</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æŸ¥è¯¢æœ¬åˆ†ç±»ä¸‹ï¼Œæ²¡æœ‰è¢«å…¶ä»–åˆ†ç»„å…³è”çš„å±æ€§
 * (æ¯”æ–¹è¯´&quot;ä¸»æœº&quot;å±æ€§åˆ†ç»„æŸ¥è¯¢ &quot;æ‰‹æœº/æ‰‹æœºé€šè®¯/æ‰‹æœº&quot;ä¸‹çš„æœªè¢«å…¶ä»–å±æ€§åˆ†ç»„å…³è”çš„åŸºæœ¬å±æ€§)
 * localhost:88/api/product/attrgroup/1/noattr/relation?t=1652878342763&amp;page=1&amp;limit=10&amp;key=
 * <span class="token keyword">@param</span> <span class="token parameter">attrgroupId</span> å±æ€§åˆ†ç»„id
 * <span class="token keyword">@param</span> <span class="token parameter">params</span>      åˆ†é¡µå‚æ•°
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/{attrgroupId}/noattr/relation&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">attrNoRelation</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;attrgroupId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> attrgroupId<span class="token punctuation">,</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">PageUtils</span> page <span class="token operator">=</span> attrService<span class="token punctuation">.</span><span class="token function">getNoRelationAttr</span><span class="token punctuation">(</span>attrgroupId<span class="token punctuation">,</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">,</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.2.png" alt="image-20220518210857053" tabindex="0" loading="lazy"><figcaption>image-20220518210857053</figcaption></figure><h4 id="_3ã€æ·»åŠ getnorelationattræŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ getnorelationattræŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>getNoRelationAttr</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.AttrService</code>ç±»é‡Œæ·»åŠ <code>getNoRelationAttr</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">PageUtils</span> <span class="token function">getNoRelationAttr</span><span class="token punctuation">(</span><span class="token class-name">Long</span> attrgroupId<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.3.png" alt="image-20220518210924259" tabindex="0" loading="lazy"><figcaption>image-20220518210924259</figcaption></figure><h4 id="_4ã€å®ç°getnorelationattræŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€å®ç°getnorelationattræŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€å®ç°<code>getNoRelationAttr</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—ä¸‹çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œæ·»åŠ æœªå®ç°çš„<code>getNoRelationAttr</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æŸ¥è¯¢æœ¬åˆ†ç±»ä¸‹ï¼Œæ²¡æœ‰è¢«å…¶ä»–åˆ†ç»„å…³è”çš„å±æ€§
 * (æ¯”æ–¹è¯´&quot;ä¸»æœº&quot;å±æ€§åˆ†ç»„æŸ¥è¯¢ &quot;æ‰‹æœº/æ‰‹æœºé€šè®¯/æ‰‹æœº&quot;ä¸‹çš„æœªè¢«å…¶ä»–å±æ€§åˆ†ç»„å…³è”çš„åŸºæœ¬å±æ€§)
 * localhost:88/api/product/attrgroup/1/noattr/relation?t=1652878342763&amp;page=1&amp;limit=10&amp;key=
 * <span class="token keyword">@param</span> <span class="token parameter">attrgroupId</span> å±æ€§åˆ†ç»„id
 * <span class="token keyword">@param</span> <span class="token parameter">params</span>      åˆ†é¡µå‚æ•°
 * <span class="token keyword">@return</span>            åˆ†é¡µå¯¹è±¡
 */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">getNoRelationAttr</span><span class="token punctuation">(</span><span class="token class-name">Long</span> attrgroupId<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//1ã€æŸ¥è¯¢è¯¥attrgroupIdçš„catelogId(å½“å‰åˆ†ç»„åªèƒ½å…³è”è‡ªå·±æ‰€å±çš„åˆ†ç±»é‡Œé¢çš„æ‰€æœ‰å±æ€§)</span>
    <span class="token class-name">AttrGroupEntity</span> attrGroupEntity <span class="token operator">=</span> attrGroupDao<span class="token punctuation">.</span><span class="token function">selectById</span><span class="token punctuation">(</span>attrgroupId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Long</span> catelogId <span class="token operator">=</span> attrGroupEntity<span class="token punctuation">.</span><span class="token function">getCatelogId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//2ã€å½“å‰åˆ†ç»„åªèƒ½å…³è”æœ¬åˆ†ç±»ä¸‹çš„å…¶ä»–åˆ†ç»„æ²¡æœ‰å¼•ç”¨çš„å±æ€§</span>
    <span class="token comment">//2.1)ã€å½“å‰åˆ†ç±»ä¸‹çš„å…¶ä»–åˆ†ç»„</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span> attrGroupQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//neï¼šnot equal</span>
    attrGroupQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getCatelogId</span><span class="token punctuation">,</span>catelogId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ne</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getAttrGroupId</span><span class="token punctuation">,</span>attrgroupId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupEntity</span><span class="token punctuation">&gt;</span></span> otherGroups <span class="token operator">=</span> attrGroupDao<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span>attrGroupQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> otherAttrGroupIds <span class="token operator">=</span> otherGroups<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">AttrGroupEntity</span><span class="token operator">::</span><span class="token function">getAttrGroupId</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span> attrQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    attrQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getCatelogId</span><span class="token punctuation">,</span> catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//2.2)ã€å¦‚æœæœ‰å…¶ä»–åˆ†ç»„ï¼Œåˆ™æŸ¥è¯¢è¿™äº›åˆ†ç»„å…³è”çš„å±æ€§</span>
    <span class="token comment">//otherAttrGroupIds!=null &amp;&amp; æœ‰äº›å¤šä½™</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>otherAttrGroupIds<span class="token operator">!=</span><span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> otherAttrGroupIds<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">&gt;</span></span> attrAttrgroupRelationQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        attrAttrgroupRelationQueryWrapper<span class="token punctuation">.</span><span class="token function">in</span><span class="token punctuation">(</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token operator">::</span><span class="token function">getAttrGroupId</span><span class="token punctuation">,</span> otherAttrGroupIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">&gt;</span></span> otherAttrAttrgroupRelations <span class="token operator">=</span> attrAttrgroupRelationDao<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span>attrAttrgroupRelationQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> otherAttrIds <span class="token operator">=</span> otherAttrAttrgroupRelations<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token operator">::</span><span class="token function">getAttrId</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.3)ã€å¦‚æœæœ‰å·²è¢«å…³è”çš„å±æ€§ï¼Œåˆ™ä»å½“å‰åˆ†ç±»çš„æ‰€æœ‰å±æ€§ä¸­ç§»é™¤è¿™äº›å·²è¢«å…³è”çš„å±æ€§;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>otherAttrIds<span class="token operator">!=</span><span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> otherAttrIds<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            attrQueryWrapper<span class="token punctuation">.</span><span class="token function">notIn</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getAttrId</span><span class="token punctuation">,</span> otherAttrIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//å¦‚æœæœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œåˆ™æ·»åŠ æŸ¥è¯¢æ¡ä»¶</span>
    <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        attrQueryWrapper<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>item<span class="token operator">-&gt;</span><span class="token punctuation">{</span>
            item<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getAttrId</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getAttrName</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span> attrQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.4.png" alt="image-20220518225631000" tabindex="0" loading="lazy"><figcaption>image-20220518225631000</figcaption></figure><h4 id="_5ã€æµ‹è¯•-9" tabindex="-1"><a class="header-anchor" href="#_5ã€æµ‹è¯•-9" aria-hidden="true">#</a> 5ã€æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢</p><h5 id="_1ã€å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†" tabindex="-1"><a class="header-anchor" href="#_1ã€å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†" aria-hidden="true">#</a> 1ã€å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.5.1.png" alt="image-20220518225512338" tabindex="0" loading="lazy"><figcaption>image-20220518225512338</figcaption></figure><h5 id="_2ã€è¿˜æ˜¾ç¤ºäº†é”€å”®å±æ€§" tabindex="-1"><a class="header-anchor" href="#_2ã€è¿˜æ˜¾ç¤ºäº†é”€å”®å±æ€§" aria-hidden="true">#</a> 2ã€è¿˜æ˜¾ç¤ºäº†é”€å”®å±æ€§</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.5.2.1.png" alt="image-20220518230754485" tabindex="0" loading="lazy"><figcaption>image-20220518230754485</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.5.2.2.png" alt="image-20220518230708756" tabindex="0" loading="lazy"><figcaption>image-20220518230708756</figcaption></figure><h5 id="_3ã€ä¿®æ”¹å®ç°ç±»çš„getnorelationattræ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹å®ç°ç±»çš„getnorelationattræ–¹æ³•" aria-hidden="true">#</a> 3ã€ä¿®æ”¹å®ç°ç±»çš„<code>getNoRelationAttr</code>æ–¹æ³•</h5><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œçš„<code>getNoRelationAttr</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>attrQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">AttrEntity</span><span class="token operator">::</span><span class="token function">getAttrType</span><span class="token punctuation">,</span><span class="token class-name">ProductConstant</span><span class="token punctuation">.</span><span class="token constant">ATTR_TYPE_BASE</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.5.3.png" alt="image-20220518230935342" tabindex="0" loading="lazy"><figcaption>image-20220518230935342</figcaption></figure><h5 id="_4ã€é‡æ–°æµ‹è¯•-4" tabindex="-1"><a class="header-anchor" href="#_4ã€é‡æ–°æµ‹è¯•-4" aria-hidden="true">#</a> 4ã€é‡æ–°æµ‹è¯•</h5><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢</p><p>å·²ç»ä¸æ˜¾ç¤ºé”€å”®å±æ€§äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.5.4.png" alt="image-20220518231201080" tabindex="0" loading="lazy"><figcaption>image-20220518231201080</figcaption></figure><h4 id="_6ã€ä¿®æ”¹å…³è”å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_6ã€ä¿®æ”¹å…³è”å…³ç³»" aria-hidden="true">#</a> 6ã€ä¿®æ”¹å…³è”å…³ç³»</h4><h5 id="_1ã€é‡æ–°æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_1ã€é‡æ–°æŸ¥è¯¢" aria-hidden="true">#</a> 1ã€é‡æ–°æŸ¥è¯¢</h5><p>åˆ é™¤<strong>è¯¥åˆ†ç±»ä¸‹</strong>å…¶ä»–<code>å±æ€§åˆ†ç»„</code>ä¸<code>åŸºæœ¬å±æ€§</code>çš„<strong>å…³è”å…³ç³»</strong>åï¼Œå†é‡æ–°æŸ¥è¯¢ï¼Œå‘ç°å¯ä»¥æŸ¥è¯¢å‡ºæ¥</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.6.1.1.png" alt="1" tabindex="0" loading="lazy"><figcaption>1</figcaption></figure><h5 id="_2ã€æ·»åŠ å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ å…³ç³»" aria-hidden="true">#</a> 2ã€æ·»åŠ å…³ç³»</h5><p>åœ¨<code>gulimall_pms</code>æ•°æ®åº“ä¸‹çš„<code>pms_attr_attrgroup_relation</code>è¡¨é‡Œæ·»åŠ ä¸€è¡Œæ•°æ®</p><p>ä½¿<code>ä¸»æœº</code>ç»„å…³è”<code>å…¥ç½‘å‹å·</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.6.2.1.png" alt="image-20220518232418576" tabindex="0" loading="lazy"><figcaption>image-20220518232418576</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.6.2.2.png" alt="image-20220518233043776" tabindex="0" loading="lazy"><figcaption>image-20220518233043776</figcaption></figure><h5 id="_3ã€è¿˜å¯ä»¥å†æ¬¡å…³è”å…¥ç½‘å‹å·" tabindex="-1"><a class="header-anchor" href="#_3ã€è¿˜å¯ä»¥å†æ¬¡å…³è”å…¥ç½‘å‹å·" aria-hidden="true">#</a> 3ã€è¿˜å¯ä»¥å†æ¬¡å…³è”<code>å…¥ç½‘å‹å·</code></h5><p>å¯ä»¥çœ‹åˆ°å…³è”<code>å…¥ç½‘å‹å·</code>åï¼Œè¿˜å¯ä»¥å†æ¬¡å…³è”<code>å…¥ç½‘å‹å·</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.6.3.png" alt="image-20220518233117780" tabindex="0" loading="lazy"><figcaption>image-20220518233117780</figcaption></figure><h5 id="_4ã€ä¿®æ”¹getnorelationattræ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿®æ”¹getnorelationattræ–¹æ³•" aria-hidden="true">#</a> 4ã€ä¿®æ”¹<code>getNoRelationAttr</code>æ–¹æ³•</h5><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œçš„<code>getNoRelationAttr</code>æ–¹æ³•</p><p>åˆ é™¤<code>.ne(AttrGroupEntity::getAttrGroupId,attrgroupId)</code>ï¼Œå–æ¶ˆæ’é™¤æœ¬åˆ†ç»„</p><p>æŸ¥è¯¢æ‰€æœ‰åˆ†ç»„(åŒ…æ‹¬æœ¬åˆ†ç»„ï¼Œå› ä¸ºæœ¬åˆ†ç»„å·²ç»å…³è”çš„å±æ€§ï¼Œä¸èƒ½å†æ¬¡å…³è”)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.6.4.png" alt="image-20220518233615200" tabindex="0" loading="lazy"><figcaption>image-20220518233615200</figcaption></figure><h5 id="_5ã€é‡æ–°æµ‹è¯•-1" tabindex="-1"><a class="header-anchor" href="#_5ã€é‡æ–°æµ‹è¯•-1" aria-hidden="true">#</a> 5ã€é‡æ–°æµ‹è¯•</h5><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢</p><p>å¯ä»¥çœ‹åˆ°å…³è”<code>å…¥ç½‘å‹å·</code>åï¼Œä¸å¯ä»¥å†æ¬¡å…³è”<code>å…¥ç½‘å‹å·</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.6.5.png" alt="image-20220518234041402" tabindex="0" loading="lazy"><figcaption>image-20220518234041402</figcaption></figure><h4 id="_7ã€æ¨¡ç³ŠæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_7ã€æ¨¡ç³ŠæŸ¥è¯¢" aria-hidden="true">#</a> 7ã€æ¨¡ç³ŠæŸ¥è¯¢</h4><h5 id="_1ã€æ ¹æ®å±æ€§id" tabindex="-1"><a class="header-anchor" href="#_1ã€æ ¹æ®å±æ€§id" aria-hidden="true">#</a> 1ã€æ ¹æ®<code>å±æ€§id</code></h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.7.1.1.png" alt="image-20220518234459174" tabindex="0" loading="lazy"><figcaption>image-20220518234459174</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.7.1.2.png" alt="image-20220518234430923" tabindex="0" loading="lazy"><figcaption>image-20220518234430923</figcaption></figure><h5 id="_2ã€æ ¹æ®å±æ€§å" tabindex="-1"><a class="header-anchor" href="#_2ã€æ ¹æ®å±æ€§å" aria-hidden="true">#</a> 2ã€æ ¹æ®<code>å±æ€§å</code></h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.7.2.1.png" alt="image-20220518234352730" tabindex="0" loading="lazy"><figcaption>image-20220518234352730</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.7.7.2.2.png" alt="image-20220518234413311" tabindex="0" loading="lazy"><figcaption>image-20220518234413311</figcaption></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œæ¨¡ç³ŠæŸ¥è¯¢æ²¡æœ‰ä»€ä¹ˆé—®é¢˜</p><h3 id="_4-5-8ã€å±æ€§åˆ†ç»„æ·»åŠ å…³è”å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_4-5-8ã€å±æ€§åˆ†ç»„æ·»åŠ å…³è”å…³ç³»" aria-hidden="true">#</a> 4.5.8ã€<code>å±æ€§åˆ†ç»„</code>æ·»åŠ å…³è”å…³ç³»</h3><h4 id="_1ã€æŸ¥çœ‹è¯·æ±‚-5" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹è¯·æ±‚-5" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹è¯·æ±‚</h4><p>å…ˆåˆ é™¤<code>ä¸»æœº</code>å’Œ<code>å…¥ç½‘å‹å·</code>çš„å…³è”å…³ç³»ï¼Œå†é‡æ–°æ·»åŠ ,æŸ¥çœ‹url</p><p>url: http://localhost:88/api/product/attrgroup/attr/relation</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.1.1.png" alt="image-20220518235355704" tabindex="0" loading="lazy"><figcaption>image-20220518235355704</figcaption></figure><p>æŸ¥è¯¢å‚æ•°</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.1.2.png" alt="image-20220518235618863" tabindex="0" loading="lazy"><figcaption>image-20220518235618863</figcaption></figure>`,64),Ka={href:"https://easydoc.net/s/78237135/ZUqEdvA4/VhgnaedC",target:"_blank",rel:"noopener noreferrer"},Xa=e(`<figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.1.3.png" alt="image-20220518235700293" tabindex="0" loading="lazy"><figcaption>image-20220518235700293</figcaption></figure><h4 id="_2ã€æ·»åŠ addrelationæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ addrelationæ–¹æ³•" aria-hidden="true">#</a> 2ã€æ·»åŠ <code>addRelation</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—é‡Œçš„<code>com.atguigu.gulimall.product.controller.AttrGroupController</code>ç±»é‡Œæ·»åŠ <code>addRelation</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">AttrAttrgroupRelationService</span> attrAttrgroupRelationService<span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * localhost:88/api/product/attrgroup/attr/relation
 */</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/attr/relation&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">addRelation</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupRelationVo</span><span class="token punctuation">&gt;</span></span> attrGroupRelationVos<span class="token punctuation">)</span><span class="token punctuation">{</span>
    attrAttrgroupRelationService<span class="token punctuation">.</span><span class="token function">saveBatch</span><span class="token punctuation">(</span>attrGroupRelationVos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.2.png" alt="image-20220519160608120" tabindex="0" loading="lazy"><figcaption>image-20220519160608120</figcaption></figure><h4 id="_3ã€æ·»åŠ savebatchæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ savebatchæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>saveBatch</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.AttrAttrgroupRelationService</code>æ¥å£é‡Œæ·»åŠ <code>saveBatch</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">saveBatch</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupRelationVo</span><span class="token punctuation">&gt;</span></span> attrGroupRelationVos<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.3.png" alt="image-20220519160636605" tabindex="0" loading="lazy"><figcaption>image-20220519160636605</figcaption></figure><h4 id="_4ã€å®ç°savebatchæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€å®ç°savebatchæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€å®ç°<code>saveBatch</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—é‡Œçš„<code>com.atguigu.gulimall.product.service.impl.AttrAttrgroupRelationServiceImpl</code>ç±»é‡Œå®ç°<code>saveBatch</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveBatch</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrGroupRelationVo</span><span class="token punctuation">&gt;</span></span> attrGroupRelationVos<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">&gt;</span></span> attrAttrgroupRelationEntities <span class="token operator">=</span> attrGroupRelationVos<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">AttrAttrgroupRelationEntity</span> attrAttrgroupRelationEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttrAttrgroupRelationEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> attrAttrgroupRelationEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> attrAttrgroupRelationEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">saveBatch</span><span class="token punctuation">(</span>attrAttrgroupRelationEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.4.png" alt="image-20220519161255770" tabindex="0" loading="lazy"><figcaption>image-20220519161255770</figcaption></figure><h4 id="_5ã€æµ‹è¯•-10" tabindex="-1"><a class="header-anchor" href="#_5ã€æµ‹è¯•-10" aria-hidden="true">#</a> 5ã€æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢ï¼Œæ·»åŠ <code>å±æ€§åˆ†ç»„</code>é‡Œçš„å…³è”å…³ç³»</p><h5 id="_1ã€æ·»åŠ å…³è”å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ å…³è”å…³ç³»" aria-hidden="true">#</a> 1ã€æ·»åŠ å…³è”å…³ç³»</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.5.1.gif" alt="GIF 2022-5-19 16-11-17" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-19 16-11-17</figcaption></figure><h5 id="_2ã€æ–°å¢è§„æ ¼å‚æ•°" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å¢è§„æ ¼å‚æ•°" aria-hidden="true">#</a> 2ã€æ–°å¢<code>è§„æ ¼å‚æ•°</code></h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.5.2.png" alt="image-20220519162129172" tabindex="0" loading="lazy"><figcaption>image-20220519162129172</figcaption></figure><h5 id="_3ã€æ–°å¢æˆåŠŸ-ä½†æ˜¯æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥" tabindex="-1"><a class="header-anchor" href="#_3ã€æ–°å¢æˆåŠŸ-ä½†æ˜¯æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥" aria-hidden="true">#</a> 3ã€æ–°å¢æˆåŠŸï¼Œä½†æ˜¯æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.5.3.png" alt="image-20220519162615473" tabindex="0" loading="lazy"><figcaption>image-20220519162615473</figcaption></figure><h5 id="_4ã€æŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#_4ã€æŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸" aria-hidden="true">#</a> 4ã€æŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—é‡Œçš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œçš„<code>queryBaseAttrPage</code>æ–¹æ³•çš„è¿™ä¸€è¡ŒæŠ¥ç©ºæŒ‡é’ˆ</p><p>å¾ˆæ˜æ˜¾ï¼Œ<code>attrRespVo</code>å¯¹è±¡æ˜¯<code>103</code>è¡Œ<code>new</code>å‡ºæ¥çš„ï¼Œä¸ä¼šæ˜¯ç©ºæŒ‡é’ˆ</p><p>åªæœ‰<code>attrGroupEntity</code>æ˜¯æŸ¥å‡ºæ¥ï¼Œç„¶åè¿”å›çš„å¯¹è±¡ï¼Œæœ‰å¯èƒ½åœ¨æ•°æ®åº“ä¸­æ²¡æ‰¾åˆ°</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.5.4.1.png" alt="image-20220519163106480" tabindex="0" loading="lazy"><figcaption>image-20220519163106480</figcaption></figure><p>ä¼ å…¥çš„<code>attr_group_id</code>ä¸º<code>null</code>ï¼Œæ•°æ®åº“è‚¯å®šæŸ¥ä¸åˆ°æ•°æ®ï¼Œæ‰€ä»¥è¿”å›<code>0</code>è¡Œæ•°æ®ï¼Œæ¥æ”¶çš„\`\`attrGroupEntity<code>è‡ªç„¶ä¸º</code>null\`</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.5.4.2.png" alt="image-20220519163207584" tabindex="0" loading="lazy"><figcaption>image-20220519163207584</figcaption></figure><h5 id="_5ã€å¤šåŠ ä¸€ä¸ªåˆ¤æ–­" tabindex="-1"><a class="header-anchor" href="#_5ã€å¤šåŠ ä¸€ä¸ªåˆ¤æ–­" aria-hidden="true">#</a> 5ã€å¤šåŠ ä¸€ä¸ªåˆ¤æ–­</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œçš„<code>queryBaseAttrPage</code>æ–¹æ³•é‡Œ å°†<code>if (attrAttrgroupRelationEntity != null)</code>æ”¹ä¸º</p><p><code>if (attrAttrgroupRelationEntity != null &amp;&amp; attrAttrgroupRelationEntity.getAttrGroupId()!=null) </code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.5.5.png" alt="image-20220519164444114" tabindex="0" loading="lazy"><figcaption>image-20220519164444114</figcaption></figure><p>åŒç†ï¼Œä¹Ÿåº”è¯¥ä¿®æ”¹å…¶ä»–ç±»ä¼¼ä»£ç </p><h5 id="_6ã€ä¿®æ”¹saveattræ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_6ã€ä¿®æ”¹saveattræ–¹æ³•" aria-hidden="true">#</a> 6ã€ä¿®æ”¹<code>saveAttr</code>æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œçš„<code>saveAttr</code>æ–¹æ³•é‡Œ</p><p>å°†<code>if (attr.getAttrType() == ProductConstant.ATTR_TYPE_BASE.getCode())</code>æ”¹ä¸º</p><p><code>if (attr.getAttrType() == ProductConstant.ATTR_TYPE_BASE.getCode() &amp;&amp; attr.getAttrGroupId()!=null) </code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.5.6.png" alt="image-20220519165943509" tabindex="0" loading="lazy"><figcaption>image-20220519165943509</figcaption></figure><h5 id="_7ã€ä¿®æ”¹updateattræ–¹æ³•-1" tabindex="-1"><a class="header-anchor" href="#_7ã€ä¿®æ”¹updateattræ–¹æ³•-1" aria-hidden="true">#</a> 7ã€ä¿®æ”¹<code>updateAttr</code>æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrServiceImpl</code>ç±»é‡Œçš„<code>updateAttr</code>æ–¹æ³•é‡Œ</p><p>å°†<code>if (attr.getAttrType() == ProductConstant.ATTR_TYPE_BASE.getCode())</code>æ”¹ä¸º</p><p><code>if (attr.getAttrType() == ProductConstant.ATTR_TYPE_BASE.getCode() &amp;&amp; attr.getAttrGroupId()!=null) </code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.5.7.png" alt="image-20220519174303778" tabindex="0" loading="lazy"><figcaption>image-20220519174303778</figcaption></figure><h4 id="_6ã€é‡æ–°æµ‹è¯•-2" tabindex="-1"><a class="header-anchor" href="#_6ã€é‡æ–°æµ‹è¯•-2" aria-hidden="true">#</a> 6ã€é‡æ–°æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢</p><h5 id="_1ã€æŸ¥è¯¢å…¨éƒ¨-1" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥è¯¢å…¨éƒ¨-1" aria-hidden="true">#</a> 1ã€æŸ¥è¯¢å…¨éƒ¨</h5><p>å¯ä»¥çœ‹åˆ°ï¼Œåˆšåˆšæ·»åŠ çš„<code>æœºèº«é¢œè‰²</code>å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.6.1.png" alt="image-20220519175025352" tabindex="0" loading="lazy"><figcaption>image-20220519175025352</figcaption></figure><h5 id="_2ã€å»ºç«‹å…³è”å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_2ã€å»ºç«‹å…³è”å…³ç³»" aria-hidden="true">#</a> 2ã€å»ºç«‹å…³è”å…³ç³»</h5><p>åœ¨<code>å•†å“ç³»ç»Ÿ/å¹³å°å±æ€§/å±æ€§åˆ†ç»„</code>é‡Œå»ºç«‹å…³è”å…³ç³»ä¹Ÿæ²¡æœ‰é—®é¢˜</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.6.2.gif" alt="GIF 2022-5-19 17-54-56" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-19 17-54-56</figcaption></figure><h5 id="_3ã€å†æ¬¡ç‚¹å‡»è§„æ ¼å‚æ•°-æŸ¥è¯¢ä¸åˆ°æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_3ã€å†æ¬¡ç‚¹å‡»è§„æ ¼å‚æ•°-æŸ¥è¯¢ä¸åˆ°æ•°æ®" aria-hidden="true">#</a> 3ã€å†æ¬¡ç‚¹å‡»<code>è§„æ ¼å‚æ•°</code>ï¼ŒæŸ¥è¯¢ä¸åˆ°æ•°æ®</h5><p>å†æ¬¡ç‚¹å‡»<code>è§„æ ¼å‚æ•°</code>ï¼ŒåˆæŸ¥è¯¢ä¸åˆ°æ•°æ®äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.6.3.png" alt="image-20220519180029672" tabindex="0" loading="lazy"><figcaption>image-20220519180029672</figcaption></figure><h5 id="_4ã€æŸ¥çœ‹æ§åˆ¶å°" tabindex="-1"><a class="header-anchor" href="#_4ã€æŸ¥çœ‹æ§åˆ¶å°" aria-hidden="true">#</a> 4ã€æŸ¥çœ‹æ§åˆ¶å°</h5><p>æŸ¥çœ‹<code>gulimall-product</code>æ¨¡å—çš„æ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°æŸ¥è¯¢åˆ°äº†ä¸¤æ¡æ•°æ®ï¼Œè€Œéœ€è¦çš„æ˜¯<code>0</code>æ¡æˆ–<code>1</code>æ¡æ•°æ®(<strong>æŸ¥ä¸åˆ°æ•°æ®</strong>æˆ–<strong>åªæŸ¥è¯¢åˆ°ä¸€æ¡æ•°æ®</strong>)</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>nested exception is org.apache.ibatis.exceptions.TooManyResultsException: Expected one result <span class="token punctuation">(</span>or null<span class="token punctuation">)</span> to be returned by selectOne<span class="token punctuation">(</span><span class="token punctuation">)</span>, but found: <span class="token number">2</span>
åµŒå¥—å¼‚å¸¸æ˜¯ org.apache.ibatis.exceptions.TooManyResultsExceptionï¼šæœŸæœ› selectOne<span class="token punctuation">(</span><span class="token punctuation">)</span> è¿”å›ä¸€ä¸ªç»“æœï¼ˆæˆ– nullï¼‰ï¼Œä½†å‘ç°ï¼š2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.6.4.png" alt="image-20220519180338886" tabindex="0" loading="lazy"><figcaption>image-20220519180338886</figcaption></figure><h5 id="_5ã€æŸ¥çœ‹æ•°æ®åº“" tabindex="-1"><a class="header-anchor" href="#_5ã€æŸ¥çœ‹æ•°æ®åº“" aria-hidden="true">#</a> 5ã€æŸ¥çœ‹æ•°æ®åº“</h5><p>åœ¨<code>gulimall_pms</code>æ•°æ®åº“ä¸‹çš„<code>pms_attr_attrgroup_relation</code>è¡¨é‡Œå°†<code>attr_id</code>=<code>6</code>å¹¶ä¸”<code>attr_group_id</code>ä¸º<code>null</code>çš„å­—æ®µåˆ æ‰</p><p>ä¹ŸæŠŠ<code>attr_id</code>ä¸º<code>4</code>çš„ä¹Ÿåˆ é™¤æ‰ï¼Œ<code>attr_id</code>ä¸º<code>4</code>çš„æ˜¯é”€å”®å±æ€§ï¼Œä¸éœ€è¦å…³è”å…³ç³»(è¿™æ˜¯ä»¥å‰ä¿®æ”¹ä»£ç å‰ï¼Œæ’å…¥çš„é”™è¯¯æ•°æ®)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.6.5.1.png" alt="image-20220519181010383" tabindex="0" loading="lazy"><figcaption>image-20220519181010383</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.6.5.2.png" alt="image-20220519213127175" tabindex="0" loading="lazy"><figcaption>image-20220519213127175</figcaption></figure><h5 id="_6ã€åˆ·æ–°å‰ç«¯é¡µé¢" tabindex="-1"><a class="header-anchor" href="#_6ã€åˆ·æ–°å‰ç«¯é¡µé¢" aria-hidden="true">#</a> 6ã€åˆ·æ–°å‰ç«¯é¡µé¢</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.6.6.png" alt="image-20220519213334536" tabindex="0" loading="lazy"><figcaption>image-20220519213334536</figcaption></figure><h4 id="_7ã€è§„æ ¼å‚æ•°æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_7ã€è§„æ ¼å‚æ•°æµ‹è¯•" aria-hidden="true">#</a> 7ã€<code>è§„æ ¼å‚æ•°</code>æµ‹è¯•</h4><p>åœ¨<code>è§„æ ¼å‚æ•°</code>é‡Œä¿®æ”¹<code>æ‰€å±åˆ†ç»„</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.5.8.7.gif" alt="GIF 2022-5-19 21-35-51" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-19 21-35-51</figcaption></figure><p>ä¸è¿‡è¿™æ ·åšå¹¶ä¸è§„èŒƒï¼Œæœ€å¥½åœ¨æ·»åŠ å…³è”å…³ç³»çš„æ—¶å€™æŸ¥è¯¢ä¸€ä¸‹å†æ·»åŠ ï¼Œé˜²æ­¢æ¶æ„æ”»å‡»</p><h2 id="_4-6ã€å•†å“æœåŠ¡-api-æ–°å¢å•†å“" tabindex="-1"><a class="header-anchor" href="#_4-6ã€å•†å“æœåŠ¡-api-æ–°å¢å•†å“" aria-hidden="true">#</a> 4.6ã€å•†å“æœåŠ¡-API-æ–°å¢å•†å“</h2><h3 id="_4-6-1ã€è°ƒè¯•ä¼šå‘˜ç­‰çº§ç›¸å…³æ¥å£" tabindex="-1"><a class="header-anchor" href="#_4-6-1ã€è°ƒè¯•ä¼šå‘˜ç­‰çº§ç›¸å…³æ¥å£" aria-hidden="true">#</a> 4.6.1ã€è°ƒè¯•ä¼šå‘˜ç­‰çº§ç›¸å…³æ¥å£</h3><h4 id="_1ã€å‘é€è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_1ã€å‘é€è¯·æ±‚" aria-hidden="true">#</a> 1ã€å‘é€è¯·æ±‚</h4><h5 id="_1ã€æœ¬åº”è¯¥å‘é€çš„è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_1ã€æœ¬åº”è¯¥å‘é€çš„è¯·æ±‚" aria-hidden="true">#</a> 1ã€æœ¬åº”è¯¥å‘é€çš„è¯·æ±‚</h5><p>ç‚¹å‡»<code>/å•†å“ç³»ç»Ÿ/å•†å“ç»´æŠ¤/å‘é€å•†å“</code>,è¿™æ˜¯åº”è¯¥å‘é€è¿™ä¸ªè¯·æ±‚ï¼Œ</p><p>è°ƒç”¨<code>gulimall-member</code>æ¨¡å—çš„<code>com.atguigu.gulimall.member.controller.MemberLevelController</code>ç±»çš„<code>list</code>æ–¹æ³•</p><p>url: http://localhost:88/api/member/memberlevel/list?t=1652972635593&amp;page=1&amp;limit=500</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.1.1.png" alt="dddd" tabindex="0" loading="lazy"><figcaption>dddd</figcaption></figure><h5 id="_2ã€æˆ‘çš„å‘é€çš„è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_2ã€æˆ‘çš„å‘é€çš„è¯·æ±‚" aria-hidden="true">#</a> 2ã€æˆ‘çš„å‘é€çš„è¯·æ±‚</h5><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘è¿™é‡Œåªå‘é€äº†ä¸¤ç»™<code>tree</code>è¯·æ±‚ï¼Œå¹¶æ²¡æœ‰å‘é€åº”è¯¥å‘é€çš„è¯·æ±‚</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.1.2.png" alt="image-20220519225349292" tabindex="0" loading="lazy"><figcaption>image-20220519225349292</figcaption></figure><h5 id="_3ã€æ–¹æ³•ä¸€-éå¸¸ä¸æ¨è" tabindex="-1"><a class="header-anchor" href="#_3ã€æ–¹æ³•ä¸€-éå¸¸ä¸æ¨è" aria-hidden="true">#</a> 3ã€æ–¹æ³•ä¸€(éå¸¸ä¸æ¨è)</h5><h6 id="_1ã€æŸ¥çœ‹å‘é€è¯·æ±‚çš„æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹å‘é€è¯·æ±‚çš„æ–¹æ³•" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹å‘é€è¯·æ±‚çš„æ–¹æ³•</h6><p>è¿™ä¸ªè¯·æ±‚æ˜¯<code>src\\views\\modules\\product\\spuadd.vue</code>æ–‡ä»¶çš„<code>getMemberLevels</code>æ–¹æ³•å‘é€çš„</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.1.3.1.png" alt="image-20220519230722823" tabindex="0" loading="lazy"><figcaption>image-20220519230722823</figcaption></figure><h6 id="_2ã€åœ¨createdé˜¶æ®µ-è°ƒç”¨è¯¥æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€åœ¨createdé˜¶æ®µ-è°ƒç”¨è¯¥æ–¹æ³•" aria-hidden="true">#</a> 2ã€åœ¨<code>created</code>é˜¶æ®µï¼Œè°ƒç”¨è¯¥æ–¹æ³•</h6><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMemberLevels</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å…¶å®åœ¨<code>mounted</code>ä¸­è°ƒç”¨è¿™ä¸ªæ–¹æ³•äº†ï¼Œä½†æ˜¯<code>mounted</code>é‡Œå…ˆç”¨çš„<code>PubSub</code>æŠ¥é”™äº†ï¼Œæ‰€ä»¥æ²¡æ‰§è¡Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.1.3.2.png" alt="image-20220519230014448" tabindex="0" loading="lazy"><figcaption>image-20220519230014448</figcaption></figure><h6 id="_3ã€æŸ¥çœ‹è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_3ã€æŸ¥çœ‹è¯·æ±‚" aria-hidden="true">#</a> 3ã€æŸ¥çœ‹è¯·æ±‚</h6><p>å¯ä»¥çœ‹åˆ°å·²ç»å‘é€è¿™ä¸ªè¯·æ±‚äº†</p><p>url: http://localhost:88/api/member/memberlevel/list?t=1652972635593&amp;page=1&amp;limit=500</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.1.3.3.png" alt="image-20220519225853391" tabindex="0" loading="lazy"><figcaption>image-20220519225853391</figcaption></figure><h5 id="_4ã€æ–¹æ³•äºŒ-å»ºè®®" tabindex="-1"><a class="header-anchor" href="#_4ã€æ–¹æ³•äºŒ-å»ºè®®" aria-hidden="true">#</a> 4ã€æ–¹æ³•äºŒ(å»ºè®®)</h5><h6 id="_1ã€æ§åˆ¶å°æŠ¥é”™-1" tabindex="-1"><a class="header-anchor" href="#_1ã€æ§åˆ¶å°æŠ¥é”™-1" aria-hidden="true">#</a> 1ã€æ§åˆ¶å°æŠ¥é”™</h6><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>PubSub is not defined ï¼šPubSub æœªå®šä¹‰
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.1.4.1.png" alt="image-20220519233039674" tabindex="0" loading="lazy"><figcaption>image-20220519233039674</figcaption></figure><h6 id="_2ã€å®‰è£…-pubsub-js" tabindex="-1"><a class="header-anchor" href="#_2ã€å®‰è£…-pubsub-js" aria-hidden="true">#</a> 2ã€å®‰è£… pubsub-js</h6><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>npm install --save pubsub-js
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.1.4.2.png" alt="image-20220520000459261" tabindex="0" loading="lazy"><figcaption>image-20220520000459261</figcaption></figure><h6 id="_3ã€æå‡æƒé™" tabindex="-1"><a class="header-anchor" href="#_3ã€æå‡æƒé™" aria-hidden="true">#</a> 3ã€æå‡æƒé™</h6><p><strong>æ–¹æ³•ä¸€ï¼š</strong></p><p>ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ&quot;VS Code&quot;</p><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.1.4.3.1.png" alt="image-20220519234508600" style="zoom:50%;"><p><strong><s>æ–¹æ³•äºŒï¼š(ä¸æ˜¯è¿™ä¸ªç”¨æˆ·)</s></strong></p><ol><li>æ‰“å¼€nodejsçš„å®‰è£…ç›®å½•</li><li>ç‚¹å‡»&quot;npm_cache&quot;,å³é”®é€‰æ‹©&quot;å±æ€§&quot;</li><li>é€‰æ‹©&quot;SYSTEM&quot;</li><li>ç‚¹å‡»&quot;ç¼–è¾‘&quot;</li><li>é€‰æ‹©&quot;Authenticated Users&quot;</li><li>ç‚¹å‡»å®Œå…¨æ§åˆ¶</li><li>ç‚¹å‡»ç¡®å®š</li></ol><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.1.4.3.2.png" alt="image-20220519235446253" tabindex="0" loading="lazy"><figcaption>image-20220519235446253</figcaption></figure><ol><li>æ‰“å¼€nodejsçš„å®‰è£…ç›®å½•</li><li>ç‚¹å‡»&quot;npm_gloa&quot;,å³é”®é€‰æ‹©&quot;å±æ€§&quot;</li><li>é€‰æ‹©&quot;SYSTEM&quot;</li><li>ç‚¹å‡»&quot;ç¼–è¾‘&quot;</li><li>é€‰æ‹©&quot;Authenticated Users&quot;</li><li>ç‚¹å‡»å®Œå…¨æ§åˆ¶</li><li>ç‚¹å‡»ç¡®å®š</li></ol><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.1.4.3.3.png" alt="image-20220520000204114" tabindex="0" loading="lazy"><figcaption>image-20220520000204114</figcaption></figure><h6 id="_4ã€é‡æ–°å®‰è£…-pubsub-js" tabindex="-1"><a class="header-anchor" href="#_4ã€é‡æ–°å®‰è£…-pubsub-js" aria-hidden="true">#</a> 4ã€é‡æ–°å®‰è£… pubsub-js</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.1.4.4.png" alt="image-20220519232622362" tabindex="0" loading="lazy"><figcaption>image-20220519232622362</figcaption></figure><h6 id="_5ã€å¯¼å…¥pubsub-js" tabindex="-1"><a class="header-anchor" href="#_5ã€å¯¼å…¥pubsub-js" aria-hidden="true">#</a> 5ã€å¯¼å…¥<code>pubsub-js</code></h6><p>åœ¨<code>B:\\renren-fast-vue\\src\\views\\modules\\product\\spuadd.vue</code>æ–‡ä»¶é‡Œçš„<code>&lt;script&gt;</code>æ ‡ç­¾é‡Œå¯¼å…¥<code>pubsub-js</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> PubSub <span class="token keyword">from</span> <span class="token string">&quot;pubsub-js&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.1.4.5.png" alt="image-20220519234016831" tabindex="0" loading="lazy"><figcaption>image-20220519234016831</figcaption></figure><h6 id="_6ã€æŸ¥çœ‹å‘é€çš„è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_6ã€æŸ¥çœ‹å‘é€çš„è¯·æ±‚" aria-hidden="true">#</a> 6ã€æŸ¥çœ‹å‘é€çš„è¯·æ±‚</h6><p>é‡å¯åï¼Œå·²ç»å‘é€è¿™ä¸ªè¯·æ±‚äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.1.4.6.png" alt="image-20220519232903557" tabindex="0" loading="lazy"><figcaption>image-20220519232903557</figcaption></figure><h6 id="_7ã€æ¥å£æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#_7ã€æ¥å£æ–‡æ¡£" aria-hidden="true">#</a> 7ã€æ¥å£æ–‡æ¡£</h6><p>urlï¼š https://easydoc.net/s/78237135/ZUqEdvA4/jCFganpf</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.1.4.7.png" alt="image-20220520092904263" tabindex="0" loading="lazy"><figcaption>image-20220520092904263</figcaption></figure><h4 id="_2ã€åŠ å…¥æ³¨å†Œä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_2ã€åŠ å…¥æ³¨å†Œä¸­å¿ƒ" aria-hidden="true">#</a> 2ã€åŠ å…¥æ³¨å†Œä¸­å¿ƒ</h4><p>åœ¨<code>gulimall-member</code>çš„<code>src\\main\\resources\\application.yml</code>é…ç½®æ–‡ä»¶ä¸­æ·»åŠ é…ç½®ï¼ŒåŠ å…¥åˆ°æ³¨å†Œä¸­å¿ƒ(å·²ç»é…ç½®è¿‡äº†)</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.2.png" alt="image-20220520085328741" tabindex="0" loading="lazy"><figcaption>image-20220520085328741</figcaption></figure><h4 id="_3ã€æ·»åŠ é…ç½®ä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ é…ç½®ä¸­å¿ƒ" aria-hidden="true">#</a> 3ã€æ·»åŠ é…ç½®ä¸­å¿ƒ</h4><p>å¯ä»¥åœ¨<code>gulimall-member</code>æ¨¡å—çš„<code>src\\main\\resources</code>é‡Œæ–°å»º<code>bootstrap.properties</code>æ–‡ä»¶ï¼Œæ·»åŠ é…ç½®ä¸­å¿ƒ(åœ¨è¿™é‡Œå°±å…ˆä¸åšäº†)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.3.png" alt="image-20220520085535283" tabindex="0" loading="lazy"><figcaption>image-20220520085535283</figcaption></figure><h4 id="_4ã€å¼€å¯æœåŠ¡æ³¨å†Œä¸å‘ç°åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#_4ã€å¼€å¯æœåŠ¡æ³¨å†Œä¸å‘ç°åŠŸèƒ½" aria-hidden="true">#</a> 4ã€å¼€å¯æœåŠ¡æ³¨å†Œä¸å‘ç°åŠŸèƒ½</h4><p>å¯ä»¥åœ¨<code>gulimall-member</code>æ¨¡å—çš„<code>com.atguigu.gulimall.member.GulimallMemberApplication</code>ç±»é‡Œ</p><p>æ·»åŠ <code>@EnableDiscoveryClient</code>æ³¨è§£ï¼Œå¼€å¯æœåŠ¡æ³¨å†Œä¸å‘ç°åŠŸèƒ½(è¿™ä¸ªå·²ç»åšäº†)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.4.png" alt="image-20220520085840532" tabindex="0" loading="lazy"><figcaption>image-20220520085840532</figcaption></figure><h4 id="_5ã€æ·»åŠ listæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€æ·»åŠ listæ–¹æ³•" aria-hidden="true">#</a> 5ã€æ·»åŠ <code>list</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-member</code>æ¨¡å—çš„<code>com.atguigu.gulimall.member.controller.MemberLevelController</code>ç±»é‡Œæ·»åŠ <code>list</code>æ–¹æ³•</p><p>å…¶å®è¿™ä¸ªæ–¹æ³•å·²ç»å†™å¥½äº†ï¼Œæ²¡æœ‰è®¿é—®æˆåŠŸçš„åŸå› æ˜¯<strong>æ²¡æœ‰å¯åŠ¨<code>gulimall-member</code>æ¨¡å—</strong>ï¼Œå¹¶ä¸”<strong>æ²¡æœ‰é…ç½®<code>gulimall-member</code>æ¨¡å—çš„ç½‘å…³</strong></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.5.png" alt="image-20220520093657422" tabindex="0" loading="lazy"><figcaption>image-20220520093657422</figcaption></figure><h4 id="_6ã€æ·»åŠ è·¯ç”±è§„åˆ™" tabindex="-1"><a class="header-anchor" href="#_6ã€æ·»åŠ è·¯ç”±è§„åˆ™" aria-hidden="true">#</a> 6ã€æ·»åŠ è·¯ç”±è§„åˆ™</h4><p>åœ¨<code>gulimall-gateway</code>æ¨¡å—çš„<code>src/main/resources/application.yml</code>é…ç½®æ–‡ä»¶ä¸­æ·»åŠ è·¯ç”±è§„åˆ™ï¼ŒåŒ¹é…<code>gulimall-member</code>æ¨¡å—</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> member_route
  <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//gulimall<span class="token punctuation">-</span>member
  <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> Path=/api/member/<span class="token important">**</span>
  <span class="token key atrule">filters</span><span class="token punctuation">:</span>
    <span class="token comment">#http://localhost:88/api/member/memberlevel/list å˜ä¸º http://localhost:8000/member/memberlevel/list</span>
    <span class="token punctuation">-</span> RewritePath=/api/(<span class="token punctuation">?</span>&lt;segment<span class="token punctuation">&gt;</span>/<span class="token punctuation">?</span>.<span class="token important">*)</span><span class="token punctuation">,</span>/$\\<span class="token punctuation">{</span>segment<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.6.png" alt="image-20220520100339120" tabindex="0" loading="lazy"><figcaption>image-20220520100339120</figcaption></figure><h4 id="_7ã€è®¿é—®æ¥å£" tabindex="-1"><a class="header-anchor" href="#_7ã€è®¿é—®æ¥å£" aria-hidden="true">#</a> 7ã€è®¿é—®æ¥å£</h4><h5 id="_1ã€ç›´æ¥è®¿é—®æˆåŠŸ" tabindex="-1"><a class="header-anchor" href="#_1ã€ç›´æ¥è®¿é—®æˆåŠŸ" aria-hidden="true">#</a> 1ã€ç›´æ¥è®¿é—®æˆåŠŸ</h5><p>ç›´æ¥è®¿é—®æ²¡æœ‰é—®é¢˜ http://localhost:8000/member/memberlevel/list</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.7.1.png" alt="image-20220520100105298" tabindex="0" loading="lazy"><figcaption>image-20220520100105298</figcaption></figure><h5 id="_2ã€é€šè¿‡ç½‘å…³è®¿é—®å¤±è´¥" tabindex="-1"><a class="header-anchor" href="#_2ã€é€šè¿‡ç½‘å…³è®¿é—®å¤±è´¥" aria-hidden="true">#</a> 2ã€é€šè¿‡ç½‘å…³è®¿é—®å¤±è´¥</h5><p>é€šè¿‡ç½‘å…³è®¿é—®å¤±è´¥ï¼š http://localhost:88/api/member/memberlevel/list</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.7.2.png" alt="image-20220520100123403" tabindex="0" loading="lazy"><figcaption>image-20220520100123403</figcaption></figure><h4 id="_8ã€æŸ¥æ‰¾åŸå› " tabindex="-1"><a class="header-anchor" href="#_8ã€æŸ¥æ‰¾åŸå› " aria-hidden="true">#</a> 8ã€æŸ¥æ‰¾åŸå› </h4><h5 id="_1ã€æŸ¥çœ‹æ§åˆ¶å°-1" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹æ§åˆ¶å°-1" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹æ§åˆ¶å°</h5><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>nacos registry, gulimall-member 192.168.19.1:8000 register finished
nacos æ³¨å†Œï¼Œgulimall-member 192.168.19.1:8000 æ³¨å†Œå®Œæˆ
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ§åˆ¶å°æ˜¾ç¤ºå·²ç»æ³¨å†ŒæˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.8.1.png" alt="image-20220520095821795" tabindex="0" loading="lazy"><figcaption>image-20220520095821795</figcaption></figure><h5 id="_2ã€æŸ¥çœ‹æŠ¥é”™-1" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹æŠ¥é”™-1" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹æŠ¥é”™</h5><p>è¿™ä¸ªæ˜¯<code>NacosConfigProperties</code>çš„æŠ¥é”™ï¼Œä¸ç”¨ç®¡ï¼Œç°åœ¨è¿˜æ²¡æœ‰é…ç½®<code>é…ç½®ä¸­å¿ƒ</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.8.2.png" alt="image-20220520095757543" tabindex="0" loading="lazy"><figcaption>image-20220520095757543</figcaption></figure><h5 id="_3ã€æŸ¥çœ‹æœåŠ¡åˆ—è¡¨" tabindex="-1"><a class="header-anchor" href="#_3ã€æŸ¥çœ‹æœåŠ¡åˆ—è¡¨" aria-hidden="true">#</a> 3ã€æŸ¥çœ‹<code>æœåŠ¡åˆ—è¡¨</code></h5><p>urlï¼šhttp://localhost:8848/nacos</p><p>ç”¨æˆ·åå’Œå¯†ç éƒ½ä¸º <code>nacos</code></p><p>å¯ä»¥çœ‹åˆ°æ²¡æœ‰å‘ç°<code>gulimall-member</code>è¿™ä¸ªæœåŠ¡</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.8.3.png" alt="image-20220520100857910" tabindex="0" loading="lazy"><figcaption>image-20220520100857910</figcaption></figure><h5 id="_4ã€æŸ¥çœ‹ç½‘å…³æ§åˆ¶å°" tabindex="-1"><a class="header-anchor" href="#_4ã€æŸ¥çœ‹ç½‘å…³æ§åˆ¶å°" aria-hidden="true">#</a> 4ã€æŸ¥çœ‹ç½‘å…³æ§åˆ¶å°</h5><p>å¯ä»¥çœ‹åˆ°<code>gulimall-gateway</code>æ¨¡å—çš„æ§åˆ¶å°æ˜¾ç¤ºï¼Œå·²æ­£ç¡®åŒ¹é…åˆ°äº†<code>gulimall-member</code>æ¨¡å—</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.8.4.png" alt="image-20220520100931896" tabindex="0" loading="lazy"><figcaption>image-20220520100931896</figcaption></figure><h5 id="_5ã€å…³é—­éšè—ç©ºæœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_5ã€å…³é—­éšè—ç©ºæœåŠ¡" aria-hidden="true">#</a> 5ã€å…³é—­<code>éšè—ç©ºæœåŠ¡</code></h5><p>å…³é—­<code>æœåŠ¡ç®¡ç†/æœåŠ¡åˆ—è¡¨</code>é‡Œçš„<code>éšè—ç©ºæœåŠ¡</code>,è¿™æ—¶å¯ä»¥çœ‹åˆ°<code>gulimall-member</code>æœåŠ¡,ä¸è¿‡æ˜¯ç©ºæœåŠ¡ï¼Œ<code>å®ä¾‹æ•°</code>å’Œ<code>å¥åº·å®ä¾‹æ•°</code>éƒ½ä¸º<code>0</code></p><p>è¿™ä¸ªæœåŠ¡æ˜¯ç”¨ä»£ç æ³¨å†Œè¿›å»çš„ï¼Œè€Œä¸æ˜¯ç‚¹<code>åˆ›å»ºæœåŠ¡</code>åˆ›å»ºçš„ï¼Œåº”è¯¥ä¸ä¼šå‡ºç°æ˜¯ç©ºæœåŠ¡å•Š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.8.5.png" alt="image-20220520102947342" tabindex="0" loading="lazy"><figcaption>image-20220520102947342</figcaption></figure><h5 id="_6ã€é‡å¯nacos" tabindex="-1"><a class="header-anchor" href="#_6ã€é‡å¯nacos" aria-hidden="true">#</a> 6ã€é‡å¯<code>nacos</code></h5><p>å…³é—­<code>nacos</code>ï¼Œå†é‡æ–°æ‰“å¼€</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.8.6.png" alt="image-20220520104734701" tabindex="0" loading="lazy"><figcaption>image-20220520104734701</figcaption></figure><h5 id="_7ã€åˆ·æ–°nacosçš„é¡µé¢" tabindex="-1"><a class="header-anchor" href="#_7ã€åˆ·æ–°nacosçš„é¡µé¢" aria-hidden="true">#</a> 7ã€åˆ·æ–°<code>nacos</code>çš„é¡µé¢</h5><p>æ‰“å¼€<code>æœåŠ¡ç®¡ç†/æœåŠ¡åˆ—è¡¨</code>é‡Œçš„<code>éšè—ç©ºæœåŠ¡</code>,è¿™æ—¶è¿˜å¯ä»¥çœ‹åˆ°<code>gulimall-member</code>æœåŠ¡,<code>å®ä¾‹æ•°</code>å’Œ<code>å¥åº·å®ä¾‹æ•°</code>ä¹Ÿéƒ½ä¸º<code>1</code>äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.8.7.png" alt="image-20220520103649758" tabindex="0" loading="lazy"><figcaption>image-20220520103649758</figcaption></figure><h5 id="_8ã€é‡æ–°é€šè¿‡ç½‘å…³è®¿é—®" tabindex="-1"><a class="header-anchor" href="#_8ã€é‡æ–°é€šè¿‡ç½‘å…³è®¿é—®" aria-hidden="true">#</a> 8ã€é‡æ–°é€šè¿‡ç½‘å…³è®¿é—®</h5><p>urlï¼šhttp://localhost:88/api/member/memberlevel/list</p><p>é‡æ–°åˆ·æ–°é€šè¿‡ç½‘å…³è®¿é—®çš„é¡µé¢ï¼Œè¿™æ—¶å·²ç»è®¿é—®æˆåŠŸäº†ï¼ŒçœŸæ˜¯å¥‡è‘©ğŸ˜¡</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.8.8.png" alt="image-20220520103733124" tabindex="0" loading="lazy"><figcaption>image-20220520103733124</figcaption></figure><h4 id="_9ã€è¯·æ±‚æˆåŠŸ" tabindex="-1"><a class="header-anchor" href="#_9ã€è¯·æ±‚æˆåŠŸ" aria-hidden="true">#</a> 9ã€è¯·æ±‚æˆåŠŸ</h4><p>urlï¼šhttp://localhost:88/api/member/memberlevel/list?t=1652972635593&amp;page=1&amp;limit=500</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.9.png" alt="image-20220520105207935" tabindex="0" loading="lazy"><figcaption>image-20220520105207935</figcaption></figure><h4 id="_10ã€æ¥å£æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#_10ã€æ¥å£æ–‡æ¡£" aria-hidden="true">#</a> 10ã€æ¥å£æ–‡æ¡£</h4><p>urlï¼š https://easydoc.net/s/78237135/ZUqEdvA4/jCFganpf</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.1.10.png" alt="4.6.1.10" tabindex="0" loading="lazy"><figcaption>4.6.1.10</figcaption></figure><h3 id="_4-6-2ã€æŸ¥è¯¢åŒ…å«æœ¬åˆ†ç±»çš„æ‰€ä»¥å“ç‰Œ" tabindex="-1"><a class="header-anchor" href="#_4-6-2ã€æŸ¥è¯¢åŒ…å«æœ¬åˆ†ç±»çš„æ‰€ä»¥å“ç‰Œ" aria-hidden="true">#</a> 4.6.2ã€æŸ¥è¯¢åŒ…å«æœ¬åˆ†ç±»çš„æ‰€ä»¥å“ç‰Œ</h3><h4 id="_1ã€å¤åˆ¶ä»£ç " tabindex="-1"><a class="header-anchor" href="#_1ã€å¤åˆ¶ä»£ç " aria-hidden="true">#</a> 1ã€å¤åˆ¶ä»£ç </h4><p><strong>å¤åˆ¶ä¹‹å‰å»ºè®®å…ˆå¤‡ä»½</strong></p><ol><li>æ‰“å¼€&quot;1.åˆ†å¸ƒå¼åŸºç¡€ï¼ˆå…¨æ ˆå¼€å‘ç¯‡ï¼‰\\èµ„æ–™æºç .zip\\docs\\ä»£ç \\å‰ç«¯\\modules&quot;ç›®å½•</li><li>é€‰æ‹©è¿™äº›æ–‡ä»¶(ä¹Ÿå¯ä»¥å…¨é€‰)(<strong>å»ºè®®å…¨é€‰å¤åˆ¶ï¼Œä¸ç„¶åé¢ä¼šæœ‰æŠ¥é”™</strong>)</li><li>é€‰æ‹©&quot;src/views&#39;ç›®å½•ä¸‹çš„&quot;moudules&quot;,ç„¶åå³é”®</li><li>é€‰æ‹©&quot;åœ¨æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­æ˜¾ç¤º&quot;</li><li>è¿›å…¥&quot;modules&quot;æ–‡ä»¶å¤¹</li><li>å³é”®ï¼Œé€‰æ‹©&quot;ç²˜è´´&quot;ï¼Œç²˜è´´åˆ°è¿™é‡Œé¢</li></ol><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.1.1.png" alt="image-20220520110715920" tabindex="0" loading="lazy"><figcaption>image-20220520110715920</figcaption></figure><p>ç„¶åç‚¹å‡»<code>æ›¿æ¢ç›®æ ‡ä¸­çš„æ–‡ä»¶</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.1.2.png" alt="image-20220520110731311" tabindex="0" loading="lazy"><figcaption>image-20220520110731311</figcaption></figure><h4 id="_2ã€æ·»åŠ ä¼šå‘˜ç­‰çº§" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ ä¼šå‘˜ç­‰çº§" aria-hidden="true">#</a> 2ã€æ·»åŠ ä¼šå‘˜ç­‰çº§</h4><h5 id="_1ã€åº”è¯¥æœ‰ä¸ªæµ‹è¯•æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_1ã€åº”è¯¥æœ‰ä¸ªæµ‹è¯•æ•°æ®" aria-hidden="true">#</a> 1ã€åº”è¯¥æœ‰ä¸ªæµ‹è¯•æ•°æ®</h5><p>ç‚¹å‡»<code>ç”¨æˆ·ç³»ç»Ÿ/ä¼šå‘˜ç­‰çº§</code>,åº”è¯¥ä¼šæœ‰ä¸ªæµ‹è¯•æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.2.1.png" alt="image-20220520111518924" tabindex="0" loading="lazy"><figcaption>image-20220520111518924</figcaption></figure><h5 id="_2ã€ä¸è¿‡æˆ‘æ²¡æœ‰" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¸è¿‡æˆ‘æ²¡æœ‰" aria-hidden="true">#</a> 2ã€ä¸è¿‡æˆ‘æ²¡æœ‰</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.2.2.png" alt="image-20220520111430051" tabindex="0" loading="lazy"><figcaption>image-20220520111430051</figcaption></figure><h5 id="_3ã€æ·»åŠ æ™®é€šä¼šå‘˜" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ æ™®é€šä¼šå‘˜" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>æ™®é€šä¼šå‘˜</code></h5><p><code>æ™®é€šä¼šå‘˜</code>è®¾ç½®ä¸º<code>é»˜è®¤ç­‰çº§</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.2.3.png" alt="image-20220520111355788" tabindex="0" loading="lazy"><figcaption>image-20220520111355788</figcaption></figure><h5 id="_4ã€æ·»åŠ é“œç‰Œä¼šå‘˜" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ é“œç‰Œä¼šå‘˜" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>é“œç‰Œä¼šå‘˜</code></h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.2.4.png" alt="image-20220520111821514" tabindex="0" loading="lazy"><figcaption>image-20220520111821514</figcaption></figure><h5 id="_5ã€æ·»åŠ é“¶ç‰Œä¼šå‘˜" tabindex="-1"><a class="header-anchor" href="#_5ã€æ·»åŠ é“¶ç‰Œä¼šå‘˜" aria-hidden="true">#</a> 5ã€æ·»åŠ <code>é“¶ç‰Œä¼šå‘˜</code></h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.2.5.png" alt="image-20220520112008322" tabindex="0" loading="lazy"><figcaption>image-20220520112008322</figcaption></figure><h4 id="_3ã€åˆç¼ºå°‘äº†è¿™ä¸ªè¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_3ã€åˆç¼ºå°‘äº†è¿™ä¸ªè¯·æ±‚" aria-hidden="true">#</a> 3ã€åˆç¼ºå°‘äº†è¿™ä¸ªè¯·æ±‚</h4><p>åˆå°‘äº†è¿™ä¸ªè¯·æ±‚: http://localhost:88/api/member/memberlevel/list?t=1652972635593&amp;page=1&amp;limit=500</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.3.1.png" alt="image-20220520113911427" tabindex="0" loading="lazy"><figcaption>image-20220520113911427</figcaption></figure><p>å†æŠŠ<code>pubsub-js</code>å¼•è¿›æ¥å°±è¡Œäº†</p><p>åœ¨<code>B:\\renren-fast-vue\\src\\views\\modules\\product\\spuadd.vue</code>æ–‡ä»¶é‡Œçš„<code>&lt;script&gt;</code>æ ‡ç­¾é‡Œå¯¼å…¥<code>pubsub-js</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> PubSub <span class="token keyword">from</span> <span class="token string">&quot;pubsub-js&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.3.2.png" alt="image-20220520113858591" tabindex="0" loading="lazy"><figcaption>image-20220520113858591</figcaption></figure><p>è¯·æ±‚å·²ç»å‡ºæ¥äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.3.3.png" alt="image-20220520114016202" tabindex="0" loading="lazy"><figcaption>image-20220520114016202</figcaption></figure><h4 id="_4ã€é€‰æ‹©åˆ†ç±»åç¼ºå°‘äº†ä¸€ä¸ªè¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_4ã€é€‰æ‹©åˆ†ç±»åç¼ºå°‘äº†ä¸€ä¸ªè¯·æ±‚" aria-hidden="true">#</a> 4ã€<code>é€‰æ‹©åˆ†ç±»</code>åç¼ºå°‘äº†ä¸€ä¸ªè¯·æ±‚</h4><p>å½“é€‰æ‹©å®Œ<code>é€‰æ‹©åˆ†ç±»</code>åï¼Œåº”è¯¥å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œä½†æ˜¯æˆ‘çš„æ²¡æœ‰å‘é€ï¼Œå¹¶ä¸”åœ¨é€‰æ‹©å®Œ<code>é€‰æ‹©åˆ†ç±»</code>åæ§åˆ¶å°æŠ¥äº†ä¸¤ä¸ªé”™</p><p>urlï¼š http://localhost:88/api/product/categorybrandrelation/brands/list?t=1653047129509&amp;catId=225</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.4.1.png" alt="image-20220520115525930" tabindex="0" loading="lazy"><figcaption>image-20220520115525930</figcaption></figure><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>vue.esm.js?efeb:591 [Vue warn]: Error in callback for watcher &quot;paths&quot;: &quot;TypeError: Cannot read properties of undefined (reading &#39;publish&#39;)&quot;
[Vue è­¦å‘Š]ï¼šè§‚å¯Ÿè€…â€œè·¯å¾„â€çš„å›è°ƒé”™è¯¯ï¼šâ€œTypeErrorï¼šæ— æ³•è¯»å–æœªå®šä¹‰çš„å±æ€§ï¼ˆæ­£åœ¨è¯»å–&#39;publish&#39;ï¼‰â€
vue.esm.js?efeb:1741 TypeError: Cannot read properties of undefined (reading &#39;publish&#39;)
TypeErrorï¼šæ— æ³•è¯»å–æœªå®šä¹‰çš„å±æ€§ï¼ˆè¯»å–â€œpublishâ€ï¼‰
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.4.2.png" alt="image-20220520115547934" tabindex="0" loading="lazy"><figcaption>image-20220520115547934</figcaption></figure><h4 id="_5ã€æ·»åŠ pubsub-jsåˆ°å…¨å±€" tabindex="-1"><a class="header-anchor" href="#_5ã€æ·»åŠ pubsub-jsåˆ°å…¨å±€" aria-hidden="true">#</a> 5ã€æ·»åŠ <code>pubsub-js</code>åˆ°å…¨å±€</h4><p>åˆ æ‰åœ¨<code>B:\\renren-fast-vue\\src\\views\\modules\\product\\spuadd.vue</code>æ–‡ä»¶é‡Œçš„<code>&lt;script&gt;</code>æ ‡ç­¾é‡Œå¯¼å…¥çš„<code>pubsub-js</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.5.1.png" alt="image-20220520120720294" tabindex="0" loading="lazy"><figcaption>image-20220520120720294</figcaption></figure><p>åœ¨<code>src\\main.js</code>é‡Œå¯¼å…¥å¹¶ä½¿ç”¨<code>pubsub-js</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token class-name">PubSub</span> from &#39;pubsub<span class="token operator">-</span>js&#39;
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>PubSub <span class="token operator">=</span> <span class="token class-name">PubSub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.5.2.png" alt="image-20220520120813028" tabindex="0" loading="lazy"><figcaption>image-20220520120813028</figcaption></figure><p>åœ¨<code>.eslintrc.js</code>é‡Œå…¨å±€ä½¿ç”¨<code>PubSub</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">,</span>
  <span class="token literal-property property">globals</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">PubSub</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.5.3.png" alt="image-20220520120827362" tabindex="0" loading="lazy"><figcaption>image-20220520120827362</figcaption></figure><p>å·²ç»å‘é€è¯·æ±‚äº†ï¼šhttp://localhost:88/api/product/categorybrandrelation/brands/list?t=1653047129509&amp;catId=225</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.5.4.png" alt="image-20220520120954196" tabindex="0" loading="lazy"><figcaption>image-20220520120954196</figcaption></figure><p>æ¥å£æ–‡æ¡£: https://easydoc.net/s/78237135/ZUqEdvA4/HgVjlzWV</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.5.5.png" alt="image-20220520201548014" tabindex="0" loading="lazy"><figcaption>image-20220520201548014</figcaption></figure><h4 id="_6ã€æ–°å»ºbrandvoç±»" tabindex="-1"><a class="header-anchor" href="#_6ã€æ–°å»ºbrandvoç±»" aria-hidden="true">#</a> 6ã€æ–°å»º<code>BrandVo</code>ç±»</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo</code>åŒ…é‡Œæ–°å»º<code>BrandVo</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/20
 * @Description:
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BrandVo</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * å“ç‰Œid
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> brandId<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * å“ç‰Œåå­—
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> brandName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.6.png" alt="image-20220520203545414" tabindex="0" loading="lazy"><figcaption>image-20220520203545414</figcaption></figure><h4 id="_7ã€æ–°å»ºrelationbrandslistæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_7ã€æ–°å»ºrelationbrandslistæ–¹æ³•" aria-hidden="true">#</a> 7ã€æ–°å»º<code>relationBrandsList</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.CategoryBrandRelationController</code>ç±»é‡Œ</p><p>æ–°å»º<code>relationBrandsList</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 *  localhost:88/api/product/categorybrandrelation/brands/list?t=1653048395592&amp;catId=225
 *  è·å–åˆ†ç±»å…³è”çš„å“ç‰Œ
 *  1ã€Controller:å¤„ç†è¯·æ±‚ï¼Œæ¥å—å’Œæ ¡éªŒæ•°æ®
 *  2ã€Serviceæ¥å—controllerä¼ æ¥çš„æ•°æ®ï¼Œè¿›è¡Œä¸šåŠ¡å¤„ç†
 *  3ã€Controlleræ¥å—serviceå¤„ç†å®Œçš„æ•°æ®ï¼Œå°è£…é¡µé¢æŒ‡å®šçš„vo
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/brands/list&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">relationBrandsList</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;catId&quot;</span><span class="token punctuation">,</span>required <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> catId<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BrandEntity</span><span class="token punctuation">&gt;</span></span> brandEntities <span class="token operator">=</span> categoryBrandRelationService<span class="token punctuation">.</span><span class="token function">getBrandsByCatId</span><span class="token punctuation">(</span>catId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BrandVo</span><span class="token punctuation">&gt;</span></span> brandVos <span class="token operator">=</span> brandEntities<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">BrandVo</span> brandVo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrandVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        brandVo<span class="token punctuation">.</span><span class="token function">setBrandId</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">getBrandId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        brandVo<span class="token punctuation">.</span><span class="token function">setBrandName</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> brandVo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span>brandVos<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.7.png" alt="image-20220520214042927" tabindex="0" loading="lazy"><figcaption>image-20220520214042927</figcaption></figure><h4 id="_8ã€æ·»åŠ getbrandsbycatidæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_8ã€æ·»åŠ getbrandsbycatidæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 8ã€æ·»åŠ <code>getBrandsByCatId</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.CategoryBrandRelationService</code>æ¥å£é‡Œ</p><p>æ·»åŠ <code>getBrandsByCatId</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BrandEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">getBrandsByCatId</span><span class="token punctuation">(</span><span class="token class-name">Long</span> catId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.8.png" alt="image-20220520203454859" tabindex="0" loading="lazy"><figcaption>image-20220520203454859</figcaption></figure><h4 id="_9ã€å®ç°getbrandsbycatidæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_9ã€å®ç°getbrandsbycatidæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 9ã€å®ç°<code>getBrandsByCatId</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.CategoryBrandRelationServiceImpl</code>ç±»é‡Œ</p><p>å®ç°<code>getBrandsByCatId</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BrandEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">getBrandsByCatId</span><span class="token punctuation">(</span><span class="token class-name">Long</span> catId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryBrandRelationEntity</span><span class="token punctuation">&gt;</span></span> categoryBrandRelationQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    categoryBrandRelationQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">CategoryBrandRelationEntity</span><span class="token operator">::</span><span class="token function">getCatelogId</span><span class="token punctuation">,</span>catId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CategoryBrandRelationEntity</span><span class="token punctuation">&gt;</span></span> categoryBrandRelationEntities <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>baseMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span>categoryBrandRelationQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> brandIds <span class="token operator">=</span> categoryBrandRelationEntities<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
            <span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">CategoryBrandRelationEntity</span><span class="token operator">::</span><span class="token function">getBrandId</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BrandEntity</span><span class="token punctuation">&gt;</span></span> brandEntities <span class="token operator">=</span> brandDao<span class="token punctuation">.</span><span class="token function">selectBatchIds</span><span class="token punctuation">(</span>brandIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> brandEntities<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.9.png" alt="image-20220520204754999" tabindex="0" loading="lazy"><figcaption>image-20220520204754999</figcaption></figure><h4 id="_10ã€æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_10ã€æµ‹è¯•" aria-hidden="true">#</a> 10ã€æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢ï¼Œ</p><h5 id="_1ã€å·²ç»å‘é€è¯·æ±‚äº†" tabindex="-1"><a class="header-anchor" href="#_1ã€å·²ç»å‘é€è¯·æ±‚äº†" aria-hidden="true">#</a> 1ã€å·²ç»å‘é€è¯·æ±‚äº†</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.10.1.png" alt="image-20220520204950145" tabindex="0" loading="lazy"><figcaption>image-20220520204950145</figcaption></figure><h5 id="_2ã€æŸ¥çœ‹è¿”å›çš„æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹è¿”å›çš„æ•°æ®" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹è¿”å›çš„æ•°æ®</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.10.2.png" alt="image-20220520205355868" tabindex="0" loading="lazy"><figcaption>image-20220520205355868</figcaption></figure><h5 id="_3ã€å°†æ‰‹æœº1æ”¹ä¸ºæ‰‹æœº" tabindex="-1"><a class="header-anchor" href="#_3ã€å°†æ‰‹æœº1æ”¹ä¸ºæ‰‹æœº" aria-hidden="true">#</a> 3ã€å°†<code>æ‰‹æœº1</code>æ”¹ä¸º<code>æ‰‹æœº</code></h5><p>å°†<code>gulimall_pms</code>æ•°æ®åº“ä¸­çš„<code>pms_category_brand_relation</code>è¡¨é‡Œçš„<code>name</code>ä¸º<code>æ‰‹æœº1</code>çš„å­—æ®µæ”¹ä¸º<code>æ‰‹æœº</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.10.3.png" alt="image-20220520205434818" tabindex="0" loading="lazy"><figcaption>image-20220520205434818</figcaption></figure><h5 id="_4ã€æ·»åŠ åˆ«çš„å“ç‰Œçš„å…³è”åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ åˆ«çš„å“ç‰Œçš„å…³è”åˆ†ç±»" aria-hidden="true">#</a> 4ã€æ·»åŠ åˆ«çš„å“ç‰Œçš„<code>å…³è”åˆ†ç±»</code></h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.10.4.png" alt="GIF 2022-5-20 20-58-33" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-20 20-58-33</figcaption></figure><h5 id="_5ã€é€‰æ‹©å“ç‰Œ" tabindex="-1"><a class="header-anchor" href="#_5ã€é€‰æ‹©å“ç‰Œ" aria-hidden="true">#</a> 5ã€é€‰æ‹©å“ç‰Œ</h5><p>é€‰æ‹©å¥½<code>é€‰æ‹©åˆ†ç±»</code>åï¼Œå¯ä»¥çœ‹åˆ°å·²è¿”å›åˆ†ç±»åŒ…å«<code>æ‰‹æœº/æ‰‹æœºé€šè®¯/æ‰‹æœº</code>çš„æ‰€æœ‰å“ç‰Œï¼Œç‚¹å‡»<code>é€‰æ‹©å“ç‰Œ</code>çš„é€‰æ‹©æ¡†åï¼Œå¯ä»¥æ˜¾ç¤ºè¿™äº›å“ç‰Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.2.10.5.png" alt="image-20220520210139905" tabindex="0" loading="lazy"><figcaption>image-20220520210139905</figcaption></figure><h3 id="_4-6-3ã€è·å–åˆ†ç±»ä¸‹æ‰€æœ‰åˆ†ç»„-å…³è”å±æ€§" tabindex="-1"><a class="header-anchor" href="#_4-6-3ã€è·å–åˆ†ç±»ä¸‹æ‰€æœ‰åˆ†ç»„-å…³è”å±æ€§" aria-hidden="true">#</a> 4.6.3ã€è·å–åˆ†ç±»ä¸‹æ‰€æœ‰åˆ†ç»„&amp;å…³è”å±æ€§</h3><h4 id="_1ã€æŸ¥çœ‹è¯·æ±‚-6" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹è¯·æ±‚-6" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹è¯·æ±‚</h4><h5 id="_1ã€è®¾ç½®åŸºæœ¬ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_1ã€è®¾ç½®åŸºæœ¬ä¿¡æ¯" aria-hidden="true">#</a> 1ã€è®¾ç½®<code>åŸºæœ¬ä¿¡æ¯</code></h5><p><code>åŸºæœ¬ä¿¡æ¯</code>è®¾ç½®å®Œæˆåï¼Œç‚¹å‡»<code>ä¸‹ä¸€æ­¥ï¼šè®¾ç½®åŸºæœ¬å‚æ•°</code>ï¼Œè¿™æ—¶ä¼šå‘é€ä¸€ä¸ªè¯·æ±‚</p><p>urlï¼šhttp://localhost:88/api/product/attrgroup/225/withattr?t=1653056166646</p><p>(è¿™é‡Œçš„æ•°æ®éšä¾¿å¡«å¡«å°±è¡Œäº†ï¼Œç°åœ¨ä¹Ÿä¸ä¼šæäº¤çš„æ•°æ®åº“)</p><p>(å›¾ç‰‡ä¸Šä¼ å¤±è´¥æ˜¯å› ä¸º<code>gulimall-third-party</code>æ¨¡å—æ²¡å¯åŠ¨)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.3.1.1.png" alt="image-20220520220205600" tabindex="0" loading="lazy"><figcaption>image-20220520220205600</figcaption></figure><h5 id="_2ã€æŸ¥çœ‹è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹è¯·æ±‚" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹è¯·æ±‚</h5><p>urlï¼šhttp://localhost:88/api/product/attrgroup/225/withattr?t=1653056166646</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.3.1.2.png" alt="image-20220520215846566" tabindex="0" loading="lazy"><figcaption>image-20220520215846566</figcaption></figure><h5 id="_3ã€æ¥å£æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#_3ã€æ¥å£æ–‡æ¡£" aria-hidden="true">#</a> 3ã€æ¥å£æ–‡æ¡£</h5><p>æ¥å£æ–‡æ¡£åœ¨<code>å•†å“ç³»ç»Ÿ/17ã€è·å–åˆ†ç±»ä¸‹æ‰€æœ‰åˆ†ç»„&amp;å…³è”å±æ€§</code>é‡Œï¼šhttps://easydoc.net/s/78237135/ZUqEdvA4/6JM6txHf</p><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.3.1.3.png" alt="image-20220520221908190" style="zoom:50%;"><h4 id="_2ã€æ–°å»ºattrgroupwithattrsvoç±»" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å»ºattrgroupwithattrsvoç±»" aria-hidden="true">#</a> 2ã€æ–°å»º<code>AttrGroupWithAttrsVo</code>ç±»</h4><p>åœ¨<code>gulimall-product</code>çš„<code>com.atguigu.gulimall.product.vo</code>åŒ…ä¸‹æ–°å»º<code>AttrGroupWithAttrsVo</code>ç±»</p><p>å¤åˆ¶<code>com.atguigu.gulimall.product.entity.AttrGroupEntity</code>ç±»çš„å­—æ®µï¼Œå¹¶åˆ æ‰æ•°æ®åº“ç›¸å…³æ³¨è§£</p><p>è°ƒæ•´<code>AttrGroupWithAttrsVo</code>ç±»ï¼Œä¿®æ”¹æˆæˆ‘ä»¬éœ€è¦çš„<code>vo</code>å¯¹è±¡</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">AttrEntity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/20
 * @Description:
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AttrGroupWithAttrsVo</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * åˆ†ç»„id
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> attrGroupId<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * ç»„å
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> attrGroupName<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * æ’åº
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> sort<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * æè¿°
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> descript<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * ç»„å›¾æ ‡
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> icon<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * æ‰€å±åˆ†ç±»id
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> catelogId<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AttrEntity</span><span class="token punctuation">&gt;</span></span> attrs<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.3.2.png" alt="image-20220520233852985" tabindex="0" loading="lazy"><figcaption>image-20220520233852985</figcaption></figure><h4 id="_3ã€æ·»åŠ getattrgroupwithattrsæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ getattrgroupwithattrsæ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>getAttrGroupWithAttrs</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.AttrGroupController</code>ç±»é‡Œæ·»åŠ </p><p><code>getAttrGroupWithAttrs</code>æ–¹æ³•ï¼Œé€šè¿‡<code>catelogId</code>è·å–å½“å‰åˆ†ç±»ä¸‹<strong>æ‰€æœ‰åˆ†ç»„</strong>&amp;<strong>å…³è”å±æ€§</strong></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.3.3.png" alt="image-20220520231533320" tabindex="0" loading="lazy"><figcaption>image-20220520231533320</figcaption></figure><h4 id="_4ã€æ·»åŠ getattrgroupwithattrsbycatelogidæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ getattrgroupwithattrsbycatelogidæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>getAttrGroupWithAttrsByCatelogId</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.AttrGroupService</code>ç±»é‡Œæ·»åŠ <code>getAttrGroupWithAttrsByCatelogId</code>æŠ½è±¡æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.3.4.png" alt="image-20220520231548548" tabindex="0" loading="lazy"><figcaption>image-20220520231548548</figcaption></figure><h4 id="_5ã€å®ç°getattrgroupwithattrsbycatelogidæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€å®ç°getattrgroupwithattrsbycatelogidæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 5ã€å®ç°<code>getAttrGroupWithAttrsByCatelogId</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.AttrGroupServiceImpl</code>ç±»é‡Œå®ç°<code>getAttrGroupWithAttrsByCatelogId</code>æŠ½è±¡æ–¹æ³•ï¼Œé€šè¿‡<code>catelogId</code>è·å–å½“å‰åˆ†ç±»ä¸‹<strong>æ‰€æœ‰åˆ†ç»„</strong>&amp;<strong>å…³è”å±æ€§</strong></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.3.5.png" alt="image-20220520234608206" tabindex="0" loading="lazy"><figcaption>image-20220520234608206</figcaption></figure><h4 id="_6ã€æŸ¥çœ‹å›æ˜¾" tabindex="-1"><a class="header-anchor" href="#_6ã€æŸ¥çœ‹å›æ˜¾" aria-hidden="true">#</a> 6ã€æŸ¥çœ‹å›æ˜¾</h4><p>å·²æ­£ç¡®è·å¾—æ•°æ®ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾åˆ°é¡µé¢ä¸Šï¼Œæ­¤æ—¶æ§åˆ¶å°ä¹ŸæŠ¥äº†ä¸€ä¸ªé”™</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.3.6.png" alt="image-20220520234852186" tabindex="0" loading="lazy"><figcaption>image-20220520234852186</figcaption></figure><h4 id="_7ã€spuadd-vueçš„ç¬¬679è¡ŒæŠ¥é”™" tabindex="-1"><a class="header-anchor" href="#_7ã€spuadd-vueçš„ç¬¬679è¡ŒæŠ¥é”™" aria-hidden="true">#</a> 7ã€<code>spuadd.vue</code>çš„ç¬¬679è¡ŒæŠ¥é”™</h4><p>å¯ä»¥çœ‹åˆ°<code>spuadd.vue</code>çš„ç¬¬679è¡Œçš„<code>foreach</code>æŠ¥é”™</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>TypeError: Cannot read properties of null (reading &#39; forEach&#39;)
TypeErrorï¼šæ— æ³•è¯»å– null çš„å±æ€§ï¼ˆè¯»å–â€œforEachâ€ï¼‰
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.3.7.png" alt="image-20220520235236298" tabindex="0" loading="lazy"><figcaption>image-20220520235236298</figcaption></figure><h4 id="_8ã€showbaseattrs-æ–¹æ³•é‡ŒåŠ ä¸€ä¸ªåˆ¤æ–­" tabindex="-1"><a class="header-anchor" href="#_8ã€showbaseattrs-æ–¹æ³•é‡ŒåŠ ä¸€ä¸ªåˆ¤æ–­" aria-hidden="true">#</a> 8ã€<code>showBaseAttrs()</code>æ–¹æ³•é‡ŒåŠ ä¸€ä¸ªåˆ¤æ–­</h4><p>åœ¨<code>src\\views\\modules\\product\\spuadd.vue</code>çš„<code>showBaseAttrs()</code>æ–¹æ³•é‡Œçš„<code>foreach</code>é‡Œé¢åŠ ä¸€ä¸ªåˆ¤æ–­ï¼Œæ²¡æœ‰<code>attrs</code>å°±ä¸éå†</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>data<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>attrs <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>attrs<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> attrArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    item<span class="token punctuation">.</span>attrs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">attr</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      attrArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">attrId</span><span class="token operator">:</span> attr<span class="token punctuation">.</span>attrId<span class="token punctuation">,</span>
        <span class="token literal-property property">attrValues</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">showDesc</span><span class="token operator">:</span> attr<span class="token punctuation">.</span>showDesc
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dataResp<span class="token punctuation">.</span>baseAttrs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>attrArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.3.8.png" alt="image-20220520235759910" tabindex="0" loading="lazy"><figcaption>image-20220520235759910</figcaption></figure><h4 id="_9ã€é¡µé¢å·²æˆåŠŸæ˜¾ç¤º" tabindex="-1"><a class="header-anchor" href="#_9ã€é¡µé¢å·²æˆåŠŸæ˜¾ç¤º" aria-hidden="true">#</a> 9ã€é¡µé¢å·²æˆåŠŸæ˜¾ç¤º</h4><p>é‡æ–°æµ‹è¯•ï¼Œé¡µé¢å·²æˆåŠŸæ˜¾ç¤ºæ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.3.9.png" alt="image-20220520235924882" tabindex="0" loading="lazy"><figcaption>image-20220520235924882</figcaption></figure><h3 id="_4-6-4ã€æ–°å¢å•†å“-1" tabindex="-1"><a class="header-anchor" href="#_4-6-4ã€æ–°å¢å•†å“-1" aria-hidden="true">#</a> 4.6.4ã€æ–°å¢å•†å“(1)</h3><h4 id="_1ã€å‘é€è¯·æ±‚-1" tabindex="-1"><a class="header-anchor" href="#_1ã€å‘é€è¯·æ±‚-1" aria-hidden="true">#</a> 1ã€å‘é€è¯·æ±‚</h4><h5 id="_1ã€æ·»åŠ æµ‹è¯•æ•°æ®-2" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ æµ‹è¯•æ•°æ®-2" aria-hidden="true">#</a> 1ã€æ·»åŠ æµ‹è¯•æ•°æ®</h5><h6 id="_1ã€æ–°å¢æœºèº«é•¿åº¦-mm" tabindex="-1"><a class="header-anchor" href="#_1ã€æ–°å¢æœºèº«é•¿åº¦-mm" aria-hidden="true">#</a> 1ã€æ–°å¢<code>æœºèº«é•¿åº¦(mm)</code></h6><p>åœ¨<code>å•†å“ç³»ç»Ÿ/å¹³å°å±æ€§/è§„æ ¼å‚æ•°</code>é‡Œæ–°å¢<code>æœºèº«é•¿åº¦(mm)</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.1.1.png" alt="image-20220521200453301" tabindex="0" loading="lazy"><figcaption>image-20220521200453301</figcaption></figure><h6 id="_2ã€æ–°å¢æœºèº«æè´¨å·¥è‰º" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å¢æœºèº«æè´¨å·¥è‰º" aria-hidden="true">#</a> 2ã€æ–°å¢<code>æœºèº«æè´¨å·¥è‰º</code></h6><p>åœ¨<code>å•†å“ç³»ç»Ÿ/å¹³å°å±æ€§/è§„æ ¼å‚æ•°</code>é‡Œæ–°å¢<code>æœºèº«æè´¨å·¥è‰º</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.1.2.png" alt="image-20220521200845851" tabindex="0" loading="lazy"><figcaption>image-20220521200845851</figcaption></figure><h6 id="_3ã€åˆ é™¤æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_3ã€åˆ é™¤æµ‹è¯•" aria-hidden="true">#</a> 3ã€åˆ é™¤<code>æµ‹è¯•</code></h6><p>åˆ é™¤<code>å•†å“ç³»ç»Ÿ/å¹³å°å±æ€§/å±æ€§åˆ†ç»„</code>é‡Œçš„<code>æµ‹è¯•</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.1.3.png" alt="image-20220521201219156" tabindex="0" loading="lazy"><figcaption>image-20220521201219156</figcaption></figure><h6 id="_4ã€æ·»åŠ ä¸»èŠ¯ç‰‡" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ ä¸»èŠ¯ç‰‡" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>ä¸»èŠ¯ç‰‡</code></h6><p>åœ¨<code>å•†å“ç³»ç»Ÿ/å¹³å°å±æ€§/å±æ€§åˆ†ç»„</code>é‡Œæ·»åŠ <code>ä¸»èŠ¯ç‰‡</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.1.4.png" alt="image-20220521201609609" tabindex="0" loading="lazy"><figcaption>image-20220521201609609</figcaption></figure><h6 id="_5ã€æ–°å¢cpuå“ç‰Œ" tabindex="-1"><a class="header-anchor" href="#_5ã€æ–°å¢cpuå“ç‰Œ" aria-hidden="true">#</a> 5ã€æ–°å¢<code>CPUå“ç‰Œ</code></h6><p>åœ¨<code>å•†å“ç³»ç»Ÿ/å¹³å°å±æ€§/è§„æ ¼å‚æ•°</code>é‡Œæ–°å¢<code>CPUå“ç‰Œ</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.1.5.png" alt="image-20220521202050971" tabindex="0" loading="lazy"><figcaption>image-20220521202050971</figcaption></figure><h6 id="_6ã€æ–°å¢cpuå‹å·" tabindex="-1"><a class="header-anchor" href="#_6ã€æ–°å¢cpuå‹å·" aria-hidden="true">#</a> 6ã€æ–°å¢<code>CPUå‹å·</code></h6><p>åœ¨<code>å•†å“ç³»ç»Ÿ/å¹³å°å±æ€§/è§„æ ¼å‚æ•°</code>é‡Œæ–°å¢<code>CPUå‹å·</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.1.6.png" alt="image-20220521202428453" tabindex="0" loading="lazy"><figcaption>image-20220521202428453</figcaption></figure><h6 id="_7ã€ä¿®æ”¹ä¸Šå¸‚å¹´ä»½é‡Œçš„æ‰€å±åˆ†ç»„" tabindex="-1"><a class="header-anchor" href="#_7ã€ä¿®æ”¹ä¸Šå¸‚å¹´ä»½é‡Œçš„æ‰€å±åˆ†ç»„" aria-hidden="true">#</a> 7ã€ä¿®æ”¹<code>ä¸Šå¸‚å¹´ä»½</code>é‡Œçš„<code>æ‰€å±åˆ†ç»„</code></h6><p>åœ¨<code>å•†å“ç³»ç»Ÿ/å¹³å°å±æ€§/è§„æ ¼å‚æ•°</code>é‡Œä¿®æ”¹<code>ä¸Šå¸‚å¹´ä»½</code>é‡Œçš„<code>æ‰€å±åˆ†ç»„</code>ä¸º<code>ä¸»ä½“</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.1.7.png" alt="image-20220521202603474" tabindex="0" loading="lazy"><figcaption>image-20220521202603474</figcaption></figure><h6 id="_8ã€ä¿®æ”¹æœºèº«é¢œè‰²é‡Œçš„æ‰€å±åˆ†ç»„" tabindex="-1"><a class="header-anchor" href="#_8ã€ä¿®æ”¹æœºèº«é¢œè‰²é‡Œçš„æ‰€å±åˆ†ç»„" aria-hidden="true">#</a> 8ã€ä¿®æ”¹<code>æœºèº«é¢œè‰²</code>é‡Œçš„<code>æ‰€å±åˆ†ç»„</code></h6><p>åœ¨<code>å•†å“ç³»ç»Ÿ/å¹³å°å±æ€§/è§„æ ¼å‚æ•°</code>é‡Œä¿®æ”¹<code>æœºèº«é¢œè‰²</code>é‡Œçš„<code>æ‰€å±åˆ†ç»„</code>ä¸º<code>åŸºæœ¬ä¿¡æ¯</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.1.8.png" alt="image-20220521202705771" tabindex="0" loading="lazy"><figcaption>image-20220521202705771</figcaption></figure><h6 id="_9ã€ä¿®æ”¹å†…å­˜é‡Œçš„å¯é€‰å€¼" tabindex="-1"><a class="header-anchor" href="#_9ã€ä¿®æ”¹å†…å­˜é‡Œçš„å¯é€‰å€¼" aria-hidden="true">#</a> 9ã€ä¿®æ”¹<code>å†…å­˜</code>é‡Œçš„<code>å¯é€‰å€¼</code></h6><p>åœ¨<code>å•†å“ç³»ç»Ÿ/å¹³å°å±æ€§/é”€å”®å±æ€§</code>é‡Œä¿®æ”¹<code>å†…å­˜</code>é‡Œçš„<code>å¯é€‰å€¼</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.1.9.png" alt="image-20220522110005717" tabindex="0" loading="lazy"><figcaption>image-20220522110005717</figcaption></figure><h6 id="_10ã€æ·»åŠ ç‰ˆæœ¬" tabindex="-1"><a class="header-anchor" href="#_10ã€æ·»åŠ ç‰ˆæœ¬" aria-hidden="true">#</a> 10ã€æ·»åŠ <code>ç‰ˆæœ¬</code></h6><p>åœ¨<code>å•†å“ç³»ç»Ÿ/å¹³å°å±æ€§/é”€å”®å±æ€§</code>é‡Œæ·»åŠ <code>ç‰ˆæœ¬</code><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.1.10.png" alt="image-20220522110314425" loading="lazy"></p><h5 id="_2ã€å½•å…¥å•†å“ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_2ã€å½•å…¥å•†å“ä¿¡æ¯" aria-hidden="true">#</a> 2ã€å½•å…¥å•†å“ä¿¡æ¯</h5><h6 id="_1ã€å½•å…¥åŸºæœ¬å±æ€§" tabindex="-1"><a class="header-anchor" href="#_1ã€å½•å…¥åŸºæœ¬å±æ€§" aria-hidden="true">#</a> 1ã€å½•å…¥<code>åŸºæœ¬å±æ€§</code></h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.1.png" alt="image-20220521203305473" tabindex="0" loading="lazy"><figcaption>image-20220521203305473</figcaption></figure><h6 id="_2ã€å½•å…¥è§„æ ¼å‚æ•°é‡Œçš„ä¸»ä½“" tabindex="-1"><a class="header-anchor" href="#_2ã€å½•å…¥è§„æ ¼å‚æ•°é‡Œçš„ä¸»ä½“" aria-hidden="true">#</a> 2ã€å½•å…¥<code>è§„æ ¼å‚æ•°</code>é‡Œçš„<code>ä¸»ä½“</code></h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.2.png" alt="image-20220521203509597" tabindex="0" loading="lazy"><figcaption>image-20220521203509597</figcaption></figure><h6 id="_3ã€å½•å…¥è§„æ ¼å‚æ•°é‡Œçš„åŸºæœ¬ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_3ã€å½•å…¥è§„æ ¼å‚æ•°é‡Œçš„åŸºæœ¬ä¿¡æ¯" aria-hidden="true">#</a> 3ã€å½•å…¥<code>è§„æ ¼å‚æ•°</code>é‡Œçš„<code>åŸºæœ¬ä¿¡æ¯</code></h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.3.png" alt="image-20220521203913840" tabindex="0" loading="lazy"><figcaption>image-20220521203913840</figcaption></figure><h6 id="_4ã€å½•å…¥è§„æ ¼å‚æ•°é‡Œçš„ä¸»èŠ¯ç‰‡" tabindex="-1"><a class="header-anchor" href="#_4ã€å½•å…¥è§„æ ¼å‚æ•°é‡Œçš„ä¸»èŠ¯ç‰‡" aria-hidden="true">#</a> 4ã€å½•å…¥<code>è§„æ ¼å‚æ•°</code>é‡Œçš„<code>ä¸»èŠ¯ç‰‡</code></h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.4.png" alt="image-20220521204015874" tabindex="0" loading="lazy"><figcaption>image-20220521204015874</figcaption></figure><h6 id="_5ã€å½•å…¥é”€å”®å±æ€§" tabindex="-1"><a class="header-anchor" href="#_5ã€å½•å…¥é”€å”®å±æ€§" aria-hidden="true">#</a> 5ã€å½•å…¥<code>é”€å”®å±æ€§</code></h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.5.png" alt="image-20220521205929197" tabindex="0" loading="lazy"><figcaption>image-20220521205929197</figcaption></figure><h6 id="_6ã€ä¿®æ”¹skuä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_6ã€ä¿®æ”¹skuä¿¡æ¯" aria-hidden="true">#</a> 6ã€ä¿®æ”¹<code>SKUä¿¡æ¯</code></h6><table><thead><tr><th>é¢œè‰²</th><th>ç‰ˆæœ¬</th><th>å•†å“åç§°</th><th>æ ‡é¢˜</th><th>å‰¯æ ‡é¢˜</th><th>ä»·æ ¼</th></tr></thead><tbody><tr><td>æ˜Ÿæ²³é“¶</td><td>8GB+128GB</td><td>åä¸º HUAWEI Mate30Pro æ˜Ÿæ²³é“¶ 8GB+128GB</td><td>åä¸º HUAWEI Mate30Pro æ˜Ÿæ²³é“¶ 8GB+128GB éº’éºŸ990æ——èˆ°èŠ¯ç‰‡OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ 4Gå…¨ç½‘é€šæ‰‹æœº</td><td>[ç°è´§æŠ¢è´­ï¼äº«ç™½æ¡12æœŸå…æ¯ï¼]éº’éºŸ990ï¼Œ OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ï¼šMate30ç³»åˆ—äº«12æœŸå…æ¯ã€‹</td><td>5799</td></tr><tr><td>æ˜Ÿæ²³é“¶</td><td>8GB+256GB</td><td>åä¸º HUAWEI Mate30Pro æ˜Ÿæ²³é“¶ 8GB+256GB</td><td>åä¸º HUAWEI Mate30Pro æ˜Ÿæ²³é“¶ 8GB+256GB éº’éºŸ990æ——èˆ°èŠ¯ç‰‡OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ 4Gå…¨ç½‘é€šæ‰‹æœº</td><td>[ç°è´§æŠ¢è´­ï¼äº«ç™½æ¡12æœŸå…æ¯ï¼]éº’éºŸ990ï¼Œ OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ï¼šMate30ç³»åˆ—äº«12æœŸå…æ¯ã€‹</td><td>6299</td></tr><tr><td>äº®é»‘è‰²</td><td>8GB+128GB</td><td>åä¸º HUAWEI Mate30Pro äº®é»‘è‰² 8GB+128GB</td><td>åä¸º HUAWEI Mate30Pro äº®é»‘è‰² 8GB+128GB éº’éºŸ990æ——èˆ°èŠ¯ç‰‡OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ 4Gå…¨ç½‘é€šæ‰‹æœº</td><td>[ç°è´§æŠ¢è´­ï¼äº«ç™½æ¡12æœŸå…æ¯ï¼]éº’éºŸ990ï¼Œ OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ï¼šMate30ç³»åˆ—äº«12æœŸå…æ¯ã€‹</td><td>5799</td></tr><tr><td>äº®é»‘è‰²</td><td>8GB+256GB</td><td>åä¸º HUAWEI Mate30Pro äº®é»‘è‰² 8GB+256GB</td><td>åä¸º HUAWEI Mate30Pro äº®é»‘è‰² 8GB+256GB éº’éºŸ990æ——èˆ°èŠ¯ç‰‡OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ 4Gå…¨ç½‘é€šæ‰‹æœº</td><td>[ç°è´§æŠ¢è´­ï¼äº«ç™½æ¡12æœŸå…æ¯ï¼]éº’éºŸ990ï¼Œ OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ï¼šMate30ç³»åˆ—äº«12æœŸå…æ¯ã€‹</td><td>6299</td></tr><tr><td>ç¿¡å†·ç¿ </td><td>8GB+128GB</td><td>åä¸º HUAWEI Mate30Pro ç¿¡å†·ç¿  8GB+128GB</td><td>åä¸º HUAWEI Mate30Pro ç¿¡å†·ç¿  8GB+128GB éº’éºŸ990æ——èˆ°èŠ¯ç‰‡OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ 4Gå…¨ç½‘é€šæ‰‹æœº</td><td>[ç°è´§æŠ¢è´­ï¼äº«ç™½æ¡12æœŸå…æ¯ï¼]éº’éºŸ990ï¼Œ OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ï¼šMate30ç³»åˆ—äº«12æœŸå…æ¯ã€‹</td><td>5799</td></tr><tr><td>ç¿¡å†·ç¿ </td><td>8GB+256GB</td><td>åä¸º HUAWEI Mate30Pro ç¿¡å†·ç¿  8GB+256GB</td><td>åä¸º HUAWEI Mate30Pro ç¿¡å†·ç¿  8GB+256GB éº’éºŸ990æ——èˆ°èŠ¯ç‰‡OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ 4Gå…¨ç½‘é€šæ‰‹æœº</td><td>[ç°è´§æŠ¢è´­ï¼äº«ç™½æ¡12æœŸå…æ¯ï¼]éº’éºŸ990ï¼Œ OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ï¼šMate30ç³»åˆ—äº«12æœŸå…æ¯ã€‹</td><td>6299</td></tr><tr><td>ç½—å…°ç´«</td><td>8GB+128GB</td><td>åä¸º HUAWEI Mate30Pro ç½—å…°ç´« 8GB+128GB</td><td>åä¸º HUAWEI Mate30Pro ç½—å…°ç´« 8GB+128GB éº’éºŸ990æ——èˆ°èŠ¯ç‰‡OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ 4Gå…¨ç½‘é€šæ‰‹æœº</td><td>[ç°è´§æŠ¢è´­ï¼äº«ç™½æ¡12æœŸå…æ¯ï¼]éº’éºŸ990ï¼Œ OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ï¼šMate30ç³»åˆ—äº«12æœŸå…æ¯ã€‹</td><td>5799</td></tr><tr><td>ç½—å…°ç´«</td><td>8GB+256GB</td><td>åä¸º HUAWEI Mate30Pro ç½—å…°ç´« 8GB+256GB</td><td>åä¸º HUAWEI Mate30Pro ç½—å…°ç´« 8GB+256GB éº’éºŸ990æ——èˆ°èŠ¯ç‰‡OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ 4Gå…¨ç½‘é€šæ‰‹æœº</td><td>[ç°è´§æŠ¢è´­ï¼äº«ç™½æ¡12æœŸå…æ¯ï¼]éº’éºŸ990ï¼Œ OLEDç¯å¹•å±åŒ4000ä¸‡å¾•å¡ç”µå½±å››æ‘„ï¼šMate30ç³»åˆ—äº«12æœŸå…æ¯ã€‹</td><td>6299</td></tr></tbody></table><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.6.png" alt="image-20220521213940120" tabindex="0" loading="lazy"><figcaption>image-20220521213940120</figcaption></figure><h6 id="_7ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„æ˜Ÿæ²³é“¶-8gb-128gbä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_7ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„æ˜Ÿæ²³é“¶-8gb-128gbä¿¡æ¯" aria-hidden="true">#</a> 7ã€ä¿®æ”¹<code>SKUä¿¡æ¯</code>é‡Œçš„<code>æ˜Ÿæ²³é“¶ 8GB+128GB</code>ä¿¡æ¯</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.7.png" alt="image-20220521214707364" tabindex="0" loading="lazy"><figcaption>image-20220521214707364</figcaption></figure><h6 id="_8ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„æ˜Ÿæ²³é“¶8gb-256gbä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_8ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„æ˜Ÿæ²³é“¶8gb-256gbä¿¡æ¯" aria-hidden="true">#</a> 8ã€ä¿®æ”¹<code>SKUä¿¡æ¯</code>é‡Œçš„<code>æ˜Ÿæ²³é“¶8GB+256GB</code>ä¿¡æ¯</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.8.png" alt="image-20220521214923139" tabindex="0" loading="lazy"><figcaption>image-20220521214923139</figcaption></figure><h6 id="_9ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„äº®é»‘è‰²-8gb-128gbä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_9ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„äº®é»‘è‰²-8gb-128gbä¿¡æ¯" aria-hidden="true">#</a> 9ã€ä¿®æ”¹<code>SKUä¿¡æ¯</code>é‡Œçš„<code>äº®é»‘è‰² 8GB+128GB</code>ä¿¡æ¯</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.9.png" alt="image-20220521215050927" tabindex="0" loading="lazy"><figcaption>image-20220521215050927</figcaption></figure><h6 id="_10ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„äº®é»‘è‰²-8gb-256gbä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_10ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„äº®é»‘è‰²-8gb-256gbä¿¡æ¯" aria-hidden="true">#</a> 10ã€ä¿®æ”¹<code>SKUä¿¡æ¯</code>é‡Œçš„<code>äº®é»‘è‰² 8GB+256GB</code>ä¿¡æ¯</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.10.png" alt="image-20220521215354005" tabindex="0" loading="lazy"><figcaption>image-20220521215354005</figcaption></figure><h6 id="_11ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„ç¿¡å†·ç¿ -8gb-128gbä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_11ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„ç¿¡å†·ç¿ -8gb-128gbä¿¡æ¯" aria-hidden="true">#</a> 11ã€ä¿®æ”¹<code>SKUä¿¡æ¯</code>é‡Œçš„<code>ç¿¡å†·ç¿  8GB+128GB</code>ä¿¡æ¯</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.11.png" alt="image-20220521215557469" tabindex="0" loading="lazy"><figcaption>image-20220521215557469</figcaption></figure><h6 id="_12ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„ç¿¡å†·ç¿ -8gb-256gbä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_12ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„ç¿¡å†·ç¿ -8gb-256gbä¿¡æ¯" aria-hidden="true">#</a> 12ã€ä¿®æ”¹<code>SKUä¿¡æ¯</code>é‡Œçš„<code>ç¿¡å†·ç¿  8GB+256GB</code>ä¿¡æ¯</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.12.png" alt="image-20220521215911728" tabindex="0" loading="lazy"><figcaption>image-20220521215911728</figcaption></figure><h6 id="_13ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„ç½—å…°ç´«-8gb-128gbä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_13ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„ç½—å…°ç´«-8gb-128gbä¿¡æ¯" aria-hidden="true">#</a> 13ã€ä¿®æ”¹<code>SKUä¿¡æ¯</code>é‡Œçš„<code>ç½—å…°ç´« 8GB+128GB</code>ä¿¡æ¯</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.13.png" alt="image-20220521220119171" tabindex="0" loading="lazy"><figcaption>image-20220521220119171</figcaption></figure><h6 id="_14ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„ç½—å…°ç´«-8gb-256gbä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_14ã€ä¿®æ”¹skuä¿¡æ¯é‡Œçš„ç½—å…°ç´«-8gb-256gbä¿¡æ¯" aria-hidden="true">#</a> 14ã€ä¿®æ”¹<code>SKUä¿¡æ¯</code>é‡Œçš„<code>ç½—å…°ç´« 8GB+256GB</code>ä¿¡æ¯</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.14.png" alt="image-20220521220313889" tabindex="0" loading="lazy"><figcaption>image-20220521220313889</figcaption></figure><h6 id="_15ã€æŸ¥çœ‹å‘é€çš„æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_15ã€æŸ¥çœ‹å‘é€çš„æ•°æ®" aria-hidden="true">#</a> 15ã€æŸ¥çœ‹å‘é€çš„æ•°æ®</h6><ol><li>æ‰“å¼€æ§åˆ¶å°</li><li>ç‚¹å‡»<code>ä¸‹ä¸€æ­¥ï¼šä¿å­˜å•†å“ä¿¡æ¯</code></li><li>ç‚¹å‡»<code>Copy</code></li><li><strong>å…ˆæ”¾åˆ°è®°äº‹æœ¬é‡Œä¿å­˜ï¼Œå…å¾—åé¢æ“ä½œå¤šäº†ï¼Œä¸å°å¿ƒä¸¢äº†</strong>(åé¢å†™å®Œåç«¯ä»£ç åä¸€å®šä¼šç”¨åˆ°ï¼Œä¸€å®šè¦å­˜ç€ï¼Œå¦è€…åªèƒ½é‡æ–°æ·»åŠ å•†å“äº†)</li></ol><p><a href="code/4.6.4.1.2.15.json">ç‚¹å‡»æŸ¥çœ‹åˆšåˆšå¤åˆ¶çš„json</a></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.2.15.png" alt="image-20220521221004925" tabindex="0" loading="lazy"><figcaption>image-20220521221004925</figcaption></figure><h5 id="_3ã€æ¥å£æ–‡æ¡£-1" tabindex="-1"><a class="header-anchor" href="#_3ã€æ¥å£æ–‡æ¡£-1" aria-hidden="true">#</a> 3ã€æ¥å£æ–‡æ¡£</h5><p>æ¥å£æ–‡æ¡£ åœ¨<code>å•†å“ç³»ç»Ÿ/19ã€æ–°å¢å•†å“</code>é‡Œï¼š https://easydoc.net/s/78237135/ZUqEdvA4/5ULdV3dd</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.1.3.png" alt="image-20220521220653670" tabindex="0" loading="lazy"><figcaption>image-20220521220653670</figcaption></figure><h4 id="_2ã€jsonç”Ÿæˆjavaå®ä½“ç±»" tabindex="-1"><a class="header-anchor" href="#_2ã€jsonç”Ÿæˆjavaå®ä½“ç±»" aria-hidden="true">#</a> 2ã€JSONç”ŸæˆJavaå®ä½“ç±»</h4><h5 id="_1ã€æ ¼å¼åŒ–json" tabindex="-1"><a class="header-anchor" href="#_1ã€æ ¼å¼åŒ–json" aria-hidden="true">#</a> 1ã€æ ¼å¼åŒ–JSON</h5><p>å°†åˆšåˆšå¤åˆ¶åˆ°JSONç²˜è´´åˆ°è¾“å…¥æ¡†ï¼Œç‚¹å‡»<code>æ ¼å¼åŒ–æ ¡éªŒ</code>ï¼Œæ£€æŸ¥JSON</p>`,379),Ja={href:"https://www.bejson.com/json/format/",target:"_blank",rel:"noopener noreferrer"},Za=e(`<p><a href="code/4.6.4.2.1.json">ç‚¹å‡»æŸ¥çœ‹æ ¼å¼åŒ–åçš„Json</a></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.2.1.png" alt="image-20220521223643977" tabindex="0" loading="lazy"><figcaption>image-20220521223643977</figcaption></figure><h5 id="_2ã€å¤åˆ¶voåŒ…çš„è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#_2ã€å¤åˆ¶voåŒ…çš„è·¯å¾„" aria-hidden="true">#</a> 2ã€å¤åˆ¶<code>vo</code>åŒ…çš„è·¯å¾„</h5><p>å¤åˆ¶<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo</code>åŒ…çš„è·¯å¾„</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.2.2.png" alt="image-20220521223237967" tabindex="0" loading="lazy"><figcaption>image-20220521223237967</figcaption></figure><h5 id="_3ã€ç”Ÿæˆjavaå®ä½“ç±»" tabindex="-1"><a class="header-anchor" href="#_3ã€ç”Ÿæˆjavaå®ä½“ç±»" aria-hidden="true">#</a> 3ã€ç”ŸæˆJavaå®ä½“ç±»</h5><ol><li>ç²˜è´´JOSN</li><li>è¾“å…¥&quot;SpuSaveVo&quot;</li><li>ç²˜è´´åˆšåˆšå¤åˆ¶çš„è·¯å¾„ &quot;com.atguigu.gulimall.product.vo&quot;</li><li>ç‚¹å‡»&quot;ç”ŸæˆJavaBean&quot;</li><li>æ£€æŸ¥ä¸€ä¸‹ä»£ç æ˜¯å¦æ­£ç¡®</li><li>ç‚¹å‡»&quot;ä¸‹è½½ä»£ç &quot;</li></ol><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.2.3.png" alt="image-20220521223304810" tabindex="0" loading="lazy"><figcaption>image-20220521223304810</figcaption></figure><h4 id="_3ã€æ·»åŠ voå¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ voå¯¹è±¡" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>vo</code>å¯¹è±¡</h4><h5 id="_1ã€ä½¿ç”¨ç”Ÿæˆçš„javaå®ä½“ç±»" tabindex="-1"><a class="header-anchor" href="#_1ã€ä½¿ç”¨ç”Ÿæˆçš„javaå®ä½“ç±»" aria-hidden="true">#</a> 1ã€ä½¿ç”¨ç”Ÿæˆçš„Javaå®ä½“ç±»</h5><p>è§£å‹åˆšåˆšç”Ÿæˆçš„Javaå®ä½“ç±»ï¼Œå¤åˆ¶è¿™äº›å®ä½“ç±»</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.3.1.1.png" alt="image-20220521223941902" tabindex="0" loading="lazy"><figcaption>image-20220521223941902</figcaption></figure><p>ç²˜è´´åˆ°<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo</code>åŒ…ä¸‹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.3.1.2.png" alt="image-20220521224052736" tabindex="0" loading="lazy"><figcaption>image-20220521224052736</figcaption></figure><h5 id="_2ã€ä¿®æ”¹ç²˜è´´çš„javaå®ä½“ç±»-ä¸æ¨è" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹ç²˜è´´çš„javaå®ä½“ç±»-ä¸æ¨è" aria-hidden="true">#</a> 2ã€ä¿®æ”¹ç²˜è´´çš„Javaå®ä½“ç±»(ä¸æ¨è)</h5><h6 id="_1ã€ä¿®æ”¹spusavevoç±»" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿®æ”¹spusavevoç±»" aria-hidden="true">#</a> 1ã€ä¿®æ”¹<code>SpuSaveVo</code>ç±»</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo</code>åŒ…ä¸‹çš„<code>SpuSaveVo</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
  * Copyright 2022 bejson.com 
  */</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Auto-generated: 2022-05-21 22:37:36
 *
 * <span class="token keyword">@author</span> bejson.com (i@bejson.com)
 * <span class="token keyword">@website</span> http://www.bejson.com/java2pojo/
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpuSaveVo</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> spuName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> spuDescription<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> catalogId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> brandId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> weight<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> publishStatus<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> decript<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> images<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Bounds</span> bounds<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BaseAttrs</span><span class="token punctuation">&gt;</span></span> baseAttrs<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Skus</span><span class="token punctuation">&gt;</span></span> skus<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.3.2.1.png" alt="image-20220521225538198" tabindex="0" loading="lazy"><figcaption>image-20220521225538198</figcaption></figure><h6 id="_2ã€ä¿®æ”¹skusç±»" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹skusç±»" aria-hidden="true">#</a> 2ã€ä¿®æ”¹<code>Skus</code>ç±»</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo</code>åŒ…ä¸‹çš„<code>Skus</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
  * Copyright 2022 bejson.com 
  */</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Auto-generated: 2022-05-21 22:37:36
 *
 * <span class="token keyword">@author</span> bejson.com (i@bejson.com)
 * <span class="token keyword">@website</span> http://www.bejson.com/java2pojo/
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Skus</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Attr</span><span class="token punctuation">&gt;</span></span> attr<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> skuName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> price<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> skuTitle<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> skuSubtitle<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Images</span><span class="token punctuation">&gt;</span></span> images<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> descar<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> fullCount<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> discount<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> countStatus<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> fullPrice<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> reducePrice<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> priceStatus<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MemberPrice</span><span class="token punctuation">&gt;</span></span> memberPrice<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.3.2.2.png" alt="image-20220521225626590" tabindex="0" loading="lazy"><figcaption>image-20220521225626590</figcaption></figure><h6 id="_3ã€ä¿®æ”¹boundsç±»" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹boundsç±»" aria-hidden="true">#</a> 3ã€ä¿®æ”¹<code>Bounds</code>ç±»</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo</code>åŒ…ä¸‹çš„<code>Bounds</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
  * Copyright 2022 bejson.com 
  */</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Auto-generated: 2022-05-21 22:37:36
 *
 * <span class="token keyword">@author</span> bejson.com (i@bejson.com)
 * <span class="token keyword">@website</span> http://www.bejson.com/java2pojo/
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Bounds</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> buyBounds<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> growBounds<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.3.2.3.png" alt="image-20220521225730419" tabindex="0" loading="lazy"><figcaption>image-20220521225730419</figcaption></figure><h6 id="_4ã€ä¿®æ”¹attrç±»" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿®æ”¹attrç±»" aria-hidden="true">#</a> 4ã€ä¿®æ”¹<code>Attr</code>ç±»</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo</code>åŒ…ä¸‹çš„<code>Attr</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
  * Copyright 2022 bejson.com 
  */</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Auto-generated: 2022-05-21 22:37:36
 *
 * <span class="token keyword">@author</span> bejson.com (i@bejson.com)
 * <span class="token keyword">@website</span> http://www.bejson.com/java2pojo/
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Attr</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> attrId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> attrName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> attrValue<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.3.2.4.png" alt="image-20220521225822709" tabindex="0" loading="lazy"><figcaption>image-20220521225822709</figcaption></figure><h6 id="_5ã€ä¿®æ”¹memberpriceç±»" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¿®æ”¹memberpriceç±»" aria-hidden="true">#</a> 5ã€ä¿®æ”¹<code>MemberPrice</code>ç±»</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo</code>åŒ…ä¸‹çš„<code>MemberPrice</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
  * Copyright 2022 bejson.com 
  */</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Auto-generated: 2022-05-21 22:37:36
 *
 * <span class="token keyword">@author</span> bejson.com (i@bejson.com)
 * <span class="token keyword">@website</span> http://www.bejson.com/java2pojo/
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MemberPrice</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> price<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.3.2.5.png" alt="image-20220521225934901" tabindex="0" loading="lazy"><figcaption>image-20220521225934901</figcaption></figure><h6 id="_6ã€ä¿®æ”¹imagesç±»" tabindex="-1"><a class="header-anchor" href="#_6ã€ä¿®æ”¹imagesç±»" aria-hidden="true">#</a> 6ã€ä¿®æ”¹<code>Images</code>ç±»</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo</code>åŒ…ä¸‹çš„<code>Images</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
  * Copyright 2022 bejson.com 
  */</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Auto-generated: 2022-05-21 22:37:36
 *
 * <span class="token keyword">@author</span> bejson.com (i@bejson.com)
 * <span class="token keyword">@website</span> http://www.bejson.com/java2pojo/
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Images</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> imgUrl<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> defaultImg<span class="token punctuation">;</span>


<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.3.2.6.png" alt="image-20220521230008068" tabindex="0" loading="lazy"><figcaption>image-20220521230008068</figcaption></figure><h6 id="_7ã€ä¿®æ”¹baseattrsç±»" tabindex="-1"><a class="header-anchor" href="#_7ã€ä¿®æ”¹baseattrsç±»" aria-hidden="true">#</a> 7ã€ä¿®æ”¹<code>BaseAttrs</code>ç±»</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo</code>åŒ…ä¸‹çš„<code>BaseAttrs</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
  * Copyright 2022 bejson.com 
  */</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Auto-generated: 2022-05-21 22:37:36
 *
 * <span class="token keyword">@author</span> bejson.com (i@bejson.com)
 * <span class="token keyword">@website</span> http://www.bejson.com/java2pojo/
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BaseAttrs</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> attrId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> attrValues<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> showDesc<span class="token punctuation">;</span>


<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.3.2.7.png" alt="image-20220521230035175" tabindex="0" loading="lazy"><figcaption>image-20220521230035175</figcaption></figure><h5 id="_3ã€ä½¿ç”¨å†…éƒ¨ç±»-æ¨è" tabindex="-1"><a class="header-anchor" href="#_3ã€ä½¿ç”¨å†…éƒ¨ç±»-æ¨è" aria-hidden="true">#</a> 3ã€ä½¿ç”¨å†…éƒ¨ç±»(æ¨è)</h5><h6 id="_1ã€ä¿®æ”¹æˆå†…éƒ¨ç±»æŠ¥é”™" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿®æ”¹æˆå†…éƒ¨ç±»æŠ¥é”™" aria-hidden="true">#</a> 1ã€ä¿®æ”¹æˆå†…éƒ¨ç±»æŠ¥é”™</h6><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpuSaveVo</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> spuName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> spuDescription<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> catalogId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> brandId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> weight<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> publishStatus<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> decript<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> images<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Bounds</span> bounds<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BaseAttrs</span><span class="token punctuation">&gt;</span></span> baseAttrs<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Skus</span><span class="token punctuation">&gt;</span></span> skus<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Data</span>
    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">BaseAttrs</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token class-name">Long</span> attrId<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> attrValues<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> showDesc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Data</span>
    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">Skus</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Attr</span><span class="token punctuation">&gt;</span></span> attr<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> skuName<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> price<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> skuTitle<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> skuSubtitle<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Images</span><span class="token punctuation">&gt;</span></span> images<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> descar<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> fullCount<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> discount<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> countStatus<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> fullPrice<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> reducePrice<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> priceStatus<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MemberPrice</span><span class="token punctuation">&gt;</span></span> memberPrice<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Data</span>
    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">Attr</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token class-name">Long</span> attrId<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> attrName<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> attrValue<span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Data</span>
    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">Images</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> imgUrl<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> defaultImg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Data</span>
    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">MemberPrice</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> price<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Data</span>
    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">Bounds</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> buyBounds<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> growBounds<span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.3.3.1.png" alt="image-20220522101000555" tabindex="0" loading="lazy"><figcaption>image-20220522101000555</figcaption></figure><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œæ§åˆ¶å°æŠ¥é”™</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Cannot construct instance of \`com.atguigu.gulimall.product.vo.SpuSaveVo$BaseAttrs\` (although at least one Creator exists): can only instantiate non-static inner class by using default, no-argument constructor; nested exception is com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot construct instance of \`com.atguigu.gulimall.product.vo.SpuSaveVo$BaseAttrs\` (although at least one Creator exists): can only instantiate non-static inner class by using default, no-argument constructor

org.springframework.http.converter.HttpMessageNotReadableExceptionï¼šJSONè§£æé”™è¯¯ï¼šæ— æ³•æ„é€ \`com.atguigu.gulimall.product.vo.SpuSaveVo$BaseAttrs\`çš„å®ä¾‹ï¼ˆå°½ç®¡è‡³å°‘å­˜åœ¨ä¸€ä¸ªCreatorï¼‰ï¼šåªèƒ½å®ä¾‹åŒ–éé™æ€å†…éƒ¨ç±» é€šè¿‡ä½¿ç”¨é»˜è®¤çš„æ— å‚æ•°æ„é€ å‡½æ•°ï¼› åµŒå¥—å¼‚å¸¸æ˜¯ com.fasterxml.jackson.databind.exc.MismatchedInputExceptionï¼šæ— æ³•æ„é€  \`com.atguigu.gulimall.product.vo.SpuSaveVo$BaseAttrs\` çš„å®ä¾‹ï¼ˆå°½ç®¡è‡³å°‘å­˜åœ¨ä¸€ä¸ª Creatorï¼‰ï¼šåªèƒ½å®ä¾‹åŒ–éé™æ€å†…éƒ¨ ä½¿ç”¨é»˜è®¤çš„æ— å‚æ•°æ„é€ å‡½æ•°è¿›è¡Œç±»
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2ã€ä¿®æ”¹ä¸ºé™æ€å†…éƒ¨ç±»" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹ä¸ºé™æ€å†…éƒ¨ç±»" aria-hidden="true">#</a> 2ã€ä¿®æ”¹ä¸ºé™æ€å†…éƒ¨ç±»</h6><p>æœ¬ç±»ä¸‹çš„æ‰€æœ‰å†…éƒ¨ç±»æ·»åŠ <code>staitc</code>å…³é”®å­—ï¼Œä¿®æ”¹ä¸ºé™æ€å†…éƒ¨ç±»</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.3.3.2.png" alt="image-20220522101630956" tabindex="0" loading="lazy"><figcaption>image-20220522101630956</figcaption></figure><h5 id="_4ã€æµ‹è¯•-4" tabindex="-1"><a class="header-anchor" href="#_4ã€æµ‹è¯•-4" aria-hidden="true">#</a> 4ã€æµ‹è¯•</h5><h6 id="_1ã€æ‰“æ–­ç‚¹" tabindex="-1"><a class="header-anchor" href="#_1ã€æ‰“æ–­ç‚¹" aria-hidden="true">#</a> 1ã€æ‰“æ–­ç‚¹</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.SpuInfoController</code>ç±»çš„<code>save</code>æ–¹æ³•</p><p>å¹¶æ‰“æ–­ç‚¹ï¼Œä»¥æµ‹è¯•<code>SpuSaveVo</code>æ˜¯å¦å¯ä»¥æ­£ç¡®å°è£…æ•°æ®</p><p>ç„¶åä»¥<code>debug</code>æ–¹å¼å¯åŠ¨<code>gulimall-product</code>æ¨¡å—</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¿å­˜
 */</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/save&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SpuSaveVo</span> spuSaveVo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//spuInfoService.save(spuInfo);</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.3.4.1.png" alt="image-20220522120721302" tabindex="0" loading="lazy"><figcaption>image-20220522120721302</figcaption></figure><h6 id="_2ã€ä½¿ç”¨postmanå‘é€è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_2ã€ä½¿ç”¨postmanå‘é€è¯·æ±‚" aria-hidden="true">#</a> 2ã€ä½¿ç”¨<code>Postman</code>å‘é€è¯·æ±‚</h6><ol><li>è¾“å…¥urlï¼šhttp://localhost:88/api/product/spuinfo/save</li><li>é€‰æ‹©<code>Post</code></li><li>ç‚¹å‡»<code>Body</code></li><li>ç‚¹å‡»<code>raw</code></li><li>é€‰æ‹©<code>JSON</code></li><li>ç²˜è´´æ§åˆ¶å°é‡Œå¤åˆ¶çš„JSON</li><li>ç‚¹å‡»<code>Send</code></li></ol><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.3.4.2.png" alt="image-20220522120320199" tabindex="0" loading="lazy"><figcaption>image-20220522120320199</figcaption></figure><h6 id="_3ã€æŸ¥çœ‹å°è£…çš„æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_3ã€æŸ¥çœ‹å°è£…çš„æ•°æ®" aria-hidden="true">#</a> 3ã€æŸ¥çœ‹å°è£…çš„æ•°æ®</h6><p>å¯ä»¥çœ‹åˆ°<code>SpuSaveVo</code>ç±»å·²æ­£ç¡®å°è£…äº†æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.3.4.3.png" alt="image-20220522101945488" tabindex="0" loading="lazy"><figcaption>image-20220522101945488</figcaption></figure><h4 id="_4ã€ä¿®æ”¹saveæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿®æ”¹saveæ–¹æ³•" aria-hidden="true">#</a> 4ã€ä¿®æ”¹<code>save</code>æ–¹æ³•</h4><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.SpuInfoController</code>ç±»çš„<code>save</code>æ–¹æ³•</p><p><strong>åº”è¯¥æ˜¯<code>spuInfoService.saveSpuInfo(spuSaveVo);</code>ï¼Œè¿™é‡Œå†™é”™äº†</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¿å­˜
 */</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/save&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SpuSaveVo</span> spuSaveVo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//spuInfoService.save(spuInfo);</span>
   spuInfoService<span class="token punctuation">.</span><span class="token function">saveSouInfo</span><span class="token punctuation">(</span>spuSaveVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.4.png" alt="image-20220522093324236" tabindex="0" loading="lazy"><figcaption>image-20220522093324236</figcaption></figure><h4 id="_5ã€æ·»åŠ savesouinfoæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€æ·»åŠ savesouinfoæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 5ã€æ·»åŠ <code>saveSouInfo</code>æŠ½è±¡æ–¹æ³•</h4><p><strong>(åº”è¯¥æ˜¯æ·»åŠ <code>saveSouInfo</code>æŠ½è±¡æ–¹æ³•ï¼Œè¿™é‡Œå†™é”™äº†)</strong></p><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.SpuInfoService</code>æ¥å£é‡Œæ·»åŠ <code>saveSouInfo</code>æŠ½è±¡æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.5.png" alt="image-20220522093446271" tabindex="0" loading="lazy"><figcaption>image-20220522093446271</figcaption></figure><h4 id="_6ã€å®ç°savesouinfoæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_6ã€å®ç°savesouinfoæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 6ã€å®ç°<code>saveSouInfo</code>æŠ½è±¡æ–¹æ³•</h4><p><strong>(åº”è¯¥æ˜¯æ·»åŠ <code>saveSpuInfo</code>æŠ½è±¡æ–¹æ³•ï¼Œè¿™é‡Œå†™é”™äº†)</strong></p><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»é‡Œå®ç°<code>saveSouInfo</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveSouInfo</span><span class="token punctuation">(</span><span class="token class-name">SpuSaveVo</span> spuSaveVo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//1ã€ä¿å­˜spuåŸºæœ¬ä¿¡æ¯ pms_spu_info</span>

    <span class="token comment">//2ã€ä¿å­˜Spuçš„æè¿°å›¾ç‰‡ pms_spu_info_desc</span>

    <span class="token comment">//3ã€ä¿å­˜spuçš„å›¾ç‰‡é›† pms_spu_images</span>

    <span class="token comment">//4ã€ä¿å­˜spuçš„è§„æ ¼å‚æ•°ï¼›pms_product_attr_value</span>

    <span class="token comment">//5ã€ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯; gulimall_sms-&gt;sms_spu_bounds</span>

    <span class="token comment">//5ã€ä¿å­˜å½“å‰spuå¯¹åº”çš„æ‰€æœ‰skuä¿¡æ¯;</span>
    <span class="token comment">//5.1)ã€skuçš„åŸºæœ¬ä¿¡æ¯; pms_sku_info</span>
    <span class="token comment">//5.2)ã€skuçš„å›¾ç‰‡ä¿¡æ¯; pms_sku_images</span>
    <span class="token comment">//5.3)ã€skuçš„é”€å”®å±æ€§ä¿¡æ¯: pms_sku_sale_attr_value</span>
    <span class="token comment">//5.4)ã€skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯ï¼›gulimall_sms-&gt;sms_sku_ladder\\sms_sku_full_reduction\\sms_ member_price</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.4.6.png" alt="image-20220522141406494" tabindex="0" loading="lazy"><figcaption>image-20220522141406494</figcaption></figure><h3 id="_4-6-5ã€æ–°å¢å•†å“-2" tabindex="-1"><a class="header-anchor" href="#_4-6-5ã€æ–°å¢å•†å“-2" aria-hidden="true">#</a> 4.6.5ã€æ–°å¢å•†å“(2)</h3><h4 id="_4-6-5-1ã€ä¿å­˜spuåŸºæœ¬ä¿¡æ¯pms-spu-info" tabindex="-1"><a class="header-anchor" href="#_4-6-5-1ã€ä¿å­˜spuåŸºæœ¬ä¿¡æ¯pms-spu-info" aria-hidden="true">#</a> 4.6.5.1ã€ä¿å­˜spuåŸºæœ¬ä¿¡æ¯<code>pms_spu_info</code></h4><h5 id="_1ã€è°ƒç”¨savebasespuinfoæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€è°ƒç”¨savebasespuinfoæ–¹æ³•" aria-hidden="true">#</a> 1ã€è°ƒç”¨<code>saveBaseSpuInfo</code>æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»é‡Œçš„<code>saveSouInfo</code>æ–¹æ³•é‡Œç¼–å†™éƒ¨åˆ†ä»£ç ï¼Œç”¨äºä¿å­˜spuåŸºæœ¬ä¿¡æ¯</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveSouInfo</span><span class="token punctuation">(</span><span class="token class-name">SpuSaveVo</span> spuSaveVo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//1ã€ä¿å­˜spuåŸºæœ¬ä¿¡æ¯ pms_spu_info</span>
    <span class="token class-name">SpuInfoEntity</span> spuInfoEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpuInfoEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">saveBaseSpuInfo</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.1.png" alt="image-20220522163949897" tabindex="0" loading="lazy"><figcaption>image-20220522163949897</figcaption></figure><h5 id="_2ã€åˆ›å»ºsavebasespuinfoæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€åˆ›å»ºsavebasespuinfoæ–¹æ³•" aria-hidden="true">#</a> 2ã€åˆ›å»º<code>saveBaseSpuInfo</code>æ–¹æ³•</h5><p>å…‰æ ‡æ”¾åœ¨<code>SpuInfoServiceImpl</code>ç±»çš„<code>saveSouInfo</code>é‡Œçš„<code>this.saveBaseSpuInfo(spuInfoEntity);</code>ä¸­çš„<code>;</code>å‰é¢</p><p>ä½¿ç”¨<code>alt+enter</code>å¿«æ·é”®ï¼Œé€‰æ‹©<code>Create method &#39;saveBaseSpuInfo&#39;</code>,ç„¶åé€‰æ‹©<code>SpuInfoService</code></p><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.SpuInfoService</code>æ¥å£åˆ›å»º<code>saveBaseSpuInfo</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">saveBaseSpuInfo</span><span class="token punctuation">(</span><span class="token class-name">SpuInfoEntity</span> spuInfoEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å…‰æ ‡æ”¾åœ¨<code>SpuInfoService</code>æ¥å£çš„<code>void saveBaseSpuInfo(SpuInfoEntity spuInfoEntity);</code>ä¸­çš„<code>;</code>å‰é¢</p><p>ä½¿ç”¨<code>alt+enter</code>å¿«æ·é”®ï¼Œé€‰æ‹©<code>Implement method &#39;saveBaseSpuInfo&#39;</code><strong>(æ²¡æœ‰è¿™ä¸ªé€‰é¡¹çš„éšä¾¿åœ¨è¯¥æŠ½è±¡æ–¹æ³•åé¢æ•²ä¸¤ä¸ªå›è½¦å°±æœ‰äº†)</strong></p><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»é‡Œå®ç°<code>saveBaseSpuInfo</code>æŠ½è±¡æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.2.png" alt="GIF 2022-5-22 16-37-11" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-22 16-37-11</figcaption></figure><h5 id="_3ã€ç¼–å†™savebasespuinfoæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€ç¼–å†™savebasespuinfoæ–¹æ³•" aria-hidden="true">#</a> 3ã€ç¼–å†™<code>saveBaseSpuInfo</code>æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»é‡Œç¼–å†™<code>saveBaseSpuInfo</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveBaseSpuInfo</span><span class="token punctuation">(</span><span class="token class-name">SpuInfoEntity</span> spuInfoEntity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>baseMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.3.png" alt="image-20220522171910439" tabindex="0" loading="lazy"><figcaption>image-20220522171910439</figcaption></figure><h5 id="_4ã€å°è£…å¯¹è±¡-æ–¹æ³•ä¸€" tabindex="-1"><a class="header-anchor" href="#_4ã€å°è£…å¯¹è±¡-æ–¹æ³•ä¸€" aria-hidden="true">#</a> 4ã€å°è£…å¯¹è±¡(æ–¹æ³•ä¸€)</h5><h6 id="_1ã€æŸ¥çœ‹spusavevoä¸­ç¼ºå°‘çš„å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹spusavevoä¸­ç¼ºå°‘çš„å­—æ®µ" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹<code>SpuSaveVo</code>ä¸­ç¼ºå°‘çš„å­—æ®µ</h6><p>å¯ä»¥çœ‹åˆ°<code>SpuSaveVo</code>ç±»é‡Œç›¸è¾ƒäº<code>SpuInfoEntity</code>æ²¡æœ‰<code>createTime</code>å­—æ®µå’Œ<code>SpuSaveVo</code>å­—æ®µ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.4.1.png" alt="image-20220522172310652" tabindex="0" loading="lazy"><figcaption>image-20220522172310652</figcaption></figure><h6 id="_2ã€ä½¿ç”¨ä»£ç æ·»åŠ æ—¶é—´" tabindex="-1"><a class="header-anchor" href="#_2ã€ä½¿ç”¨ä»£ç æ·»åŠ æ—¶é—´" aria-hidden="true">#</a> 2ã€ä½¿ç”¨ä»£ç æ·»åŠ æ—¶é—´</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»çš„<code>saveBaseSpuInfo</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveSouInfo</span><span class="token punctuation">(</span><span class="token class-name">SpuSaveVo</span> spuSaveVo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//1ã€ä¿å­˜spuåŸºæœ¬ä¿¡æ¯ pms_spu_info</span>
    <span class="token class-name">SpuInfoEntity</span> spuInfoEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpuInfoEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>spuSaveVo<span class="token punctuation">,</span>spuInfoEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    spuInfoEntity<span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    spuInfoEntity<span class="token punctuation">.</span><span class="token function">setUpdateTime</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">saveBaseSpuInfo</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.4.2.png" alt="image-20220522172613649" tabindex="0" loading="lazy"><figcaption>image-20220522172613649</figcaption></figure><h5 id="_5ã€å°è£…å¯¹è±¡-æ–¹æ³•äºŒ" tabindex="-1"><a class="header-anchor" href="#_5ã€å°è£…å¯¹è±¡-æ–¹æ³•äºŒ" aria-hidden="true">#</a> 5ã€å°è£…å¯¹è±¡(æ–¹æ³•äºŒ)</h5><h6 id="_1ã€ä¿®æ”¹savebasespuinfoæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿®æ”¹savebasespuinfoæ–¹æ³•" aria-hidden="true">#</a> 1ã€ä¿®æ”¹<code>saveBaseSpuInfo</code>æ–¹æ³•</h6><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»çš„<code>saveBaseSpuInfo</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveSouInfo</span><span class="token punctuation">(</span><span class="token class-name">SpuSaveVo</span> spuSaveVo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//1ã€ä¿å­˜spuåŸºæœ¬ä¿¡æ¯ pms_spu_info</span>
    <span class="token class-name">SpuInfoEntity</span> spuInfoEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpuInfoEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>spuSaveVo<span class="token punctuation">,</span>spuInfoEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">saveBaseSpuInfo</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.1.png" alt="image-20220522172710746" tabindex="0" loading="lazy"><figcaption>image-20220522172710746</figcaption></figure><h6 id="_2ã€æ·»åŠ metaobjecthandleré…ç½®" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ metaobjecthandleré…ç½®" aria-hidden="true">#</a> 2ã€æ·»åŠ <code>MetaObjectHandler</code>é…ç½®</h6><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.config</code>åŒ…é‡Œæ–°å»º<code>MyBatisConfig</code>ç±»ï¼Œç»§æ‰¿<code>MetaObjectHandler</code>ç±»</p><p><strong>(åº”è¯¥æŠŠ<code>LocalDateTime.class</code>æ”¹ä¸º<code>new Date()</code>)</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>handlers<span class="token punctuation">.</span></span><span class="token class-name">MetaObjectHandler</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>reflection<span class="token punctuation">.</span></span><span class="token class-name">MetaObject</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDateTime</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/22
 * @Description:
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyMetaObjectHandler</span> <span class="token keyword">implements</span> <span class="token class-name">MetaObjectHandler</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insertFill</span><span class="token punctuation">(</span><span class="token class-name">MetaObject</span> metaObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;start insert fill...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//this.setFieldValByName(&quot;createTime&quot;, new Date(), metaObject);</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setFieldValByName</span><span class="token punctuation">(</span><span class="token string">&quot;createTime&quot;</span><span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setFieldValByName</span><span class="token punctuation">(</span><span class="token string">&quot;updateTime&quot;</span><span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateFill</span><span class="token punctuation">(</span><span class="token class-name">MetaObject</span> metaObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;start update fill...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setFieldValByName</span><span class="token punctuation">(</span><span class="token string">&quot;updateTime&quot;</span><span class="token punctuation">,</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.2.png" alt="image-20220522180735126" tabindex="0" loading="lazy"><figcaption>image-20220522180735126</figcaption></figure><h6 id="_3ã€å®ä½“ç±»-tablefieldæ·»åŠ æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_3ã€å®ä½“ç±»-tablefieldæ·»åŠ æ³¨è§£" aria-hidden="true">#</a> 3ã€å®ä½“ç±»<code>@TableField</code>æ·»åŠ æ³¨è§£</h6><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.entity.SpuInfoEntity</code>å®ä½“ç±»çš„<code>createTime</code>å’Œ<code>updateTime</code>å­—æ®µæ·»åŠ <code>@TableField</code>æ³¨è§£,æµ‹è¯•æ—¶è‚¯å®šä¼šæŠ¥é”™ï¼Œè¿™é‡Œæƒ³çœ‹ä¸€ä¸‹ä¼šæŠ¥ä»€ä¹ˆé”™(å¦‚æœä½¿ç”¨çš„æ˜¯<code>new Date()</code>å°±ä¸ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”è¿˜ä¼šå¾—åˆ°æ­£ç¡®çš„ç»“æœ)</p><p>(å¦‚æœæ˜¯MetaObjectHandleré…ç½®ç±»ä½¿ç”¨çš„æ˜¯LocalDateTimeç±»å‹ è¦åŠ @DateTimeFormatä¸åŠ è¿™ä¸ªæ³¨è§£æŸ¥è¯¢çš„æ—¶å€™ä¼šæŠ¥é”™)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 1ã€å¦‚æœæ˜¯MetaObjectHandleré…ç½®ç±»ä½¿ç”¨çš„æ˜¯LocalDateTimeç±»å‹ è¦åŠ @DateTimeFormatä¸åŠ è¿™ä¸ªæ³¨è§£æŸ¥è¯¢çš„æ—¶å€™ä¼šæŠ¥é”™
 *    DateUtilä½¿ç”¨çš„æ˜¯org.springblade.core.tool.utils.DateUtil;
 *    @DateTimeFormat(pattern = DateUtil.PATTERN_DATETIME)
 *    @JsonFormat(pattern = DateUtil.PATTERN_DATETIME)
 *    @TableField(fill = FieldFill.INSERT)
 * 2ã€å¦‚æœä½¿ç”¨çš„æ˜¯ new Date() ,åˆ™åªéœ€è¦ä½¿ç”¨ @TableField(fill = FieldFill.INSERT)
 *    @TableField(fill = FieldFill.INSERT)
 */</span>
<span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>fill <span class="token operator">=</span> <span class="token class-name">FieldFill</span><span class="token punctuation">.</span><span class="token constant">INSERT</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Date</span> createTime<span class="token punctuation">;</span>
<span class="token doc-comment comment">/**
 * 
 */</span>
<span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>fill <span class="token operator">=</span> <span class="token class-name">FieldFill</span><span class="token punctuation">.</span><span class="token constant">INSERT_UPDATE</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Date</span> updateTime<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.3.png" alt="image-20220522182337080" tabindex="0" loading="lazy"><figcaption>image-20220522182337080</figcaption></figure><p>åˆ«äººçš„<code>DateUtil</code>å·¥å…·ç±»ï¼Œä¸è¿‡å®ƒä½¿ç”¨çš„æ˜¯<code>new Date()</code>æ–¹å¼ï¼Œä¸éœ€è¦è®¾ç½®<code>@DateTimeFormat</code>ï¼Œè¿™é‡Œæƒ³çœ‹ä¸€çœ‹ä¼šæŠ¥ä»€ä¹ˆé”™</p><p><a href="code/4.6.5.1.5.3.java">ç‚¹å‡»æŸ¥çœ‹<code>DateUtil</code>ç±»å®Œæ•´ä»£ç </a></p><h6 id="_4ã€ä½¿ç”¨postmanå‘é€è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_4ã€ä½¿ç”¨postmanå‘é€è¯·æ±‚" aria-hidden="true">#</a> 4ã€ä½¿ç”¨<code>Postman</code>å‘é€è¯·æ±‚</h6><p>é‡å¯<code>gulimall-product</code>æ¨¡å—,ä½¿ç”¨<code>Postman</code>å‘é€è¯·æ±‚</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.4.png" alt="image-20220522181338567" tabindex="0" loading="lazy"><figcaption>image-20220522181338567</figcaption></figure><h6 id="_5ã€æŸ¥çœ‹æŠ¥é”™" tabindex="-1"><a class="header-anchor" href="#_5ã€æŸ¥çœ‹æŠ¥é”™" aria-hidden="true">#</a> 5ã€æŸ¥çœ‹æŠ¥é”™</h6><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.reflection.ReflectionException: Could not set property &#39;createTime&#39; of &#39;class com.atguigu.gulimall.product.entity.SpuInfoEntity&#39; with value &#39;class java.time.LocalDateTime&#39; Cause: java.lang.IllegalArgumentException: argument type mismatch

org.mybatis.spring.MyBatisSystemExceptionï¼šåµŒå¥—å¼‚å¸¸æ˜¯ org.apache.ibatis.reflection.ReflectionExceptionï¼šæ— æ³•å°† &#39;class com.atguigu.gulimall.product.entity.SpuInfoEntity&#39; çš„å±æ€§&#39;createTime&#39;è®¾ç½®ä¸º&#39;class java.time&#39; .LocalDateTime&#39; åŸå› ï¼šjava.lang.IllegalArgumentExceptionï¼šå‚æ•°ç±»å‹ä¸åŒ¹é…
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.5.png" alt="image-20220522181444148" tabindex="0" loading="lazy"><figcaption>image-20220522181444148</figcaption></figure><h6 id="_6ã€googleä¸€ä¸‹è¿™ä¸ªé”™" tabindex="-1"><a class="header-anchor" href="#_6ã€googleä¸€ä¸‹è¿™ä¸ªé”™" aria-hidden="true">#</a> 6ã€<code>google</code>ä¸€ä¸‹è¿™ä¸ªé”™</h6><p><code>stackoverflow</code>ä¸Šè¯´éœ€è¦ä½¿ç”¨<code>DateTimeFormatter.ISO_LOCAL_DATE_TIME</code></p><p>https://stackoverflow.com/questions/57972766/java-lang-illegalargumentexception-platform-class-java-time-localdatetime-with</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.6.png" alt="image-20220522181635099" tabindex="0" loading="lazy"><figcaption>image-20220522181635099</figcaption></figure><h6 id="_7ã€å±æ€§å€¼å¿…é¡»æ˜¯å¸¸é‡" tabindex="-1"><a class="header-anchor" href="#_7ã€å±æ€§å€¼å¿…é¡»æ˜¯å¸¸é‡" aria-hidden="true">#</a> 7ã€å±æ€§å€¼å¿…é¡»æ˜¯å¸¸é‡</h6><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.entity.SpuInfoEntity</code>ç±»çš„<code>createTime</code>æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£<code>@DateTimeFormat(pattern = DateTimeFormatter.ISO_LOCAL_DATE_TIME)</code>æç¤º<code>Attribute value must be constant</code></p><p>åˆ æ‰è¿™ä¸ªæ³¨è§£ï¼Œæµ‹è¯•ä¸€ä¸‹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.7.png" alt="image-20220522181946429" tabindex="0" loading="lazy"><figcaption>image-20220522181946429</figcaption></figure><h6 id="_8ã€æµ‹è¯•æ—¥æœŸæ ¼å¼" tabindex="-1"><a class="header-anchor" href="#_8ã€æµ‹è¯•æ—¥æœŸæ ¼å¼" aria-hidden="true">#</a> 8ã€æµ‹è¯•æ—¥æœŸæ ¼å¼</h6><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.GulimallProductApplicationTests</code>ç±»æ·»åŠ <code>DateTimeFormatterTest</code>æµ‹è¯•æ–¹æ³•ï¼Œè¿›è¡Œæµ‹è¯•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">DateTimeFormatterTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token class-name">DateTimeFormatter</span> formatter <span class="token operator">=</span> <span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token constant">ISO_LOCAL_DATE_TIME</span><span class="token punctuation">;</span>
   <span class="token class-name">LocalDateTime</span> localDateTime <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–å½“å‰æ—¶é—´</span>
   <span class="token class-name">String</span> str <span class="token operator">=</span> formatter<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>localDateTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>localDateTime<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2022-01-24T11:06:34.473</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•ç»“æœ:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>2022-05-22T18:30:59:498
2022-05-22T18:30:59:498
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.8.1.png" alt="image-20220522193641644" tabindex="0" loading="lazy"><figcaption>image-20220522193641644</figcaption></figure><p>å‚è€ƒé“¾æ¥ï¼š https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html</p><p><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.8.2.png" alt="image-20220522193704482" loading="lazy">ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.GulimallProductApplicationTests</code>ç±»çš„<code>DateTimeFormatterTest</code>æµ‹è¯•æ–¹æ³•ï¼Œé‡æ–°è¿›è¡Œæµ‹è¯•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">DateTimeFormatterTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token class-name">DateTimeFormatter</span> formatter1 <span class="token operator">=</span> <span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token constant">ISO_LOCAL_DATE_TIME</span><span class="token punctuation">;</span>
   <span class="token class-name">LocalDateTime</span> localDateTime1 <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–å½“å‰æ—¶é—´</span>
   <span class="token class-name">String</span> str1 <span class="token operator">=</span> formatter1<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>localDateTime1<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>localDateTime1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2022-01-24T11:06:34.473</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;==========================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">DateTimeFormatter</span> formatter2 <span class="token operator">=</span> <span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-ddTHH:mm:ss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">LocalDateTime</span> localDateTime2 <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–å½“å‰æ—¶é—´</span>
   <span class="token class-name">String</span> str2 <span class="token operator">=</span> formatter2<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>localDateTime2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>localDateTime2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•å¤±è´¥äº†ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>java.lang.IllegalArgumentException: Unknown pattern letter: T
java.lang.IllegalArgumentExceptionï¼šæœªçŸ¥æ¨¡å¼å­—æ¯ï¼šT
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.8.3.png" alt="image-20220522194537130" tabindex="0" loading="lazy"><figcaption>image-20220522194537130</figcaption></figure><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.GulimallProductApplicationTests</code>ç±»çš„<code>DateTimeFormatterTest</code>æµ‹è¯•æ–¹æ³•ï¼Œé‡æ–°è¿›è¡Œæµ‹è¯•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">DateTimeFormatterTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token class-name">DateTimeFormatter</span> formatter1 <span class="token operator">=</span> <span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token constant">ISO_LOCAL_DATE_TIME</span><span class="token punctuation">;</span>
   <span class="token class-name">LocalDateTime</span> localDateTime1 <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–å½“å‰æ—¶é—´</span>
   <span class="token class-name">String</span> str1 <span class="token operator">=</span> formatter1<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>localDateTime1<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>localDateTime1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2022-01-24T11:06:34.473</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;==========================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">DateTimeFormatter</span> formatter2 <span class="token operator">=</span> <span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">LocalDateTime</span> localDateTime2 <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–å½“å‰æ—¶é—´</span>
   <span class="token class-name">String</span> str2 <span class="token operator">=</span> formatter2<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>localDateTime2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>localDateTime2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºçš„æ ¼å¼è¿˜æ˜¯ä¸å¯¹ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>2022-05-22T19:46:24.884
2022-05-22T19:46:24.884
==========================
2022-05-22T19:46:24.886
2022-05-22T19:46:24
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.8.4.png" alt="image-20220522194710291" tabindex="0" loading="lazy"><figcaption>image-20220522194710291</figcaption></figure><p>æŸ¥çœ‹<code>DateTimeFormatter.ISO_LOCAL_DATE_TIME</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.8.5.png" alt="image-20220522195349302" tabindex="0" loading="lazy"><figcaption>image-20220522195349302</figcaption></figure><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.entity.SpuInfoEntity</code>å®ä½“ç±»çš„<code>createTime</code>å’Œ<code>updateTime</code>å­—æ®µä¸Šæ·»åŠ æ³¨è§£ï¼Œé‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œä½¿ç”¨<code>Postman</code>å‘é€è¯·æ±‚åï¼Œè¿˜æ˜¯æŠ¥é”™</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 1ã€å¦‚æœæ˜¯MetaObjectHandleré…ç½®ç±»ä½¿ç”¨çš„æ˜¯LocalDateTimeç±»å‹ è¦åŠ @DateTimeFormatä¸åŠ è¿™ä¸ªæ³¨è§£æŸ¥è¯¢çš„æ—¶å€™ä¼šæŠ¥é”™
 *       DateUtilä½¿ç”¨çš„æ˜¯org.springblade.core.tool.utils.DateUtil;
 *    @DateTimeFormat(pattern = DateUtil.PATTERN_DATETIME)
 *    @JsonFormat(pattern = DateUtil.PATTERN_DATETIME)
 *    @TableField(fill = FieldFill.INSERT)
 * 2ã€å¦‚æœä½¿ç”¨çš„æ˜¯ new Date() ,åˆ™åªéœ€è¦ä½¿ç”¨ @TableField(fill = FieldFill.INSERT)
 *       @TableField(fill = FieldFill.INSERT)
 */</span>
<span class="token annotation punctuation">@DateTimeFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>fill <span class="token operator">=</span> <span class="token class-name">FieldFill</span><span class="token punctuation">.</span><span class="token constant">INSERT</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Date</span> createTime<span class="token punctuation">;</span>
<span class="token doc-comment comment">/**
 * 
 */</span>
<span class="token annotation punctuation">@DateTimeFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>fill <span class="token operator">=</span> <span class="token class-name">FieldFill</span><span class="token punctuation">.</span><span class="token constant">INSERT_UPDATE</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Date</span> updateTime<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.8.6.png" alt="image-20220522195303101" tabindex="0" loading="lazy"><figcaption>image-20220522195303101</figcaption></figure><h6 id="_9ã€æœ€ç»ˆæ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#_9ã€æœ€ç»ˆæ–¹æ¡ˆ" aria-hidden="true">#</a> 9ã€æœ€ç»ˆæ–¹æ¡ˆ</h6><p>è¿˜æ˜¯ä½¿ç”¨äº†æœ€åˆåº”è¯¥ä½¿ç”¨çš„æ–¹æ³•</p><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.config.MyMetaObjectHandler</code>ç±»</p><p>å°†<code> LocalDateTime.class</code>å…¨éƒ¨ä¿®æ”¹ä¸º<code>new Date()</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>handlers<span class="token punctuation">.</span></span><span class="token class-name">MetaObjectHandler</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>reflection<span class="token punctuation">.</span></span><span class="token class-name">MetaObject</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/22
 * @Description:
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyMetaObjectHandler</span> <span class="token keyword">implements</span> <span class="token class-name">MetaObjectHandler</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insertFill</span><span class="token punctuation">(</span><span class="token class-name">MetaObject</span> metaObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;start insert fill...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//this.setFieldValByName(&quot;createTime&quot;, new Date(), metaObject);</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setFieldValByName</span><span class="token punctuation">(</span><span class="token string">&quot;createTime&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setFieldValByName</span><span class="token punctuation">(</span><span class="token string">&quot;updateTime&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateFill</span><span class="token punctuation">(</span><span class="token class-name">MetaObject</span> metaObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;start update fill...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setFieldValByName</span><span class="token punctuation">(</span><span class="token string">&quot;updateTime&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.9.1.png" alt="image-20220522201105155" tabindex="0" loading="lazy"><figcaption>image-20220522201105155</figcaption></figure><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œä½¿ç”¨<code>Postman</code>å‘é€è¯·æ±‚</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.9.2.png" alt="image-20220522201604822" tabindex="0" loading="lazy"><figcaption>image-20220522201604822</figcaption></figure><p><code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.entity.SpuInfoEntity</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">FieldFill</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableField</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableName</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">JsonFormat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>format<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">DateTimeFormat</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * spuä¿¡æ¯
 * 
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@email</span> 2185180175@qq.com
 * <span class="token keyword">@date</span> 2022-04-17 18:19:58
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span><span class="token string">&quot;pms_spu_info&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpuInfoEntity</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>

   <span class="token doc-comment comment">/**
    * å•†å“id
    */</span>
   <span class="token annotation punctuation">@TableId</span>
   <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * å•†å“åç§°
    */</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> spuName<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * å•†å“æè¿°
    */</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> spuDescription<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * æ‰€å±åˆ†ç±»id
    */</span>
   <span class="token keyword">private</span> <span class="token class-name">Long</span> catalogId<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * å“ç‰Œid
    */</span>
   <span class="token keyword">private</span> <span class="token class-name">Long</span> brandId<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * 
    */</span>
   <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> weight<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * ä¸Šæ¶çŠ¶æ€[0 - ä¸‹æ¶ï¼Œ1 - ä¸Šæ¶]
    */</span>
   <span class="token keyword">private</span> <span class="token class-name">Integer</span> publishStatus<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * 1ã€å¦‚æœæ˜¯MetaObjectHandleré…ç½®ç±»ä½¿ç”¨çš„æ˜¯LocalDateTimeç±»å‹ è¦åŠ @DateTimeFormatä¸åŠ è¿™ä¸ªæ³¨è§£æŸ¥è¯¢çš„æ—¶å€™ä¼šæŠ¥é”™
    *       DateUtilä½¿ç”¨çš„æ˜¯org.springblade.core.tool.utils.DateUtil;
    *    @DateTimeFormat(pattern = DateUtil.PATTERN_DATETIME)
    *    @JsonFormat(pattern = DateUtil.PATTERN_DATETIME)
    *    @TableField(fill = FieldFill.INSERT)
    * 2ã€å¦‚æœä½¿ç”¨çš„æ˜¯ new Date() ,åˆ™åªéœ€è¦ä½¿ç”¨ @TableField(fill = FieldFill.INSERT)
    *       @TableField(fill = FieldFill.INSERT)
    */</span>
   <span class="token annotation punctuation">@DateTimeFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span>
   <span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span>
   <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>fill <span class="token operator">=</span> <span class="token class-name">FieldFill</span><span class="token punctuation">.</span><span class="token constant">INSERT</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">Date</span> createTime<span class="token punctuation">;</span>
   <span class="token doc-comment comment">/**
    * 
    */</span>
   <span class="token annotation punctuation">@DateTimeFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span>
   <span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span>
   <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>fill <span class="token operator">=</span> <span class="token class-name">FieldFill</span><span class="token punctuation">.</span><span class="token constant">INSERT_UPDATE</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">Date</span> updateTime<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹åˆ°æ’å…¥åˆ°æ—¶é—´ç²¾ç¡®åˆ°äº†<code>æ¯«ç§’</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.9.3.png" alt="image-20220522201403809" tabindex="0" loading="lazy"><figcaption>image-20220522201403809</figcaption></figure><p>æŸ¥çœ‹æ•°æ®åº“,æ•°æ®åº“çš„æ—¶é—´ç²¾ç¡®åˆ°äº†<code>ç§’</code>(å››èˆäº”å…¥)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.9.4.png" alt="image-20220522201644762" tabindex="0" loading="lazy"><figcaption>image-20220522201644762</figcaption></figure><p>åˆ æ‰<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.entity.SpuInfoEntity</code>ç±»<code>createTime</code>å­—æ®µå’Œ<code>updateTime</code>å­—æ®µä¸Šçš„<code>@DateTimeFormat</code>å’Œ<code>@JsonFormat</code>æ³¨è§£</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.9.5.png" alt="image-20220522201719091" tabindex="0" loading="lazy"><figcaption>image-20220522201719091</figcaption></figure><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œé‡æ–°ä½¿ç”¨<code>Postman</code>å‘é€è¯·æ±‚ï¼Œæ§åˆ¶å°è¿˜æ˜¯ç²¾ç¡®åˆ°<code>æ¯«ç§’</code>,æ•°æ®åº“è¿˜æ˜¯ç²¾ç¡®åˆ°<code>ç§’</code>(å››èˆäº”å…¥)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.9.7.png" alt="image-20220522201908544" tabindex="0" loading="lazy"><figcaption>image-20220522201908544</figcaption></figure><p>æˆªæ–­<code>gulimall_pms</code>æ¨¡å—çš„<code>pms_spu_info</code>ï¼Œåˆ é™¤æ•°æ®å¹¶ä½¿<code>id</code>é‡æ–°ä»<code>1</code>å¼€å§‹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.5.9.8.png" alt="image-20220522212108872" tabindex="0" loading="lazy"><figcaption>image-20220522212108872</figcaption></figure><h5 id="_6ã€ä¿®æ”¹savesouinfoä¸ºsavespuinfo" tabindex="-1"><a class="header-anchor" href="#_6ã€ä¿®æ”¹savesouinfoä¸ºsavespuinfo" aria-hidden="true">#</a> 6ã€ä¿®æ”¹<code>saveSouInfo</code>ä¸º<code>saveSpuInfo</code></h5><p>ä¿®æ”¹<code>saveSouInfo</code>ä¸º<code>saveSpuInfo</code>ï¼Œä¹‹å‰è¿™ä¸ªæ–¹æ³•åå†™é”™äº†</p><p>åŒå‡»é€‰ä¸­<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»çš„<code>saveSpuInfo</code>æ–¹æ³•</p><p>å³é”®é€‰æ‹©<code>Find Usages</code>ï¼ŒæŸ¥çœ‹å“ªäº›ç±»è°ƒç”¨äº†è¯¥æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.6.1.png" alt="image-20220522225959312" tabindex="0" loading="lazy"><figcaption>image-20220522225959312</figcaption></figure><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.SpuInfoController</code>ç±»çš„<code>save</code>æ–¹æ³•é‡Œï¼Œ</p><p>æŠŠ<code>saveSouInfo</code>ä¿®æ”¹ä¸º<code>saveSpuInfo</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.6.2.png" alt="image-20220522221105775" tabindex="0" loading="lazy"><figcaption>image-20220522221105775</figcaption></figure><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.SpuInfoService</code>æ¥å£é‡Œï¼ŒæŠŠ<code>saveSouInfo</code>æŠ½è±¡æ–¹æ³•ä¿®æ”¹ä¸º<code>saveSpuInfo</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.6.3.png" alt="image-20220522221206062" tabindex="0" loading="lazy"><figcaption>image-20220522221206062</figcaption></figure><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»é‡ŒæŠŠ<code>saveSpuInfo</code>æ–¹æ³•æ”¹ä¸º<code>saveSpuInfo</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.1.6.4.png" alt="image-20220522230202137" tabindex="0" loading="lazy"><figcaption>image-20220522230202137</figcaption></figure><h4 id="_4-6-5-2ã€ä¿å­˜spuçš„æè¿°ä¿¡æ¯pms-spu-info-desc" tabindex="-1"><a class="header-anchor" href="#_4-6-5-2ã€ä¿å­˜spuçš„æè¿°ä¿¡æ¯pms-spu-info-desc" aria-hidden="true">#</a> 4.6.5.2ã€ä¿å­˜Spuçš„æè¿°ä¿¡æ¯<code>pms_spu_info_desc</code></h4><h5 id="_1ã€è°ƒç”¨savespuinfodescæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€è°ƒç”¨savespuinfodescæ–¹æ³•" aria-hidden="true">#</a> 1ã€è°ƒç”¨<code>saveSpuInfoDesc</code>æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»é‡Œçš„<code>saveSouInfo</code>æ–¹æ³•é‡Œç¼–å†™éƒ¨åˆ†ä»£ç ï¼Œç”¨äºä¿å­˜Spuçš„æè¿°å›¾ç‰‡</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">SpuInfoDescService</span> spuInfoDescService<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveSpuInfo</span><span class="token punctuation">(</span><span class="token class-name">SpuSaveVo</span> spuSaveVo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//1ã€ä¿å­˜spuåŸºæœ¬ä¿¡æ¯ pms_spu_info</span>
    <span class="token class-name">SpuInfoEntity</span> spuInfoEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpuInfoEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>spuSaveVo<span class="token punctuation">,</span>spuInfoEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">saveBaseSpuInfo</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//2ã€ä¿å­˜Spuçš„æè¿°ä¿¡æ¯ pms_spu_info_desc</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> decript <span class="token operator">=</span> spuSaveVo<span class="token punctuation">.</span><span class="token function">getDecript</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>decript<span class="token operator">!=</span><span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> decript<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpuInfoDescEntity</span> spuInfoDescEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpuInfoDescEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//this.saveBaseSpuInfo(spuInfoEntity);æ‰§è¡Œåï¼Œä¼šå°†ç”Ÿæˆçš„idèµ‹å€¼åˆ°puInfoDescEntityçš„spuIdé‡Œ</span>
        spuInfoDescEntity<span class="token punctuation">.</span><span class="token function">setSpuId</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å°†List&lt;String&gt;è½¬ä¸ºStringï¼Œç”¨é€—å·åˆ†éš”</span>
        spuInfoDescEntity<span class="token punctuation">.</span><span class="token function">setDecript</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span> decript<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        spuInfoDescService<span class="token punctuation">.</span><span class="token function">saveSpuInfoDesc</span><span class="token punctuation">(</span>spuInfoDescEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.2.1.png" alt="image-20220523001135275" tabindex="0" loading="lazy"><figcaption>image-20220523001135275</figcaption></figure><h5 id="_2ã€åˆ›å»ºsavespuinfodescæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€åˆ›å»ºsavespuinfodescæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 2ã€åˆ›å»º<code>saveSpuInfoDesc</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.SpuInfoDescService</code>æ¥å£é‡Œæ·»åŠ <code>saveSpuInfoDesc</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">saveSpuInfoDesc</span><span class="token punctuation">(</span><span class="token class-name">SpuInfoDescEntity</span> spuInfoDescEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoDescServiceImpl</code>ç±»é‡Œå®ç°<code>saveSpuInfoDesc</code>æŠ½è±¡æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.2.2.gif" alt="GIF 2022-5-23 0-13-40" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-23 0-13-40</figcaption></figure><h5 id="_3ã€ä¿®æ”¹savespuinfodescæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹savespuinfodescæ–¹æ³•" aria-hidden="true">#</a> 3ã€ä¿®æ”¹<code>saveSpuInfoDesc</code>æ–¹æ³•</h5><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoDescServiceImpl</code>ç±»é‡Œçš„<code>saveSpuInfoDesc</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveSpuInfoDesc</span><span class="token punctuation">(</span><span class="token class-name">SpuInfoDescEntity</span> spuInfoDescEntity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>baseMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>spuInfoDescEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.2.3.png" alt="image-20220522224957138" tabindex="0" loading="lazy"><figcaption>image-20220522224957138</figcaption></figure><h4 id="_4-6-5-3ã€ä¿å­˜spuçš„å›¾ç‰‡é›†pms-spu-images" tabindex="-1"><a class="header-anchor" href="#_4-6-5-3ã€ä¿å­˜spuçš„å›¾ç‰‡é›†pms-spu-images" aria-hidden="true">#</a> 4.6.5.3ã€ä¿å­˜spuçš„å›¾ç‰‡é›†<code>pms_spu_images</code></h4><h5 id="_1ã€è°ƒç”¨saveimagesæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1ã€è°ƒç”¨saveimagesæ–¹æ³•" aria-hidden="true">#</a> 1ã€è°ƒç”¨<code>saveImages</code>æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»é‡Œçš„<code>saveSouInfo</code>æ–¹æ³•é‡Œç¼–å†™éƒ¨åˆ†ä»£ç ï¼Œç”¨äºä¿å­˜Spuçš„å›¾ç‰‡é›†</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">SpuInfoDescService</span> spuInfoDescService<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">SpuImagesService</span> spuImagesService<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveSpuInfo</span><span class="token punctuation">(</span><span class="token class-name">SpuSaveVo</span> spuSaveVo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//1ã€ä¿å­˜spuåŸºæœ¬ä¿¡æ¯ pms_spu_info</span>
    <span class="token class-name">SpuInfoEntity</span> spuInfoEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpuInfoEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>spuSaveVo<span class="token punctuation">,</span>spuInfoEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">saveBaseSpuInfo</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//2ã€ä¿å­˜Spuçš„æè¿°å›¾ç‰‡ pms_spu_info_desc</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> decript <span class="token operator">=</span> spuSaveVo<span class="token punctuation">.</span><span class="token function">getDecript</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>decript<span class="token operator">!=</span><span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> decript<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpuInfoDescEntity</span> spuInfoDescEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpuInfoDescEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        spuInfoDescEntity<span class="token punctuation">.</span><span class="token function">setSpuId</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        spuInfoDescEntity<span class="token punctuation">.</span><span class="token function">setDecript</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span> decript<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        spuInfoDescService<span class="token punctuation">.</span><span class="token function">saveSpuInfoDesc</span><span class="token punctuation">(</span>spuInfoDescEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//3ã€ä¿å­˜spuçš„å›¾ç‰‡é›† pms_spu_images</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> images <span class="token operator">=</span> spuSaveVo<span class="token punctuation">.</span><span class="token function">getImages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>images<span class="token operator">!=</span><span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> images<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        spuImagesService<span class="token punctuation">.</span><span class="token function">saveImages</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> images<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.3.1.png" alt="image-20220523201222020" tabindex="0" loading="lazy"><figcaption>image-20220523201222020</figcaption></figure><h5 id="_2ã€æ·»åŠ saveimagesæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ saveimagesæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 2ã€æ·»åŠ <code>saveImages</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.SpuImagesService</code>ç±»é‡Œæ·»åŠ <code>saveImages</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">saveImages</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> images<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuImagesServiceImpl</code>ç±»å®ç°<code>saveImages</code>æŠ½è±¡æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.3.2.gif" alt="GIF 2022-5-23 20-13-04" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-23 20-13-04</figcaption></figure><h5 id="_3ã€å®ç°saveimagesæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€å®ç°saveimagesæ–¹æ³•" aria-hidden="true">#</a> 3ã€å®ç°<code>saveImages</code>æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuImagesServiceImpl</code>ç±»é‡Œçš„<code>saveImages</code>æ–¹æ³•æ·»åŠ å…·ä½“å®ç°</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ‰¹é‡ä¿å­˜å›¾ç‰‡
 * <span class="token keyword">@param</span> <span class="token parameter">id</span>        spuId
 * <span class="token keyword">@param</span> <span class="token parameter">images</span>    å›¾ç‰‡é›†çš„url
 */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveImages</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> images<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>images<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SpuImagesEntity</span><span class="token punctuation">&gt;</span></span> spuImagesEntities <span class="token operator">=</span> images<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>image <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpuImagesEntity</span> spuImagesEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpuImagesEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        spuImagesEntity<span class="token punctuation">.</span><span class="token function">setSpuId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        spuImagesEntity<span class="token punctuation">.</span><span class="token function">setImgUrl</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> spuImagesEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">saveBatch</span><span class="token punctuation">(</span>spuImagesEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.3.3.png" alt="image-20220523202313469" tabindex="0" loading="lazy"><figcaption>image-20220523202313469</figcaption></figure><h4 id="_4-6-5-4ã€ä¿å­˜spuçš„è§„æ ¼å‚æ•°pms-product-attr-value" tabindex="-1"><a class="header-anchor" href="#_4-6-5-4ã€ä¿å­˜spuçš„è§„æ ¼å‚æ•°pms-product-attr-value" aria-hidden="true">#</a> 4.6.5.4ã€ä¿å­˜spuçš„è§„æ ¼å‚æ•°<code>pms_product_attr_value</code></h4><h5 id="_1ã€ç§æœ‰è®¿é—®æƒé™æ— æ³•è®¿é—®" tabindex="-1"><a class="header-anchor" href="#_1ã€ç§æœ‰è®¿é—®æƒé™æ— æ³•è®¿é—®" aria-hidden="true">#</a> 1ã€ç§æœ‰è®¿é—®æƒé™æ— æ³•è®¿é—®</h5><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token string">&#39;com.atguigu.gulimall.product.vo.SpuSaveVo.BaseAttrs&#39;</span> has private access <span class="token keyword">in</span> <span class="token string">&#39;com.atguigu.gulimall.product.vo.SpuSaveVo&#39;</span>

<span class="token string">&#39;com.atguigu.gulimall.product.vo.SpuSaveVo.BaseAttrs&#39;</span> åœ¨ <span class="token string">&#39;com.atguigu.gulimall.product.vo.SpuSaveVo&#39;</span> ä¸­å…·æœ‰ç§æœ‰è®¿é—®æƒé™
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.4.1.png" alt="image-20220523204943855" tabindex="0" loading="lazy"><figcaption>image-20220523204943855</figcaption></figure><h5 id="_2ã€å°†spusavevoçš„å†…éƒ¨ç±»éƒ½æ”¹ä¸ºå…¬æœ‰" tabindex="-1"><a class="header-anchor" href="#_2ã€å°†spusavevoçš„å†…éƒ¨ç±»éƒ½æ”¹ä¸ºå…¬æœ‰" aria-hidden="true">#</a> 2ã€å°†<code>SpuSaveVo</code>çš„å†…éƒ¨ç±»éƒ½æ”¹ä¸ºå…¬æœ‰</h5><p>å°†<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo.SpuSaveVo</code>ç±»çš„æ‰€æœ‰å†…éƒ¨ç±»çš„è®¿é—®æƒé™éƒ½æ”¹ä¸º<code>public</code></p><p><a href="code/4.6.5.4.2.SpuSaveVo.java">ç‚¹å‡»æŸ¥çœ‹<code>SpuSaveVo</code>ç±»å®Œæ•´ä»£ç </a></p><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.4.2.png" alt="image-20220523204847342" style="zoom:33%;"><h5 id="_3ã€è°ƒç”¨saveproductattræ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€è°ƒç”¨saveproductattræ–¹æ³•" aria-hidden="true">#</a> 3ã€è°ƒç”¨<code>saveProductAttr</code>æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»é‡Œçš„<code>saveSouInfo</code>æ–¹æ³•é‡Œç¼–å†™éƒ¨åˆ†ä»£ç ï¼Œä¿å­˜spuçš„è§„æ ¼å‚æ•°</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">SpuInfoDescService</span> spuInfoDescService<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">SpuImagesService</span> spuImagesService<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">AttrService</span> attrService<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">ProductAttrValueService</span> productAttrValueService<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveSpuInfo</span><span class="token punctuation">(</span><span class="token class-name">SpuSaveVo</span> spuSaveVo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//1ã€ä¿å­˜spuåŸºæœ¬ä¿¡æ¯ pms_spu_info</span>
    <span class="token class-name">SpuInfoEntity</span> spuInfoEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpuInfoEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>spuSaveVo<span class="token punctuation">,</span>spuInfoEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">saveBaseSpuInfo</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//2ã€ä¿å­˜Spuçš„æè¿°å›¾ç‰‡ pms_spu_info_desc</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> decript <span class="token operator">=</span> spuSaveVo<span class="token punctuation">.</span><span class="token function">getDecript</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>decript<span class="token operator">!=</span><span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> decript<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpuInfoDescEntity</span> spuInfoDescEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpuInfoDescEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        spuInfoDescEntity<span class="token punctuation">.</span><span class="token function">setSpuId</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        spuInfoDescEntity<span class="token punctuation">.</span><span class="token function">setDecript</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span> decript<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        spuInfoDescService<span class="token punctuation">.</span><span class="token function">saveSpuInfoDesc</span><span class="token punctuation">(</span>spuInfoDescEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//3ã€ä¿å­˜spuçš„å›¾ç‰‡é›† pms_spu_images</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> images <span class="token operator">=</span> spuSaveVo<span class="token punctuation">.</span><span class="token function">getImages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>images<span class="token operator">!=</span><span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> images<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        spuImagesService<span class="token punctuation">.</span><span class="token function">saveImages</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> images<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//4ã€ä¿å­˜spuçš„è§„æ ¼å‚æ•°ï¼›pms_product_attr_value</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SpuSaveVo<span class="token punctuation">.</span>BaseAttrs</span><span class="token punctuation">&gt;</span></span> baseAttrs <span class="token operator">=</span> spuSaveVo<span class="token punctuation">.</span><span class="token function">getBaseAttrs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>baseAttrs<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductAttrValueEntity</span><span class="token punctuation">&gt;</span></span> productAttrValueEntities <span class="token operator">=</span> baseAttrs<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>attr <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">ProductAttrValueEntity</span> productAttrValueEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProductAttrValueEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            productAttrValueEntity<span class="token punctuation">.</span><span class="token function">setSpuId</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                productAttrValueEntity<span class="token punctuation">.</span><span class="token function">setAttrId</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                productAttrValueEntity<span class="token punctuation">.</span><span class="token function">setAttrValue</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                productAttrValueEntity<span class="token punctuation">.</span><span class="token function">setQuickShow</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getShowDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">AttrEntity</span> attrEntity <span class="token operator">=</span> attrService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span><span class="token function">getAttrId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>attrEntity <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    productAttrValueEntity<span class="token punctuation">.</span><span class="token function">setAttrName</span><span class="token punctuation">(</span>attrEntity<span class="token punctuation">.</span><span class="token function">getAttrName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> productAttrValueEntity<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        productAttrValueService<span class="token punctuation">.</span><span class="token function">saveProductAttr</span><span class="token punctuation">(</span>productAttrValueEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.4.3.png" alt="image-20220523211034830" tabindex="0" loading="lazy"><figcaption>image-20220523211034830</figcaption></figure><h5 id="_4ã€æ·»åŠ saveproductattræŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ saveproductattræŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>saveProductAttr</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.ProductAttrValueService</code>ç±»é‡Œæ·»åŠ <code>saveProductAttr</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">saveProductAttr</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductAttrValueEntity</span><span class="token punctuation">&gt;</span></span> productAttrValueEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.ProductAttrValueServiceImpl</code>ç±»é‡Œå®ç°<code>saveProductAttr</code>æŠ½è±¡æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.4.4.gif" alt="GIF 2022-5-23 21-11-06" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-23 21-11-06</figcaption></figure><h5 id="_5ã€å®ç°saveproductattræŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€å®ç°saveproductattræŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 5ã€å®ç°<code>saveProductAttr</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.ProductAttrValueServiceImpl</code>ç±»é‡Œçš„<code>saveProductAttr</code>æ–¹æ³•é‡Œæ·»åŠ å…·ä½“å®ç°</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveProductAttr</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductAttrValueEntity</span><span class="token punctuation">&gt;</span></span> productAttrValueEntities<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">saveBatch</span><span class="token punctuation">(</span>productAttrValueEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.4.5.png" alt="image-20220523211149789" tabindex="0" loading="lazy"><figcaption>image-20220523211149789</figcaption></figure><h4 id="_4-6-5-5ã€ä¿å­˜å½“å‰spuå¯¹åº”çš„æ‰€æœ‰skuä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_4-6-5-5ã€ä¿å­˜å½“å‰spuå¯¹åº”çš„æ‰€æœ‰skuä¿¡æ¯" aria-hidden="true">#</a> 4.6.5.5ã€ä¿å­˜å½“å‰spuå¯¹åº”çš„æ‰€æœ‰skuä¿¡æ¯</h4><h5 id="_1ã€å¤åˆ¶skuçš„ä¿¡æ¯åˆ°skuinfoentity" tabindex="-1"><a class="header-anchor" href="#_1ã€å¤åˆ¶skuçš„ä¿¡æ¯åˆ°skuinfoentity" aria-hidden="true">#</a> 1ã€å¤åˆ¶<code>sku</code>çš„ä¿¡æ¯åˆ°<code>skuInfoEntity</code></h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.ProductAttrValueServiceImpl</code>ç±»é‡Œçš„<code>saveProductAttr</code>æ–¹æ³•é‡Œå¤åˆ¶<code>sku</code>çš„ä¿¡æ¯åˆ°<code>skuInfoEntity</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.5.1.png" alt="image-20220523213603802" tabindex="0" loading="lazy"><figcaption>image-20220523213603802</figcaption></figure><h5 id="_2ã€æŸ¥çœ‹å¯ä»¥å¤åˆ¶çš„å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹å¯ä»¥å¤åˆ¶çš„å­—æ®µ" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹å¯ä»¥å¤åˆ¶çš„å­—æ®µ</h5><p>æ¯”å¯¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo.SpuSaveVo.Skus</code>ç±»</p><p>å’Œ<code>com.atguigu.gulimall.product.entity.SkuInfoEntity</code>ç±»</p><p>å¯ä»¥çœ‹åˆ°<code>skuName</code>ã€<code>price</code>ã€<code>skuTitle</code>ã€<code>skuSubtitle</code>è¿™äº›å­—æ®µå¯ä»¥æ‹·è´</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.5.2.png" alt="image-20220523213242536" tabindex="0" loading="lazy"><figcaption>image-20220523213242536</figcaption></figure><h5 id="_3ã€ä¿å­˜skuçš„åŸºæœ¬ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿å­˜skuçš„åŸºæœ¬ä¿¡æ¯" aria-hidden="true">#</a> 3ã€ä¿å­˜skuçš„åŸºæœ¬ä¿¡æ¯</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.ProductAttrValueServiceImpl</code>ç±»é‡Œçš„<code>saveProductAttr</code>æ–¹æ³•é‡Œä¿å­˜skuçš„åŸºæœ¬ä¿¡æ¯,è°ƒç”¨<code>skuImagesService</code>ç±»çš„<code>saveBatch</code>æ–¹æ³•</p><p><a href="code/4.6.5.5.3.SpuInfoServiceImpl.java">ç‚¹å‡»æŸ¥çœ‹<code>SpuInfoServiceImpl</code>ç±»å®Œæ•´ä»£ç </a></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.5.3.png" alt="image-20220523221527652" tabindex="0" loading="lazy"><figcaption>image-20220523221527652</figcaption></figure><h5 id="_4ã€æ·»åŠ saveskuinfoæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ saveskuinfoæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>saveSkuInfo</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.SkuInfoService</code>æ¥å£æ·»åŠ <code>saveSkuInfo</code>æŠ½è±¡æ–¹æ³•</p><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SkuInfoServiceImpl</code>ç±»é‡Œå®ç°<code>saveSkuInfo</code>æŠ½è±¡æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.5.4.gif" alt="GIF 2022-5-23 22-17-54" tabindex="0" loading="lazy"><figcaption>GIF 2022-5-23 22-17-54</figcaption></figure><h5 id="_5ã€å®ç°saveskuinfoæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€å®ç°saveskuinfoæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 5ã€å®ç°<code>saveSkuInfo</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SkuInfoServiceImpl</code>ç±»é‡Œçš„<code>saveSkuInfo</code>æ–¹æ³•é‡Œæ·»åŠ å…·ä½“å®ç°</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.5.5.png" alt="image-20220523221930967" tabindex="0" loading="lazy"><figcaption>image-20220523221930967</figcaption></figure><h5 id="_6ã€æ‰¹é‡ä¿å­˜skuçš„å›¾ç‰‡ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_6ã€æ‰¹é‡ä¿å­˜skuçš„å›¾ç‰‡ä¿¡æ¯" aria-hidden="true">#</a> 6ã€æ‰¹é‡ä¿å­˜skuçš„å›¾ç‰‡ä¿¡æ¯</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.ProductAttrValueServiceImpl</code>ç±»é‡Œçš„<code>saveProductAttr</code>æ–¹æ³•é‡Œè°ƒç”¨<code>skuImagesService</code>å¯¹è±¡çš„<code>saveBatch</code>æ–¹æ³•ï¼Œæ‰¹é‡ä¿å­˜skuçš„å›¾ç‰‡ä¿¡æ¯</p><p><a href="code/4.6.5.5.6.SpuInfoServiceImpl.java">ç‚¹å‡»æŸ¥çœ‹<code>SpuInfoServiceImpl</code>ç±»å®Œæ•´ä»£ç </a></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.5.6.png" alt="image-20220523223744919" tabindex="0" loading="lazy"><figcaption>image-20220523223744919</figcaption></figure><h5 id="_7ã€æ‰¹é‡ä¿å­˜skuçš„é”€å”®å±æ€§ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_7ã€æ‰¹é‡ä¿å­˜skuçš„é”€å”®å±æ€§ä¿¡æ¯" aria-hidden="true">#</a> 7ã€æ‰¹é‡ä¿å­˜skuçš„é”€å”®å±æ€§ä¿¡æ¯</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.ProductAttrValueServiceImpl</code>ç±»é‡Œçš„<code>saveProductAttr</code>æ–¹æ³•é‡Œè°ƒç”¨<code>skuSaleAttrValueService</code>å¯¹è±¡çš„<code>saveBatch</code>æ–¹æ³•ï¼Œæ‰¹é‡ä¿å­˜skuçš„é”€å”®å±æ€§ä¿¡æ¯</p><p><a href="code/4.6.5.5.7.SpuInfoServiceImpl.java">ç‚¹å‡»æŸ¥çœ‹<code>SpuInfoServiceImpl</code>ç±»å®Œæ•´ä»£ç </a></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.5.5.7.png" alt="image-20220523230155354" tabindex="0" loading="lazy"><figcaption>image-20220523230155354</figcaption></figure><h3 id="_4-6-6ã€è°ƒç”¨è¿œç¨‹æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_4-6-6ã€è°ƒç”¨è¿œç¨‹æœåŠ¡" aria-hidden="true">#</a> 4.6.6ã€è°ƒç”¨è¿œç¨‹æœåŠ¡</h3><h4 id="_1ã€è°ƒç”¨è¿œç¨‹æœåŠ¡æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#_1ã€è°ƒç”¨è¿œç¨‹æœåŠ¡æ­¥éª¤" aria-hidden="true">#</a> 1ã€è°ƒç”¨è¿œç¨‹æœåŠ¡æ­¥éª¤</h4><ol><li>æœåŠ¡åŒæ–¹ä¸Šçº¿ï¼Œå¹¶ä¸”æ”¾åˆ°æ³¨å†Œä¸­å¿ƒä¸­</li><li>æœåŠ¡åŒæ–¹å¼€å¯æœåŠ¡æ³¨å†Œå’Œå‘ç°åŠŸèƒ½(<code>@EnableDiscoveryClient</code>)</li><li>æœåŠ¡æ¶ˆè´¹æ–¹ç¼–å†™<code>feign</code>æ¥å£ï¼Œåœ¨æ¥å£å£°æ˜è°ƒç”¨<code>å“ªä¸ªæœåŠ¡</code>(<code>@FeignClient</code>)çš„<code>å“ªä¸ªæ¥å£</code>(<code>@RequestMapping</code>)</li><li>æœåŠ¡æ¶ˆè´¹æ–¹å¼€å¯è¿œç¨‹è°ƒç”¨åŠŸèƒ½(<code>@EnableFeignClients</code>)</li></ol><h4 id="_2ã€ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯" aria-hidden="true">#</a> 2ã€ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»çš„<code>saveSpuInfo</code>æ–¹æ³•ï¼Œæƒ³è¦ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯ï¼Œå³ä¿®æ”¹<code>gulimall_sms</code>æ•°æ®åº“çš„<code>sms_spu_bounds</code>è¡¨</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.2.0.1.png" alt="image-20220601114158761" tabindex="0" loading="lazy"><figcaption>image-20220601114158761</figcaption></figure><p>æ­¤æ—¶éœ€è¦è¿œç¨‹è°ƒç”¨<code>gulimall-coupon</code>æ¨¡å—çš„<code>com.atguigu.gulimall.coupon.controller.SpuBoundsController</code>ç±»çš„<code>save</code>æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.2.0.2.png" alt="image-20220601114238502" tabindex="0" loading="lazy"><figcaption>image-20220601114238502</figcaption></figure><h5 id="_1ã€æ–°å»ºcouponfeignserviceç±»" tabindex="-1"><a class="header-anchor" href="#_1ã€æ–°å»ºcouponfeignserviceç±»" aria-hidden="true">#</a> 1ã€æ–°å»º<code>CouponFeignService</code>ç±»</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product</code>åŒ…ä¸‹æ–°å»º<code>feign</code>æ–‡ä»¶å¤¹</p><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.feign</code>åŒ…é‡Œæ–°å»º<code>CouponFeignService</code>ç±»</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.2.1.png" alt="image-20220601121222193" tabindex="0" loading="lazy"><figcaption>image-20220601121222193</figcaption></figure><h5 id="_2ã€å¼€å¯è¿œç¨‹è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#_2ã€å¼€å¯è¿œç¨‹è°ƒç”¨" aria-hidden="true">#</a> 2ã€å¼€å¯è¿œç¨‹è°ƒç”¨</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„å¯åŠ¨ç±»<code>GulimallProductApplication</code>ä¸Šæ·»åŠ æ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableFeignClients</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">&quot;com.atguigu.gulimall.product.feign&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.2.2.png" alt="image-20220601121502104" tabindex="0" loading="lazy"><figcaption>image-20220601121502104</figcaption></figure><h5 id="_3ã€æ–°å»ºspuboundtoç±»" tabindex="-1"><a class="header-anchor" href="#_3ã€æ–°å»ºspuboundtoç±»" aria-hidden="true">#</a> 3ã€æ–°å»º<code>SpuBoundTo</code>ç±»</h5><p>åœ¨<code>gulimall-common</code>æ¨¡å—çš„<code>com.atguigu.common</code>åŒ…ä¸‹æ–°å»º<code>to</code>æ–‡ä»¶å¤¹</p><p>åœ¨<code>gulimall-common</code>æ¨¡å—çš„<code>com.atguigu.common.to</code>åŒ…ä¸‹æ–°å»º<code>SpuBoundTo</code>ç±»ç”¨äºè¿œç¨‹è°ƒç”¨<code>gulimall-coupon</code>æ¨¡å—çš„<code>com.atguigu.gulimall.coupon.controller.SpuBoundsController</code>ç±»çš„<code>save</code>æ–¹æ³•æ—¶ä¼ è¾“å¯¹è±¡æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.2.3.png" alt="image-20220601121411961" tabindex="0" loading="lazy"><figcaption>image-20220601121411961</figcaption></figure><h5 id="_4ã€ä¿®æ”¹è¯·æ±‚æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿®æ”¹è¯·æ±‚æ–¹å¼" aria-hidden="true">#</a> 4ã€ä¿®æ”¹è¯·æ±‚æ–¹å¼</h5><p>åœ¨<code>gulimall-coupon</code>æ¨¡å—é‡Œä¿®æ”¹<code>com.atguigu.gulimall.coupon.controller.SpuBoundsController</code>ç±»çš„<code>save</code>çš„è¯·æ±‚æ–¹å¼ä¸º<code>@PostMapping</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>  <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/save&quot;</span><span class="token punctuation">)</span>
      <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SpuBoundsEntity</span> spuBounds<span class="token punctuation">)</span><span class="token punctuation">{</span>
spuBoundsService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>spuBounds<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.2.4.png" alt="image-20220601122053306" tabindex="0" loading="lazy"><figcaption>image-20220601122053306</figcaption></figure><h5 id="_5ã€æ·»åŠ savespuboundsæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€æ·»åŠ savespuboundsæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 5ã€æ·»åŠ <code>saveSpuBounds</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.feign.CouponFeignService</code>æ¥å£æ¥é‡Œæ·»åŠ <code>saveSpuBounds</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>feign</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>common<span class="token punctuation">.</span>to<span class="token punctuation">.</span></span><span class="token class-name">SpuBoundTo</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>common<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">R</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">FeignClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PostMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestBody</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/6/1
 * @Description:
 */</span>
<span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span><span class="token string">&quot;gulimall-coupon&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CouponFeignService</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * 1ã€CouponFeignService . saveSpuBounds(spuBoundTo);
     *   1)ã€@RequestBodyå°†è¿™ä¸ªå¯¹è±¡è½¬ä¸ºjsonã€‚
     *   2)ã€æ‰¾åˆ°gul imall-couponæœåŠ¡ï¼Œ ç»™/coupon/spubounds/saveå‘é€è¯·æ±‚ã€‚
     *       å°†ä¸Šä¸€æ­¥è½¬çš„jsonæ”¾åœ¨è¯·æ±‚ä½“ä½ç½®ï¼Œå‘é€è¯·æ±‚;
     *   3)ã€å¯¹æ–¹æœåŠ¡æ”¶åˆ°è¯·æ±‚ã€‚è¯·æ±‚ä½“é‡Œæœ‰jsonæ•°æ®ã€‚
     *       (@RequestBody SpuBoundsEntity spuBounds );å°†è¯·æ±‚ä½“çš„jsonè½¬ä¸ºSpuBoundsEntity;
     * åªè¦isonæ•°æ®æ¨¡å‹æ˜¯å…¼å®¹çš„ã€‚åŒæ–¹æœåŠ¡æ— éœ€ä½¿ç”¨åŒä¸€ä¸ªto
     * <span class="token keyword">@param</span> <span class="token parameter">spuBoundTo</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/coupon/spubounds/save&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">R</span> <span class="token function">saveSpuBounds</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SpuBoundTo</span> spuBoundTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.5.png" alt="image-20220601122610199" tabindex="0" loading="lazy"><figcaption>image-20220601122610199</figcaption></figure><h5 id="_6ã€ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_6ã€ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯" aria-hidden="true">#</a> 6ã€ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.ProductAttrValueServiceImpl</code>ç±»é‡Œçš„<code>saveProductAttr</code>æ–¹æ³•é‡Œè°ƒç”¨<code>couponFeignService</code>å¯¹è±¡çš„<code>saveSpuBounds</code>æ–¹æ³•ï¼Œç”¨äºä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">CouponFeignService</span> couponFeignService<span class="token punctuation">;</span>

<span class="token comment">//5ã€ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯; gulimall_sms-&gt;sms_spu_bounds</span>
<span class="token class-name">SpuSaveVo<span class="token punctuation">.</span>Bounds</span> bounds <span class="token operator">=</span> spuSaveVo<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SpuBoundTo</span> spuBoundTo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpuBoundTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>bounds<span class="token punctuation">,</span>spuBoundTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
spuBoundTo<span class="token punctuation">.</span><span class="token function">setSpuId</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
couponFeignService<span class="token punctuation">.</span><span class="token function">saveSpuBounds</span><span class="token punctuation">(</span>spuBoundTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.2.6.png" alt="image-20220601122753256" tabindex="0" loading="lazy"><figcaption>image-20220601122753256</figcaption></figure><h4 id="_3ã€ä¿å­˜skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿å­˜skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯" aria-hidden="true">#</a> 3ã€ä¿å­˜skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯</h4><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.3.0.png" alt="image-20220601123339903" tabindex="0" loading="lazy"><figcaption>image-20220601123339903</figcaption></figure><h5 id="_1ã€æ–°å»ºskureductiontoç±»" tabindex="-1"><a class="header-anchor" href="#_1ã€æ–°å»ºskureductiontoç±»" aria-hidden="true">#</a> 1ã€æ–°å»º<code>SkuReductionTo</code>ç±»</h5><p>å¤åˆ¶<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.vo.SpuSaveVo</code>ç±»çš„è¿™äº›å±æ€§å’Œ<code>MemberPrice</code>å†…éƒ¨ç±»</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.3.1.1.png" alt="image-20220601123703015" tabindex="0" loading="lazy"><figcaption>image-20220601123703015</figcaption></figure><p>åœ¨<code>gulimall-common</code>æ¨¡å—æ–°å»º<code>com.atguigu.common.to</code>åŒ…ä¸‹æ–°å»º<code>SkuReductionTo</code>ç±»ï¼Œç²˜è´´åˆšåˆšå¤åˆ¶çš„<code>SpuSaveVo</code>ç±»çš„å±æ€§å’Œ<code>MemberPrice</code>å†…éƒ¨ç±»,å†æ·»åŠ <code>skuId</code>å­—æ®µ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>common<span class="token punctuation">.</span>to</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/6/1
 * @Description:
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SkuReductionTo</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> skuId<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * æ»¡å‡ ä»¶æ‰“å‡ æŠ˜
     * countStatus: æ˜¯å¦å¯ä»¥å åŠ ä¼˜æƒ 
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> fullCount<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> discount<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> countStatus<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * æ»¡å¤šå°‘å‡å¤šå°‘
     * priceStatusï¼šæ˜¯å¦å¯ä»¥å åŠ ä¼˜æƒ 
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> fullPrice<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> reducePrice<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> priceStatus<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * ä¼šå‘˜ä»·æ ¼
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MemberPrice</span><span class="token punctuation">&gt;</span></span> memberPrice<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Data</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MemberPrice</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> price<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.3.1.2.png" alt="image-20220601124110777" tabindex="0" loading="lazy"><figcaption>image-20220601124110777</figcaption></figure><h5 id="_2ã€è°ƒç”¨gulimall-couponæœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_2ã€è°ƒç”¨gulimall-couponæœåŠ¡" aria-hidden="true">#</a> 2ã€è°ƒç”¨<code>gulimall-coupon</code>æœåŠ¡</h5><p>å†<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»çš„<code>saveSpuInfo</code>æ–¹æ³•é‡Œæ·»åŠ ä»£ç ï¼Œè°ƒç”¨<code>gulimall-coupon</code>æœåŠ¡ï¼Œç”¨äºä¿å­˜<code>skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//5.4)ã€skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯ï¼›gulimall_sms-&gt;sms_sku_ladder\\sms_sku_full_reduction\\sms_ member_price</span>
<span class="token class-name">SkuReductionTo</span> skuReductionTo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkuReductionTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>sku<span class="token punctuation">,</span>skuReductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
skuReductionTo<span class="token punctuation">.</span><span class="token function">setSkuId</span><span class="token punctuation">(</span>skuId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">R</span> r1 <span class="token operator">=</span> couponFeignService<span class="token punctuation">.</span><span class="token function">saveSkuReduction</span><span class="token punctuation">(</span>skuReductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.3.2.png" alt="image-20220601124401637" tabindex="0" loading="lazy"><figcaption>image-20220601124401637</figcaption></figure><h5 id="_3ã€æ·»åŠ saveskureductionæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ saveskureductionæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>saveSkuReduction</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.feign.CouponFeignService</code>æ¥å£é‡Œæ·»åŠ <code>saveSkuReduction</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">saveSkuReduction</span><span class="token punctuation">(</span><span class="token class-name">SkuReductionTo</span> skuReductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.3.3.png" alt="image-20220601150651848" tabindex="0" loading="lazy"><figcaption>image-20220601150651848</figcaption></figure><h5 id="_4ã€æ·»åŠ saveinfoæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ saveinfoæ–¹æ³•" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>saveInfo</code>æ–¹æ³•</h5><p>åœ¨<code>gulimall-coupon</code>æ¨¡å—çš„<code>com.atguigu.gulimall.coupon.service.SkuFullReductionService</code>ç±»é‡Œæ·»åŠ <code>saveInfo</code>æ–¹æ³•ï¼Œç”¨äºä¿å­˜æ»¡å‡å’ŒæŠ˜æ‰£ä¿¡æ¯</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¿å­˜æ»¡å‡å’ŒæŠ˜æ‰£ä¿¡æ¯
 */</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/saveinfo&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">saveInfo</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SkuReductionTo</span> reductionTo<span class="token punctuation">)</span><span class="token punctuation">{</span>
    skuFullReductionService<span class="token punctuation">.</span><span class="token function">saveSkuReduction</span><span class="token punctuation">(</span>reductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.3.4.png" alt="image-20220601151040320" tabindex="0" loading="lazy"><figcaption>image-20220601151040320</figcaption></figure><h5 id="_5ã€ä¿®æ”¹saveskureductionæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¿®æ”¹saveskureductionæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 5ã€ä¿®æ”¹<code>saveSkuReduction</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.feign.CouponFeignService</code>æ¥å£é‡Œä¿®æ”¹<code>saveSkuReduction</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/coupon/skufullreduction/saveinfo&quot;</span><span class="token punctuation">)</span>
<span class="token class-name">R</span> <span class="token function">saveSkuReduction</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SkuReductionTo</span> skuReductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.3.5.png" alt="image-20220601150926019" tabindex="0" loading="lazy"><figcaption>image-20220601150926019</figcaption></figure><h5 id="_6ã€æ·»åŠ saveskureductionæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_6ã€æ·»åŠ saveskureductionæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 6ã€æ·»åŠ <code>saveSkuReduction</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-coupon</code>æ¨¡å—çš„<code>com.atguigu.gulimall.coupon.service.SkuFullReductionService</code>æ¥å£é‡Œæ·»åŠ <code>saveSkuReduction</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">saveSkuReduction</span><span class="token punctuation">(</span><span class="token class-name">SkuReductionTo</span> reductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.3.6.1.png" alt="image-20220601151118002" tabindex="0" loading="lazy"><figcaption>image-20220601151118002</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.3.6.2.png" alt="image-20220601151149222" tabindex="0" loading="lazy"><figcaption>image-20220601151149222</figcaption></figure><h5 id="_7ã€å®ç°saveskureductionæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_7ã€å®ç°saveskureductionæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 7ã€å®ç°<code>saveSkuReduction</code>æŠ½è±¡æ–¹æ³•</h5><p>åœ¨<code>gulimall-coupon</code>æ¨¡å—çš„<code>com.atguigu.gulimall.coupon.service.impl.SkuFullReductionServiceImpl</code>ç±»é‡Œå®ç°<code>saveSkuReduction</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveSkuReduction</span><span class="token punctuation">(</span><span class="token class-name">SkuReductionTo</span> reductionTo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//1ã€skuçš„ ä¼˜æƒ (æ»¡å‡ ä»¶æ‰“å‡ æŠ˜) ä¿¡æ¯ï¼›gulimall_sms-&gt;sms_sku_ladder</span>
    <span class="token class-name">SkuLadderEntity</span> skuLadderEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkuLadderEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    skuLadderEntity<span class="token punctuation">.</span><span class="token function">setSkuId</span><span class="token punctuation">(</span>reductionTo<span class="token punctuation">.</span><span class="token function">getSkuId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    skuLadderEntity<span class="token punctuation">.</span><span class="token function">setFullCount</span><span class="token punctuation">(</span>reductionTo<span class="token punctuation">.</span><span class="token function">getFullCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    skuLadderEntity<span class="token punctuation">.</span><span class="token function">setDiscount</span><span class="token punctuation">(</span>reductionTo<span class="token punctuation">.</span><span class="token function">getDiscount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ˜¯å¦å¯ä»¥å åŠ ä¼˜æƒ </span>
    skuLadderEntity<span class="token punctuation">.</span><span class="token function">setAddOther</span><span class="token punctuation">(</span>reductionTo<span class="token punctuation">.</span><span class="token function">getCountStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    skuLadderService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>skuLadderEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//2ã€skuçš„ æ»¡å‡(æ»¡å¤šå°‘å‡å¤šå°‘) ä¿¡æ¯ï¼›sms_sku_full_reduction</span>
    <span class="token class-name">SkuFullReductionEntity</span> skuFullReductionEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkuFullReductionEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>reductionTo<span class="token punctuation">,</span> skuFullReductionEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    skuFullReductionEntity<span class="token punctuation">.</span><span class="token function">setAddOther</span><span class="token punctuation">(</span>reductionTo<span class="token punctuation">.</span><span class="token function">getPriceStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>skuFullReductionEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//3ã€skuçš„ æ‰“æŠ˜ ä¿¡æ¯ï¼›sms_ member_price</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SkuReductionTo<span class="token punctuation">.</span>MemberPrice</span><span class="token punctuation">&gt;</span></span> memberPrice <span class="token operator">=</span> reductionTo<span class="token punctuation">.</span><span class="token function">getMemberPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MemberPriceEntity</span><span class="token punctuation">&gt;</span></span> memberPriceEntities <span class="token operator">=</span> memberPrice<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>member <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">MemberPriceEntity</span> memberPriceEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MemberPriceEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        memberPriceEntity<span class="token punctuation">.</span><span class="token function">setSkuId</span><span class="token punctuation">(</span>reductionTo<span class="token punctuation">.</span><span class="token function">getSkuId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        memberPriceEntity<span class="token punctuation">.</span><span class="token function">setMemberLevelId</span><span class="token punctuation">(</span>member<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        memberPriceEntity<span class="token punctuation">.</span><span class="token function">setMemberLevelName</span><span class="token punctuation">(</span>member<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        memberPriceEntity<span class="token punctuation">.</span><span class="token function">setMemberPrice</span><span class="token punctuation">(</span>member<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        memberPriceEntity<span class="token punctuation">.</span><span class="token function">setAddOther</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> memberPriceEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    memberPriceService<span class="token punctuation">.</span><span class="token function">saveBatch</span><span class="token punctuation">(</span>memberPriceEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.3.7.png" alt="image-20220601153731834" tabindex="0" loading="lazy"><figcaption>image-20220601153731834</figcaption></figure><h5 id="_8ã€æ·»åŠ getcodeæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_8ã€æ·»åŠ getcodeæ–¹æ³•" aria-hidden="true">#</a> 8ã€æ·»åŠ <code>getCode</code>æ–¹æ³•</h5><p>åœ¨<code>gulimall-common</code>æ¨¡å—çš„<code>com.atguigu.common.utils.R</code>ç±»é‡Œæ·»åŠ <code>getCode</code>æ–¹æ³•,ç”¨äºè·å–çŠ¶æ€ç </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.3.8.png" alt="image-20220601154315951" tabindex="0" loading="lazy"><figcaption>image-20220601154315951</figcaption></figure><h5 id="_9ã€è·å–è¿œç¨‹è®¿é—®çš„çŠ¶æ€ç -åœ¨å¤±è´¥åè®°å½•æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#_9ã€è·å–è¿œç¨‹è®¿é—®çš„çŠ¶æ€ç -åœ¨å¤±è´¥åè®°å½•æ—¥å¿—" aria-hidden="true">#</a> 9ã€è·å–è¿œç¨‹è®¿é—®çš„çŠ¶æ€ç ï¼Œåœ¨å¤±è´¥åè®°å½•æ—¥å¿—</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»çš„<code>saveSpuInfo</code>æ–¹æ³•é‡Œé¢æ·»åŠ éƒ¨åˆ†ä»£ç ,ç”¨äºè·å–è¿œç¨‹è®¿é—®<code>gulimall-coupon</code>æ¨¡å—æ—¶è¿”å›çš„çŠ¶æ€ç ï¼Œå¹¶åœ¨å¤±è´¥åè®°å½•æ—¥å¿—</p><p>åœ¨<code>ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯</code>çš„<code>couponFeignService.saveSpuBounds(spuBoundTo);</code>æ–¹æ³•é‡Œæ¥æ”¶è¿”å›å€¼ï¼Œå¦‚æœè¿œç¨‹è®¿é—®å¤±è´¥åˆ™è®°å½•æ—¥å¿—</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//5ã€ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯; gulimall_sms-&gt;sms_spu_bounds</span>
<span class="token class-name">SpuSaveVo<span class="token punctuation">.</span>Bounds</span> bounds <span class="token operator">=</span> spuSaveVo<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SpuBoundTo</span> spuBoundTo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpuBoundTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>bounds<span class="token punctuation">,</span>spuBoundTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
spuBoundTo<span class="token punctuation">.</span><span class="token function">setSpuId</span><span class="token punctuation">(</span>spuInfoEntity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">R</span> r <span class="token operator">=</span> couponFeignService<span class="token punctuation">.</span><span class="token function">saveSpuBounds</span><span class="token punctuation">(</span>spuBoundTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>r<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;è¿œç¨‹ä¿å­˜spuç§¯åˆ†ä¿¡æ¯å¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.3.9.1.png" alt="image-20220601155006225" tabindex="0" loading="lazy"><figcaption>image-20220601155006225</figcaption></figure><p>åœ¨<code>ä¿å­˜skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯</code>çš„<code>couponFeignService.saveSkuReduction(skuReductionTo);</code>æ–¹æ³•é‡Œæ¥æ”¶è¿”å›å€¼ï¼Œå¦‚æœè¿œç¨‹è®¿é—®å¤±è´¥åˆ™è®°å½•æ—¥å¿—</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//5.4)ã€skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯ï¼›gulimall_sms-&gt;sms_sku_ladder\\sms_sku_full_reduction\\sms_ member_price</span>
<span class="token class-name">SkuReductionTo</span> skuReductionTo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkuReductionTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>sku<span class="token punctuation">,</span>skuReductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
skuReductionTo<span class="token punctuation">.</span><span class="token function">setSkuId</span><span class="token punctuation">(</span>skuId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">R</span> r1 <span class="token operator">=</span> couponFeignService<span class="token punctuation">.</span><span class="token function">saveSkuReduction</span><span class="token punctuation">(</span>skuReductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>r1<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;è¿œç¨‹ä¿å­˜skuä¼˜æƒ ä¿¡æ¯å¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.6.3.9.2.png" alt="image-20220601154858415" tabindex="0" loading="lazy"><figcaption>image-20220601154858415</figcaption></figure><p><code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»çš„å®Œæ•´ä»£ç </p><p><a href="code/4.6.6.3.9.SpuInfoServiceImpl.java">ç‚¹å‡»æŸ¥çœ‹<code>SpuInfoServiceImpl</code>ç±»å®Œæ•´ä»£ç </a></p><h3 id="_4-6-7ã€æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_4-6-7ã€æµ‹è¯•" aria-hidden="true">#</a> 4.6.7ã€æµ‹è¯•</h3><p>æµ‹è¯•ä¹‹å‰æœ€å¥½æŠŠ<code>gulimall_pms</code>æ•°æ®åº“å¤‡ä»½ä¸€ä¸‹ï¼Œå…å¾—åé¢è°ƒè¯•å‘ç°ä»£ç å†™é”™äº†ï¼Œä¸çŸ¥é“è¿™æ¬¡æ·»åŠ äº†å“ªäº›æ•°æ®ï¼Œä»è€Œå¯¼è‡´åˆ é”™æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.0.png" alt="image-20220612161346948" tabindex="0" loading="lazy"><figcaption>image-20220612161346948</figcaption></figure><h4 id="_1ã€ä¿®æ”¹é…ç½®" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿®æ”¹é…ç½®" aria-hidden="true">#</a> 1ã€ä¿®æ”¹é…ç½®</h4><h5 id="_1ã€ç‚¹å‡»edit-configurations" tabindex="-1"><a class="header-anchor" href="#_1ã€ç‚¹å‡»edit-configurations" aria-hidden="true">#</a> 1ã€ç‚¹å‡»<code>Edit Configurations...</code></h5><p>ç‚¹å‡»åŠŸèƒ½åŒºå†…è¿è¡Œç±»çš„å³è¾¹ã€è¿è¡ŒæŒ‰é’®å·¦è¾¹çš„ä¸‹ä¸‰è§’ï¼Œé€‰æ‹©<code>Edit Configurations...</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.1.1.png" alt="image-20220601155532934" tabindex="0" loading="lazy"><figcaption>image-20220601155532934</figcaption></figure><h5 id="_2ã€æ–°å»ºcompound" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å»ºcompound" aria-hidden="true">#</a> 2ã€æ–°å»º<code>Compound</code></h5><p>ç‚¹å‡»å¼¹å‡ºçš„<code>Run/Debug Configurations</code>æ¡†é‡Œå·¦ä¸Šè§’çš„<code>+</code>å·ï¼Œåœ¨ä¸‹æ–¹çš„æ¡†é‡Œé€‰æ‹©<code>Compound</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.1.2.png" alt="image-20220601155708909" tabindex="0" loading="lazy"><figcaption>image-20220601155708909</figcaption></figure><h5 id="_3ã€åœ¨compoundé‡Œæ·»åŠ å„ä¸ªæ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_3ã€åœ¨compoundé‡Œæ·»åŠ å„ä¸ªæ¨¡å—" aria-hidden="true">#</a> 3ã€åœ¨<code>Compound</code>é‡Œæ·»åŠ å„ä¸ªæ¨¡å—</h5><p>åœ¨æ–°å»ºçš„<code>Compound</code>é‡Œé¢çš„å³è¾¹çš„æ¡†çš„å·¦ä¸Šè§’ç‚¹å‡»<code>+</code>å·ï¼ŒæŠŠä¸‹é¢è¿™äº›æœåŠ¡æ·»åŠ è¿›æ¥</p><ol><li>GulimallCouponApplication</li><li>GulimallGatewayApplication</li><li>GulimallMemberApplication</li><li>GulimallProductApplication</li><li>GulimallThirdPartyApplication</li><li>RenrenApplication</li></ol><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.1.3.png" alt="image-20220601155949929" tabindex="0" loading="lazy"><figcaption>image-20220601155949929</figcaption></figure><h5 id="_4ã€ä¿®æ”¹æ¨¡å—æœ€å¤§å†…å­˜å ç”¨" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿®æ”¹æ¨¡å—æœ€å¤§å†…å­˜å ç”¨" aria-hidden="true">#</a> 4ã€ä¿®æ”¹æ¨¡å—æœ€å¤§å†…å­˜å ç”¨</h5><h6 id="_1ã€ç‚¹å‡»ç¼–è¾‘æŒ‰é’®" tabindex="-1"><a class="header-anchor" href="#_1ã€ç‚¹å‡»ç¼–è¾‘æŒ‰é’®" aria-hidden="true">#</a> 1ã€ç‚¹å‡»ç¼–è¾‘æŒ‰é’®</h6><p>ç‚¹å‡»<code>Spring Boot&#39;GulimallCouponApplication&#39;</code>ï¼Œç„¶åç‚¹å‡»<code>Compound</code>é‡Œé¢çš„å³è¾¹çš„æ¡†çš„å·¦ä¸Šè§’çš„ç¼–è¾‘æŒ‰é’®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.1.4.1.png" alt="image-20220601160037029" tabindex="0" loading="lazy"><figcaption>image-20220601160037029</figcaption></figure><h6 id="_2ã€é™åˆ¶å•ä¸ªæ¨¡å—æœ€å¤§å†…å­˜" tabindex="-1"><a class="header-anchor" href="#_2ã€é™åˆ¶å•ä¸ªæ¨¡å—æœ€å¤§å†…å­˜" aria-hidden="true">#</a> 2ã€é™åˆ¶å•ä¸ªæ¨¡å—æœ€å¤§å†…å­˜</h6><p>åœ¨<code>GulimallCouponApplication</code>æ¨¡å—çš„è¿è¡Œé…ç½®é‡Œçš„<code>Environment</code>æ çš„<code>VM options</code>é‡Œçš„å³æ–¹æ¡†é‡Œè¾“å…¥<code>-Xmx100m</code>ï¼Œé™åˆ¶<code>GulimallCouponApplication</code>æ¨¡å—çš„æœ€å¤§å†…å­˜å ç”¨ä¸º<code>100m</code></p><p>åŒç†ä¿®æ”¹å…¶ä»–7ä¸ªæ¨¡å—çš„æœ€å¤§å†…å­˜å ç”¨</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>-Xmx100m
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.1.4.2.png" alt="image-20220601160256195" tabindex="0" loading="lazy"><figcaption>image-20220601160256195</figcaption></figure><p>åœ¨<code>GulimallGatewayApplication</code>æ¨¡å—çš„è¿è¡Œé…ç½®é‡Œçš„<code>Environment</code>æ çš„<code>VM options</code>é‡Œçš„å³æ–¹æ¡†é‡Œè¾“å…¥<code>-Xmx100m</code>ï¼Œé™åˆ¶<code>GulimallGatewayApplication</code>æ¨¡å—çš„æœ€å¤§å†…å­˜å ç”¨ä¸º<code>100m</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.1.4.3.png" alt="image-20220601160348699" tabindex="0" loading="lazy"><figcaption>image-20220601160348699</figcaption></figure><p>åœ¨<code>GulimallMemberApplication</code>æ¨¡å—çš„è¿è¡Œé…ç½®é‡Œçš„<code>Environment</code>æ çš„<code>VM options</code>é‡Œçš„å³æ–¹æ¡†é‡Œè¾“å…¥<code>-Xmx100m</code>ï¼Œé™åˆ¶<code>GulimallMemberApplication</code>æ¨¡å—çš„æœ€å¤§å†…å­˜å ç”¨ä¸º<code>100m</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.1.4.4.png" alt="image-20220601160419110" tabindex="0" loading="lazy"><figcaption>image-20220601160419110</figcaption></figure><p>åœ¨<code>GulimallOrderApplication</code>æ¨¡å—çš„è¿è¡Œé…ç½®é‡Œçš„<code>Environment</code>æ çš„<code>VM options</code>é‡Œçš„å³æ–¹æ¡†é‡Œè¾“å…¥<code>-Xmx100m</code>ï¼Œé™åˆ¶<code>GulimallOrderApplication</code>æ¨¡å—çš„æœ€å¤§å†…å­˜å ç”¨ä¸º<code>100m</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.1.4.5.png" alt="image-20220601160507405" tabindex="0" loading="lazy"><figcaption>image-20220601160507405</figcaption></figure><p>åœ¨<code>GulimallProductApplication</code>æ¨¡å—çš„è¿è¡Œé…ç½®é‡Œçš„<code>Environment</code>æ çš„<code>VM options</code>é‡Œçš„å³æ–¹æ¡†é‡Œè¾“å…¥<code>-Xmx100m</code>ï¼Œé™åˆ¶<code>GulimallProductApplication</code>æ¨¡å—çš„æœ€å¤§å†…å­˜å ç”¨ä¸º<code>100m</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.1.4.6.png" alt="image-20220601160536846" tabindex="0" loading="lazy"><figcaption>image-20220601160536846</figcaption></figure><p>åœ¨<code>GulimallThirdPartyApplication</code>æ¨¡å—çš„è¿è¡Œé…ç½®é‡Œçš„<code>Environment</code>æ çš„<code>VM options</code>é‡Œçš„å³æ–¹æ¡†é‡Œè¾“å…¥<code>-Xmx100m</code>ï¼Œé™åˆ¶<code>GulimallThirdPartyApplication</code>æ¨¡å—çš„æœ€å¤§å†…å­˜å ç”¨ä¸º<code>100m</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.1.4.7.png" alt="image-20220601160602726" tabindex="0" loading="lazy"><figcaption>image-20220601160602726</figcaption></figure><p>åœ¨<code>GulimallWareApplication</code>æ¨¡å—çš„è¿è¡Œé…ç½®é‡Œçš„<code>Environment</code>æ çš„<code>VM options</code>é‡Œçš„å³æ–¹æ¡†é‡Œè¾“å…¥<code>-Xmx100m</code>ï¼Œé™åˆ¶<code>GulimallWareApplication</code>æ¨¡å—çš„æœ€å¤§å†…å­˜å ç”¨ä¸º<code>100m</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.1.4.8.png" alt="image-20220601160630466" tabindex="0" loading="lazy"><figcaption>image-20220601160630466</figcaption></figure><p>åœ¨<code>RenrenApplication</code>æ¨¡å—çš„è¿è¡Œé…ç½®é‡Œçš„<code>Environment</code>æ çš„<code>VM options</code>é‡Œçš„å³æ–¹æ¡†é‡Œè¾“å…¥<code>-Xmx100m</code>ï¼Œé™åˆ¶<code>RenrenApplication</code>æ¨¡å—çš„æœ€å¤§å†…å­˜å ç”¨ä¸º<code>100m</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.1.4.9.png" alt="image-20220601160655782" tabindex="0" loading="lazy"><figcaption>image-20220601160655782</figcaption></figure><h4 id="_2ã€æ·»åŠ æ–­ç‚¹" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ æ–­ç‚¹" aria-hidden="true">#</a> 2ã€æ·»åŠ æ–­ç‚¹</h4><h5 id="_1ã€æ‰“æ–­ç‚¹-1" tabindex="-1"><a class="header-anchor" href="#_1ã€æ‰“æ–­ç‚¹-1" aria-hidden="true">#</a> 1ã€æ‰“æ–­ç‚¹</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»çš„<code>saveSpuInfo</code>æ–¹æ³•çš„å¼€å¤´æ‰“ä¸€ä¸ªæ–­ç‚¹ï¼Œç”¨äºæµ‹è¯•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.1.png" alt="image-20220611235807652" tabindex="0" loading="lazy"><figcaption>image-20220611235807652</figcaption></figure><h5 id="_2ã€æ‰“å¼€run-dashboard" tabindex="-1"><a class="header-anchor" href="#_2ã€æ‰“å¼€run-dashboard" aria-hidden="true">#</a> 2ã€æ‰“å¼€<code>Run Dashboard</code></h5><h6 id="_1ã€æ²¡æœ‰run-dashboardé€‰é¡¹" tabindex="-1"><a class="header-anchor" href="#_1ã€æ²¡æœ‰run-dashboardé€‰é¡¹" aria-hidden="true">#</a> 1ã€æ²¡æœ‰<code>Run Dashboard</code>é€‰é¡¹</h6><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.2.1.png" alt="image-20220606232040208" tabindex="0" loading="lazy"><figcaption>image-20220606232040208</figcaption></figure><h6 id="_2ã€æ·»åŠ ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ ç»„ä»¶" aria-hidden="true">#</a> 2ã€æ·»åŠ ç»„ä»¶</h6><p>åœ¨<code>gulimall\\.idea\\workspace.xml</code>é‡Œæ·»åŠ ç»„ä»¶</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>RunDashboard<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>configurationTypes<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SpringBootApplicationConfigurationType<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>set</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ruleStates<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RuleState</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ConfigurationTypeDashboardGroupingRule<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RuleState</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RuleState</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>StatusDashboardGroupingRule<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RuleState</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.2.2.png" alt="image-20220606232154637" tabindex="0" loading="lazy"><figcaption>image-20220606232154637</figcaption></figure><h6 id="_3ã€æ·»åŠ çš„ç»„ä»¶è¢«åˆ é™¤äº†" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ çš„ç»„ä»¶è¢«åˆ é™¤äº†" aria-hidden="true">#</a> 3ã€æ·»åŠ çš„ç»„ä»¶è¢«åˆ é™¤äº†</h6><p>ç‚¹åˆ«çš„æ–‡ä»¶ï¼Œåœ¨è¿”å›<code>gulimall\\.idea\\workspace.xml</code>å‘ç°ï¼Œåˆšåˆšæ·»åŠ çš„ç»„ä»¶è¢«åˆ é™¤äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.2.3.png" alt="image-20220606232544250" tabindex="0" loading="lazy"><figcaption>image-20220606232544250</figcaption></figure><h6 id="_4ã€æ”¹æˆservicesäº†" tabindex="-1"><a class="header-anchor" href="#_4ã€æ”¹æˆservicesäº†" aria-hidden="true">#</a> 4ã€æ”¹æˆ<code>Services</code>äº†ğŸ˜¥</h6><p>æˆ‘è¿™ä¸ªç‰ˆæœ¬çš„IDEAå·²ç»æŠŠ<code>Run Dashboard</code>æ”¹æˆ<code>Services</code>äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.2.4.png" alt="image-20220606232751462" tabindex="0" loading="lazy"><figcaption>image-20220606232751462</figcaption></figure><h5 id="_3ã€ä»¥debugæ–¹å¼å¯åŠ¨gulimallproductapplicationæ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_3ã€ä»¥debugæ–¹å¼å¯åŠ¨gulimallproductapplicationæ¨¡å—" aria-hidden="true">#</a> 3ã€ä»¥<code>debug</code>æ–¹å¼å¯åŠ¨<code>GulimallProductApplication</code>æ¨¡å—</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.3.png" alt="image-20220606232934382" tabindex="0" loading="lazy"><figcaption>image-20220606232934382</figcaption></figure><h5 id="_4ã€å‘é€è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_4ã€å‘é€è¯·æ±‚" aria-hidden="true">#</a> 4ã€å‘é€è¯·æ±‚</h5><p>ä½¿ç”¨<code>Postman</code>å‘é€ä»¥å‰æ–°å¢å•†å“æ—¶(ä¿å­˜çš„æœ‰<code>json</code>æ•°æ®)çš„é‚£ä¸ªè¯·æ±‚</p><p>urlï¼šhttp://localhost:88/api/product/spuinfo/save</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.4.1.png" alt="image-20220606235141570" tabindex="0" loading="lazy"><figcaption>image-20220606235141570</figcaption></figure><p>ç„¶åç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œç›´åˆ°æ‰§è¡Œ<code>this.saveBaseSpuInfo(spuInfoEntity);</code>æ–¹æ³•å®Œæ¯•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.4.2.png" alt="image-20220612160514320" tabindex="0" loading="lazy"><figcaption>image-20220612160514320</figcaption></figure><h5 id="_5ã€ä¿®æ”¹äº‹åŠ¡éš”ç¦»çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¿®æ”¹äº‹åŠ¡éš”ç¦»çº§åˆ«" aria-hidden="true">#</a> 5ã€ä¿®æ”¹äº‹åŠ¡éš”ç¦»çº§åˆ«</h5><p>æŸ¥çœ‹<code>gulimall_pms</code>æ•°æ®åº“çš„<code>pms_sou_info</code>è¡¨,å‘ç°å¹¶æ²¡æœ‰æ•°æ®ï¼Œè¿™æ˜¯å› ä¸ºäº‹åŠ¡æ²¡æœ‰æäº¤ï¼Œå¯ä»¥ä¿®æ”¹å½“å‰ä¼šè¯çš„éš”ç¦»çº§åˆ«ä¸º<code>è¯»æœªæäº¤</code>è¿™æ ·å°±å¯ä»¥çœ‹åˆ°è¿˜æœªæäº¤çš„æ•°æ®äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.5.1.png" alt="image-20220606234532035" tabindex="0" loading="lazy"><figcaption>image-20220606234532035</figcaption></figure><p>//è¿™ä¸ª<code>isolation</code>å°‘äº†ä¸€ä¸ª<code>o</code>ï¼Œæœç„¶ç™¾åº¦çš„ä¸œè¥¿ä¸é è°±</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>set session transaction isolatin level READ UNCOMMITTED;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¿™ä¸ªæ˜¯æ­£ç¡®çš„</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>set session transaction isolation level read uncommitted;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.5.2.png" alt="image-20220606234716582" tabindex="0" loading="lazy"><figcaption>image-20220606234716582</figcaption></figure><p>é‡æ–°åˆ·æ–°<code>gulimall_pms</code>æ•°æ®åº“ä¸‹çš„<code>pms_spu_info</code>è¡¨ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æœ‰æ•°æ®äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.5.5.png" alt="image-20220607000248976" tabindex="0" loading="lazy"><figcaption>image-20220607000248976</figcaption></figure><h5 id="ğŸ“-å¦‚æœæ²¡æœ‰æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ğŸ“-å¦‚æœæ²¡æœ‰æ•°æ®" aria-hidden="true">#</a> ğŸ“ å¦‚æœæ²¡æœ‰æ•°æ®</h5><p>å¦‚æœé‡æ–°åˆ·æ–°å‘ç°è¿˜æ²¡æœ‰ï¼Œè¿™æ˜¯navicateè½¯ä»¶çš„é—®é¢˜ğŸ˜¥</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.5.3.png" alt="image-20220607000740209" tabindex="0" loading="lazy"><figcaption>image-20220607000740209</figcaption></figure><p>é€‰ä¸­<code>gulimall_pms</code>æ•°æ®åº“ï¼Œå³é”®é€‰æ‹©<code>æ–°å»ºæŸ¥è¯¢</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.5.5.png" alt="image-20220606235935459" tabindex="0" loading="lazy"><figcaption>image-20220606235935459</figcaption></figure><p>åœ¨æ–°åˆ›å»ºçš„å¯¹è¯æ¡†å†…è¾“å…¥å¦‚ä¸‹è¯­å¥ï¼ŒæŸ¥çœ‹<code>pms_spu_info</code>è¡¨ï¼Œç‚¹å‡»<code>è¿è¡Œ</code></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT * FROM pms_spu_info;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.5.6.png" alt="image-20220607000040075" tabindex="0" loading="lazy"><figcaption>image-20220607000040075</figcaption></figure><p>æˆ–è€…ç›´æ¥åœ¨è®¾ç½®<code>å½“å‰ä¼šè¯äº‹åŠ¡éš”ç¦»çº§åˆ«</code>çš„å‘½ä»¤è¡Œç•Œé¢é‡Œæ‰§è¡Œä¹Ÿè¡Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.2.5.7.png" alt="image-20220607000145379" tabindex="0" loading="lazy"><figcaption>image-20220607000145379</figcaption></figure><h4 id="_3ã€spu-idå¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#_3ã€spu-idå¼‚å¸¸" aria-hidden="true">#</a> 3ã€spu_idå¼‚å¸¸</h4><h5 id="_1ã€æŠ¥äº†ä¸ªå¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#_1ã€æŠ¥äº†ä¸ªå¼‚å¸¸" aria-hidden="true">#</a> 1ã€æŠ¥äº†ä¸ªå¼‚å¸¸</h5><p>ç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œç›´åˆ°æ‰§è¡Œ<code>this.saveBaseSpuInfo(spuInfoEntity);</code>æ–¹æ³•å®Œæ¯•</p><p>åœ¨æ‰§è¡Œ<code>this.saveBaseSpuInfo(spuInfoEntity);</code>æ–¹æ³•çš„æ—¶å€™ï¼ŒæŠ›äº†ä¸ªå¼‚å¸¸</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Error updating database.  Cause: java.sql.SQLException: Field &#39;spu_id&#39; doesn&#39;t have a default value
æ›´æ–°æ•°æ®åº“æ—¶å‡ºé”™ã€‚ åŸå› ï¼šjava.sql.SQLExceptionï¼šå­—æ®µ &#39;spu_id&#39; æ²¡æœ‰é»˜è®¤å€¼
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.3.1.png" alt="image-20220612162902508" tabindex="0" loading="lazy"><figcaption>image-20220612162902508</figcaption></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œä»£ç æ˜æ˜è®¾ç½®äº†<code>spuId</code>å’Œ<code>descipt</code>ï¼Œä½†æ˜¯æ‰§è¡Œçš„<code>sql</code>è¯­å¥å´åªæ’å…¥äº†<code>descipt</code>å­—æ®µ</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>INSERT INTO pms_spu_info_desc ( decript ) VALUES ( ? ) 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_2ã€æŸ¥çœ‹pms-spu-info-descè¡¨ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹pms-spu-info-descè¡¨ç»“æ„" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹<code>pms_spu_info_desc</code>è¡¨ç»“æ„</h5><p>æŸ¥çœ‹<code>gulimall_pns</code>æ•°æ®åº“çš„<code>pms_spu_info_desc</code>è¡¨çš„è¡¨ç»“æ„</p><p>é€‰ä¸­<code>gulimall_pns</code>æ•°æ®åº“çš„<code>pms_spu_info_desc</code>è¡¨ï¼Œå³é”®é€‰æ‹©<code>è®¾è®¡è¡¨</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.3.2.1.png" alt="image-20220612163500782" tabindex="0" loading="lazy"><figcaption>image-20220612163500782</figcaption></figure><p>å¯ä»¥çœ‹åˆ°<code>spu_id</code>å­—æ®µä¸æ˜¯<strong>è‡ªåŠ¨é€’å¢</strong>çš„,è¿™ä¸ªå­—æ®µæ˜¯spuçš„idï¼Œæ˜¯éœ€è¦æŒ‡å®šçš„</p><p>è€Œ<code>mybatis</code>å½“æˆäº†è‡ªå¢çš„ï¼Œæ‰€ä»¥æ’å…¥çš„æ—¶å€™åªæ’å…¥äº†<code>descipt</code>å­—æ®µï¼Œæ‰€ä»¥å°±æŠ›äº†ä¸ªå¼‚å¸¸</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.3.2.2.png" alt="image-20220612163540243" tabindex="0" loading="lazy"><figcaption>image-20220612163540243</figcaption></figure><h5 id="_3ã€ä¿®æ”¹spuinfodescentityç±»çš„å­—æ®µæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹spuinfodescentityç±»çš„å­—æ®µæ³¨è§£" aria-hidden="true">#</a> 3ã€ä¿®æ”¹<code>SpuInfoDescEntity</code>ç±»çš„å­—æ®µæ³¨è§£</h5><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.entity.SpuInfoDescEntity</code>ç±»çš„<code>spuId</code>å­—æ®µçš„<code>@TableId</code>æ³¨è§£ä¸Šæ·»åŠ å‚æ•°ï¼ŒæŒ‡å‡ºidä¸ºè¾“å…¥çš„</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span><span class="token constant">INPUT</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Long</span> spuId<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.3.3.png" alt="image-20220612164332539" tabindex="0" loading="lazy"><figcaption>image-20220612164332539</figcaption></figure><h5 id="_4ã€é‡æ–°æµ‹è¯•-5" tabindex="-1"><a class="header-anchor" href="#_4ã€é‡æ–°æµ‹è¯•-5" aria-hidden="true">#</a> 4ã€é‡æ–°æµ‹è¯•</h5><p>é‡æ–°ä»¥<code>debug</code>æ–¹å¼å¯åŠ¨<code>GulimallProductApplication</code>æ¨¡å—</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.3.4.1.png" alt="image-20220612164854483" tabindex="0" loading="lazy"><figcaption>image-20220612164854483</figcaption></figure><p>é‡æ–°åœ¨<code>Postman</code>é‡Œé¢å‘é€è¯·æ±‚</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.3.4.2.png" alt="image-20220612165111157" tabindex="0" loading="lazy"><figcaption>image-20220612165111157</figcaption></figure><p>ç»§ç»­ç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œç›´åˆ°æ‰§è¡Œ<code>this.saveBaseSpuInfo(spuInfoEntity);</code>æ–¹æ³•å®Œæ¯•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.3.4.3.png" alt="image-20220612165210715" tabindex="0" loading="lazy"><figcaption>image-20220612165210715</figcaption></figure><p>æ‰“å¼€<code>navicat</code>ï¼Œåœ¨å‘½ä»¤è¡Œé‡ŒæŸ¥è¯¢<code>pms_spu_info_desc</code>è¡¨ï¼Œå¯ä»¥çœ‹åˆ°æ‰§è¡ŒæˆåŠŸäº†</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>select <span class="token operator">*</span> from pms_spu_info_desc<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.3.4.4.png" alt="image-20220612165408926" tabindex="0" loading="lazy"><figcaption>image-20220612165408926</figcaption></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ¬¡æ‰§è¡Œçš„sqlè¯­å¥å°±æ²¡æœ‰é—®é¢˜äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.3.4.5.png" alt="image-20220612165628681" tabindex="0" loading="lazy"><figcaption>image-20220612165628681</figcaption></figure><h4 id="_4ã€ä¿å­˜spuçš„å›¾ç‰‡é›†" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿å­˜spuçš„å›¾ç‰‡é›†" aria-hidden="true">#</a> 4ã€ä¿å­˜spuçš„å›¾ç‰‡é›†</h4><p>ç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œç›´åˆ°æ‰§è¡Œ<code>spuImagesService.saveImages(spuInfoEntity.getId(), images);</code>æ–¹æ³•å®Œæ¯•</p><p>æ§åˆ¶å°å¯ä»¥çœ‹åˆ°æ’å…¥äº†å¾ˆå¤šçš„æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.4.1.png" alt="image-20220612165941643" tabindex="0" loading="lazy"><figcaption>image-20220612165941643</figcaption></figure><p>æ‰“å¼€<code>navicat</code>ï¼Œåœ¨å‘½ä»¤è¡Œé‡ŒæŸ¥è¯¢<code>pms_spu_info_desc</code>è¡¨ï¼Œå¯ä»¥çœ‹åˆ°spuçš„å›¾ç‰‡é›†å·²ç»ä¿å­˜æˆåŠŸäº†</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from pms_spu_images;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.4.2.png" alt="image-20220612170119892" tabindex="0" loading="lazy"><figcaption>image-20220612170119892</figcaption></figure><h4 id="_5ã€ä¿å­˜spuçš„è§„æ ¼å‚æ•°" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¿å­˜spuçš„è§„æ ¼å‚æ•°" aria-hidden="true">#</a> 5ã€ä¿å­˜spuçš„è§„æ ¼å‚æ•°</h4><p>åœ¨<code>productAttrValueService.saveProductAttr(productAttrValueEntities);</code>è¿™æ®µä»£ç ä¸Šæ‰“ä¸ªæ–­ç‚¹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.5.1.png" alt="image-20220612170714934" tabindex="0" loading="lazy"><figcaption>image-20220612170714934</figcaption></figure><p>ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œåˆ°<code>productAttrValueService.saveProductAttr(productAttrValueEntities);</code>è¿™æ¡è¯­å¥</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.5.2.png" alt="image-20220612171237828" tabindex="0" loading="lazy"><figcaption>image-20220612171237828</figcaption></figure><p>ç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code>productAttrValueService.saveProductAttr(productAttrValueEntities);</code></p><p>æ§åˆ¶å°å¯ä»¥çœ‹åˆ°å·²ç»æ‰§è¡ŒæˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.5.3.png" alt="image-20220612171013680" tabindex="0" loading="lazy"><figcaption>image-20220612171013680</figcaption></figure><p>æ‰“å¼€<code>navicat</code>ï¼Œåœ¨å‘½ä»¤è¡Œé‡ŒæŸ¥è¯¢<code>pms_product_attr_value;</code>è¡¨ï¼Œå¯ä»¥çœ‹åˆ°æ‰§è¡ŒæˆåŠŸäº†</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from pms_product_attr_value;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.5.4.png" alt="image-20220612171503231" tabindex="0" loading="lazy"><figcaption>image-20220612171503231</figcaption></figure><h4 id="_6ã€è¿œç¨‹ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_6ã€è¿œç¨‹ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯" aria-hidden="true">#</a> 6ã€è¿œç¨‹ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯</h4><p>ç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code>R r = couponFeignService.saveSpuBounds(spuBoundTo);</code></p><p>æ‰§è¡Œè¿™ä¸€æ­¥æ—¶é—´ç¨å¾®ä¼šé•¿ä¸€äº›ï¼Œå¤§æ¦‚å‡ ç§’</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.6.1.1.png" alt="image-20220612173109279" tabindex="0" loading="lazy"><figcaption>image-20220612173109279</figcaption></figure><p>é€‰æ‹©<code>gulimall_sms</code>æ•°æ®åº“ï¼Œå³é”®é€‰æ‹©<code>æ–°å»ºæŸ¥è¯¢</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.6.1.2.png" alt="image-20220612183822411" tabindex="0" loading="lazy"><figcaption>image-20220612183822411</figcaption></figure><p>åœ¨é‡Œé¢è¾“å…¥sqlè¯­å¥ï¼Œé€‰ä¸­åˆšåˆšè¾“å…¥sqlè¯­å¥ï¼Œç‚¹å‡»<code>è¿è¡Œå·²é€‰æ‹©çš„</code>ï¼Œå°±å¯ä»¥çœ‹åˆ°å·²ç»æ‰§è¡ŒæˆåŠŸäº†</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>#è®¾ç½®äº‹åŠ¡éš”ç¦»çº§åˆ«
set session transaction isolation level read uncommitted;
select * from sms_spu_bounds;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.6.1.3.png" alt="image-20220613172225685" tabindex="0" loading="lazy"><figcaption>image-20220613172225685</figcaption></figure><p>ğŸ“ å¦‚æœæŠ›äº†ç±»å‹è½¬æ¢å¼‚å¸¸</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>java.lang.classCastException: java.lang.Integer cannot be cast to java.lang.String
java.lang.classCastExceptionï¼šjava.lang.Integer ä¸èƒ½è½¬æ¢ä¸º java.lang.String
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.6.2.1.png" alt="image-20220612173525024" tabindex="0" loading="lazy"><figcaption>image-20220612173525024</figcaption></figure><p>åªéœ€è¦ä¿®æ”¹<code>gulimall-common</code>æ¨¡å—çš„<code>com.atguigu.common.utils.R</code>ç±»çš„<code>getCode</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.6.2.2.png" alt="image-20220612173828646" tabindex="0" loading="lazy"><figcaption>image-20220612173828646</figcaption></figure><p>ğŸ“å¦‚æœè¯·æ±‚è¶…æ—¶äº†ï¼Œå¯ä»¥åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>src\\main\\resources\\application.yml</code>é…ç½®æ–‡ä»¶é‡Œé…ç½®è¶…æ—¶æ—¶é—´</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">ribbon</span><span class="token punctuation">:</span>
  <span class="token key atrule">ReadTimeout</span><span class="token punctuation">:</span> <span class="token number">5000</span>
  <span class="token key atrule">ConnectTimeout</span><span class="token punctuation">:</span> <span class="token number">5000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.6.3.png" alt="image-20220612194409602" tabindex="0" loading="lazy"><figcaption>image-20220612194409602</figcaption></figure><h4 id="_7ã€ä¿å­˜skuçš„åŸºæœ¬ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_7ã€ä¿å­˜skuçš„åŸºæœ¬ä¿¡æ¯" aria-hidden="true">#</a> 7ã€ä¿å­˜skuçš„åŸºæœ¬ä¿¡æ¯</h4><p>åœ¨è¿™äº›ä»£ç ä¸Šæ·»åŠ æ–­ç‚¹</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>skuInfoService.saveSkuInfo(skuInfoEntity);
skuImagesService.saveBatch(skuImagesEntities);
skuSaleAttrValueService.saveBatch(skuSaleAttrValueEntities);
R r1 = couponFeignService.saveSkuReduction(skuReductionTo);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.7.1.png" alt="image-20220612184727878" tabindex="0" loading="lazy"><figcaption>image-20220612184727878</figcaption></figure><p>ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œåˆ°<code>skuInfoService.saveSkuInfo(skuInfoEntity);</code>è¿™é‡Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.7.2.png" alt="image-20220612184840945" tabindex="0" loading="lazy"><figcaption>image-20220612184840945</figcaption></figure><p>ç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code>skuInfoService.saveSkuInfo(skuInfoEntity);</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.7.3.png" alt="image-20220612185003469" tabindex="0" loading="lazy"><figcaption>image-20220612185003469</figcaption></figure><p>åœ¨<code>gulimall_pms</code>æ•°æ®åº“çš„å‘½ä»¤è¡Œé‡ŒæŸ¥è¯¢<code>pms_sku_info</code>è¡¨ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æ‰§è¡ŒæˆåŠŸäº†</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from pms_sku_info;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.7.4.png" alt="image-20220612185214403" tabindex="0" loading="lazy"><figcaption>image-20220612185214403</figcaption></figure><h4 id="_8ã€ä¿å­˜skuçš„å›¾ç‰‡ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_8ã€ä¿å­˜skuçš„å›¾ç‰‡ä¿¡æ¯" aria-hidden="true">#</a> 8ã€ä¿å­˜skuçš„å›¾ç‰‡ä¿¡æ¯</h4><p>ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œåˆ°<code>skuImagesService.saveBatch(skuImagesEntities);</code>è¿™é‡Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.8.1.png" alt="image-20220612185351159" tabindex="0" loading="lazy"><figcaption>image-20220612185351159</figcaption></figure><p>ç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code>skuImagesService.saveBatch(skuImagesEntities);</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.8.2.png" alt="image-20220612185428681" tabindex="0" loading="lazy"><figcaption>image-20220612185428681</figcaption></figure><p>åœ¨<code>gulimall_pms</code>æ•°æ®åº“çš„å‘½ä»¤è¡Œé‡ŒæŸ¥è¯¢<code>pms_sku_images</code>è¡¨ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æ‰§è¡ŒæˆåŠŸäº†ï¼Œä½†æ˜¯æœ‰å¾ˆå¤šç©ºçš„<code>img_url</code>ä¹Ÿè¢«æ’å…¥è¿›æ¥äº†</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code> select * from pms_sku_images;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.8.3.png" alt="image-20220612185714965" tabindex="0" loading="lazy"><figcaption>image-20220612185714965</figcaption></figure><p>åœ¨<code>skuImagesService.saveBatch(skuImagesEntities);</code>è¿™é‡Œæ·»åŠ ä¸€ä¸ªå¾…åŠäº‹é¡¹</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>//TODO æ²¡æœ‰å›¾ç‰‡ï¼›è·¯å¾„çš„æ— éœ€ä¿å­˜
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.8.4.png" alt="image-20220612185924619" tabindex="0" loading="lazy"><figcaption>image-20220612185924619</figcaption></figure><h4 id="_9ã€ä¿å­˜skuçš„é”€å”®å±æ€§ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_9ã€ä¿å­˜skuçš„é”€å”®å±æ€§ä¿¡æ¯" aria-hidden="true">#</a> 9ã€ä¿å­˜skuçš„é”€å”®å±æ€§ä¿¡æ¯</h4><p>ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œåˆ°<code> skuSaleAttrValueService.saveBatch(skuSaleAttrValueEntities);</code>è¿™é‡Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.9.1.png" alt="image-20220612190054935" tabindex="0" loading="lazy"><figcaption>image-20220612190054935</figcaption></figure><p>ç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code> skuSaleAttrValueService.saveBatch(skuSaleAttrValueEntities);</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.9.2.png" alt="image-20220612190159595" tabindex="0" loading="lazy"><figcaption>image-20220612190159595</figcaption></figure><p>åœ¨<code>gulimall_pms</code>æ•°æ®åº“çš„å‘½ä»¤è¡Œé‡ŒæŸ¥è¯¢<code>pms_sku_sale_attr_value</code>è¡¨ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æ‰§è¡ŒæˆåŠŸäº†</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from pms_sku_sale_attr_value;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.9.3.png" alt="image-20220612190332004" tabindex="0" loading="lazy"><figcaption>image-20220612190332004</figcaption></figure><h4 id="_10ã€è¿œç¨‹ä¿å­˜skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_10ã€è¿œç¨‹ä¿å­˜skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯" aria-hidden="true">#</a> 10ã€è¿œç¨‹ä¿å­˜skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯</h4><p>ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œåˆ°<code>R r1 = couponFeignService.saveSkuReduction(skuReductionTo);</code>è¿™é‡Œ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.10.1.png" alt="image-20220612190433233" tabindex="0" loading="lazy"><figcaption>image-20220612190433233</figcaption></figure><p>ç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code>R r1 = couponFeignService.saveSkuReduction(skuReductionTo);</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.10.2.png" alt="image-20220612190957155" tabindex="0" loading="lazy"><figcaption>image-20220612190957155</figcaption></figure><p>åœ¨<code>gulimall_sms</code>æ•°æ®åº“çš„å‘½ä»¤è¡Œé‡ŒæŸ¥è¯¢<code>sms_sku_full_reduction</code>è¡¨ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æ‰§è¡ŒæˆåŠŸäº†ï¼Œä½†æ˜¯æœ‰å¾ˆå¤šéƒ½ä¸º0çš„æ•°æ®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from sms_sku_full_reduction;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.10.3.png" alt="image-20220612210049416" tabindex="0" loading="lazy"><figcaption>image-20220612210049416</figcaption></figure><p>åœ¨<code>gulimall_sms</code>æ•°æ®åº“çš„å‘½ä»¤è¡Œé‡ŒæŸ¥è¯¢<code>sms_sku_ladder</code>è¡¨ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æ‰§è¡ŒæˆåŠŸäº†ï¼Œä½†æ˜¯æœ‰å¾ˆå¤šéƒ½ä¸º0çš„æ•°æ®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from sms_sku_ladder;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.10.4.png" alt="image-20220612205848035" tabindex="0" loading="lazy"><figcaption>image-20220612205848035</figcaption></figure><p>åœ¨<code>gulimall_sms</code>æ•°æ®åº“çš„å‘½ä»¤è¡Œé‡ŒæŸ¥è¯¢<code>sms_member_price</code>è¡¨ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æ‰§è¡ŒæˆåŠŸäº†ï¼Œä½†æ˜¯æœ‰å¾ˆå¤šéƒ½ä¸º0çš„æ•°æ®</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>select <span class="token operator">*</span> from sms_member_price<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.10.5.png" alt="image-20220612205651548" tabindex="0" loading="lazy"><figcaption>image-20220612205651548</figcaption></figure><h4 id="_11ã€ä¿å­˜æ‰€æœ‰spuä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_11ã€ä¿å­˜æ‰€æœ‰spuä¿¡æ¯" aria-hidden="true">#</a> 11ã€ä¿å­˜æ‰€æœ‰spuä¿¡æ¯</h4><p>ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œåˆ°<code>skuInfoService.saveSkuInfo(skuInfoEntity);</code>è¿™é‡Œ,ç”¨äºä¿å­˜ç¬¬äºŒä¸ªspuä¿¡æ¯</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.11.1.png" alt="image-20220612191302481" tabindex="0" loading="lazy"><figcaption>image-20220612191302481</figcaption></figure><p>ä¸€ç›´ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œç›´åˆ°æ‰§è¡Œå®Œæ‰€æœ‰</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.11.2.png" alt="image-20220612191443305" tabindex="0" loading="lazy"><figcaption>image-20220612191443305</figcaption></figure><p>åœ¨<code>gulimall_pms</code>æ•°æ®åº“çš„å‘½ä»¤è¡Œä¸­æ‰§è¡Œsqlè¯­å¥ï¼ŒæŸ¥è¯¢<code>pms_sku_info</code>ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°8æ¡æ•°æ®å·²æˆåŠŸæ’å…¥</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>select * from pms_sku_info;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.7.11.3.png" alt="image-20220612191706272" tabindex="0" loading="lazy"><figcaption>image-20220612191706272</figcaption></figure><h3 id="_4-6-8ã€å•†å“ä¿å­˜å…¶ä»–é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_4-6-8ã€å•†å“ä¿å­˜å…¶ä»–é—®é¢˜" aria-hidden="true">#</a> 4.6.8ã€å•†å“ä¿å­˜å…¶ä»–é—®é¢˜</h3><h4 id="_1ã€å›¾ç‰‡çš„urlä¸ºç©ºæ—¶ä¸ä¿å­˜åˆ°æ•°æ®åº“" tabindex="-1"><a class="header-anchor" href="#_1ã€å›¾ç‰‡çš„urlä¸ºç©ºæ—¶ä¸ä¿å­˜åˆ°æ•°æ®åº“" aria-hidden="true">#</a> 1ã€å›¾ç‰‡çš„urlä¸ºç©ºæ—¶ä¸ä¿å­˜åˆ°æ•°æ®åº“</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»çš„<code>saveSpuInfo</code>æ–¹æ³•é‡Œï¼Œ</p><p>åœ¨<code>skuImagesService.saveBatch(skuImagesEntities);</code>æ–¹æ³•è°ƒç”¨ä¹‹å‰</p><p>æ”¶é›†æ•°æ®ä¹‹å‰ï¼Œæ·»åŠ è¿‡æ»¤æ¡ä»¶ï¼Œå¦‚æœå›¾ç‰‡çš„urlä¸ºç©ºï¼Œå°±è¿‡æ»¤æ‰ï¼›å½“å›¾ç‰‡çš„urlä¸ä¸ºç©ºæ—¶æ‰ä¿ç•™</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SkuImagesEntity</span><span class="token punctuation">&gt;</span></span> skuImagesEntities <span class="token operator">=</span> sku<span class="token punctuation">.</span><span class="token function">getImages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>img <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">SkuImagesEntity</span> skuImagesEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkuImagesEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    skuImagesEntity<span class="token punctuation">.</span><span class="token function">setSkuId</span><span class="token punctuation">(</span>skuId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    skuImagesEntity<span class="token punctuation">.</span><span class="token function">setImgUrl</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span><span class="token function">getImgUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    skuImagesEntity<span class="token punctuation">.</span><span class="token function">setDefaultImg</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span><span class="token function">getDefaultImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> skuImagesEntity<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>entry<span class="token operator">-&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">//å¦‚æœå›¾ç‰‡çš„urlä¸ºç©ºï¼Œå°±è¿‡æ»¤æ‰</span>
    <span class="token keyword">return</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">getImgUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
skuImagesService<span class="token punctuation">.</span><span class="token function">saveBatch</span><span class="token punctuation">(</span>skuImagesEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.8.1.png" alt="image-20220613210153936" tabindex="0" loading="lazy"><figcaption>image-20220613210153936</figcaption></figure><h4 id="_2ã€å½“æœ‰æ‰“æŠ˜æˆ–æ»¡å‡ä¿¡æ¯æ‰è°ƒç”¨è¿œç¨‹æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_2ã€å½“æœ‰æ‰“æŠ˜æˆ–æ»¡å‡ä¿¡æ¯æ‰è°ƒç”¨è¿œç¨‹æœåŠ¡" aria-hidden="true">#</a> 2ã€å½“æœ‰<code>æ‰“æŠ˜</code>æˆ–<code>æ»¡å‡</code>ä¿¡æ¯æ‰è°ƒç”¨è¿œç¨‹æœåŠ¡</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»çš„<code>saveSpuInfo</code>æ–¹æ³•é‡Œï¼Œ</p><p>åœ¨æ‰§è¡Œ<code>R r1 = couponFeignService.saveSkuReduction(skuReductionTo);</code>æ–¹æ³•ä¹‹å‰ï¼Œæ·»åŠ åˆ¤æ–­å½“æœ‰<code>æ‰“æŠ˜</code>æˆ–<code>æ»¡å‡</code>ä¿¡æ¯æ—¶æ‰è°ƒç”¨è¿œç¨‹æœåŠ¡</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//æ»¡å‡ ä»¶æ‰“å‡ æŠ˜ã€æ»¡å¤šå°‘å‡å¤šå°‘ï¼Œå¦‚æœæœ‰ä¸€é¡¹æœ‰æ•°æ®æ‰è°ƒç”¨è¿œç¨‹æœåŠ¡</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>skuReductionTo<span class="token punctuation">.</span><span class="token function">getFullCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">||</span> skuReductionTo<span class="token punctuation">.</span><span class="token function">getFullPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ONE</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">R</span> r1 <span class="token operator">=</span> couponFeignService<span class="token punctuation">.</span><span class="token function">saveSkuReduction</span><span class="token punctuation">(</span>skuReductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>r1<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;è¿œç¨‹ä¿å­˜skuä¼˜æƒ ä¿¡æ¯å¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.8.2.png" alt="image-20220612200805478" tabindex="0" loading="lazy"><figcaption>image-20220612200805478</figcaption></figure><p><code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»çš„å®Œæ•´ä»£ç </p><p><a href="code/4.6.8.2.SpuInfoServiceImpl.java">ç‚¹å‡»æŸ¥çœ‹<code>SpuInfoServiceImpl</code>ç±»å®Œæ•´ä»£ç </a></p><h4 id="_3ã€è®¾ç½®ä¼šå‘˜ä»·æ ¼ä¹Ÿè¿œç¨‹è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#_3ã€è®¾ç½®ä¼šå‘˜ä»·æ ¼ä¹Ÿè¿œç¨‹è°ƒç”¨" aria-hidden="true">#</a> 3ã€è®¾ç½®ä¼šå‘˜ä»·æ ¼ä¹Ÿè¿œç¨‹è°ƒç”¨</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»çš„<code>saveSpuInfo</code>æ–¹æ³•é‡Œåœ¨<code>5.4</code>åŠŸèƒ½é‡Œä¿®æ”¹ä»£ç ï¼Œå½“æœ‰<code>æ‰“æŠ˜</code>æˆ–<code>æ»¡å‡</code>æˆ–<code>è®¾ç½®ä¼šå‘˜ä»·æ ¼</code>ä¿¡æ¯æ‰è°ƒç”¨è¿œç¨‹æœåŠ¡</p><p><strong>è¿™äº›ä»·æ ¼åº”è¯¥ä¸<code>BigDecimal.ZERO</code>æ¯”ï¼Œä¹‹å‰ä»£ç å†™çš„æœ‰é—®é¢˜</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//5.4)ã€skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯ï¼›gulimall_sms-&gt;sms_sku_ladder\\sms_sku_full_reduction\\sms_ member_price</span>
<span class="token class-name">SkuReductionTo</span> skuReductionTo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkuReductionTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>sku<span class="token punctuation">,</span>skuReductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
skuReductionTo<span class="token punctuation">.</span><span class="token function">setSkuId</span><span class="token punctuation">(</span>skuId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//æŸ¥è¯¢æ˜¯å¦æœ‰ä¼šå‘˜ä»·æ ¼</span>
<span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SkuReductionTo<span class="token punctuation">.</span>MemberPrice</span><span class="token punctuation">&gt;</span></span> memberPriceList <span class="token operator">=</span> skuReductionTo<span class="token punctuation">.</span><span class="token function">getMemberPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>memberPrice <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> memberPrice<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//æ»¡å‡ ä»¶æ‰“å‡ æŠ˜ã€æ»¡å¤šå°‘å‡å¤šå°‘ã€ä¼šå‘˜ä»·æ ¼ï¼Œå¦‚æœæœ‰ä¸€é¡¹æœ‰æ•°æ®æ‰è°ƒç”¨è¿œç¨‹æœåŠ¡</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>skuReductionTo<span class="token punctuation">.</span><span class="token function">getFullCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span>
        <span class="token operator">||</span> skuReductionTo<span class="token punctuation">.</span><span class="token function">getFullPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span>
        <span class="token operator">||</span> memberPriceList<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">R</span> r1 <span class="token operator">=</span> couponFeignService<span class="token punctuation">.</span><span class="token function">saveSkuReduction</span><span class="token punctuation">(</span>skuReductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>r1<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;è¿œç¨‹ä¿å­˜skuä¼˜æƒ ä¿¡æ¯å¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.8.3.png" alt="image-20220612205101515" tabindex="0" loading="lazy"><figcaption>image-20220612205101515</figcaption></figure><h4 id="_4ã€å½“æœ‰æ»¡å‡ä¿¡æ¯æ‰ä¿å­˜" tabindex="-1"><a class="header-anchor" href="#_4ã€å½“æœ‰æ»¡å‡ä¿¡æ¯æ‰ä¿å­˜" aria-hidden="true">#</a> 4ã€å½“æœ‰æ»¡å‡ä¿¡æ¯æ‰ä¿å­˜</h4><p>ä¿®æ”¹<code>gulimall-coupon</code>æ¨¡å—çš„<code>com.atguigu.gulimall.coupon.service.impl.SkuFullReductionServiceImpl</code>ç±»çš„<code>saveSkuReduction</code>æ–¹æ³•ï¼Œå½“æœ‰æ»¡å‡ä¿¡æ¯æ‰ä¿å­˜</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//æœ‰æ»¡å‡ä¿¡æ¯æ‰ä¿å­˜</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>reductionTo<span class="token punctuation">.</span><span class="token function">getFullPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//2ã€skuçš„ æ»¡å‡(æ»¡å¤šå°‘å‡å¤šå°‘) ä¿¡æ¯ï¼›sms_sku_full_reduction</span>
    <span class="token class-name">SkuFullReductionEntity</span> skuFullReductionEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkuFullReductionEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>reductionTo<span class="token punctuation">,</span> skuFullReductionEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    skuFullReductionEntity<span class="token punctuation">.</span><span class="token function">setAddOther</span><span class="token punctuation">(</span>reductionTo<span class="token punctuation">.</span><span class="token function">getPriceStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>skuFullReductionEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.8.4.png" alt="image-20220612203149627" tabindex="0" loading="lazy"><figcaption>image-20220612203149627</figcaption></figure><h4 id="_5ã€å½“ä¼šå‘˜ä»·æ ¼å¤§äº0æ‰ä¿å­˜" tabindex="-1"><a class="header-anchor" href="#_5ã€å½“ä¼šå‘˜ä»·æ ¼å¤§äº0æ‰ä¿å­˜" aria-hidden="true">#</a> 5ã€å½“ä¼šå‘˜ä»·æ ¼å¤§äº0æ‰ä¿å­˜</h4><p>ä¿®æ”¹<code>gulimall-coupon</code>æ¨¡å—<code>com.atguigu.gulimall.coupon.service.impl.SkuFullReductionServiceImpl</code>ç±»é‡Œçš„<code>saveSkuReduction</code>æ–¹æ³•ï¼Œå½“ä¼šå‘˜ä»·æ ¼å¤§äº0(ä¿®æ”¹äº†ä¼šå‘˜ä»·æ ¼)æ‰ä¿å­˜</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token comment">//3ã€skuçš„ä¼šå‘˜ä¼˜æƒ ä¿¡æ¯ï¼›sms_ member_price</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SkuReductionTo<span class="token punctuation">.</span>MemberPrice</span><span class="token punctuation">&gt;</span></span> memberPrice <span class="token operator">=</span> reductionTo<span class="token punctuation">.</span><span class="token function">getMemberPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MemberPriceEntity</span><span class="token punctuation">&gt;</span></span> memberPriceEntities <span class="token operator">=</span> memberPrice<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>member<span class="token operator">-&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> member<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>member <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">MemberPriceEntity</span> memberPriceEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MemberPriceEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        memberPriceEntity<span class="token punctuation">.</span><span class="token function">setSkuId</span><span class="token punctuation">(</span>reductionTo<span class="token punctuation">.</span><span class="token function">getSkuId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        memberPriceEntity<span class="token punctuation">.</span><span class="token function">setMemberLevelId</span><span class="token punctuation">(</span>member<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        memberPriceEntity<span class="token punctuation">.</span><span class="token function">setMemberLevelName</span><span class="token punctuation">(</span>member<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        memberPriceEntity<span class="token punctuation">.</span><span class="token function">setMemberPrice</span><span class="token punctuation">(</span>member<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        memberPriceEntity<span class="token punctuation">.</span><span class="token function">setAddOther</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> memberPriceEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    memberPriceService<span class="token punctuation">.</span><span class="token function">saveBatch</span><span class="token punctuation">(</span>memberPriceEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.8.5.png" alt="image-20220612204104653" tabindex="0" loading="lazy"><figcaption>image-20220612204104653</figcaption></figure><h3 id="_4-6-9ã€é‡æ–°æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_4-6-9ã€é‡æ–°æµ‹è¯•" aria-hidden="true">#</a> 4.6.9ã€é‡æ–°æµ‹è¯•</h3><h4 id="_1ã€é‡å¯é¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#_1ã€é‡å¯é¡¹ç›®" aria-hidden="true">#</a> 1ã€é‡å¯é¡¹ç›®</h4><p>é€‰æ‹©IDEAä¸‹è¾¹é€‰é¡¹æ¡†çš„<code>Services</code>é€‰é¡¹ï¼Œç‚¹å‡»<code>GulimallProductApplication</code>,å³é”®é€‰æ‹©<code>Return</code>ï¼Œé‡æ–°ä»¥<code>debug</code>æ–¹å¼å¯åŠ¨<code>GulimallProductApplication</code>é¡¹ç›®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.1.1.png" alt="image-20220612210946079" tabindex="0" loading="lazy"><figcaption>image-20220612210946079</figcaption></figure><p>ç‚¹å‡»<code>GulimallCouponApplication</code>,å³é”®é€‰æ‹©<code>Return</code>ï¼Œé‡æ–°ä»¥<code>debug</code>æ–¹å¼å¯åŠ¨<code>GulimallCouponApplication</code>é¡¹ç›®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.1.2.png" alt="image-20220612211004238" tabindex="0" loading="lazy"><figcaption>image-20220612211004238</figcaption></figure><h4 id="_2ã€æ·»åŠ åŸºæœ¬ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ åŸºæœ¬ä¿¡æ¯" aria-hidden="true">#</a> 2ã€æ·»åŠ åŸºæœ¬ä¿¡æ¯</h4><p>åœ¨<code>å•†å“ç³»ç»Ÿ</code>-&gt;<code>å•†å“ç»´æŠ¤</code>-&gt;<code>å‘å¸ƒå•†å“</code>é‡Œæ·»åŠ å•†å“çš„åŸºæœ¬ä¿¡æ¯</p><p><code>å•†å“åç§°</code>é‡Œè¾“å…¥<code>Apple iPhoneXS è‹¹æœXSæ‰‹æœº</code></p><p><code>å•†å“æè¿°</code>è¾“å…¥<code>è‹¹æœæ‰‹æœº</code></p><p><code>é€‰æ‹©åˆ†ç±»</code>é€‰æ‹©<code>æ‰‹æœº/æ‰‹æœºé€šè®¯/æ‰‹æœº</code></p><p><code>é€‰æ‹©å“ç‰Œ</code>é€‰æ‹©<code>Apple</code></p><p><code>å•†å“é‡é‡(Kg)</code>è¾“å…¥<code>0.198</code></p><p><code>è®¾ç½®ç§¯åˆ†</code>é‡Œï¼Œ<code>é‡‘å¸</code>è¾“å…¥<code>500</code>ï¼Œ<code>æˆé•¿å€¼</code>è¾“å…¥<code>500</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.2.1.png" alt="image-20220612211954522" tabindex="0" loading="lazy"><figcaption>image-20220612211954522</figcaption></figure><p><code>å•†å“ä»‹ç»</code>é€‰ä»¥ä¸‹ä¸¤ä¸ªå›¾ç‰‡</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.2.2.png" alt="image-20220612212014107" tabindex="0" loading="lazy"><figcaption>image-20220612212014107</figcaption></figure><p>ç„¶åç‚¹å‡»<code>ä¸‹ä¸€æ­¥ï¼šè®¾ç½®åŸºæœ¬å‚æ•°</code></p><h4 id="_3ã€æ·»åŠ è§„æ ¼å‚æ•°" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ è§„æ ¼å‚æ•°" aria-hidden="true">#</a> 3ã€æ·»åŠ è§„æ ¼å‚æ•°</h4><p>åœ¨<code>è§„æ ¼å‚æ•°</code>é‡Œ,ä¸»ä½“å†…çš„<code>å…¥ç½‘å‹å·</code>é€‰æ‹©<code>A2100</code>ï¼Œä¸Šå¸‚å¹´ä»½é€‰æ‹©<code>2018</code>ï¼ˆåŸºæœ¬ä¿¡æ¯å’Œä¸»èŠ¯ç‰‡åœ¨è¿™é‡Œæˆ‘å°±ä¸é€‰äº†ï¼‰</p><p>ç„¶åç‚¹å‡»<code>ä¸‹ä¸€æ­¥ï¼šè®¾ç½®é”€å”®å±æ€§</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.3.png" alt="image-20220612212342961" tabindex="0" loading="lazy"><figcaption>image-20220612212342961</figcaption></figure><h4 id="_4ã€æ·»åŠ é”€å”®å±æ€§" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ é”€å”®å±æ€§" aria-hidden="true">#</a> 4ã€æ·»åŠ é”€å”®å±æ€§</h4><p>åœ¨<code>é”€å”®å±æ€§</code>é‡Œçš„<code>é€‰æ‹©é”€å”®å±æ€§</code>çš„<code>é¢œè‰²</code>é‡Œï¼Œæ·»åŠ å¹¶é€‰æ‹©<code>é“¶è‰²</code>ã€<code>æ·±ç©ºç°è‰²</code>ã€<code>é‡‘è‰²</code></p><p><code>å†…å­˜</code>é€‰æ‹©<code>4G</code></p><p><code>ç‰ˆæœ¬</code>é‡Œï¼Œæ·»åŠ å¹¶é€‰æ‹©<code>64GB</code>ã€<code>256GB</code>ã€<code>512GB</code></p><p>ç„¶åç‚¹å‡»<code>ä¸‹ä¸€æ­¥ï¼šè®¾ç½®SKUä¿¡æ¯</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.4.png" alt="image-20220612212701344" tabindex="0" loading="lazy"><figcaption>image-20220612212701344</figcaption></figure><h4 id="_5ã€æ·»åŠ skuä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_5ã€æ·»åŠ skuä¿¡æ¯" aria-hidden="true">#</a> 5ã€æ·»åŠ SKUä¿¡æ¯</h4><h5 id="_1ã€æ·»åŠ åŸºæœ¬ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ åŸºæœ¬ä¿¡æ¯" aria-hidden="true">#</a> 1ã€æ·»åŠ åŸºæœ¬ä¿¡æ¯</h5><p>åœ¨<code>é”€å”®å±æ€§</code>é‡Œæ·»åŠ å¦‚ä¸‹ä¿¡æ¯ï¼Œå…¶ä¸­æœ‰äº›ä¿¡æ¯æ˜¯å·²ç»è‡ªåŠ¨ç”Ÿæˆå¥½çš„(é¡ºåºå¯èƒ½ä¸åŒ)</p><table><thead><tr><th>é¢œè‰²</th><th>ç‰ˆæœ¬</th><th>å•†å“åç§°</th><th>æ ‡é¢˜</th><th>å‰¯æ ‡é¢˜</th><th>ä»·æ ¼</th></tr></thead><tbody><tr><td>é“¶è‰²</td><td>64GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº é“¶è‰² 64GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº é“¶è‰² 64GB</td><td>å›½è¡Œæ­£å“ã€ç™½æ¡å…­æœŸå…æ¯ã€‘</td><td>5999</td></tr><tr><td>é“¶è‰²</td><td>256GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº é“¶è‰² 256GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº é“¶è‰² 256GB</td><td>å›½è¡Œæ­£å“ã€ç™½æ¡å…­æœŸå…æ¯ã€‘</td><td>6799</td></tr><tr><td>é“¶è‰²</td><td>512GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº é“¶è‰² 512GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº é“¶è‰² 512GB</td><td>å›½è¡Œæ­£å“ã€ç™½æ¡å…­æœŸå…æ¯ã€‘è‹¹æœXSæ‰‹æœº é“¶è‰² 512GB</td><td>6999</td></tr><tr><td>æ·±ç©ºç°è‰²</td><td>64GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº æ·±ç©ºç°è‰² 64GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº æ·±ç©ºç°è‰² 64GB</td><td>å›½è¡Œæ­£å“ã€ç™½æ¡å…­æœŸå…æ¯ã€‘</td><td>5999</td></tr><tr><td>æ·±ç©ºç°è‰²</td><td>256GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº æ·±ç©ºç°è‰² 256GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº æ·±ç©ºç°è‰² 256GB</td><td>å›½è¡Œæ­£å“ã€ç™½æ¡å…­æœŸå…æ¯ã€‘</td><td>6799</td></tr><tr><td>æ·±ç©ºç°è‰²</td><td>512GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº æ·±ç©ºç°è‰² 512GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº æ·±ç©ºç°è‰² 512GB</td><td>å›½è¡Œæ­£å“ã€ç™½æ¡å…­æœŸå…æ¯ã€‘</td><td>6999</td></tr><tr><td>é‡‘è‰²</td><td>64GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº é‡‘è‰² 64GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº é‡‘è‰² 64GB</td><td>å›½è¡Œæ­£å“ã€ç™½æ¡å…­æœŸå…æ¯ã€‘</td><td>5999</td></tr><tr><td>é‡‘è‰²</td><td>256GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº é‡‘è‰² 256GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº é‡‘è‰² 256GB</td><td>å›½è¡Œæ­£å“ã€ç™½æ¡å…­æœŸå…æ¯ã€‘</td><td>6799</td></tr><tr><td>é‡‘è‰²</td><td>512GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº é‡‘è‰² 512GB</td><td>Apple IPhoneXS è‹¹æœXSæ‰‹æœº é‡‘è‰² 512GB</td><td>å›½è¡Œæ­£å“ã€ç™½æ¡å…­æœŸå…æ¯ã€‘</td><td>6999</td></tr></tbody></table><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.5.1.png" alt="image-20220612213201736" tabindex="0" loading="lazy"><figcaption>image-20220612213201736</figcaption></figure><h5 id="_2ã€æ·»åŠ è¯¦ç»†ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ è¯¦ç»†ä¿¡æ¯" aria-hidden="true">#</a> 2ã€æ·»åŠ è¯¦ç»†ä¿¡æ¯</h5><p>åœ¨<code>é“¶è‰² 64GB Apple IPhoneXS è‹¹æœXSæ‰‹æœº é“¶è‰² 64GB Apple IPhoneXS è‹¹æœXSæ‰‹æœº é“¶è‰² 64GB å›½è¡Œæ­£å“ã€ç™½æ¡å…­æœŸå…æ¯ã€‘ 5999</code> (ç¬¬ä¸€æ¡ä¿¡æ¯)çš„<code>ä»·æ ¼</code>å³è¾¹ï¼Œç‚¹å‡»<code>&gt;</code>å³ç®­å¤´ï¼Œåœ¨è¿™é‡Œæ·»åŠ è¯¦ç»†ä¿¡æ¯</p><p>ç‚¹å‡»<code>+</code>å·ï¼Œç„¶åé€‰æ‹©ä¸€å¼ å›¾ç‰‡ï¼Œä»¥æ·»åŠ è¿™ä¸ªå›¾ç‰‡ï¼Œé€‰æ‹©ä¸€äº›å›¾ç‰‡ä½œä¸ºè¿™ä¸ª<code>SKU</code>çš„å›¾ç‰‡é›†ï¼Œå¹¶é€‰æ‹©å…¶ä¸­ä¸€ä¸ªç‚¹å‡»<code>è®¾ä¸ºé»˜è®¤</code>ï¼Œç”¨æ¥åšé»˜è®¤å›¾ç‰‡</p><p>åœ¨<code>è®¾ç½®æŠ˜æ‰£</code>é‡Œï¼Œæ»¡<code>2</code>ä»¶ï¼Œæ‰“<code>0.98</code>æŠ˜ï¼Œå¹¶å‹¾é€‰<code>å¯å åŠ ä¼˜æƒ </code></p><p>åœ¨<code>è®¾ç½®æ»¡å‡</code>é‡Œï¼Œæ»¡<code>10000</code>å…ƒï¼Œå‡<code>50</code>å…ƒï¼Œå¹¶å‹¾é€‰<code>å¯å åŠ ä¼˜æƒ </code></p><p>åœ¨<code>è®¾ç½®ä¼šå‘˜ä»·</code>é‡Œï¼Œ<code>é“œç‰Œä¼šå‘˜</code>è®¾ç½®ä¼šå‘˜ä»·ä¸º<code>5980</code>å…ƒï¼Œ<code>é“¶ç‰Œä¼šå‘˜</code>(è¿™é‡Œå‰ç«¯å­—æ‰“é”™äº†)è®¾ç½®ä¼šå‘˜ä»·ä¸º<code>5970</code>å…ƒ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.5.2.png" alt="image-20220612214656192" tabindex="0" loading="lazy"><figcaption>image-20220612214656192</figcaption></figure><p>æŒ‰<code>f12</code>æ‰“å¼€æ§åˆ¶å°ï¼Œåœ¨æ§åˆ¶å°é‡Œé€‰æ‹©<code>Console</code>ï¼Œç„¶åç‚¹å‡»<code>ä¸‹ä¸€æ­¥ï¼šä¿ç•™å•†å“ä¿¡æ¯</code>,å…ˆ<strong>ä¸</strong>è¦ç‚¹å‡»<code>æç¤º</code>é‡Œçš„<code>ç¡®å®š</code></p><p>åœ¨æ§åˆ¶å°è¾“å‡ºçš„ä¿¡æ¯é‚£ç‚¹å‡»å³é”®ï¼Œé€‰æ‹©<code>Save as...</code>ï¼Œ<strong>å…ˆæ”¾åˆ°è®°äº‹æœ¬é‡Œä¿å­˜ï¼Œå…å¾—åé¢æ“ä½œå¤šäº†ï¼Œä¸å°å¿ƒä¸¢äº†</strong>(åä¸ºçš„é‚£ä¸ªä¹Ÿä¿ç•™ç€ï¼Œåé¢è¿˜ç”¨å¾—ä¸Š)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.5.3.png" alt="image-20220612214825166" tabindex="0" loading="lazy"><figcaption>image-20220612214825166</figcaption></figure><h5 id="_4ã€å‘é€çš„å®Œæ•´json" tabindex="-1"><a class="header-anchor" href="#_4ã€å‘é€çš„å®Œæ•´json" aria-hidden="true">#</a> 4ã€å‘é€çš„å®Œæ•´json</h5><p>åˆ é™¤æœ€å¼€å¤´çš„<code>spuadd.vue?c0e3:697 ~~~~~</code>ï¼Œåé¢éƒ¨åˆ†å³ä¸ºæ­£ç¡®çš„ã€å®Œæ•´çš„json</p><p><a href="code/4.6.9.5.4.json">ç‚¹å‡»æŸ¥çœ‹å®Œæ•´json</a></p><h5 id="_5ã€æ ¼å¼åŒ–åçš„json" tabindex="-1"><a class="header-anchor" href="#_5ã€æ ¼å¼åŒ–åçš„json" aria-hidden="true">#</a> 5ã€æ ¼å¼åŒ–åçš„json</h5><p><a href="code/4.6.9.5.5.json">ç‚¹å‡»æŸ¥çœ‹æ ¼å¼åçš„json</a></p><h4 id="_6ã€æŠ›å‡ºç±»å‹å¼ºè½¬å¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#_6ã€æŠ›å‡ºç±»å‹å¼ºè½¬å¼‚å¸¸" aria-hidden="true">#</a> 6ã€æŠ›å‡ºç±»å‹å¼ºè½¬å¼‚å¸¸</h4><h5 id="_1ã€ç³»ç»ŸæœªçŸ¥å¼‚å¸¸-1" tabindex="-1"><a class="header-anchor" href="#_1ã€ç³»ç»ŸæœªçŸ¥å¼‚å¸¸-1" aria-hidden="true">#</a> 1ã€ç³»ç»ŸæœªçŸ¥å¼‚å¸¸</h5><p>ç‚¹å‡»å‰ç«¯<code>æç¤º</code>å¯¹è¯æ¡†çš„<code>ç¡®å®šæŒ‰é’®</code>åï¼Œæç¤º<code>ä¿å­˜å¤±è´¥ï¼ŒåŸå› ã€ç³»ç»ŸæœªçŸ¥å¼‚å¸¸ã€‘</code>ï¼ŒæŸ¥çœ‹è¯·æ±‚ï¼Œå‘ç°<code>msg</code>æ˜¯<code>ç³»ç»ŸæœªçŸ¥å¼‚å¸¸</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.6.1.png" alt="image-20220612215347322" tabindex="0" loading="lazy"><figcaption>image-20220612215347322</figcaption></figure><h5 id="_2ã€æŸ¥çœ‹åç«¯çš„æ§åˆ¶å°" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹åç«¯çš„æ§åˆ¶å°" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹åç«¯çš„æ§åˆ¶å°</h5><p>æŸ¥çœ‹<code>GulimallProductApplication</code>æ¨¡å—çš„æ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°æŠ›å‡ºäº†<code>.ClassCastException</code>(ç±»å¼ºè½¬)å¼‚å¸¸</p><p><code>com.atguigu.gulimall.product.vo.SpuSaveVo$MemberPrice</code>ä¸èƒ½è¢«å¼ºè½¬ä¸º<code>com.atguigu.common.to.SkuReductionTo$MemberPrice</code></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>java.lang.ClassCastException: com.atguigu.gulimall.product.vo.SpuSaveVo$MemberPrice cannot be cast to com.atguigu.common.to.SkuReductionTo$MemberPrice
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174) ~[na:1.8.0_301]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.6.2.1.png" alt="image-20220612234832710" tabindex="0" loading="lazy"><figcaption>image-20220612234832710</figcaption></figure><p>è°ƒè¯•å‘ç°<code>BeanUtils.copyProperties(sku,skuReductionTo);</code>æŠŠ<code>Skus</code>é‡Œçš„<code>MemberPrice</code>é›†åˆï¼Œèµ‹ç»™äº†<code>SkuReductionTo</code>é‡Œçš„<code>memberPrice</code>ï¼Œè¿™æ ·å°±å¯¼è‡´<code>memberPrice</code>æ˜¯<code>com.atguigu.gulimall.product.vo.SpuSaveVo$MemberPrice</code>ç±»å‹çš„é›†åˆï¼Œè€Œä¸æ˜¯æœ¬ç±»çš„<code>com.atguigu.common.to.SkuReductionTo$MemberPrice</code>ç±»å‹çš„é›†åˆï¼Œ</p><p>æ‰€ä»¥å½“éå†æ—¶ï¼Œç¼–è¯‘å™¨å¼ºè½¬ä¸ºæœ¬ç±»çš„<code>com.atguigu.gulimall.product.vo.SpuSaveVo$MemberPrice</code>é›†åˆï¼Œå°±å‘ç”Ÿäº†ç±»å¼ºè½¬å¼‚å¸¸</p><p>(éå†æ—¶ç¼–è¯‘å™¨æ£€æŸ¥çš„<code>memberPrice</code>é›†åˆç±»å‹ä¸º<code>com.atguigu.common.to.SkuReductionTo$MemberPrice</code>;è€Œ<code>BeanUtils.copyProperties(sku,skuReductionTo);</code>æ˜¯åœ¨è¿è¡Œæ—¶æ‰§è¡Œçš„ï¼Œç¼–è¯‘å™¨æ— æ³•é¢„çŸ¥å…¶ç±»å‹ï¼Œå…¶æŠŠ<code>com.atguigu.gulimall.product.vo.SpuSaveVo$MemberPrice</code>ç±»å‹çš„é›†åˆèµ‹ç»™äº†<code>memberPrice</code>ï¼›åœ¨è¿è¡Œ<code>memberPrice</code>éå†ä»£ç æ—¶å‘ç°ä¸é¢„æœŸç±»å‹ä¸ä¸€è‡´ï¼Œå¼ºè½¬ç±»å‹å°±å‘ç”Ÿäº†ç±»å¼ºè½¬å¼‚å¸¸)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.6.2.2.png" alt="image-20220613161427467" tabindex="0" loading="lazy"><figcaption>image-20220613161427467</figcaption></figure><h5 id="_3ã€å°è¯•ä¸æ˜¾å¼è·å–è¿”å›ç±»å‹ä¼šä¸ä¼šæŠ¥é”™" tabindex="-1"><a class="header-anchor" href="#_3ã€å°è¯•ä¸æ˜¾å¼è·å–è¿”å›ç±»å‹ä¼šä¸ä¼šæŠ¥é”™" aria-hidden="true">#</a> 3ã€å°è¯•ä¸æ˜¾å¼è·å–è¿”å›ç±»å‹ä¼šä¸ä¼šæŠ¥é”™</h5><p>æµ‹è¯•ä¹‹å‰æŠ¥é”™æ˜¯ä¸æ˜¯å› ä¸ºä»¥ä¸‹ä»£ç æ˜¾å¼è·å–äº†è¿”å›ç±»å‹ä¸º<code>SkuReductionTo.MemberPrice</code>è€ŒæŠ¥çš„é”™</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SkuReductionTo<span class="token punctuation">.</span>MemberPrice</span><span class="token punctuation">&gt;</span></span> memberPriceList <span class="token operator">=</span> skuReductionTo<span class="token punctuation">.</span><span class="token function">getMemberPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>memberPrice <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> memberPrice<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¯¥ä»£ç å‰ï¼Œæ·»åŠ ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤º</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//5.4)ã€skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯ï¼›gulimall_sms-&gt;sms_sku_ladder\\sms_sku_full_reduction\\sms_ member_price</span>
<span class="token class-name">SkuReductionTo</span> skuReductionTo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkuReductionTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>skuReductionTo<span class="token punctuation">.</span><span class="token function">getMemberPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>sku<span class="token punctuation">,</span>skuReductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>skuReductionTo<span class="token punctuation">.</span><span class="token function">getMemberPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
skuReductionTo<span class="token punctuation">.</span><span class="token function">setSkuId</span><span class="token punctuation">(</span>skuId<span class="token punctuation">)</span><span class="token punctuation">;</span>
skuReductionTo<span class="token punctuation">.</span><span class="token function">getMemberPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>e<span class="token operator">-&gt;</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot; &quot;</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot; &quot;</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>GulimallProductApplication</code>æ¨¡å—æ§åˆ¶å°æ‰“å°<code>skuReductionTo.getMemberPrice()</code>å¯ä»¥çœ‹åˆ°<code>memberPrice()</code>ä¸º<code>SpuSaveVo$MemberPrice</code>ç±»å‹çš„é›†åˆ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.6.3.1.png" alt="image-20220613001145096" tabindex="0" loading="lazy"><figcaption>image-20220613001145096</figcaption></figure><p>ç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œç»§ç»­å‘ä¸‹è¿è¡Œã€‚</p><p>åœ¨ç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ­¥è¿‡<code>skuReductionTo.getMemberPrice().forEach(e-&gt;{</code>å‘ç°æ²¡æœ‰å†å‘ä¸‹è¿è¡Œäº†ï¼Œè¿™æ—¶åº”è¯¥æ˜¯å‘ç”Ÿå¼‚å¸¸äº†ï¼Œå†æ¬¡ç‚¹å‡»<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œå°±è·³åˆ°çš„æ•è·å¼‚å¸¸çš„ç±»é‡Œå»äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.6.3.2.png" alt="image-20220613165957636" tabindex="0" loading="lazy"><figcaption>image-20220613165957636</figcaption></figure><p>ç‚¹å‡»<code>Step Out(æ­¥å‡º)</code>ï¼Œç›´æ¥æ‰§è¡Œåˆ°æœ¬ç±»ç›¸åº”æ–¹æ³•ç»“æŸ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.6.3.3.png" alt="  " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>å¤šæ¬¡ç‚¹å‡»<code>Step Out(æ­¥å‡º)</code>ï¼Œæ‰§è¡Œå®Œæ‰€æœ‰å¼‚å¸¸æ•è·ç±»ï¼Œå°±çœ‹åˆ°äº†æ§åˆ¶å°å¼‚å¸¸ä¿¡æ¯</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.6.3.4.png" alt="image-20220613165144512" tabindex="0" loading="lazy"><figcaption>image-20220613165144512</figcaption></figure><h5 id="_4ã€è§£å†³æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€è§£å†³æ–¹æ³•" aria-hidden="true">#</a> 4ã€è§£å†³æ–¹æ³•</h5><p>ğŸ“ å¯ä»¥å…ˆæŠŠè¿œç¨‹è°ƒç”¨çš„å…ˆæ³¨é‡Šæ‰ï¼Œå› ä¸ºæ²¡ä½¿ç”¨åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œè¿™äº›è¿œç¨‹è°ƒç”¨æ— æ³•å›æ»šï¼Œæ³¨é‡Šæ‰é¿å…è®¸å¤šæ— ç”¨çš„æ•°æ®è¢«æäº¤</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.6.4.0.png" alt="image-20220613163711487" tabindex="0" loading="lazy"><figcaption>image-20220613163711487</figcaption></figure><h6 id="æ–¹æ³•ä¸€-1" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•ä¸€-1" aria-hidden="true">#</a> æ–¹æ³•ä¸€</h6><p>ä¸ä½¿ç”¨<code>BeanUtils.copyProperties(sku, skuReductionTo);</code>æ–¹æ³•æ‹·è´çš„<code>SkuReductionTo</code>ç±»é‡Œçš„<code>memberPrice</code></p><p>ç›´æ¥ä½¿ç”¨åŸæ•°æ®çš„<code>sku</code>å¯¹è±¡çš„<code>memberPrice</code>è¿›è¡Œåˆ¤æ–­</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//5.4)ã€skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯ï¼›gulimall_sms-&gt;sms_sku_ladder\\sms_sku_full_reduction\\sms_ member_price</span>
<span class="token class-name">SkuReductionTo</span> skuReductionTo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkuReductionTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>sku<span class="token punctuation">,</span> skuReductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
skuReductionTo<span class="token punctuation">.</span><span class="token function">setSkuId</span><span class="token punctuation">(</span>skuId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>skuReductionTo<span class="token punctuation">.</span><span class="token function">getMemberPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SpuSaveVo<span class="token punctuation">.</span>MemberPrice</span><span class="token punctuation">&gt;</span></span> firstMemberPrice <span class="token operator">=</span> sku<span class="token punctuation">.</span><span class="token function">getMemberPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>memberPrice <span class="token operator">-&gt;</span> memberPrice<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//æ»¡å‡ ä»¶æ‰“å‡ æŠ˜ã€æ»¡å¤šå°‘å‡å¤šå°‘ã€ä¼šå‘˜ä»·æ ¼ï¼Œå¦‚æœæœ‰ä¸€é¡¹æœ‰æ•°æ®æ‰è°ƒç”¨è¿œç¨‹æœåŠ¡</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>skuReductionTo<span class="token punctuation">.</span><span class="token function">getFullCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span>
        <span class="token operator">||</span> skuReductionTo<span class="token punctuation">.</span><span class="token function">getFullPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span>
        <span class="token operator">||</span> firstMemberPrice<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">R</span> r1 <span class="token operator">=</span> couponFeignService<span class="token punctuation">.</span><span class="token function">saveSkuReduction</span><span class="token punctuation">(</span>skuReductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>r1<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;è¿œç¨‹ä¿å­˜skuä¼˜æƒ ä¿¡æ¯å¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.6.4.1.1.png" alt="image-20220613163009555" tabindex="0" loading="lazy"><figcaption>image-20220613163009555</figcaption></figure><p>å¯ä»¥çœ‹åˆ°<code>sku</code>é‡Œçš„<code>memberPrice</code>ç±»å‹ä¸º<code>SpuSaveVo$MemberPrice</code>ï¼Œå°±æ˜¯å®ƒåº”è¯¥çš„ç±»å‹ï¼Œæ­¤æ—¶è‚¯å®šä¸ä¼šæŠ¥é”™</p><p>ä¸‹é¢çš„æ–¹æ³•åœ¨å¤„ç†<code>skuReductionTo</code>é‡Œçš„é”™è¯¯çš„<code>SpuSaveVo$MemberPrice</code>ç±»å‹æ²¡æœ‰æŠ¥é”™çš„åŸå› æ˜¯ï¼šå‘ç”Ÿäº†è¿œç¨‹è°ƒç”¨ï¼Œè¿œç¨‹è°ƒç”¨æ˜¯é€šè¿‡<code>json</code>æ¥ä¼ è¾“æ•°æ®ï¼Œ<code>SpuSaveVo$MemberPrice</code>ç±»å’Œ<code>SkuReductionTo$MemberPrice</code>ç±»çš„æ‰€æœ‰æ•°æ®å­—æ®µåç§°å’Œç±»å‹éƒ½ç›¸åŒï¼Œæ‰€ä»¥è½¬åŒ–çš„<code>json</code>æ•°æ®éƒ½ä¸€æ ·ï¼Œåœ¨æœåŠ¡æä¾›æ–¹æ¥æ”¶<code>json</code>è½¬åŒ–ä¸º<code>SkuReductionTo$MemberPrice</code>ç±»å‹æ—¶ä¹Ÿä¸ä¼šå‡ºé”™</p><p>(<code>SpuSaveVo$MemberPrice</code>ç±»å’Œ<code>SkuReductionTo$MemberPrice</code>ç±»çš„æ‰€æœ‰æ•°æ®å­—æ®µåç§°å’Œç±»å‹éƒ½ç›¸åŒï¼Œä½†æ˜¯ç±»å¼ºè½¬å¤±è´¥çš„åŸå› æ˜¯å®ƒä»¬ä¹‹é—´æ²¡æœ‰ç»§æ‰¿å…³ç³»ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªç±»ä¸èƒ½å¼ºè½¬)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.6.4.1.2.png" alt="image-20220613171053930" tabindex="0" loading="lazy"><figcaption>image-20220613171053930</figcaption></figure><h6 id="æ–¹æ³•äºŒ-1" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•äºŒ-1" aria-hidden="true">#</a> æ–¹æ³•äºŒ</h6><p><code>SpuSaveVo$MemberPrice</code>ç±»å’Œ<code>SkuReductionTo$MemberPrice</code>ç±»çš„æ‰€æœ‰æ•°æ®å­—æ®µåç§°å’Œç±»å‹éƒ½ç›¸åŒï¼Œæ‰€ä»¥è½¬åŒ–çš„<code>json</code>æ•°æ®éƒ½ä¸€æ ·ï¼Œå¯ä»¥å…ˆå°†<code>SpuSaveVo$MemberPrice</code>ç±»é›†åˆè½¬åŒ–ä¸º<code>json</code>ï¼Œå†é€šè¿‡<code>json</code>è½¬åŒ–ä¸º<code>SkuReductionTo$MemberPrice</code>ç±»é›†åˆï¼Œæœ€åå†èµ‹å€¼ç»™<code>skuReductionTo</code>ç±»çš„<code>memberPrice</code>å­—æ®µï¼Œç„¶åè¿›è¡Œå¤„ç†</p><p>(ä¸è¿‡æ²¡å¿…è¦ä½¿ç”¨è¿™ç§æ–¹æ³•æ¥å›è½¬ï¼Œå¾ˆå½±å“æ€§èƒ½ï¼Œè¿™é‡Œåªæä¾›ä¸€ç§æ€è·¯)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//5.4)ã€skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯ï¼›gulimall_sms-&gt;sms_sku_ladder\\sms_sku_full_reduction\\sms_ member_price</span>
<span class="token class-name">SkuReductionTo</span> skuReductionTo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkuReductionTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>sku<span class="token punctuation">,</span>skuReductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
skuReductionTo<span class="token punctuation">.</span><span class="token function">setSkuId</span><span class="token punctuation">(</span>skuId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>skuReductionTo<span class="token punctuation">.</span><span class="token function">getMemberPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>sku<span class="token punctuation">.</span><span class="token function">getMemberPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SkuReductionTo<span class="token punctuation">.</span>MemberPrice</span><span class="token punctuation">&gt;</span></span> memberPriceList <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parseArray</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token class-name">SkuReductionTo<span class="token punctuation">.</span>MemberPrice</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
skuReductionTo<span class="token punctuation">.</span><span class="token function">setMemberPrice</span><span class="token punctuation">(</span>memberPriceList<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SkuReductionTo<span class="token punctuation">.</span>MemberPrice</span><span class="token punctuation">&gt;</span></span> firstMemberPrice <span class="token operator">=</span> skuReductionTo<span class="token punctuation">.</span><span class="token function">getMemberPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>memberPrice <span class="token operator">-&gt;</span> memberPrice<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//æ»¡å‡ ä»¶æ‰“å‡ æŠ˜ã€æ»¡å¤šå°‘å‡å¤šå°‘ã€ä¼šå‘˜ä»·æ ¼ï¼Œå¦‚æœæœ‰ä¸€é¡¹æœ‰æ•°æ®æ‰è°ƒç”¨è¿œç¨‹æœåŠ¡</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>skuReductionTo<span class="token punctuation">.</span><span class="token function">getFullCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span>
        <span class="token operator">||</span> skuReductionTo<span class="token punctuation">.</span><span class="token function">getFullPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span>
        <span class="token operator">||</span> firstMemberPrice<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">R</span> r1 <span class="token operator">=</span> couponFeignService<span class="token punctuation">.</span><span class="token function">saveSkuReduction</span><span class="token punctuation">(</span>skuReductionTo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>r1<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;è¿œç¨‹ä¿å­˜skuä¼˜æƒ ä¿¡æ¯å¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.6.4.2.1.png" alt="image-20220613162718750" tabindex="0" loading="lazy"><figcaption>image-20220613162718750</figcaption></figure><p>è°ƒè¯•å¯ä»¥çœ‹åˆ°<code>skuReductionTo</code>ç±»çš„<code>memberPrice</code>å­—æ®µå·²ç»å˜ä¸ºæ­£ç¡®çš„<code>SkuReductionTo$MemberPrice</code>é›†åˆ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.6.4.2.2.png" alt="image-20220613164406730" tabindex="0" loading="lazy"><figcaption>image-20220613164406730</figcaption></figure><h6 id="æ–¹æ³•ä¸‰-1" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•ä¸‰-1" aria-hidden="true">#</a> æ–¹æ³•ä¸‰</h6><p>å¯ä»¥å°†æ–°å»ºä¸€ä¸ª<code>pubic</code>ä¿®é¥°çš„<code>MemberPrice</code>ç±»ï¼Œå¹¶åˆ é™¤<code>SpuSaveVo</code>ç±»å’Œ<code>SkuReductionTo</code>ç±»çš„<code>MemberPrice</code>å†…éƒ¨ç±»ï¼Œ</p><p>è®©<code>SpuSaveVo</code>ç±»å’Œ<code>SkuReductionTo</code>ç±»éƒ½ä½¿ç”¨æ–°å»ºçš„<code>MemberPrice</code>ç±»ï¼Œè¿™æ ·ä¹Ÿä¸ä¼šæœ‰å¼‚å¸¸ç±»</p><h4 id="_7ã€é‡æ–°æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_7ã€é‡æ–°æµ‹è¯•" aria-hidden="true">#</a> 7ã€é‡æ–°æµ‹è¯•</h4><h5 id="_1ã€æ¸…ç©ºæ•°æ®" tabindex="-1"><a class="header-anchor" href="#_1ã€æ¸…ç©ºæ•°æ®" aria-hidden="true">#</a> 1ã€æ¸…ç©ºæ•°æ®</h5><p>æ‰“å¼€åˆšåˆšæ³¨é‡Šçš„è¿œç¨‹è°ƒç”¨ï¼Œä½¿å…¶å¯ä»¥è¿œç¨‹è°ƒç”¨</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.1.1.png" alt="image-20220613171446817" tabindex="0" loading="lazy"><figcaption>image-20220613171446817</figcaption></figure><p>æ¸…ç©º<code>gulimall_pms</code>æ•°æ®åº“ä¸­<code>pms_product_attr_value</code>è¡¨çš„æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.1.2.png" alt="image-20220613200905318" tabindex="0" loading="lazy"><figcaption>image-20220613200905318</figcaption></figure><p>æˆªæ–­<code>gulimall_pms</code>æ•°æ®åº“ä¸­<code>pms_product_attr_value</code>è¡¨çš„æ•°æ®(å…¶å®å¯ä»¥ä¸ç”¨æ¸…ç©ºï¼Œç›´æ¥æˆªæ–­)</p><p>æ¸…ç©ºè¡¨åªä¼šåˆ é™¤è¡¨ä¸­çš„æ•°æ®ï¼Œæ’å…¥æ—¶å¦‚æœä¸æŒ‡å®š<code>id</code>çš„è¯ï¼Œ<code>id</code>è¿˜æ˜¯ä¼šç»§ç»­å‘åé€’å¢ï¼›</p><p>è€Œæˆªæ–­è¡¨ä¸ä»…ä¼šåˆ é™¤è¡¨ä¸­çš„æ•°æ®ï¼Œ<code>id</code>ä¹Ÿä¼šé‡æ–°ä»<code>1</code>å¼€å§‹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.1.3.png" alt="image-20220613200938323" tabindex="0" loading="lazy"><figcaption>image-20220613200938323</figcaption></figure><p>éœ€è¦<code>æ¸…ç©º</code>å¹¶<code>æˆªæ–­</code>å¦‚ä¸‹è¡¨(å¯ä»¥ä¸ç”¨æ¸…ç©ºï¼Œç›´æ¥æˆªæ–­)ï¼Œ<strong>å¯ä»¥å…ˆå¤‡ä»½è¿™ä¸¤ä¸ªæ•°æ®åº“ï¼Œé˜²æ­¢åˆ é”™äº†</strong></p><p><strong><code>gulimall_pms</code>æ•°æ®åº“</strong></p><ol><li>pms_product_attr_value</li><li>pms_sku_images</li><li>pms_sku_info</li><li>pms_sku_sale_attr_value</li><li>pms_spu_images</li><li>pms_spu_info</li><li>pms_spu_info_desc</li></ol><p><strong><code>gulimall_sms</code>æ•°æ®åº“</strong></p><ol><li>sms_member_price</li><li>sms_sku_full_reduction</li><li>sms_sku_ladder</li><li>sms_spu_bounds</li></ol><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.1.4.png" alt="image-20220613173419233" style="zoom:67%;"><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.1.5.png" alt="image-20220613173527547" style="zoom:67%;"><p>ç‚¹å‡»<code>gulimall_pms</code>æ•°æ®åº“ï¼Œå³é”®é€‰æ‹©<code>è½¬å‚¨ SQL æ–‡ä»¶</code> ï¼Œç„¶åé€‰æ‹©<code>ç»“æ„å’Œæ•°æ®...</code>ï¼Œä»¥å¤åˆ¶<code>gulimall_pms</code>æ•°æ®åº“ï¼Œå¦‚æœè¯¯åˆ äº†å¯ä»¥æ¢å¤æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.1.6.png" alt="image-20220613203942743" tabindex="0" loading="lazy"><figcaption>image-20220613203942743</figcaption></figure><p>åŒç†ï¼Œç‚¹å‡»<code>gulimall_sms</code>æ•°æ®åº“ï¼Œå³é”®é€‰æ‹©<code>è½¬å‚¨ SQL æ–‡ä»¶</code> ï¼Œç„¶åé€‰æ‹©<code>ç»“æ„å’Œæ•°æ®...</code>ï¼Œä»¥å¤åˆ¶<code>gulimall_sms</code>æ•°æ®åº“ï¼Œå¦‚æœè¯¯åˆ äº†å¯ä»¥æ¢å¤æ•°æ®(è¿˜å¯ä»¥å¤åˆ¶å…¶ä»–æ•°æ®åº“<code>ç»“æ„å’Œæ•°æ®...</code>ï¼Œé˜²æ­¢è¯¯åˆ é™¤å…¶ä»–æ•°æ®åº“ä¸­çš„æ•°æ®äº†)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.1.7.png" alt="image-20220613204017921" tabindex="0" loading="lazy"><figcaption>image-20220613204017921</figcaption></figure><h5 id="_2ã€é‡å¯æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_2ã€é‡å¯æ¨¡å—" aria-hidden="true">#</a> 2ã€é‡å¯æ¨¡å—</h5><p>é‡å¯<code>GulimallProductApplication</code>æ¨¡å—</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.2.1.png" alt="image-20220613204112485" tabindex="0" loading="lazy"><figcaption>image-20220613204112485</figcaption></figure><p>é‡å¯<code>GulimallCouponApplication</code>æ•°æ®åº“</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.2.2.png" alt="image-20220613204145602" tabindex="0" loading="lazy"><figcaption>image-20220613204145602</figcaption></figure><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»çš„<code>saveSpuInfo</code>æ–¹æ³•é‡Œï¼Œå¯¹æ‰€æœ‰æ“ä½œæ•°æ®åº“çš„ä»£ç éƒ½æ‰“æ–­ç‚¹(åŒ…æ‹¬è¿œç¨‹è°ƒç”¨ä»£ç )ï¼Œæ€»å…±9å¤„æ–­ç‚¹</p><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.2.3.png" alt="image-20220613211118601" style="zoom:50%;"><h5 id="_3ã€å‘é€è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_3ã€å‘é€è¯·æ±‚" aria-hidden="true">#</a> 3ã€å‘é€è¯·æ±‚</h5><p>æ‰“å¼€ä¿å­˜çš„è‹¹æœçš„è¯·æ±‚ï¼Œä»<code>spuadd.vue?c0e3:697 ~~~~~</code>åé¢çš„ç¬¬ä¸€ä¸ª<code>{</code>å¼€å§‹å¤åˆ¶ï¼Œä¸€ç›´å¤åˆ¶åˆ°æœ€å</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.3.1.png" alt="image-20220613204932016" tabindex="0" loading="lazy"><figcaption>image-20220613204932016</figcaption></figure><p>æ‰“å¼€<code>Postman</code></p><ol><li>è¾“å…¥&quot;http://localhost:88/api/product/spuinfo/save&quot;</li><li>è¯·æ±‚æ–¹å¼é€‰æ‹©&quot;POST&quot;</li><li>ç‚¹å‡»<code>Body</code></li><li>ç‚¹å‡»<code>raw</code></li><li>é€‰æ‹©<code>JSON</code></li><li>ç²˜è´´åˆšåˆšå¤åˆ¶çš„JSON</li><li>ç‚¹å‡»<code>Send</code></li></ol><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.3.2.png" alt="image-20220613204726065" tabindex="0" loading="lazy"><figcaption>image-20220613204726065</figcaption></figure><h5 id="_4ã€æŸ¥çœ‹æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_4ã€æŸ¥çœ‹æ•°æ®" aria-hidden="true">#</a> 4ã€æŸ¥çœ‹æ•°æ®</h5><h6 id="_1ã€ä¿å­˜spuåŸºæœ¬ä¿¡æ¯-pms-spu-info" tabindex="-1"><a class="header-anchor" href="#_1ã€ä¿å­˜spuåŸºæœ¬ä¿¡æ¯-pms-spu-info" aria-hidden="true">#</a> 1ã€ä¿å­˜spuåŸºæœ¬ä¿¡æ¯ pms_spu_info</h6><p>ç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code>this.saveBaseSpuInfo(spuInfoEntity);</code>è¿™æ®µä»£ç </p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.1.1.png" alt="image-20220613211238135" tabindex="0" loading="lazy"><figcaption>image-20220613211238135</figcaption></figure><p>åœ¨<code>navicat</code>è½¯ä»¶é‡Œç‚¹å‡»<code>gulimall_pms</code>æ•°æ®åº“ï¼Œå³é”®é€‰æ‹©<code>æ–°å»ºæŸ¥è¯¢</code></p><p>ğŸ“ ä»¥ä¸‹<code>sql</code>ä¸ºè¯¥<code>æ–°å»ºæŸ¥è¯¢</code>ç”¨åˆ°çš„æ‰€æœ‰<code>sql</code>è¯­å¥</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>set session transaction isolation level read uncommitted;
select * from pms_spu_info;
select * from pms_spu_info_desc;
select * from pms_spu_images;
select * from pms_product_attr_value;
select * from pms_sku_info;
select * from pms_sku_images;
select * from pms_sku_sale_attr_value;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.1.2.png" alt="image-20220613225416756" tabindex="0" loading="lazy"><figcaption>image-20220613225416756</figcaption></figure><p>è¾“å…¥ä»¥ä¸‹<code>sql</code>ï¼Œè®¾ç½®å½“å‰ä¼šè¯çš„éš”ç¦»çº§åˆ«ä¸º<code>è¯»æœªæäº¤</code>,å¹¶æŸ¥è¯¢<code>gulimall_pms</code>æ•°æ®åº“é‡Œ,<code>pms_spu_info</code>è¡¨ä¸­çš„æ•°æ®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>set session transaction isolation level read uncommitted;
select * from pms_spu_info;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.1.3.png" alt="image-20220613224818155" tabindex="0" loading="lazy"><figcaption>image-20220613224818155</figcaption></figure><h6 id="_2ã€ä¿å­˜spuçš„æè¿°-pms-spu-info-desc" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿å­˜spuçš„æè¿°-pms-spu-info-desc" aria-hidden="true">#</a> 2ã€ä¿å­˜Spuçš„æè¿° pms_spu_info_desc</h6><p>ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹åœæ­¢(ä¸æ‰§è¡Œè¯¥æ–­ç‚¹)ï¼Œç„¶åç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code>spuInfoDescService.saveSpuInfoDesc(spuInfoDescEntity);</code>è¿™æ®µä»£ç </p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.2.1.png" alt="image-20220613223914215" tabindex="0" loading="lazy"><figcaption>image-20220613223914215</figcaption></figure><p>åœ¨<code>gulimall_pms</code>æ•°æ®åº“çš„<code>æ–°å»ºæŸ¥è¯¢</code>é‡Œæ·»åŠ <code>sql</code>è¯­å¥ï¼Œå¹¶é€‰ä¸­åˆšåˆšæ·»åŠ åˆ°<code>sql</code>è¯­å¥ï¼Œç‚¹å‡»<code>è¿è¡Œå·²é€‰æ‹©çš„</code>,å³å¯æŸ¥çœ‹åˆšåˆšä¿å­˜çš„æ•°æ®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from pms_spu_info_desc;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.2.2.png" alt="image-20220613224920966" tabindex="0" loading="lazy"><figcaption>image-20220613224920966</figcaption></figure><h6 id="_3ã€ä¿å­˜spuçš„å›¾ç‰‡é›†-pms-spu-images" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿å­˜spuçš„å›¾ç‰‡é›†-pms-spu-images" aria-hidden="true">#</a> 3ã€ä¿å­˜spuçš„å›¾ç‰‡é›† pms_spu_images</h6><p>ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹åœæ­¢(ä¸æ‰§è¡Œè¯¥æ–­ç‚¹)ï¼Œç„¶åç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code>spuImagesService.saveImages(spuInfoEntity.getId(), images);</code>è¿™è¡Œä»£ç </p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.3.1.png" alt="image-20220613224052953" tabindex="0" loading="lazy"><figcaption>image-20220613224052953</figcaption></figure><p>åœ¨<code>gulimall_pms</code>æ•°æ®åº“çš„<code>æ–°å»ºæŸ¥è¯¢</code>é‡Œæ·»åŠ <code>sql</code>è¯­å¥ï¼Œå¹¶é€‰ä¸­åˆšåˆšæ·»åŠ åˆ°<code>sql</code>è¯­å¥ï¼Œç‚¹å‡»<code>è¿è¡Œå·²é€‰æ‹©çš„</code>,å³å¯æŸ¥çœ‹åˆšåˆšä¿å­˜çš„æ•°æ®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from pms_spu_images;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.3.2.png" alt="image-20220613225025623" tabindex="0" loading="lazy"><figcaption>image-20220613225025623</figcaption></figure><h6 id="_4ã€ä¿å­˜spuçš„è§„æ ¼å‚æ•°-pms-product-attr-value" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿å­˜spuçš„è§„æ ¼å‚æ•°-pms-product-attr-value" aria-hidden="true">#</a> 4ã€ä¿å­˜spuçš„è§„æ ¼å‚æ•°ï¼›pms_product_attr_value</h6><p>ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹åœæ­¢(ä¸æ‰§è¡Œè¯¥æ–­ç‚¹)ï¼Œç„¶åç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code>productAttrValueService.saveProductAttr(productAttrValueEntities);</code>è¿™è¡Œä»£ç </p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.4.1.png" alt="image-20220613224503399" tabindex="0" loading="lazy"><figcaption>image-20220613224503399</figcaption></figure><p>åœ¨<code>gulimall_pms</code>æ•°æ®åº“çš„<code>æ–°å»ºæŸ¥è¯¢</code>é‡Œæ·»åŠ <code>sql</code>è¯­å¥ï¼Œå¹¶é€‰ä¸­åˆšåˆšæ·»åŠ åˆ°<code>sql</code>è¯­å¥ï¼Œç‚¹å‡»<code>è¿è¡Œå·²é€‰æ‹©çš„</code>,å³å¯æŸ¥çœ‹åˆšåˆšä¿å­˜çš„æ•°æ®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from pms_product_attr_value;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.4.2.png" alt="image-20220613224716339" tabindex="0" loading="lazy"><figcaption>image-20220613224716339</figcaption></figure><h6 id="_5ã€è¿œç¨‹ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯-gulimall-sms-sms-spu-bounds" tabindex="-1"><a class="header-anchor" href="#_5ã€è¿œç¨‹ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯-gulimall-sms-sms-spu-bounds" aria-hidden="true">#</a> 5ã€è¿œç¨‹ä¿å­˜spuçš„ç§¯åˆ†ä¿¡æ¯; gulimall_sms-&gt;sms_spu_bounds</h6><p>ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹åœæ­¢(ä¸æ‰§è¡Œè¯¥æ–­ç‚¹)ï¼Œç„¶åç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code>R r = couponFeignService.saveSpuBounds(spuBoundTo);</code>è¿™è¡Œä»£ç </p><p>ç”±äºè¯¥æ–¹æ³•è¦è¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œæ‰€ä»¥è¿™è¿™è¡Œä»£ç è¦æ‰§è¡Œçš„ä¹…ä¸€ç‚¹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.5.0.1.png" alt="image-20220613225213723" tabindex="0" loading="lazy"><figcaption>image-20220613225213723</figcaption></figure><p>åœ¨<code>navicat</code>è½¯ä»¶é‡Œç‚¹å‡»<code>gulimall_sms</code>æ•°æ®åº“ï¼Œå³é”®é€‰æ‹©<code>æ–°å»ºæŸ¥è¯¢</code></p><p>ğŸ“ ä»¥ä¸‹<code>sql</code>ä¸ºè¯¥<code>æ–°å»ºæŸ¥è¯¢</code>ç”¨åˆ°çš„æ‰€æœ‰<code>sql</code>è¯­å¥</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>set session transaction isolation level read uncommitted;
select * from sms_spu_bounds;
select * from sms_sku_ladder;
select * from sms_sku_full_reduction;
select * from sms_member_price;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.5.0.2.png" alt="image-20220613225452678" tabindex="0" loading="lazy"><figcaption>image-20220613225452678</figcaption></figure><p>è¾“å…¥ä»¥ä¸‹<code>sql</code>ï¼Œè®¾ç½®å½“å‰ä¼šè¯çš„éš”ç¦»çº§åˆ«ä¸º<code>è¯»æœªæäº¤</code>,å¹¶æŸ¥è¯¢<code>gulimall_sms</code>æ•°æ®åº“é‡Œ,<code>sms_spu_bounds</code>è¡¨ä¸­çš„æ•°æ®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>set session transaction isolation level read uncommitted;
select * from sms_spu_bounds;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.5.0.3.png" alt="image-20220613225559481" tabindex="0" loading="lazy"><figcaption>image-20220613225559481</figcaption></figure><h6 id="_5-1ã€skuçš„åŸºæœ¬ä¿¡æ¯-pms-sku-info" tabindex="-1"><a class="header-anchor" href="#_5-1ã€skuçš„åŸºæœ¬ä¿¡æ¯-pms-sku-info" aria-hidden="true">#</a> 5.1ã€skuçš„åŸºæœ¬ä¿¡æ¯; pms_sku_info</h6><p>ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹åœæ­¢(ä¸æ‰§è¡Œè¯¥æ–­ç‚¹)ï¼Œç„¶åç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code>skuInfoService.saveSkuInfo(skuInfoEntity);</code>è¿™è¡Œä»£ç </p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.5.1.1.png" alt="image-20220613225814817" tabindex="0" loading="lazy"><figcaption>image-20220613225814817</figcaption></figure><p>åœ¨<code>gulimall_pms</code>æ•°æ®åº“çš„<code>æ–°å»ºæŸ¥è¯¢</code>é‡Œæ·»åŠ <code>sql</code>è¯­å¥ï¼Œå¹¶é€‰ä¸­åˆšåˆšæ·»åŠ åˆ°<code>sql</code>è¯­å¥ï¼Œç‚¹å‡»<code>è¿è¡Œå·²é€‰æ‹©çš„</code>,å³å¯æŸ¥çœ‹åˆšåˆšä¿å­˜çš„æ•°æ®</p><p>(ä¸å°å¿ƒæŠŠ<code>select * from pms_product_attr_value;</code>è¿™è¡Œä»£ç åˆ äº†)</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from pms_sku_info;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.5.1.2.png" alt="image-20220613225728853" tabindex="0" loading="lazy"><figcaption>image-20220613225728853</figcaption></figure><h6 id="_5-2ã€skuçš„å›¾ç‰‡ä¿¡æ¯-pms-sku-images" tabindex="-1"><a class="header-anchor" href="#_5-2ã€skuçš„å›¾ç‰‡ä¿¡æ¯-pms-sku-images" aria-hidden="true">#</a> 5.2ã€skuçš„å›¾ç‰‡ä¿¡æ¯; pms_sku_images</h6><p>ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹åœæ­¢(ä¸æ‰§è¡Œè¯¥æ–­ç‚¹)ï¼Œç„¶åç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code>skuImagesService.saveBatch(skuImagesEntities);</code>è¿™è¡Œä»£ç </p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.5.2.1.png" alt="image-20220613230444086" tabindex="0" loading="lazy"><figcaption>image-20220613230444086</figcaption></figure><p>åœ¨<code>gulimall_pms</code>æ•°æ®åº“çš„<code>æ–°å»ºæŸ¥è¯¢</code>é‡Œæ·»åŠ <code>sql</code>è¯­å¥ï¼Œå¹¶é€‰ä¸­åˆšåˆšæ·»åŠ åˆ°<code>sql</code>è¯­å¥ï¼Œç‚¹å‡»<code>è¿è¡Œå·²é€‰æ‹©çš„</code>,å³å¯æŸ¥çœ‹åˆšåˆšä¿å­˜çš„æ•°æ®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from pms_sku_images;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹åˆ°è¿™æ—¶æ²¡æœ‰<code>img_url</code>ä¸º<code>null</code>çš„æ•°æ®äº†(<code>img_url</code>ä¸º<code>null</code>çš„æ•°æ®éƒ½è¢«è¿‡æ»¤æ‰äº†ï¼Œä¸ä¼šä¿å­˜åˆ°æ•°æ®åº“äº†)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.5.2.2.png" alt="image-20220613230557481" tabindex="0" loading="lazy"><figcaption>image-20220613230557481</figcaption></figure><h6 id="_5-3ã€skuçš„é”€å”®å±æ€§ä¿¡æ¯-pms-sku-sale-attr-value" tabindex="-1"><a class="header-anchor" href="#_5-3ã€skuçš„é”€å”®å±æ€§ä¿¡æ¯-pms-sku-sale-attr-value" aria-hidden="true">#</a> 5.3ã€skuçš„é”€å”®å±æ€§ä¿¡æ¯: pms_sku_sale_attr_value</h6><p>ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹åœæ­¢(ä¸æ‰§è¡Œè¯¥æ–­ç‚¹)ï¼Œç„¶åç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code>skuSaleAttrValueService.saveBatch(skuSaleAttrValueEntities);</code>è¿™è¡Œä»£ç </p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.5.3.1.png" alt="image-20220613230754102" tabindex="0" loading="lazy"><figcaption>image-20220613230754102</figcaption></figure><p>åœ¨<code>gulimall_pms</code>æ•°æ®åº“çš„<code>æ–°å»ºæŸ¥è¯¢</code>é‡Œæ·»åŠ <code>sql</code>è¯­å¥ï¼Œå¹¶é€‰ä¸­åˆšåˆšæ·»åŠ åˆ°<code>sql</code>è¯­å¥ï¼Œç‚¹å‡»<code>è¿è¡Œå·²é€‰æ‹©çš„</code>,å³å¯æŸ¥çœ‹åˆšåˆšä¿å­˜çš„æ•°æ®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from pms_sku_sale_attr_value;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.5.3.2.png" alt="image-20220613230855981" tabindex="0" loading="lazy"><figcaption>image-20220613230855981</figcaption></figure><h6 id="_5-4ã€è¿œç¨‹ä¿å­˜skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯-gulimall-sms-sms-sku-ladder-sms-sku-full-reduction-sms-member-price" tabindex="-1"><a class="header-anchor" href="#_5-4ã€è¿œç¨‹ä¿å­˜skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯-gulimall-sms-sms-sku-ladder-sms-sku-full-reduction-sms-member-price" aria-hidden="true">#</a> 5.4ã€è¿œç¨‹ä¿å­˜skuçš„ä¼˜æƒ ã€æ»¡å‡ã€æ‰“æŠ˜ç­‰ä¿¡æ¯ï¼›gulimall_sms-&gt;sms_sku_ladder\\sms_sku_full_reduction\\sms_ member_price</h6><p>ç‚¹å‡»<code>Resume Program</code>æŒ‰é’®ï¼Œæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹åœæ­¢(ä¸æ‰§è¡Œè¯¥æ–­ç‚¹)ï¼Œç„¶åç‚¹å‡»è°ƒè¯•çš„<code>Step Over(æ­¥è¿‡)</code>æŒ‰é’®ï¼Œæ‰§è¡Œ<code>R r1 = couponFeignService.saveSkuReduction(skuReductionTo);</code>è¿™è¡Œä»£ç </p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.5.4.1.png" alt="image-20220613231325398" tabindex="0" loading="lazy"><figcaption>image-20220613231325398</figcaption></figure><p>åœ¨<code>gulimall-coupon</code>æ¨¡å—çš„<code>com.atguigu.gulimall.coupon.service.impl.SkuFullReductionServiceImpl</code>ç±»çš„<code>saveSkuReduction</code>æ–¹æ³•é‡Œè®¾ç½®äº†<code>æœ‰æ‰“æŠ˜ä¿¡æ¯æ‰ä¿å­˜</code>ã€<code>æœ‰æ»¡å‡ä¿¡æ¯æ‰ä¿å­˜</code>ã€<code>æœ‰ä¼šå‘˜ä¼˜æƒ ä¿¡æ¯æ‰ä¿å­˜</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.5.4.2.png" alt="image-20220613231505771" tabindex="0" loading="lazy"><figcaption>image-20220613231505771</figcaption></figure><p>åœ¨<code>gulimall_sms</code>æ•°æ®åº“çš„<code>æ–°å»ºæŸ¥è¯¢</code>é‡Œæ·»åŠ <code>sql</code>è¯­å¥ï¼Œå¹¶é€‰ä¸­åˆšåˆšæ·»åŠ åˆ°<code>sql</code>è¯­å¥ï¼Œç‚¹å‡»<code>è¿è¡Œå·²é€‰æ‹©çš„</code>,å³å¯æŸ¥çœ‹åˆšåˆšä¿å­˜çš„æ•°æ®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from sms_sku_ladder;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹åˆ°æ²¡æœ‰<code>æ‰“æŠ˜ä¿¡æ¯</code>ä¸ºç©ºçš„æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.5.4.3.png" alt="image-20220613231951960" tabindex="0" loading="lazy"><figcaption>image-20220613231951960</figcaption></figure><p>åœ¨<code>gulimall_sms</code>æ•°æ®åº“çš„<code>æ–°å»ºæŸ¥è¯¢</code>é‡Œæ·»åŠ <code>sql</code>è¯­å¥ï¼Œå¹¶é€‰ä¸­åˆšåˆšæ·»åŠ åˆ°<code>sql</code>è¯­å¥ï¼Œç‚¹å‡»<code>è¿è¡Œå·²é€‰æ‹©çš„</code>,å³å¯æŸ¥çœ‹åˆšåˆšä¿å­˜çš„æ•°æ®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from sms_sku_full_reduction;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹åˆ°æ²¡æœ‰<code>æ»¡å‡ä¿¡æ¯</code>ä¸ºç©ºçš„æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.5.4.4.png" alt="image-20220613232056519" tabindex="0" loading="lazy"><figcaption>image-20220613232056519</figcaption></figure><p>åœ¨<code>gulimall_sms</code>æ•°æ®åº“çš„<code>æ–°å»ºæŸ¥è¯¢</code>é‡Œæ·»åŠ <code>sql</code>è¯­å¥ï¼Œå¹¶é€‰ä¸­åˆšåˆšæ·»åŠ åˆ°<code>sql</code>è¯­å¥ï¼Œç‚¹å‡»<code>è¿è¡Œå·²é€‰æ‹©çš„</code>,å³å¯æŸ¥çœ‹åˆšåˆšä¿å­˜çš„æ•°æ®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select * from sms_member_price;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹åˆ°æ²¡æœ‰<code>ä¼šå‘˜ä¼˜æƒ ä¿¡æ¯</code>ä¸ºç©ºçš„æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.4.5.4.5.png" alt="image-20220613232324450" tabindex="0" loading="lazy"><figcaption>image-20220613232324450</figcaption></figure><h5 id="_5ã€æˆªæ–­è¡¨-é‡æ–°å‘é€æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_5ã€æˆªæ–­è¡¨-é‡æ–°å‘é€æ•°æ®" aria-hidden="true">#</a> 5ã€æˆªæ–­è¡¨ï¼Œé‡æ–°å‘é€æ•°æ®</h5><p>æ¸…ç©ºå¹¶æˆªæ–­è¡¨(å…¶å®å¯ä»¥ä¸æ¸…ç©ºï¼Œç›´æ¥æˆªæ–­)ï¼Œåˆ é™¤<code>gulimall_pms</code>æ•°æ®åº“<code>pms_product_attr_value</code>è¡¨é‡Œé¢çš„æ•°æ®(å«æœ‰å¤§é‡åƒåœ¾æ•°æ®)</p><p>åŒç†æ¸…ç©ºå¹¶æˆªæ–­(å…¶å®å¯ä»¥ä¸æ¸…ç©ºï¼Œç›´æ¥æˆªæ–­)ä»¥ä¸‹æ‰€æœ‰è¡¨</p><p><strong><code>gulimall_pms</code>æ•°æ®åº“</strong></p><ol><li>pms_product_attr_value</li><li>pms_sku_images</li><li>pms_sku_info</li><li>pms_sku_sale_attr_value</li><li>pms_spu_images</li><li>pms_spu_info</li><li>pms_spu_info_desc</li></ol><p><strong><code>gulimall_sms</code>æ•°æ®åº“</strong></p><ol><li>sms_member_price</li><li>sms_sku_full_reduction</li><li>sms_sku_ladder</li><li>sms_spu_bounds</li></ol><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.5.1.png" alt="image-20220613233757008" tabindex="0" loading="lazy"><figcaption>image-20220613233757008</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.5.2.png" alt="image-20220613233828662" tabindex="0" loading="lazy"><figcaption>image-20220613233828662</figcaption></figure><p>é‡æ–°å‘åç«¯å‘é€<code>åä¸ºæ‰‹æœº</code>å’Œ<code>è‹¹æœæ‰‹æœº</code>å•†å“çš„<code>json</code>æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.5.3.png" alt="image-20220619174732338" tabindex="0" loading="lazy"><figcaption>image-20220619174732338</figcaption></figure><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.6.9.7.5.4.png" alt="image-20220613233312152" tabindex="0" loading="lazy"><figcaption>image-20220613233312152</figcaption></figure><h5 id="_6ã€é™„å½•" tabindex="-1"><a class="header-anchor" href="#_6ã€é™„å½•" aria-hidden="true">#</a> 6ã€é™„å½•</h5><h6 id="_1ã€gulimall-pmsæ•°æ®åº“çš„æ–°å»ºæŸ¥è¯¢é‡Œçš„æ‰€æœ‰sqlè¯­å¥" tabindex="-1"><a class="header-anchor" href="#_1ã€gulimall-pmsæ•°æ®åº“çš„æ–°å»ºæŸ¥è¯¢é‡Œçš„æ‰€æœ‰sqlè¯­å¥" aria-hidden="true">#</a> 1ã€<code>gulimall_pms</code>æ•°æ®åº“çš„<code>æ–°å»ºæŸ¥è¯¢</code>é‡Œçš„æ‰€æœ‰<code>sql</code>è¯­å¥</h6><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>set session transaction isolation level read uncommitted;
select * from pms_spu_info;
select * from pms_spu_info_desc;
select * from pms_spu_images;
select * from pms_product_attr_value;
select * from pms_sku_info;
select * from pms_sku_images;
select * from pms_sku_sale_attr_value;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2ã€gulimall-smsæ•°æ®åº“çš„æ–°å»ºæŸ¥è¯¢é‡Œçš„æ‰€æœ‰sqlè¯­å¥" tabindex="-1"><a class="header-anchor" href="#_2ã€gulimall-smsæ•°æ®åº“çš„æ–°å»ºæŸ¥è¯¢é‡Œçš„æ‰€æœ‰sqlè¯­å¥" aria-hidden="true">#</a> 2ã€<code>gulimall_sms</code>æ•°æ®åº“çš„<code>æ–°å»ºæŸ¥è¯¢</code>é‡Œçš„æ‰€æœ‰<code>sql</code>è¯­å¥</h6><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>set session transaction isolation level read uncommitted;
select * from sms_spu_bounds;
select * from sms_sku_ladder;
select * from sms_sku_full_reduction;
select * from sms_member_price;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-7ã€å•†å“æœåŠ¡-api-å•†å“ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_4-7ã€å•†å“æœåŠ¡-api-å•†å“ç®¡ç†" aria-hidden="true">#</a> 4.7ã€å•†å“æœåŠ¡-API-å•†å“ç®¡ç†</h2><h3 id="_4-7-1ã€spuæ£€ç´¢" tabindex="-1"><a class="header-anchor" href="#_4-7-1ã€spuæ£€ç´¢" aria-hidden="true">#</a> 4.7.1ã€SPUæ£€ç´¢</h3><h4 id="_1ã€æŸ¥çœ‹è¯·æ±‚-7" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹è¯·æ±‚-7" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹è¯·æ±‚</h4><p>åœ¨<code>å•†å“ç³»ç»Ÿ</code>-&gt;<code>å•†å“ç»´æŠ¤</code>-&gt;<code>spuç®¡ç†</code>é‡Œï¼Œ<code>åˆ†ç±»</code>é€‰æ‹©<code>æ‰‹æœº/æ‰‹æœºé€šè®¯/æ‰‹æœº</code>ï¼Œ<code>å“ç‰Œ</code>é€‰æ‹©<code>åä¸º</code>,<code>çŠ¶æ€</code>é€‰æ‹©<code>ä¸Šæ¶</code>,</p><p>æŒ‰<code>f12</code>é€‰æ‹©<code>Network</code>ï¼Œæ¸…ç©º<code>Network</code>é‡Œçš„æ•°æ®ï¼Œç„¶åç‚¹å‡»<code>æŸ¥è¯¢</code></p><p>ç„¶åæŸ¥çœ‹è¯·æ±‚urlä¸º</p><p><a href="">http:ğŸ˜•/localhost:88/api/product/spuinfo/list?t=1655170424813&amp;status=1&amp;key=&amp;brandId=1&amp;catelogId=225&amp;page=1&amp;limit=10</a></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.1.1.png" alt="image-20220614093602135" tabindex="0" loading="lazy"><figcaption>image-20220614093602135</figcaption></figure><p>ç‚¹å‡»<code>Payload</code>ï¼ŒæŸ¥çœ‹å‘é€çš„<code>json</code>æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.1.2.png" alt="image-20220614093637205" tabindex="0" loading="lazy"><figcaption>image-20220614093637205</figcaption></figure><p>æ¥å£æ–‡æ¡£åœ¨<code>å•†å“ç³»ç»Ÿ/18ã€spuæ£€ç´¢</code>é‡Œ : https://easydoc.net/s/78237135/ZUqEdvA4/9LISLvy7</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.1.3.png" alt="image-20220614093404399" tabindex="0" loading="lazy"><figcaption>image-20220614093404399</figcaption></figure><h4 id="_2ã€ä¿®æ”¹listæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹listæ–¹æ³•" aria-hidden="true">#</a> 2ã€ä¿®æ”¹<code>list</code>æ–¹æ³•</h4><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.SpuInfoController</code>ç±»çš„<code>list</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * åˆ—è¡¨
 */</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/list&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">PageUtils</span> page <span class="token operator">=</span> spuInfoService<span class="token punctuation">.</span><span class="token function">queryPageByCondition</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">,</span> page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.2.png" alt="image-20220614094259175" tabindex="0" loading="lazy"><figcaption>image-20220614094259175</figcaption></figure><h4 id="_3ã€æ·»åŠ querypagebyconditionæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ querypagebyconditionæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>queryPageByCondition</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.SpuInfoService</code>æ¥å£é‡Œæ·»åŠ <code>queryPageByCondition</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">PageUtils</span> <span class="token function">queryPageByCondition</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.3.png" alt="image-20220614094320514" tabindex="0" loading="lazy"><figcaption>image-20220614094320514</figcaption></figure><h4 id="_4ã€å®ç°querypagebyconditionæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€å®ç°querypagebyconditionæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€å®ç°<code>queryPageByCondition</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SpuInfoServiceImpl</code>ç±»é‡Œå®ç°æœªå®ç°çš„<code>queryPageByCondition</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ ¹æ®æ¡ä»¶åˆ†é¡µæŸ¥è¯¢
 * <span class="token punctuation">{</span>
 *    page: 1,//å½“å‰é¡µç 
 *    limit: 10,//æ¯é¡µè®°å½•æ•°
 *    sidx: &#39;id&#39;,//æ’åºå­—æ®µ
 *    order: &#39;asc/desc&#39;,//æ’åºæ–¹å¼
 *    key: &#39;åä¸º&#39;,//æ£€ç´¢å…³é”®å­—
 *    catelogId: 6,//ä¸‰çº§åˆ†ç±»id
 *    brandId: 1,//å“ç‰Œid
 *    status: 0,//å•†å“çŠ¶æ€
 * <span class="token punctuation">}</span>
 * <span class="token keyword">@param</span> <span class="token parameter">params</span>
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">queryPageByCondition</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SpuInfoEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ ¹æ®&quot;key&quot;ï¼Œç²¾ç¡®åŒ¹é…å•†å“id æˆ– æ¨¡ç³ŠæŸ¥è¯¢spu_name</span>
    <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span>wrapper<span class="token operator">-&gt;</span><span class="token punctuation">{</span>
        wrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">SpuInfoEntity</span><span class="token operator">::</span><span class="token function">getId</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">SpuInfoEntity</span><span class="token operator">::</span><span class="token function">getSpuName</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ ¹æ®statusç²¾ç¡®åŒ¹é…çŠ¶æ€</span>
    <span class="token class-name">String</span> status <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">SpuInfoEntity</span><span class="token operator">::</span><span class="token function">getPublishStatus</span><span class="token punctuation">,</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ ¹æ®brandIdç²¾ç¡®åŒ¹é…å“ç‰Œid</span>
    <span class="token class-name">String</span> brandId <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;brandId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>brandId<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">SpuInfoEntity</span><span class="token operator">::</span><span class="token function">getBrandId</span><span class="token punctuation">,</span>brandId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ ¹æ®catelogIdç²¾ç¡®åŒ¹é…æ‰€å±åˆ†ç±»idï¼ˆæ³¨æ„ï¼šå‰ç«¯å‘æ¥çš„æ˜¯catelogId,æ•°æ®åº“å†™çš„æ˜¯catalogIdï¼‰</span>
    <span class="token class-name">String</span> catelogId <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;catelogId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>catelogId<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">SpuInfoEntity</span><span class="token operator">::</span><span class="token function">getCatalogId</span><span class="token punctuation">,</span>catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SpuInfoEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SpuInfoEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span>
            lambdaQueryWrapper
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.4.png" alt="image-20220614112141228" tabindex="0" loading="lazy"><figcaption>image-20220614112141228</figcaption></figure><h4 id="_5ã€æµ‹è¯•-11" tabindex="-1"><a class="header-anchor" href="#_5ã€æµ‹è¯•-11" aria-hidden="true">#</a> 5ã€æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œæ‰“å¼€å‰ç«¯é¡µé¢è¿›è¡Œæµ‹è¯•</p><h5 id="æµ‹è¯•ä¸€" tabindex="-1"><a class="header-anchor" href="#æµ‹è¯•ä¸€" aria-hidden="true">#</a> æµ‹è¯•ä¸€</h5><p>æ‰“å¼€<code>å•†å“ç³»ç»Ÿ</code>-&gt;<code>å•†å“ç»´æŠ¤</code>-&gt;<code>spuç®¡ç†</code>,ä¿®æ”¹<code>çŠ¶æ€</code>ä¸º<code>ä¸Šæ¶</code>ï¼Œç‚¹å‡»<code>æŸ¥è¯¢</code>ï¼Œå¯ä»¥çœ‹åˆ°æ²¡æœ‰æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.5.1.1.png" alt="image-20220614112300493" tabindex="0" loading="lazy"><figcaption>image-20220614112300493</figcaption></figure><p>æŸ¥çœ‹<code>GulimallProductApplication</code>æ¨¡å—çš„æ§åˆ¶å°è¾“å‡ºçš„<code>sql</code>è¯­å¥ï¼Œå¯ä»¥çœ‹åˆ°<code>sql</code>è¯­å¥æ­£å¸¸</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>SELECT COUNT(1) FROM pms_spu_info WHERE (publish_status = ? AND brand_id = ? AND catalog_id = ?) 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.5.1.2.png" alt="image-20220614112931073" tabindex="0" loading="lazy"><figcaption>image-20220614112931073</figcaption></figure><h5 id="æµ‹è¯•äºŒ" tabindex="-1"><a class="header-anchor" href="#æµ‹è¯•äºŒ" aria-hidden="true">#</a> æµ‹è¯•äºŒ</h5><p>æ‰“å¼€<code>å•†å“ç³»ç»Ÿ</code>-&gt;<code>å•†å“ç»´æŠ¤</code>-&gt;<code>spuç®¡ç†</code>,ä¿®æ”¹<code>çŠ¶æ€</code>ä¸º<code>æ–°å»º</code>ï¼Œç‚¹å‡»<code>æŸ¥è¯¢</code>ï¼Œå¯ä»¥çœ‹åˆ°ä¸€æ¡æ•°æ®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.5.2.1.png" alt="image-20220614112329904" tabindex="0" loading="lazy"><figcaption>image-20220614112329904</figcaption></figure><p>æŸ¥çœ‹<code>GulimallProductApplication</code>æ¨¡å—çš„æ§åˆ¶å°è¾“å‡ºçš„<code>sql</code>è¯­å¥ï¼Œå¯ä»¥çœ‹åˆ°<code>sql</code>è¯­å¥æ­£å¸¸</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>SELECT COUNT(1) FROM pms_spu_info WHERE (brand_id = ? AND catalog_id = ?) 
SELECT id,spu_description,spu_name,catalog_id,create_time,brand_id,weight,update_time,publish_status FROM pms_spu_info WHERE (brand_id = ? AND catalog_id = ?) LIMIT ?,? 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.5.2.2.png" alt="image-20220614113208157" tabindex="0" loading="lazy"><figcaption>image-20220614113208157</figcaption></figure><p>æµ‹è¯•ä¸‰</p><p>æ‰“å¼€<code>å•†å“ç³»ç»Ÿ</code>-&gt;<code>å•†å“ç»´æŠ¤</code>-&gt;<code>spuç®¡ç†</code>ï¼Œ<code>æ£€ç´¢</code>çš„è¾“å…¥æ¡†ä¸­è¾“å…¥<code>1</code>ï¼Œç‚¹å‡»<code>æŸ¥è¯¢</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.5.3.1.png" alt="image-20220614112545011" tabindex="0" loading="lazy"><figcaption>image-20220614112545011</figcaption></figure><p>æŸ¥çœ‹<code>GulimallProductApplication</code>æ¨¡å—çš„æ§åˆ¶å°è¾“å‡ºçš„<code>sql</code>è¯­å¥ï¼Œå¯ä»¥çœ‹åˆ°<code>sql</code>è¯­å¥æ­£å¸¸</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>SELECT COUNT(1) FROM pms_spu_info WHERE (((id = ? OR spu_name LIKE ?)) AND brand_id = ? AND catalog_id = ?) 

SELECT id,spu_description,spu_name,catalog_id,create_time,brand_id,weight,update_time,publish_status FROM pms_spu_info WHERE (( (id = ? OR spu_name LIKE ?) ) AND brand_id = ? AND catalog_id = ?) LIMIT ?,? 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.5.3.2.png" alt="image-20220614113252034" tabindex="0" loading="lazy"><figcaption>image-20220614113252034</figcaption></figure><h4 id="_6ã€çŠ¶æ€å¼‚å¸¸é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_6ã€çŠ¶æ€å¼‚å¸¸é—®é¢˜" aria-hidden="true">#</a> 6ã€çŠ¶æ€å¼‚å¸¸é—®é¢˜</h4><p>å¦‚æœ<code>çŠ¶æ€</code>ä¸º<code>æ–°å»º</code>æ—¶ï¼Œ<code>status</code>ä¸º<code>1</code>åˆ™æ˜¯å‰ç«¯å’Œæ•°æ®åº“çš„çŠ¶æ€ç æ²¡æœ‰å¯¹åº”èµ·æ¥</p><p>æŸ¥çœ‹<code>src\\views\\modules\\product\\spuinfo.vue</code>æ–‡ä»¶çš„ä»¥ä¸‹ä»£ç ï¼Œè¿™é‡ŒæŒ‡å®šäº†<code>æ–°å»º</code>ã€<code>å·²ä¸Šæ¶</code>ã€<code>å·²ä¸‹æ¶</code>çŠ¶æ€åˆ†åˆ«ä¸º<code>0</code>ã€<code>1</code>ã€<code>2</code></p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>publishStatus<span class="token punctuation">&quot;</span></span> <span class="token attr-name">header-align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸Šæ¶çŠ¶æ€<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tag</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope.row.publishStatus == 0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>æ–°å»º<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tag</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tag</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope.row.publishStatus == 1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>å·²ä¸Šæ¶<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tag</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tag</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope.row.publishStatus == 2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>å·²ä¸‹æ¶<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tag</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.6.1.png" alt="image-20220614114116404" tabindex="0" loading="lazy"><figcaption>image-20220614114116404</figcaption></figure><p>æ£€ç´¢æ¡ä»¶åœ¨<code>src\\views\\modules\\product\\spu.vue</code>æ–‡ä»¶é‡Œï¼Œå¯ä»¥çœ‹åˆ°<code>spu.vue</code>æ–‡ä»¶å¼•ç”¨äº†<code>Spuinfo</code>æ–‡ä»¶</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.6.2.png" alt="image-20220614113806046" tabindex="0" loading="lazy"><figcaption>image-20220614113806046</figcaption></figure><p>ä¿®æ”¹<code>spu.vue</code>æ–‡ä»¶é‡Œçš„<code>çŠ¶æ€</code>é‡Œçš„ä¸åŒçŠ¶æ€å¯¹åº”çš„å€¼ï¼Œ<code>æ–°å»º</code>ã€<code>å·²ä¸Šæ¶</code>ã€<code>å·²ä¸‹æ¶</code>çŠ¶æ€åˆ†åˆ«ä¸º<code>0</code>ã€<code>1</code>ã€<code>2</code></p><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-select</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>160px</span><span class="token punctuation">&quot;</span></span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataForm.status<span class="token punctuation">&quot;</span></span> <span class="token attr-name">clearable</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-option</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ–°å»º<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-option</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-option</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸Šæ¶<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-option</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-option</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸‹æ¶<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-select</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.6.3.png" alt="image-20220614113850905" tabindex="0" loading="lazy"><figcaption>image-20220614113850905</figcaption></figure><h4 id="_7ã€ä¿®æ”¹æ—¶é—´æ ¼å¼å’Œæ—¶åŒº" tabindex="-1"><a class="header-anchor" href="#_7ã€ä¿®æ”¹æ—¶é—´æ ¼å¼å’Œæ—¶åŒº" aria-hidden="true">#</a> 7ã€ä¿®æ”¹æ—¶é—´æ ¼å¼å’Œæ—¶åŒº</h4><p>è€å¸ˆçš„æ—¶é—´<code>æ ¼å¼</code>ä¸ç¬¦åˆä¸­å›½äººä¹ æƒ¯</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.7.1.png" alt="image-20220619200710866" tabindex="0" loading="lazy"><figcaption>image-20220619200710866</figcaption></figure><p>è€Œæˆ‘çš„é¡¹ç›®<code>æ—¶åŒº</code>ä¸å¯¹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.7.2.png" alt="image-20220614115448525" tabindex="0" loading="lazy"><figcaption>image-20220614115448525</figcaption></figure><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>src/main/resources/application.yml</code>é…ç½®æ–‡ä»¶ï¼Œè®¾ç½®æ—¶é—´æ˜¾ç¤ºçš„æ ¼å¼</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">jackson</span><span class="token punctuation">:</span>
    <span class="token key atrule">date-format</span><span class="token punctuation">:</span> yyyy<span class="token punctuation">-</span>MM<span class="token punctuation">-</span>dd HH<span class="token punctuation">-</span>mm<span class="token punctuation">-</span>ss
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.7.3.png" alt="image-20220614114631103" tabindex="0" loading="lazy"><figcaption>image-20220614114631103</figcaption></figure><p>æ—¶åŒºæœ€å¥½ä¹Ÿè®¾ç½®ä¸€ä¸‹</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">jackson</span><span class="token punctuation">:</span>
    <span class="token key atrule">date-format</span><span class="token punctuation">:</span> yyyy<span class="token punctuation">-</span>MM<span class="token punctuation">-</span>dd HH<span class="token punctuation">-</span>mm<span class="token punctuation">-</span>ss
    <span class="token key atrule">time-zone</span><span class="token punctuation">:</span> GMT+8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.1.7.4.png" alt="image-20220614114810747" tabindex="0" loading="lazy"><figcaption>image-20220614114810747</figcaption></figure><h3 id="_4-7-2ã€skuæ£€ç´¢" tabindex="-1"><a class="header-anchor" href="#_4-7-2ã€skuæ£€ç´¢" aria-hidden="true">#</a> 4.7.2ã€SKUæ£€ç´¢</h3><h4 id="_1ã€æŸ¥çœ‹æ¥å£" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹æ¥å£" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹æ¥å£</h4><p>åœ¨<code>å•†å“ç³»ç»Ÿ/å•†å“ç»´æŠ¤/å•†å“ç®¡ç†</code>é‡Œç‚¹å‡»æŸ¥è¯¢ï¼ŒæŸ¥çœ‹è¯·æ±‚</p><p>urlï¼š http://localhost:88/api/product/skuinfo/list?t=1655193479594&amp;page=1&amp;limit=10&amp;key=&amp;catelogId=0&amp;brandId=0</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.2.1.1.png" alt="image-20220614155909254" tabindex="0" loading="lazy"><figcaption>image-20220614155909254</figcaption></figure><p>æ¥å£æ–‡æ¡£åœ¨<code>å•†å“ç³»ç»Ÿ/21ã€skuæ£€ç´¢</code>é‡Œï¼šhttps://easydoc.net/s/78237135/ZUqEdvA4/ucirLq1D</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.2.1.2.png" alt="image-20220614115218657" tabindex="0" loading="lazy"><figcaption>image-20220614115218657</figcaption></figure><h4 id="_2ã€ä¿®æ”¹listæ–¹æ³•-1" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹listæ–¹æ³•-1" aria-hidden="true">#</a> 2ã€ä¿®æ”¹<code>list</code>æ–¹æ³•</h4><p>ä¿®æ”¹<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.SkuInfoController</code>æ¨¡å—çš„<code>list</code>æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.2.2.png" alt="image-20220614115720234" tabindex="0" loading="lazy"><figcaption>image-20220614115720234</figcaption></figure><h4 id="_3ã€æ·»åŠ querypagebyconditionæŠ½è±¡æ–¹æ³•-1" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ querypagebyconditionæŠ½è±¡æ–¹æ³•-1" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>queryPageByCondition</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.SkuInfoService</code>æ¥å£é‡Œæ·»åŠ <code>queryPageByCondition</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">PageUtils</span> <span class="token function">queryPageByCondition</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.2.3.png" alt="image-20220614115816925" tabindex="0" loading="lazy"><figcaption>image-20220614115816925</figcaption></figure><h4 id="_4ã€å®ç°querypagebyconditionæŠ½è±¡æ–¹æ³•-1" tabindex="-1"><a class="header-anchor" href="#_4ã€å®ç°querypagebyconditionæŠ½è±¡æ–¹æ³•-1" aria-hidden="true">#</a> 4ã€å®ç°<code>queryPageByCondition</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.SkuInfoServiceImpl</code>ç±»é‡Œå®ç°æœªå®ç°çš„<code>queryPageByCondition</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ ¹æ®æ¡ä»¶åˆ†é¡µæŸ¥è¯¢
 * <span class="token punctuation">{</span>
 * page: 1,//å½“å‰é¡µç 
 * limit: 10,//æ¯é¡µè®°å½•æ•°
 * sidx: &#39;id&#39;,//æ’åºå­—æ®µ
 * order: &#39;asc/desc&#39;,//æ’åºæ–¹å¼
 * key: &#39;åä¸º&#39;,//æ£€ç´¢å…³é”®å­—
 * catelogId: 0,
 * brandId: 0,
 * min: 0,
 * max: 0
 * <span class="token punctuation">}</span>
 *
 * <span class="token keyword">@param</span> <span class="token parameter">params</span>
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">queryPageByCondition</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SkuInfoEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ ¹æ®&quot;key&quot;ï¼Œç²¾ç¡®åŒ¹é…å•†å“id æˆ– æ¨¡ç³ŠæŸ¥è¯¢spu_name</span>
    <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>  <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> wrapper <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        wrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">SkuInfoEntity</span><span class="token operator">::</span><span class="token function">getSkuId</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">SkuInfoEntity</span><span class="token operator">::</span><span class="token function">getSkuName</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//æ ¹æ®catelogIdç²¾ç¡®åŒ¹é…æ‰€å±åˆ†ç±»idï¼ˆæ³¨æ„ï¼šå‰ç«¯å‘æ¥çš„æ˜¯catelogId,æ•°æ®åº“å†™çš„æ˜¯catalogIdï¼‰</span>
    <span class="token class-name">String</span> catelogId <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;catelogId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>catelogId<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span>catelogId<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">SkuInfoEntity</span><span class="token operator">::</span><span class="token function">getCatalogId</span><span class="token punctuation">,</span> catelogId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//æ ¹æ®brandIdç²¾ç¡®åŒ¹é…å“ç‰Œid</span>
    <span class="token class-name">String</span> brandId <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;brandId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>brandId<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span>brandId<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">SkuInfoEntity</span><span class="token operator">::</span><span class="token function">getBrandId</span><span class="token punctuation">,</span> brandId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// price &gt;= min</span>
    <span class="token class-name">String</span> min <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;min&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>min<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">BigDecimal</span> mimBigDecimal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span>min<span class="token punctuation">)</span><span class="token punctuation">;</span>
            lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">ge</span><span class="token punctuation">(</span>mimBigDecimal<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">SkuInfoEntity</span><span class="token operator">::</span><span class="token function">getPrice</span><span class="token punctuation">,</span> min<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// price &lt;= max</span>
    <span class="token class-name">String</span> max <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;max&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">BigDecimal</span> maxBigDecimal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>
            lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">le</span><span class="token punctuation">(</span> maxBigDecimal<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">SkuInfoEntity</span><span class="token operator">::</span><span class="token function">getPrice</span><span class="token punctuation">,</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SkuInfoEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SkuInfoEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span>
            lambdaQueryWrapper
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.2.4.png" alt="image-20220614174410390" tabindex="0" loading="lazy"><figcaption>image-20220614174410390</figcaption></figure><h4 id="_5ã€æµ‹è¯•-12" tabindex="-1"><a class="header-anchor" href="#_5ã€æµ‹è¯•-12" aria-hidden="true">#</a> 5ã€æµ‹è¯•</h4><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œæ‰“å¼€<code>å•†å“ç³»ç»Ÿ/å•†å“ç»´æŠ¤/å•†å“ç®¡ç†</code>,å¯ä»¥çœ‹åˆ°<code>ä»·æ ¼</code>çš„ä¸¤ä¸ªè¾“å…¥æ¡†æ²¡è¾“å…¥æ—¶éƒ½ä¸º<code>0</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.2.5.1.png" alt="image-20220619220828891" tabindex="0" loading="lazy"><figcaption>image-20220619220828891</figcaption></figure><p>æ‰‹åŠ¨æŠŠ<code>ä»·æ ¼</code>çš„ç¬¬äºŒä¸ªè¾“å…¥æ¡†(æœ€å¤§å€¼)çš„<code>0</code>åˆ äº†ï¼›æ‰“å¼€æ§åˆ¶å°ï¼Œç‚¹å‡»<code>vue</code>ï¼Œæœ€å·¦è¾¹é€‰æ‹©<code>APP 1</code>ï¼Œ</p><p>ä¸­é—´ä¾æ¬¡é€‰æ‹©<code>Root</code>-&gt;<code>APP</code>-&gt;<code>Main</code>-&gt;<code>MainContent</code>-&gt;<code>ElTabs</code>-&gt;<code>ElPane</code>-&gt;<code>ElCard</code>-&gt;<code>Manager</code>,</p><p>å¯ä»¥çœ‹åˆ°å½“ä»·æ ¼çš„è¾“å…¥æ¡†æ²¡æœ‰æ•°æ®æ—¶ï¼Œå€¼ä¸º<code>undefined</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.2.5.2.png" alt="image-20220614155157775" tabindex="0" loading="lazy"><figcaption>image-20220614155157775</figcaption></figure><p>æ‰“å¡<code>Vs Code</code>ï¼Œç‚¹å‡»<code>æœç´¢æ¡†</code>(æˆ–ä½¿ç”¨å¿«æ·é”®<code>ctrl+shift+F</code>)ï¼Œè¾“å…¥<code>ä»·æ ¼</code>ï¼Œç„¶åç‚¹å‡»<code>enter</code>,</p><p>é€‰æ‹©<code>spu.vue</code>é‡Œçš„è¿™ä¸ªæŠŠ<code>data</code>-&gt;<code>return</code>-&gt;<code>dataForm</code>-&gt;<code>price</code>é‡Œçš„<code>min</code>å’Œ<code>max</code>å€¼éƒ½æ”¹ä¸º<code>undefined</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">catPathSub</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token literal-property property">brandIdSub</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token literal-property property">dataForm</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">brandId</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token literal-property property">catelogId</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token literal-property property">price</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
        <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token keyword">undefined</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">dataList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">pageIndex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">pageSize</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token literal-property property">totalPage</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">dataListLoading</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">dataListSelections</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">addOrUpdateVisible</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">catelogPath</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.2.5.3.png" alt="image-20220619222303036" tabindex="0" loading="lazy"><figcaption>image-20220619222303036</figcaption></figure><p>ä¿®æ”¹åæŸ¥çœ‹é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°<code>ä»·æ ¼</code>çš„ä¸¤ä¸ªè¾“å…¥æ¡†æ²¡è¾“å…¥æ—¶éƒ½æ²¡æœ‰<code>0</code>äº†ï¼Œå°±ä¸æ˜¾ç¤ºæ•°æ®äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.2.5.4.png" alt="image-20220614155349645" tabindex="0" loading="lazy"><figcaption>image-20220614155349645</figcaption></figure><p>è¿™æ ·ä¿®æ”¹åï¼Œæ²¡æœ‰è®¾ç½®çš„åœ¨å‘é€è¯·æ±‚æ—¶å°±ä¸ä¼šå°±ä¸ä¼šå¸¦ä¸Šè¿™ä¸ªå­—æ®µäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.7.2.5.5.png" alt="image-20220614155607613" tabindex="0" loading="lazy"><figcaption>image-20220614155607613</figcaption></figure><h2 id="_4-8ã€ä»“åº“æœåŠ¡-api-ä»“åº“ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_4-8ã€ä»“åº“æœåŠ¡-api-ä»“åº“ç®¡ç†" aria-hidden="true">#</a> 4.8ã€ä»“åº“æœåŠ¡-API-ä»“åº“ç®¡ç†</h2><p><code>ä»“åº“æœåŠ¡-API-ä»“åº“ç®¡ç†</code>å¯¹åº”äº<code>gulimall_wms</code>æ•°æ®åº“</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.0.1.png" alt="image-20220614160337441" tabindex="0" loading="lazy"><figcaption>image-20220614160337441</figcaption></figure><p><code>ä»“åº“æœåŠ¡-API-ä»“åº“ç®¡ç†</code>å¯¹åº”äº<code>gulimall-ware</code>æ¨¡å—</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.0.2.png" alt="image-20220614160421031" tabindex="0" loading="lazy"><figcaption>image-20220614160421031</figcaption></figure><h3 id="_4-8-1ã€æ•´åˆwareæœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_4-8-1ã€æ•´åˆwareæœåŠ¡" aria-hidden="true">#</a> 4.8.1ã€æ•´åˆwareæœåŠ¡</h3><h4 id="_1ã€é…ç½®æ³¨å†Œä¸­å¿ƒåœ°å€" tabindex="-1"><a class="header-anchor" href="#_1ã€é…ç½®æ³¨å†Œä¸­å¿ƒåœ°å€" aria-hidden="true">#</a> 1ã€é…ç½®æ³¨å†Œä¸­å¿ƒåœ°å€</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>src/main/resources/application.yml</code>é…ç½®æ–‡ä»¶é‡Œï¼Œæ·»åŠ <code>é…ç½®æ³¨å†Œä¸­å¿ƒåœ°å€</code>å’Œ<code>åº”ç”¨å</code></p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> gulimall<span class="token punctuation">-</span>ware
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.1.1.png" alt="image-20220614160600771" tabindex="0" loading="lazy"><figcaption>image-20220614160600771</figcaption></figure><h4 id="_2ã€å¼€å¯æœåŠ¡å‘ç°" tabindex="-1"><a class="header-anchor" href="#_2ã€å¼€å¯æœåŠ¡å‘ç°" aria-hidden="true">#</a> 2ã€å¼€å¯æœåŠ¡å‘ç°</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.GulimallWareApplication</code>å¯åŠ¨ç±»ä¸Šæ·»åŠ <code>@EnableDiscoveryClient</code>æœåŠ¡å‘ç°æ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableDiscoveryClient</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.1.2.png" alt="image-20220614160709664" tabindex="0" loading="lazy"><figcaption>image-20220614160709664</figcaption></figure><h4 id="_3ã€æŒ‡å®šè¦æ‰«æçš„mapperæ–‡ä»¶æ‰€åœ¨çš„åŒ…" tabindex="-1"><a class="header-anchor" href="#_3ã€æŒ‡å®šè¦æ‰«æçš„mapperæ–‡ä»¶æ‰€åœ¨çš„åŒ…" aria-hidden="true">#</a> 3ã€æŒ‡å®šè¦æ‰«æçš„<code>Mapper</code>æ–‡ä»¶æ‰€åœ¨çš„åŒ…</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.GulimallWareApplication</code>å¯åŠ¨ç±»ä¸Šæ·»åŠ <code>@MapperScan(&quot;com.atguigu.gulimall.ware.dao&quot;)</code>æ³¨è§£ï¼Œå¹¶æŒ‡å®šè¦æ‰«æçš„<code>Mapper</code>æ–‡ä»¶æ‰€åœ¨çš„åŒ…</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token string">&quot;com.atguigu.gulimall.ware.dao&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.1.3.png" alt="image-20220614160821054" tabindex="0" loading="lazy"><figcaption>image-20220614160821054</figcaption></figure><h4 id="_4ã€å¼€å¯äº‹åŠ¡ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_4ã€å¼€å¯äº‹åŠ¡ç®¡ç†" aria-hidden="true">#</a> 4ã€å¼€å¯äº‹åŠ¡ç®¡ç†</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.GulimallWareApplication</code>å¯åŠ¨ç±»ä¸Šæ·»åŠ <code>@EnableTransactionManagement</code>æ³¨è§£ï¼Œç”¨äºå¼€å¯<code>äº‹åŠ¡ç®¡ç†</code>åŠŸèƒ½</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableTransactionManagement</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.1.4.png" alt="image-20220614160924438" tabindex="0" loading="lazy"><figcaption>image-20220614160924438</figcaption></figure><h3 id="_4-8-2ã€è¿è¡Œgulimall-ware-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_4-8-2ã€è¿è¡Œgulimall-ware-æ¨¡å—" aria-hidden="true">#</a> 4.8.2ã€è¿è¡Œgulimall-ware\`æ¨¡å—</h3><h4 id="_1ã€å°†gulimall-wareæ¨¡å—æ·»åŠ åˆ°compondé‡Œ" tabindex="-1"><a class="header-anchor" href="#_1ã€å°†gulimall-wareæ¨¡å—æ·»åŠ åˆ°compondé‡Œ" aria-hidden="true">#</a> 1ã€å°†<code>gulimall-ware</code>æ¨¡å—æ·»åŠ åˆ°<code>Compond</code>é‡Œ</h4><p>ç‚¹å‡»<code>Unnamed</code>ï¼Œé€‰æ‹©<code>Edit Configurations...</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.2.1.png" alt="image-20220614161220452" tabindex="0" loading="lazy"><figcaption>image-20220614161220452</figcaption></figure><p>ç‚¹å‡»å³ä¾§çš„<code>+</code>å·ï¼Œåœ¨å¼¹å‡ºçš„é€‰æ‹©æ¡†ä¸­é€‰æ‹©<code>GulimallWareApplication</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.2.2.png" alt="image-20220614161055713" tabindex="0" loading="lazy"><figcaption>image-20220614161055713</figcaption></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå·²ç»æ·»åŠ åˆ°åç§°ä¸º<code>Unnamed</code>çš„<code>compond</code>é‡Œäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.2.3.png" alt="image-20220614161149410" tabindex="0" loading="lazy"><figcaption>image-20220614161149410</figcaption></figure><h4 id="_2ã€å¯åŠ¨gulimall-wareæ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_2ã€å¯åŠ¨gulimall-wareæ¨¡å—" aria-hidden="true">#</a> 2ã€å¯åŠ¨<code>gulimall-ware</code>æ¨¡å—</h4><p>ç‚¹å‡»<code>IDEA</code>åº•éƒ¨çš„<code>Services</code>ï¼Œé€‰æ‹©<code>GulimallWareApplication</code>,ç„¶åç‚¹å‡»<code>Run</code>è¿è¡ŒæŒ‰é’®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.2.4.png" alt="image-20220614161339771" tabindex="0" loading="lazy"><figcaption>image-20220614161339771</figcaption></figure><p>å¯ä»¥çœ‹åˆ°<code>GulimallWareApplication</code>çš„æ§åˆ¶å°æŠ¥é”™äº†,è¿™é‡ŒæŠ¥é”™æ˜¯å› ä¸ºåŠ äº†<code>é…ç½®ä¸­å¿ƒ</code>çš„ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰é…ç½®<code>é…ç½®ä¸­å¿ƒåœ°å€</code>ã€<code>å‘½åç©ºé—´</code>ç­‰ï¼Œè¿™é‡Œå¯ä»¥å…ˆä¸ç”¨ç®¡</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.2.5.png" alt="image-20220614161420866" tabindex="0" loading="lazy"><figcaption>image-20220614161420866</figcaption></figure><p>æ‰“å¼€<code>nacos</code>çš„å‰ç«¯é¡µé¢ï¼Œç‚¹å‡»<code>æœåŠ¡ç®¡ç†</code>é‡Œçš„<code>æœåŠ¡åˆ—è¡¨</code>ï¼Œå¯ä»¥çœ‹åˆ°<code>gulimall-ware</code>å·²ç»æ³¨å†Œçš„<code>æ³¨å†Œä¸­å¿ƒ</code>é‡Œäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.2.6.png" alt="image-20220614161506499" tabindex="0" loading="lazy"><figcaption>image-20220614161506499</figcaption></figure><h3 id="_4-8-3ã€ä»“åº“ç®¡ç†æ‰“ä¸å¼€" tabindex="-1"><a class="header-anchor" href="#_4-8-3ã€ä»“åº“ç®¡ç†æ‰“ä¸å¼€" aria-hidden="true">#</a> 4.8.3ã€ä»“åº“ç®¡ç†æ‰“ä¸å¼€</h3><p>ç‚¹å‡»<code>åº“å­˜ç³»ç»Ÿ</code>é‡Œçš„<code>ä»“åº“ç®¡ç†</code>ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ç›´åˆ·æ–°ä¸å‡ºæ¥æ•°æ®ï¼Œæ‰“å¼€æ§åˆ¶å°ï¼Œç‚¹å‡»å¤±è´¥çš„é‚£ä¸ª<code>list</code>çš„è¯·æ±‚ï¼Œå³ä¾§é€‰æ‹©<code>Preview</code>,å¯ä»¥çœ‹åˆ°<code>path</code>çš„å€¼ä¸º<code>/renren-fast/ware/wareinfo/list</code>ï¼Œè¿™è¡¨æ˜ç½‘å…³è·¯ç”±ç»™äº†<code>renren-fast</code>æ¨¡å—ï¼Œè€Œä¸æ˜¯<code>gulimall-ware</code>æ¨¡å—</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.3.1.png" alt="image-20220614161724134" tabindex="0" loading="lazy"><figcaption>image-20220614161724134</figcaption></figure><p>åœ¨<code>gulimall-gateway</code>æ¨¡å—çš„<code>src/main/resources/application.yml</code>é…ç½®æ–‡ä»¶é‡Œæ·»åŠ é…ç½®ï¼Œé…ç½®è´Ÿè½½å‡è¡¡åˆ°<code>gulimall-ware</code>æ¨¡å—çš„è·¯å¾„åŒ¹é…è§„åˆ™(æ³¨æ„å†™åˆ°<code>admin_route</code>å‰é¢)</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> ware_route
  <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//gulimall<span class="token punctuation">-</span>ware
  <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> Path=/api/ware/<span class="token important">**</span>
  <span class="token key atrule">filters</span><span class="token punctuation">:</span>
    <span class="token comment">#http://localhost:88/api/ware/wareinfo/list å˜ä¸º http://localhost:11000/ware/wareinfo/list</span>
    <span class="token punctuation">-</span> RewritePath=/api/(<span class="token punctuation">?</span>&lt;segment<span class="token punctuation">&gt;</span>/<span class="token punctuation">?</span>.<span class="token important">*)</span><span class="token punctuation">,</span>/$\\<span class="token punctuation">{</span>segment<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.3.2.png" alt="image-20220614162009550" tabindex="0" loading="lazy"><figcaption>image-20220614162009550</figcaption></figure><p>é‡å¯<code>gulimall-ware</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°è¯·æ±‚å·²ç»æˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.3.3.png" alt="image-20220614162150162" tabindex="0" loading="lazy"><figcaption>image-20220614162150162</figcaption></figure><h3 id="_4-8-4ã€æ·»åŠ æµ‹è¯•æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_4-8-4ã€æ·»åŠ æµ‹è¯•æ•°æ®" aria-hidden="true">#</a> 4.8.4ã€æ·»åŠ æµ‹è¯•æ•°æ®</h3><h4 id="_1ã€æ·»åŠ ä¸€æ¡æµ‹è¯•æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_1ã€æ·»åŠ ä¸€æ¡æµ‹è¯•æ•°æ®" aria-hidden="true">#</a> 1ã€æ·»åŠ ä¸€æ¡æµ‹è¯•æ•°æ®</h4><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ</code>é‡Œçš„<code>ä»“åº“ç»´æŠ¤</code>é‡Œï¼Œç‚¹å‡»<code>æ–°å»º</code>ï¼Œæ–°å»ºä¸€æ¡æ•°æ®ï¼›<code>ä»“åº“å</code>ä¸º<code>1å·ä»“åº“</code>ï¼Œ<code>ä»“åº“åœ°å€</code>ä¸º<code>åŒ—äº¬</code>ï¼Œ<code>åŒºåŸŸç¼–ç </code>ä¸º<code>124</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.4.1.1.png" alt="image-20220614162259394" tabindex="0" loading="lazy"><figcaption>image-20220614162259394</figcaption></figure><p>å¯ä»¥çœ‹åˆ°å·²ç»æ·»åŠ æˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.4.1.2.png" alt="image-20220614162329695" tabindex="0" loading="lazy"><figcaption>image-20220614162329695</figcaption></figure><h4 id="_2ã€ä¿®æ”¹è¯¥æµ‹è¯•æ•°æ®çš„å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹è¯¥æµ‹è¯•æ•°æ®çš„å­—æ®µ" aria-hidden="true">#</a> 2ã€ä¿®æ”¹è¯¥æµ‹è¯•æ•°æ®çš„å­—æ®µ</h4><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ</code>é‡Œçš„<code>ä»“åº“ç»´æŠ¤</code>é‡Œï¼Œç‚¹å‡»åˆšåˆšæ·»åŠ çš„æ•°æ®å³è¾¹çš„<code>ä¿®æ”¹</code>æŒ‰é’®ï¼ŒæŠŠ<code>ä»“åº“åœ°å€</code>ä¿®æ”¹ä¸º<code>åŒ—äº¬xx</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.4.2.1.png" alt="image-20220614162409669" tabindex="0" loading="lazy"><figcaption>image-20220614162409669</figcaption></figure><p>å¯ä»¥çœ‹åˆ°å·²ç»ä¿®æ”¹æˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.4.2.2.png" alt="image-20220614162440788" tabindex="0" loading="lazy"><figcaption>image-20220614162440788</figcaption></figure><h4 id="_3ã€å†æ·»åŠ ä¸€æ¡æµ‹è¯•æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_3ã€å†æ·»åŠ ä¸€æ¡æµ‹è¯•æ•°æ®" aria-hidden="true">#</a> 3ã€å†æ·»åŠ ä¸€æ¡æµ‹è¯•æ•°æ®</h4><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.4.3.png" alt="image-20220614162532455" tabindex="0" loading="lazy"><figcaption>image-20220614162532455</figcaption></figure><h3 id="_4-8-5ã€æ·»åŠ ä»“åº“ç»´æŠ¤æŸ¥è¯¢åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#_4-8-5ã€æ·»åŠ ä»“åº“ç»´æŠ¤æŸ¥è¯¢åŠŸèƒ½" aria-hidden="true">#</a> 4.8.5ã€æ·»åŠ ä»“åº“ç»´æŠ¤æŸ¥è¯¢åŠŸèƒ½</h3><h4 id="_1ã€æŸ¥çœ‹æ¥å£-1" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹æ¥å£-1" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹æ¥å£</h4><p>å…ˆæ‰“å¼€æ§åˆ¶å°ï¼Œç‚¹å‡»<code>Network</code>ï¼Œæ¸…ç©ºæ•°æ®ï¼Œç„¶åç‚¹å‡»<code>åº“å­˜ç³»ç»Ÿ</code>é‡Œçš„<code>ä»“åº“ç»´æŠ¤</code>é‡Œçš„æŸ¥è¯¢æŒ‰é’®ï¼ŒæŸ¥çœ‹å‘é€è¯·æ±‚url</p><p>urlï¼šhttp://localhost:88/api/ware/wareinfo/list?t=1655195182345&amp;page=1&amp;limit=10&amp;key=</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.5.1.png" alt="image-20220614162709471" tabindex="0" loading="lazy"><figcaption>image-20220614162709471</figcaption></figure><h4 id="_2ã€ä¿®æ”¹querypageæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹querypageæ–¹æ³•" aria-hidden="true">#</a> 2ã€ä¿®æ”¹<code>queryPage</code>æ–¹æ³•</h4><p>ä¿®æ”¹<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.WareInfoServiceImpl</code>ç±»çš„<code>queryPage</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">queryPage</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WareInfoEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">WareInfoEntity</span><span class="token operator">::</span><span class="token function">getId</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">WareInfoEntity</span><span class="token operator">::</span><span class="token function">getName</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">WareInfoEntity</span><span class="token operator">::</span><span class="token function">getAddress</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">WareInfoEntity</span><span class="token operator">::</span><span class="token function">getAreacode</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WareInfoEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WareInfoEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span>
            lambdaQueryWrapper
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.5.2.png" alt="image-20220614163435122" tabindex="0" loading="lazy"><figcaption>image-20220614163435122</figcaption></figure><h4 id="_3ã€ä¿®æ”¹æ—¥å¿—çº§åˆ«ä¸ºdebug" tabindex="-1"><a class="header-anchor" href="#_3ã€ä¿®æ”¹æ—¥å¿—çº§åˆ«ä¸ºdebug" aria-hidden="true">#</a> 3ã€ä¿®æ”¹æ—¥å¿—çº§åˆ«ä¸º<code>debug</code></h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>src/main/resources/application.yml</code>é…ç½®æ–‡ä»¶é‡Œæ·»åŠ é…ç½®ï¼Œä¿®æ”¹<code>com.atguigu</code>åŒ…åŠå…¶å­åŒ…çš„è¾“å‡ºæ—¥å¿—çš„çº§åˆ«ä¸º<code>debug</code>çº§åˆ«</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">com.atguigu</span><span class="token punctuation">:</span> debug
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.5.3.png" alt="image-20220614163644567" tabindex="0" loading="lazy"><figcaption>image-20220614163644567</figcaption></figure><h4 id="_4ã€æŸ¥çœ‹sqlè¯­å¥" tabindex="-1"><a class="header-anchor" href="#_4ã€æŸ¥çœ‹sqlè¯­å¥" aria-hidden="true">#</a> 4ã€æŸ¥çœ‹<code>sql</code>è¯­å¥</h4><p>é‡å¯<code>gulimall-ware</code>æ¨¡å—ï¼Œå†æ¬¡ç‚¹å‡»<code>åº“å­˜ç³»ç»Ÿ</code>é‡Œçš„<code>ä»“åº“ç»´æŠ¤</code>é‡Œçš„æŸ¥è¯¢æŒ‰é’®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.5.4.1.png" alt="image-20220614163824115" tabindex="0" loading="lazy"><figcaption>image-20220614163824115</figcaption></figure><p>æŸ¥çœ‹<code>GulimallWareApplication</code>æ¨¡å—çš„æ§åˆ¶å°è¾“å‡ºçš„<code>sql</code>è¯­å¥ï¼Œå¯ä»¥çœ‹åˆ°<code>sql</code>è¯­å¥æ­£å¸¸</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>SELECT id,address,name,areacode FROM wms_ware_info WHERE (id = ? OR name LIKE ? OR address LIKE ? OR areacode LIKE ?) 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.5.4.2.png" alt="image-20220614163937587" tabindex="0" loading="lazy"><figcaption>image-20220614163937587</figcaption></figure><h4 id="_5ã€åˆ†é¡µè¿˜æœ‰é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_5ã€åˆ†é¡µè¿˜æœ‰é—®é¢˜" aria-hidden="true">#</a> 5ã€åˆ†é¡µè¿˜æœ‰é—®é¢˜</h4><p>å¤åˆ¶<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.config.MyBatisConfig</code>ç±»æ–‡ä»¶</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.5.5.1.png" alt="image-20220615210545460" tabindex="0" loading="lazy"><figcaption>image-20220615210545460</figcaption></figure><p>ç²˜è´´åˆ°<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.config</code>åŒ…ä¸‹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.5.5.2.png" alt="image-20220615210644264" tabindex="0" loading="lazy"><figcaption>image-20220615210644264</figcaption></figure><p>å‰ªåˆ‡<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.GulimallWareApplication</code>å¯åŠ¨ç±»çš„<code>å¼€å¯äº‹åŠ¡ç®¡ç†æ³¨è§£</code>å’Œ<code>MapperåŒ…æ‰«ææ³¨è§£</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableTransactionManagement</span>
<span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token string">&quot;com.atguigu.gulimall.ware.dao&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.5.5.3.png" alt="image-20220615210741669" tabindex="0" loading="lazy"><figcaption>image-20220615210741669</figcaption></figure><p>å°†åˆšåˆšç²˜è´´çš„ä»£ç ï¼Œæ›¿æ¢åˆ°<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.config.MyBatisConfig</code>çš„</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableTransactionManagement</span>
<span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token string">&quot;com.atguigu.gulimall.product.dao&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å°†å…¶æ”¹ä¸º</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableTransactionManagement</span>
<span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token string">&quot;com.atguigu.gulimall.ware.dao&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.5.5.4.png" alt="image-20220615210757239" tabindex="0" loading="lazy"><figcaption>image-20220615210757239</figcaption></figure><p>å®Œæ•´ä»£ç </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>product<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>extension<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span></span><span class="token class-name">PaginationInterceptor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">MapperScan</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">EnableTransactionManagement</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/5/10
 * @Description:
 * @EnableTransactionManagement ï¼šå¼€å¯äº‹åŠ¡åŠŸèƒ½
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableTransactionManagement</span>
<span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token string">&quot;com.atguigu.gulimall.product.dao&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBatisConfig</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * å¼•å…¥åˆ†é¡µæ’ä»¶
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">PaginationInterceptor</span> <span class="token function">paginationInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">PaginationInterceptor</span> paginationInterceptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PaginationInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®è¯·æ±‚çš„é¡µé¢å¤§äºæœ€å¤§é¡µåæ“ä½œï¼Œtrueè°ƒå›åˆ°é¦–é¡µï¼Œfalse ç»§ç»­è¯·æ±‚ é»˜è®¤false</span>
        paginationInterceptor<span class="token punctuation">.</span><span class="token function">setOverflow</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®æœ€å¤§å•é¡µé™åˆ¶æ•°é‡ï¼Œé»˜è®¤500æ¡ï¼Œ-1 ä¸å—é™åˆ¶</span>
        paginationInterceptor<span class="token punctuation">.</span><span class="token function">setLimit</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> paginationInterceptor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6ã€é‡æ–°æµ‹è¯•-3" tabindex="-1"><a class="header-anchor" href="#_6ã€é‡æ–°æµ‹è¯•-3" aria-hidden="true">#</a> 6ã€é‡æ–°æµ‹è¯•</h4><p>é‡å¯<code>gulimall-ware</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯ç•Œé¢</p><h5 id="_1ã€é‡æ–°ç‚¹å‡»æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_1ã€é‡æ–°ç‚¹å‡»æŸ¥è¯¢" aria-hidden="true">#</a> 1ã€é‡æ–°ç‚¹å‡»æŸ¥è¯¢</h5><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.5.6.1.png" alt="image-20220619234648667" tabindex="0" loading="lazy"><figcaption>image-20220619234648667</figcaption></figure><h5 id="_2ã€æŸ¥çœ‹sqlè¯­å¥" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹sqlè¯­å¥" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹<code>sql</code>è¯­å¥</h5><p>æŸ¥çœ‹<code>GulimallWareApplication</code>æ¨¡å—çš„æ§åˆ¶å°è¾“å‡ºçš„<code>sql</code>è¯­å¥ï¼Œå¯ä»¥çœ‹åˆ°å·²è¿‘å¸¦ä¸Šåˆ†é¡µä¿¡æ¯äº†</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>SELECT COUNT(1) FROM wms_ware_info WHERE (id = ? OR name LIKE ? OR address LIKE ? OR areacode LIKE ?) 

SELECT id,address,name,areacode FROM wms_ware_info WHERE (id = ? OR name LIKE ? OR address LIKE ? OR areacode LIKE ?) LIMIT ?,? 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.5.6.2.png" alt="image-20220619235039841" tabindex="0" loading="lazy"><figcaption>image-20220619235039841</figcaption></figure><h3 id="_4-8-6ã€å•†å“åº“å­˜" tabindex="-1"><a class="header-anchor" href="#_4-8-6ã€å•†å“åº“å­˜" aria-hidden="true">#</a> 4.8.6ã€å•†å“åº“å­˜</h3><h4 id="_1ã€æŸ¥çœ‹æ¥å£-2" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹æ¥å£-2" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹æ¥å£</h4><p>å…ˆæ‰“å¼€æ§åˆ¶å°ï¼Œç‚¹å‡»<code>Network</code>ï¼Œæ¸…ç©ºæ•°æ®ï¼Œç„¶åç‚¹å‡»<code>åº“å­˜ç³»ç»Ÿ/å•†å“åº“å­˜</code>ï¼Œ<code>ä»“åº“</code>é€‰æ‹©<code>1å·ä»“åº“</code>,<code>skuId</code>è¾“å…¥<code>1</code>ï¼Œç‚¹å‡»æŸ¥è¯¢ï¼Œå¯ä»¥çœ‹åˆ°è¯·æ±‚çš„urlä¸ºï¼šhttp://localhost:88/api/ware/waresku/list?t=1655196148943&amp;page=1&amp;limit=10&amp;skuId=1&amp;wareId=1</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.6.1.1.png" alt="image-20220614164256829" tabindex="0" loading="lazy"><figcaption>image-20220614164256829</figcaption></figure><p>æ¥å£æ–‡æ¡£åœ¨<code>åº“å­˜ç³»ç»Ÿ/02ã€æŸ¥è¯¢å•†å“åº“å­˜</code>é‡Œ: https://easydoc.net/s/78237135/ZUqEdvA4/hwXrEXBZ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.6.1.2.png" alt="image-20220614164553204" tabindex="0" loading="lazy"><figcaption>image-20220614164553204</figcaption></figure><h4 id="_2ã€ä¿®æ”¹querypageæ–¹æ³•-1" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹querypageæ–¹æ³•-1" aria-hidden="true">#</a> 2ã€ä¿®æ”¹<code>queryPage</code>æ–¹æ³•</h4><p>ä¿®æ”¹<code>gulimall-ware</code>æ¨¡å—é‡Œçš„<code>com.atguigu.gulimall.ware.service.impl.WareSkuServiceImpl</code>ç±»çš„<code>queryPage</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token punctuation">{</span>
 *    page: 1,//å½“å‰é¡µç 
 *    limit: 10,//æ¯é¡µè®°å½•æ•°
 *    sidx: &#39;id&#39;,//æ’åºå­—æ®µ
 *    order: &#39;asc/desc&#39;,//æ’åºæ–¹å¼
 *    wareId: 123,//ä»“åº“id
 *    skuId: 123//å•†å“id
 * <span class="token punctuation">}</span>
 * <span class="token keyword">@param</span> <span class="token parameter">params</span>
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">queryPage</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WareSkuEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> skuId <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;skuId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>skuId<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">WareSkuEntity</span><span class="token operator">::</span><span class="token function">getSkuId</span><span class="token punctuation">,</span>skuId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> wareId <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;wareId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>wareId<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">WareSkuEntity</span><span class="token operator">::</span><span class="token function">getWareId</span><span class="token punctuation">,</span>wareId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WareSkuEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WareSkuEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span>
            lambdaQueryWrapper
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.6.2.png" alt="image-20220614165103674" tabindex="0" loading="lazy"><figcaption>image-20220614165103674</figcaption></figure><h4 id="_3ã€é‡æ–°å‘é€è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_3ã€é‡æ–°å‘é€è¯·æ±‚" aria-hidden="true">#</a> 3ã€é‡æ–°å‘é€è¯·æ±‚</h4><p>é‡å¯<code>gulimall-ware</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢ï¼›æ‰“å¼€æ§åˆ¶å°ï¼Œç‚¹å‡»<code>Network</code>ï¼Œæ¸…ç©ºæ•°æ®ï¼Œç„¶åç‚¹å‡»<code>åº“å­˜ç³»ç»Ÿ/å•†å“åº“å­˜</code>é‡Œçš„<code>æŸ¥è¯¢</code></p><p>urlï¼šhttp://localhost:88/api/ware/waresku/list?t=1655196600891&amp;page=1&amp;limit=10&amp;skuId=1&amp;wareId=1</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.6.3.1.png" alt="image-20220614165026503" tabindex="0" loading="lazy"><figcaption>image-20220614165026503</figcaption></figure><p>æŸ¥çœ‹<code>GulimallWareApplication</code>æ¨¡å—çš„æ§åˆ¶å°æ‰“å°çš„<code>sql</code>è¯­å¥</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>SELECT id,sku_name,ware_id,stock_locked,stock,sku_id FROM wms_ware_sku WHERE (sku_id = ? AND ware_id = ?)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.6.3.2.png" alt="image-20220614165215365" tabindex="0" loading="lazy"><figcaption>image-20220614165215365</figcaption></figure><h4 id="_4ã€æ–°å¢å•†å“åº“å­˜" tabindex="-1"><a class="header-anchor" href="#_4ã€æ–°å¢å•†å“åº“å­˜" aria-hidden="true">#</a> 4ã€æ–°å¢å•†å“åº“å­˜</h4><p>ç‚¹å‡»<code>åº“å­˜ç³»ç»Ÿ/å•†å“åº“å­˜</code>é‡Œçš„<code>æ–°å¢</code>æŒ‰é’®ï¼Œæ–°å¢ä¸€ä¸ªå•†å“åº“å­˜</p><p><code>sku_id</code>è¾“å…¥<code>1</code>ï¼Œ<code>ä»“åº“</code>é€‰æ‹©<code>1å·ä»“åº“</code>ï¼Œ<code>åº“å­˜æ•°</code>è¾“å…¥<code>10</code>ï¼Œ<code>sku_name</code>è¾“å…¥<code>åä¸º</code>ï¼Œ<code>é”å®šåº“å­˜</code>è¾“å…¥<code>0</code>ï¼Œç„¶åç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.6.4.1.png" alt="image-20220614165300900" tabindex="0" loading="lazy"><figcaption>image-20220614165300900</figcaption></figure><p>å¯ä»¥çœ‹åˆ°å·²ç»æ–°å¢æˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.6.4.2.png" alt="image-20220614165328584" tabindex="0" loading="lazy"><figcaption>image-20220614165328584</figcaption></figure><h4 id="_5ã€ä¿®æ”¹å•†å“åº“å­˜" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¿®æ”¹å•†å“åº“å­˜" aria-hidden="true">#</a> 5ã€ä¿®æ”¹å•†å“åº“å­˜</h4><p>ç‚¹å‡»åˆšåˆšæ·»åŠ çš„é‚£è¡Œæ•°æ®çš„<code>ä¿®æ”¹</code>æŒ‰é’®ï¼ŒæŠŠ<code>åº“å­˜æ•°</code>ä¿®æ”¹ä¸º<code>100</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.6.5.1.png" alt="image-20220614165400506" tabindex="0" loading="lazy"><figcaption>image-20220614165400506</figcaption></figure><p>å¯ä»¥çœ‹åˆ°å·²ç»ä¿®æ”¹æˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.6.5.2.png" alt="image-20220614165425437" tabindex="0" loading="lazy"><figcaption>image-20220614165425437</figcaption></figure><h4 id="_6ã€å•†å“ç®¡ç†è·³è½¬åˆ°åº“å­˜ç®¡ç†æºå¸¦skuid" tabindex="-1"><a class="header-anchor" href="#_6ã€å•†å“ç®¡ç†è·³è½¬åˆ°åº“å­˜ç®¡ç†æºå¸¦skuid" aria-hidden="true">#</a> 6ã€<code>å•†å“ç®¡ç†</code>è·³è½¬åˆ°<code>åº“å­˜ç®¡ç†</code>æºå¸¦<code>skuId</code></h4><p>é€‰æ‹©<code>å•†å“ç³»ç»Ÿ/å•†å“ç»´æŠ¤/å•†å“ç®¡ç†</code>ï¼Œç‚¹å‡»ä¸€æ¡æ•°æ®çš„<code>æ›´å¤š</code>æŒ‰é’®ï¼Œå†<code>æ›´å¤š</code>é‡Œé¢é€‰æ‹©<code>åº“å­˜ç®¡ç†</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.6.6.1.png" alt="image-20220614165640587" tabindex="0" loading="lazy"><figcaption>image-20220614165640587</figcaption></figure><p>å¯ä»¥çœ‹åˆ°è·³è½¬åˆ°<code>åº“å­˜ç®¡ç†</code>æ—¶å·²è‡ªåŠ¨æºå¸¦åˆšåˆšé€‰æ‹©çš„é‚£ä¸ª<code>å•†å“ç®¡ç†</code>çš„é‚£æ¡æ•°æ®çš„<code>skuId</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.6.6.2.png" alt="image-20220614165720231" tabindex="0" loading="lazy"><figcaption>image-20220614165720231</figcaption></figure><h4 id="_7ã€é‡‡è´­éœ€æ±‚æ·»åŠ æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_7ã€é‡‡è´­éœ€æ±‚æ·»åŠ æ•°æ®" aria-hidden="true">#</a> 7ã€<code>é‡‡è´­éœ€æ±‚</code>æ·»åŠ æ•°æ®</h4><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œç‚¹å‡»<code>æ–°å¢</code>ï¼Œ<code>é‡‡è´­å•†å“id</code>è¾“å…¥<code>3</code>ï¼Œ<code>é‡‡è´­æ•°é‡</code>è¾“å…¥<code>2</code>ï¼Œ<code>ä»“åº“</code>é€‰æ‹©<code>1å·ä»“åº“</code>ï¼Œç„¶åç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.6.7.1.png" alt="image-20220614165934717" tabindex="0" loading="lazy"><figcaption>image-20220614165934717</figcaption></figure><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œç‚¹å‡»<code>æ–°å¢</code>ï¼Œ<code>é‡‡è´­å•†å“id</code>è¾“å…¥<code>1</code>ï¼Œ<code>é‡‡è´­æ•°é‡</code>è¾“å…¥<code>10</code>ï¼Œ<code>ä»“åº“</code>é€‰æ‹©<code>1å·ä»“åº“</code>ï¼Œç„¶åç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.6.7.2.png" alt="image-20220614170034342" tabindex="0" loading="lazy"><figcaption>image-20220614170034342</figcaption></figure><h4 id="_8ã€åˆå¹¶æ•´å•" tabindex="-1"><a class="header-anchor" href="#_8ã€åˆå¹¶æ•´å•" aria-hidden="true">#</a> 8ã€åˆå¹¶æ•´å•</h4><p>é€‰ä¸­è¡¨å¤´ä¸­<code>id</code>å·¦ä¾§çš„å¯é€‰æŒ‰é’®ï¼Œä»¥å…¨é€‰æ‰€æœ‰é‡‡è´­éœ€æ±‚ï¼Œç„¶åç‚¹å‡»<code>æ‰¹é‡æ“ä½œ</code>ï¼Œåœ¨<code>æ‰¹é‡æ“ä½œ</code>é‡Œé€‰æ‹©<code>åˆå¹¶æ•´å•</code>ï¼Œç¨åå®Œæˆè¿™ä¸ªåŠŸèƒ½</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.6.8.png" alt="image-20220614170203075" tabindex="0" loading="lazy"><figcaption>image-20220614170203075</figcaption></figure><h3 id="_4-8-7ã€æŸ¥è¯¢é‡‡è´­éœ€æ±‚" tabindex="-1"><a class="header-anchor" href="#_4-8-7ã€æŸ¥è¯¢é‡‡è´­éœ€æ±‚" aria-hidden="true">#</a> 4.8.7ã€æŸ¥è¯¢é‡‡è´­éœ€æ±‚</h3><h4 id="_1ã€æŸ¥çœ‹æ¥å£-3" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹æ¥å£-3" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹æ¥å£</h4><p>å…ˆæ‰“å¼€æ§åˆ¶å°ï¼Œç‚¹å‡»<code>Network</code>ï¼Œæ¸…ç©ºæ•°æ®ï¼Œç„¶åç‚¹å‡»<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>ï¼Œåœ¨é‡‡è´­éœ€æ±‚é‡Œï¼Œ<code>ä»“åº“</code>é€‰æ‹©<code>1å·ä»“åº“</code>ï¼Œ<code>çŠ¶æ€</code>é€‰æ‹©<code>å·²åˆ†é…</code>ï¼Œç‚¹å‡»æŸ¥è¯¢ï¼Œå¯ä»¥çœ‹åˆ°è¯·æ±‚çš„urlä¸º</p><p>http://localhost:88/api/ware/purchasedetail/list?t=1655197388337&amp;page=1&amp;limit=10&amp;key=&amp;status=1&amp;wareId=1</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.7.1.1.png" alt="image-20220614170329492" tabindex="0" loading="lazy"><figcaption>image-20220614170329492</figcaption></figure><p>æ¥å£æ–‡æ¡£åœ¨<code>åº“å­˜ç³»ç»Ÿ/03.æŸ¥è¯¢é‡‡è´­éœ€æ±‚</code>é‡Œ: https://easydoc.net/s/78237135/ZUqEdvA4/Ss4zsV7R</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.7.1.2.png" alt="image-20220614170424163" tabindex="0" loading="lazy"><figcaption>image-20220614170424163</figcaption></figure><h4 id="_2ã€ä¿®æ”¹querypageæ–¹æ³•-2" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¿®æ”¹querypageæ–¹æ³•-2" aria-hidden="true">#</a> 2ã€ä¿®æ”¹<code>queryPage</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.PurchaseDetailServiceImpl</code>ç±»é‡Œä¿®æ”¹<code>queryPage</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token punctuation">{</span>
 *    page: 1,//å½“å‰é¡µç 
 *    limit: 10,//æ¯é¡µè®°å½•æ•°
 *    sidx: &#39;id&#39;,//æ’åºå­—æ®µ
 *    order: &#39;asc/desc&#39;,//æ’åºæ–¹å¼
 *    key: &#39;åä¸º&#39;,//æ£€ç´¢å…³é”®å­—
 *    status: 0,//çŠ¶æ€
 *    wareId: 1,//ä»“åº“id
 * <span class="token punctuation">}</span>
 * <span class="token keyword">@param</span> <span class="token parameter">params</span>
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">queryPage</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span>wrapper <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            wrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDetailEntity</span><span class="token operator">::</span><span class="token function">getSkuId</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDetailEntity</span><span class="token operator">::</span><span class="token function">getPurchaseId</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> status <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">PurchaseDetailEntity</span><span class="token operator">::</span><span class="token function">getStatus</span><span class="token punctuation">,</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> wareId <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;wareId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>wareId<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">PurchaseDetailEntity</span><span class="token operator">::</span><span class="token function">getWareId</span><span class="token punctuation">,</span>wareId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span>
            lambdaQueryWrapper
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.7.2.png" alt="image-20220614183804323" tabindex="0" loading="lazy"><figcaption>image-20220614183804323</figcaption></figure><h4 id="_3ã€æµ‹è¯•-4" tabindex="-1"><a class="header-anchor" href="#_3ã€æµ‹è¯•-4" aria-hidden="true">#</a> 3ã€æµ‹è¯•</h4><p>é‡å¯<code>gulimall-ware</code>æ¨¡å—ï¼Œç‚¹å‡»<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>ï¼Œåœ¨é‡‡è´­éœ€æ±‚é‡Œï¼Œ<code>ä»“åº“</code>é€‰æ‹©<code>1å·ä»“åº“</code>ï¼Œ<code>çŠ¶æ€</code>é€‰æ‹©<code>å·²åˆ†é…</code>ï¼Œç‚¹å‡»æŸ¥è¯¢</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.7.3.1.png" alt="image-20220614184255818" tabindex="0" loading="lazy"><figcaption>image-20220614184255818</figcaption></figure><p>æŸ¥çœ‹<code>GulimallWareApplication</code>æ¨¡å—çš„æ§åˆ¶å°æ‰“å°çš„<code>sql</code>è¯­å¥</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>SELECT id,ware_id,purchase_id,sku_price,sku_num,sku_id,status FROM wms_purchase_detail WHERE (( (sku_id = ? OR purchase_id = ?) ) AND status = ? AND ware_id = ?)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.7.3.2.png" alt="image-20220614184415655" tabindex="0" loading="lazy"><figcaption>image-20220614184415655</figcaption></figure><h3 id="_4-8-8ã€åˆå¹¶é‡‡è´­éœ€æ±‚-1-æŸ¥è¯¢é‡‡è´­å•" tabindex="-1"><a class="header-anchor" href="#_4-8-8ã€åˆå¹¶é‡‡è´­éœ€æ±‚-1-æŸ¥è¯¢é‡‡è´­å•" aria-hidden="true">#</a> 4.8.8ã€åˆå¹¶é‡‡è´­éœ€æ±‚(1.æŸ¥è¯¢<code>é‡‡è´­å•</code>)</h3><h4 id="_1ã€é‡‡è´­ç®€è¦æµç¨‹" tabindex="-1"><a class="header-anchor" href="#_1ã€é‡‡è´­ç®€è¦æµç¨‹" aria-hidden="true">#</a> 1ã€é‡‡è´­ç®€è¦æµç¨‹</h4><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.1.png" alt="image-20220614184722625" style="zoom:67%;"><h4 id="_2ã€æ–°å¢é‡‡è´­å•" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å¢é‡‡è´­å•" aria-hidden="true">#</a> 2ã€æ–°å¢é‡‡è´­å•</h4><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­å•</code>é‡Œï¼Œç‚¹å‡»<code>æ–°å¢</code>ï¼Œ<code>ä¼˜å…ˆçº§</code>è¾“å…¥<code>1</code>ï¼Œç„¶åç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.2.png" alt="image-20220614184928961" tabindex="0" loading="lazy"><figcaption>image-20220614184928961</figcaption></figure><h4 id="_3ã€æŸ¥è¯¢é‡‡è´­å•æ¥å£" tabindex="-1"><a class="header-anchor" href="#_3ã€æŸ¥è¯¢é‡‡è´­å•æ¥å£" aria-hidden="true">#</a> 3ã€æŸ¥è¯¢<code>é‡‡è´­å•</code>æ¥å£</h4><p>å…ˆæ‰“å¼€æ§åˆ¶å°ï¼Œç‚¹å‡»<code>Network</code>ï¼Œæ¸…ç©ºæ•°æ®ï¼›é€‰ä¸­è¡¨å¤´ä¸­<code>id</code>å·¦ä¾§çš„å¯é€‰æŒ‰é’®ï¼Œä»¥å…¨é€‰æ‰€æœ‰é‡‡è´­éœ€æ±‚ï¼Œç„¶åç‚¹å‡»<code>æ‰¹é‡æ“ä½œ</code>ï¼Œåœ¨<code>æ‰¹é‡æ“ä½œ</code>é‡Œé€‰æ‹©<code>åˆå¹¶æ•´å•</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.3.1.png" alt="image-20220614185015067" tabindex="0" loading="lazy"><figcaption>image-20220614185015067</figcaption></figure><p>åœ¨<code>åˆå¹¶åˆ°æ•´å•</code>çš„å¯¹è¯æ¡†ä¸­éœ€è¦æŸ¥è¯¢<code>æ–°å»º</code>æˆ–<code>å·²åˆ†é…</code>çš„<code>é‡‡è´­å•</code>ï¼Œå¯ä»¥çœ‹åˆ°urlä¸º</p><p>http://localhost:88/api/ware/purchase/unreceive/list?t=1655203843040</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.3.2.png" alt="image-20220614185105320" tabindex="0" loading="lazy"><figcaption>image-20220614185105320</figcaption></figure><p><code>æ–°å»º</code>æˆ–<code>å·²åˆ†é…</code>çš„<code>é‡‡è´­å•</code>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­å•</code>é‡Œçš„<code>çŠ¶æ€</code>ä¸­å¯ä»¥çœ‹åˆ°</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.3.3.png" alt="image-20220614185229357" tabindex="0" loading="lazy"><figcaption>image-20220614185229357</figcaption></figure><p>æ¥å£æ–‡æ¡£åœ¨<code>åº“å­˜ç³»ç»Ÿ/05ã€æŸ¥è¯¢æœªé¢†å–çš„é‡‡è´­å•</code>é‡Œï¼šhttps://easydoc.net/s/78237135/ZUqEdvA4/hI12DNrH</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.3.4.png" alt="image-20220614185453482" tabindex="0" loading="lazy"><figcaption>image-20220614185453482</figcaption></figure><h4 id="_4ã€æ·»åŠ unreceivelistæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ unreceivelistæ–¹æ³•" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>unreceiveList</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.controller.PurchaseController</code>é‡Œæ·»åŠ <code>unreceiveList</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * åˆ†é¡µæŸ¥è¯¢æœªé¢†å–çš„é‡‡è´­å•
 */</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/unreceive/list&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">unreceiveList</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">PageUtils</span> page <span class="token operator">=</span> purchaseService<span class="token punctuation">.</span><span class="token function">queryPageUnreceivePurchase</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">,</span> page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.4.png" alt="image-20220614190152959" tabindex="0" loading="lazy"><figcaption>image-20220614190152959</figcaption></figure><h4 id="_5ã€æ·»åŠ querypageunreceivepurchaseæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€æ·»åŠ querypageunreceivepurchaseæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 5ã€æ·»åŠ <code>queryPageUnreceivePurchase</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.PurchaseService</code>æ¥å£é‡Œæ·»åŠ <code>queryPageUnreceivePurchase</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">PageUtils</span> <span class="token function">queryPageUnreceivePurchase</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.5.png" alt="image-20220614190254861" tabindex="0" loading="lazy"><figcaption>image-20220614190254861</figcaption></figure><h4 id="_6ã€å®ç°querypageunreceivepurchaseæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_6ã€å®ç°querypageunreceivepurchaseæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 6ã€å®ç°<code>queryPageUnreceivePurchase</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.PurchaseServiceImpl</code>é‡Œå®ç°æœªå®ç°çš„<code>queryPageUnreceivePurchase</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PageUtils</span> <span class="token function">queryPageUnreceivePurchase</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æŸ¥è¯¢çŠ¶æ€ä¸º0(æ–°å»º) æˆ– 1(å·²åˆ†é…) çš„é‡‡è´­å•</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">PurchaseEntity</span><span class="token operator">::</span><span class="token function">getStatus</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">PurchaseEntity</span><span class="token operator">::</span><span class="token function">getStatus</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">IPage</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseEntity</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span>
            lambdaQueryWrapper
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PageUtils</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.6.png" alt="image-20220614190912851" tabindex="0" loading="lazy"><figcaption>image-20220614190912851</figcaption></figure><h4 id="_7ã€æµ‹è¯•-5" tabindex="-1"><a class="header-anchor" href="#_7ã€æµ‹è¯•-5" aria-hidden="true">#</a> 7ã€æµ‹è¯•</h4><p>ç‚¹å‡»ä»¥å‰åˆ›å»º<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­å•</code>é‡Œçš„<code>é‡‡è´­å•id</code>ä¸º<code>1</code>çš„<code>æ“ä½œ</code>é‡Œçš„<code>åˆ†é…</code>æŒ‰é’®ï¼Œåœ¨å¼¹å‡ºçš„<code>åˆ†é…é‡‡è´­äººå‘˜</code>é‡Œé€‰æ‹©<code>admin</code>ï¼Œç„¶åç‚¹å‡»ç¡®å®šï¼Œå³å¯åˆ†é…é‡‡è´­äººå‘˜</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.7.1.png" alt="image-20220614191038467" tabindex="0" loading="lazy"><figcaption>image-20220614191038467</figcaption></figure><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œï¼Œé€‰ä¸­è¡¨å¤´ä¸­<code>id</code>å·¦ä¾§çš„å¯é€‰æŒ‰é’®ï¼Œä»¥å…¨é€‰æ‰€æœ‰é‡‡è´­éœ€æ±‚ï¼Œç„¶åç‚¹å‡»<code>æ‰¹é‡æ“ä½œ</code>ï¼Œåœ¨<code>æ‰¹é‡æ“ä½œ</code>é‡Œé€‰æ‹©<code>åˆå¹¶æ•´å•</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.7.2.png" alt="image-20220614191329442" tabindex="0" loading="lazy"><figcaption>image-20220614191329442</figcaption></figure><p>ç„¶åå°±å¯ä»¥çœ‹åˆ°ä»¥å‰åˆ›å»ºçš„<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­å•</code>é‡Œçš„é‡‡è´­å•çŠ¶æ€ä¸º<code>æ–°å»º</code>æˆ–<code>å·²åˆ†é…</code>çš„<code>é‡‡è´­å•</code>ï¼Œå¦‚æœåˆ†é…äº†é‡‡è´­äººå‘˜ï¼Œå°±å¯ä»¥åœ¨ä¸‹æ‹‰åˆ—è¡¨ä¸­çš„<code>é‡‡è´­å•id</code>çš„å³è¾¹æ˜¾ç¤ºå¯¹åº”çš„åˆ†é…çš„<code>é‡‡è´­äººå‘˜å§“å</code>å’Œ<code>é‡‡è´­äººå‘˜ç”µè¯</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.7.3.png" alt="image-20220614191349478" tabindex="0" loading="lazy"><figcaption>image-20220614191349478</figcaption></figure><h4 id="_8ã€ä¿®æ”¹åˆ†é…çš„é‡‡è´­äººå‘˜" tabindex="-1"><a class="header-anchor" href="#_8ã€ä¿®æ”¹åˆ†é…çš„é‡‡è´­äººå‘˜" aria-hidden="true">#</a> 8ã€ä¿®æ”¹åˆ†é…çš„é‡‡è´­äººå‘˜</h4><p>åœ¨<code>ç³»ç»Ÿç®¡ç†/ç®¡ç†å‘˜åˆ—è¡¨</code>é‡Œæ–°å»ºç®¡ç†å‘˜ï¼›<code>ç”¨æˆ·å</code>é€‰æ‹©<code>leifengyang</code>ï¼Œ<code>å¯†ç </code>è¾“å…¥<code>123456</code>ï¼Œ<code>ç¡®è®¤å¯†ç </code>é‡Œè¾“å…¥<code>123456</code>ï¼Œ<code>é‚®ç®±</code>è¾“å…¥<code>aaa@qq.com</code>ï¼Œ<code>æ‰‹æœºå·</code>è¾“å…¥<code>12345678912</code>ï¼Œ<code>çŠ¶æ€</code>é»˜è®¤<code>æ­£å¸¸</code>ä¸ç”¨ç®¡ï¼Œç„¶åç‚¹å‡»<code>ç¡®å®š</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.8.1.png" alt="image-20220614191547642" tabindex="0" loading="lazy"><figcaption>image-20220614191547642</figcaption></figure><p>ç„¶åç‚¹å‡»<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­å•</code>é‡Œçš„ä¸Šæ¬¡åˆ›å»ºçš„<code>é‡‡è´­å•id</code>ä¸º<code>1</code>çš„é‚£è¡Œæ•°æ®çš„<code>æ“ä½œ</code>é‡Œçš„<code>åˆ†é…</code>æŒ‰é’®ï¼Œåœ¨å¼¹å‡ºçš„<code>åˆ†é…é‡‡è´­äººå‘˜</code>é‡Œå°±å¯ä»¥çœ‹åˆ°åˆšåˆš<code>æ·»åŠ ç®¡ç†å‘˜</code>é‡Œæ·»åŠ çš„ç®¡ç†å‘˜äº†ï¼Œè¿™äº›ç®¡ç†å‘˜å°±æ˜¯å¯ä»¥åˆ†é…çš„é‡‡è´­äººå‘˜</p><p>é€‰æ‹©åˆšåˆšåˆ›å»ºçš„<code>leifengyang</code>ï¼Œç„¶åç‚¹å‡»<code>ç¡®å®š</code>æŒ‰é’®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.8.2.png" alt="image-20220614191715258" tabindex="0" loading="lazy"><figcaption>image-20220614191715258</figcaption></figure><p>è¿™æ ·ä¸Šæ¬¡åˆ›å»ºçš„<code>é‡‡è´­å•id</code>ä¸º<code>1</code>çš„é‚£è¡Œæ•°æ®çš„<code>é‡‡è´­äººå</code>å°±å˜æˆäº†<code>leifengyang</code>ï¼Œè”ç³»ç”µè¯å°±å˜ä¸ºäº†<code>12345678912</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.8.3.png" alt="image-20220614191740042" tabindex="0" loading="lazy"><figcaption>image-20220614191740042</figcaption></figure><p>é€‰ä¸­è¡¨å¤´ä¸­<code>id</code>å·¦ä¾§çš„å¯é€‰æŒ‰é’®ï¼Œä»¥å…¨é€‰æ‰€æœ‰é‡‡è´­éœ€æ±‚ï¼Œç„¶åç‚¹å‡»<code>æ‰¹é‡æ“ä½œ</code>ï¼Œåœ¨<code>æ‰¹é‡æ“ä½œ</code>é‡Œé€‰æ‹©<code>åˆå¹¶æ•´å•</code>ï¼Œç„¶åå°±å¯ä»¥çœ‹åˆ°<code>é‡‡è´­å•id</code>ä¸º<code>1</code>çš„<code>é‡‡è´­äººå‘˜å§“å</code>å·²ç»ä¿®æ”¹ä¸º<code>leifengyang</code>äº†ï¼Œè”ç³»ç”µè¯å·²ç»è¢«ä¿®æ”¹ä¸º<code>12345678912</code>äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.8.8.4.png" alt="image-20220614191939490" tabindex="0" loading="lazy"><figcaption>image-20220614191939490</figcaption></figure><h3 id="_4-8-9ã€åˆå¹¶é‡‡è´­éœ€æ±‚-2-å®Œæˆåˆå¹¶" tabindex="-1"><a class="header-anchor" href="#_4-8-9ã€åˆå¹¶é‡‡è´­éœ€æ±‚-2-å®Œæˆåˆå¹¶" aria-hidden="true">#</a> 4.8.9ã€åˆå¹¶é‡‡è´­éœ€æ±‚(2.å®Œæˆåˆå¹¶)</h3><h4 id="_1ã€æŸ¥çœ‹æ¥å£-4" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹æ¥å£-4" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹æ¥å£</h4><h5 id="_1ã€é€‰æ‹©æƒ³è¦åˆå¹¶çš„é‡‡è´­å•id" tabindex="-1"><a class="header-anchor" href="#_1ã€é€‰æ‹©æƒ³è¦åˆå¹¶çš„é‡‡è´­å•id" aria-hidden="true">#</a> 1ã€é€‰æ‹©æƒ³è¦åˆå¹¶çš„é‡‡è´­å•id</h5><p>é€‰æ‹©<code>1 leifengyang: 12345678912</code>å ï¼Œå…ˆæ‰“å¼€æ§åˆ¶å°ï¼Œç‚¹å‡»<code>Network</code>ï¼Œæ¸…ç©ºæ•°æ®ï¼Œç„¶åç‚¹å‡»ç¡®å®š</p><p>å¯ä»¥çœ‹åˆ°è¯·æ±‚çš„urlä¸ºï¼š http://localhost:88/api/ware/purchase/merge</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.1.1.1.png" alt="image-20220614192020545" tabindex="0" loading="lazy"><figcaption>image-20220614192020545</figcaption></figure><p>å‘é€åˆ°<code>json</code>æ•°æ®ä¸º<code>{purchaseId: 1, items: {1, 2}}</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.1.1.2.png" alt="image-20220614192448552" tabindex="0" loading="lazy"><figcaption>image-20220614192448552</figcaption></figure><p>æ¥å£æ–‡æ¡£åœ¨<code>åº“å­˜ç³»ç»Ÿ/04ã€åˆå¹¶é‡‡è´­éœ€æ±‚</code>é‡Œï¼šhttps://easydoc.net/s/78237135/ZUqEdvA4/cUlv9QvK</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.1.1.3.png" alt="image-20220614192149087" tabindex="0" loading="lazy"><figcaption>image-20220614192149087</figcaption></figure><h5 id="_2ã€ä¸é€‰æ‹©æƒ³è¦åˆå¹¶çš„é‡‡è´­å•id" tabindex="-1"><a class="header-anchor" href="#_2ã€ä¸é€‰æ‹©æƒ³è¦åˆå¹¶çš„é‡‡è´­å•id" aria-hidden="true">#</a> 2ã€ä¸é€‰æ‹©æƒ³è¦åˆå¹¶çš„é‡‡è´­å•id</h5><p>åœ¨<code>åˆå¹¶åˆ°æ•´å•</code>é‡Œå¯ä»¥ä¸é€‰æ‹©æƒ³è¦åˆå¹¶çš„é‡‡è´­å•ï¼Œç›´æ¥ç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.1.2.1.png" alt="image-20220614192556641" tabindex="0" loading="lazy"><figcaption>image-20220614192556641</figcaption></figure><p>åœ¨å¼¹å‡ºçš„<code>æç¤º</code>å¯¹è¯æ¡†é‡Œç‚¹å‡»<code>ç¡®å®š</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.1.2.2.png" alt="image-20220614192615039" tabindex="0" loading="lazy"><figcaption>image-20220614192615039</figcaption></figure><p>è¿™æ—¶æäº¤çš„<code>json</code>æ•°æ®ï¼Œæ²¡æœ‰<code>purchaseId</code>(é‡‡è´­å•id)ï¼Œåªæœ‰<code>item</code>,è¿™æ—¶éœ€è¦è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°çš„é‡‡è´­å•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.1.2.3.png" alt="image-20220614192702323" tabindex="0" loading="lazy"><figcaption>image-20220614192702323</figcaption></figure><h4 id="_2ã€æ–°å»ºmergevoç±»" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å»ºmergevoç±»" aria-hidden="true">#</a> 2ã€æ–°å»º<code>MergeVo</code>ç±»</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware</code>åŒ…ä¸‹ï¼Œæ–°å»º<code>vo</code>æ–‡ä»¶å¤¹ï¼Œåœ¨åˆšåˆšæ–°å»ºçš„<code>com.atguigu.gulimall.ware.vo</code>æ–‡ä»¶å¤¹é‡Œæ–°å»º<code>MergeVo</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>ware<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/6/14
 * @Description:
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MergeVo</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * é‡‡è´­å•id
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> purchaseId<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * è¦åˆå¹¶çš„é‡‡è´­é¡¹é›†åˆ
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> items<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.2.png" alt="image-20220614193510395" tabindex="0" loading="lazy"><figcaption>image-20220614193510395</figcaption></figure><h4 id="_3ã€æ·»åŠ mergeæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ mergeæ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>merge</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.controller.PurchaseController</code>ç±»é‡Œæ·»åŠ <code>merge</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * åˆå¹¶é‡‡è´­éœ€æ±‚
 * <span class="token keyword">@param</span> <span class="token parameter">mergeVo</span>
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/merge&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">MergeVo</span> mergeVo<span class="token punctuation">)</span><span class="token punctuation">{</span>
    purchaseService<span class="token punctuation">.</span><span class="token function">mergePurchase</span><span class="token punctuation">(</span>mergeVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.3.png" alt="image-20220614193952336" tabindex="0" loading="lazy"><figcaption>image-20220614193952336</figcaption></figure><h4 id="_4ã€æ·»åŠ mergepurchaseæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ mergepurchaseæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>mergePurchase</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.PurchaseService</code>æ¥å£é‡Œæ·»åŠ <code>mergePurchase</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">mergePurchase</span><span class="token punctuation">(</span><span class="token class-name">MergeVo</span> mergeVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.4.png" alt="image-20220614194027812" tabindex="0" loading="lazy"><figcaption>image-20220614194027812</figcaption></figure><h4 id="_5ã€è°ƒæ•´å¸¸é‡ç±»çš„ä»£ç ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_5ã€è°ƒæ•´å¸¸é‡ç±»çš„ä»£ç ç»“æ„" aria-hidden="true">#</a> 5ã€è°ƒæ•´å¸¸é‡ç±»çš„ä»£ç ç»“æ„</h4><p>åœ¨<code>gulimall-common</code>æ¨¡å—çš„<code>com.atguigu.common.constant</code>åŒ…ä¸‹æ–°å»º<code>product</code>æ–‡ä»¶å¤¹,æŠŠ<code>ProductConstant</code>æšä¸¾ç±»ç§»åŠ¨åˆ°<code>product</code>æ–‡ä»¶å¤¹ä¸‹</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.5.1.png" alt="image-20220614200450052" tabindex="0" loading="lazy"><figcaption>image-20220614200450052</figcaption></figure><p>é€‰ä¸­<code>ProductConstant</code>æšä¸¾ç±»ï¼Œå³é”®é€‰æ‹©<code>Refactor</code>(é‡æ„)ï¼Œç„¶åé€‰æ‹©<code>Rename...</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.5.2.png" alt="image-20220614200633959" tabindex="0" loading="lazy"><figcaption>image-20220614200633959</figcaption></figure><p>åœ¨å¼¹å‡ºçš„æ¡†å†…ï¼Œä¿®æ”¹åå­—ä¸º<code>AttrEnum</code>ï¼Œç„¶åç‚¹å‡»<code>Refactor</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.5.3.png" alt="image-20220614200617454" tabindex="0" loading="lazy"><figcaption>image-20220614200617454</figcaption></figure><h4 id="_6ã€æ–°å»ºé‡‡è´­å•†å“æšä¸¾ç±»" tabindex="-1"><a class="header-anchor" href="#_6ã€æ–°å»ºé‡‡è´­å•†å“æšä¸¾ç±»" aria-hidden="true">#</a> 6ã€æ–°å»ºé‡‡è´­å•†å“æšä¸¾ç±»</h4><p>åœ¨<code>gulimall-common</code>æ¨¡å—çš„<code>com.atguigu.common.constant</code>åŒ…ä¸‹æ–°å»º<code>ware</code>æ–‡ä»¶å¤¹ï¼Œåœ¨<code>com.atguigu.common.constant.ware</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»º<code>PurchaseStatusEnum</code>(é‡‡è´­å•†å“çš„é‡‡è´­å•å®ŒæˆçŠ¶æ€)æšä¸¾ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>common<span class="token punctuation">.</span>constant<span class="token punctuation">.</span>ware</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/6/14
 * @Description:
 */</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">PurchaseStatusEnum</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * åˆšæ–°å»ºçŠ¶æ€
     */</span>
    <span class="token function">CREATED</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;æ–°å»º&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token doc-comment comment">/**
     * å·²åˆ†é…ç»™é‡‡è´­å‘˜
     */</span>
    <span class="token function">ASSIGNED</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;å·²åˆ†é…&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token doc-comment comment">/**
     * é‡‡è´­å‘˜å·²é¢†å–
     */</span>
    <span class="token function">RECEIVE</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">&quot;å·²é¢†å–&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token doc-comment comment">/**
     * é‡‡è´­å‘˜å·²å®Œæˆé‡‡è´­
     */</span>
    <span class="token function">FINISHED</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">&quot;å·²å®Œæˆ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token doc-comment comment">/**
     * é‡‡è´­å¼‚å¸¸
     */</span>
    <span class="token function">HASERROR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">&quot;æœ‰å¼‚å¸¸&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> status<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> msg<span class="token punctuation">;</span>

    <span class="token class-name">PurchaseStatusEnum</span><span class="token punctuation">(</span><span class="token keyword">int</span> status<span class="token punctuation">,</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">=</span> status<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> status<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> msg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.6.1.png" alt="image-20220614202825301" tabindex="0" loading="lazy"><figcaption>image-20220614202825301</figcaption></figure><p>åœ¨<code>gulimall-common</code>æ¨¡å—çš„<code>com.atguigu.common.constant.ware</code>åŒ…ä¸‹æ–°å»º<code>PurchaseStatusEnum</code>(é‡‡è´­å•å…·ä½“é‡‡è´­çš„å•†å“çš„å®ŒæˆçŠ¶æ€)æšä¸¾ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>common<span class="token punctuation">.</span>constant<span class="token punctuation">.</span>ware</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/6/14
 * @Description:
 */</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">PurchaseDetailStatusEnum</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * åˆšæ–°å»ºçŠ¶æ€
     */</span>
    <span class="token function">CREATED</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;æ–°å»º&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token doc-comment comment">/**
     * å·²åˆ†é…ç»™é‡‡è´­å‘˜
     */</span>
    <span class="token function">ASSIGNED</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;å·²åˆ†é…&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token doc-comment comment">/**
     * é‡‡è´­å‘˜æ­£åœ¨é‡‡è´­
     */</span>
    <span class="token function">BUYING</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">&quot;æ­£åœ¨é‡‡è´­&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token doc-comment comment">/**
     * é‡‡è´­å‘˜å·²å®Œæˆé‡‡è´­
     */</span>
    <span class="token function">FINISHED</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">&quot;å·²å®Œæˆ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token doc-comment comment">/**
     * é‡‡è´­å‘˜é‡‡è´­å¤±è´¥
     */</span>
    <span class="token function">HASERROR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">&quot;é‡‡è´­å¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> status<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> msg<span class="token punctuation">;</span>

    <span class="token class-name">PurchaseDetailStatusEnum</span><span class="token punctuation">(</span><span class="token keyword">int</span> status<span class="token punctuation">,</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">=</span> status<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> status<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> msg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.6.2.png" alt="image-20220614203245139" tabindex="0" loading="lazy"><figcaption>image-20220614203245139</figcaption></figure><h4 id="_7ã€å®ç°mergepurchaseæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_7ã€å®ç°mergepurchaseæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 7ã€å®ç°<code>mergePurchase</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.PurchaseServiceImpl</code>ç±»é‡Œä¿®æ”¹ç©ºçš„<code>mergePurchase</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">mergePurchase</span><span class="token punctuation">(</span><span class="token class-name">MergeVo</span> mergeVo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Long</span> purchaseId <span class="token operator">=</span> mergeVo<span class="token punctuation">.</span><span class="token function">getPurchaseId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>purchaseId <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">PurchaseEntity</span> purchaseEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PurchaseEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        purchaseEntity<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">PurchaseStatusEnum</span><span class="token punctuation">.</span><span class="token constant">CREATED</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>purchaseEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        purchaseId <span class="token operator">=</span> purchaseEntity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> items <span class="token operator">=</span> mergeVo<span class="token punctuation">.</span><span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Long</span> finalPurchaseId <span class="token operator">=</span> purchaseId<span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">&gt;</span></span> purchaseDetailEntities <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">PurchaseDetailEntity</span> purchaseDetailEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">setPurchaseId</span><span class="token punctuation">(</span>finalPurchaseId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDetailStatusEnum</span><span class="token punctuation">.</span><span class="token constant">ASSIGNED</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> purchaseDetailEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    purchaseDetailService<span class="token punctuation">.</span><span class="token function">updateBatchById</span><span class="token punctuation">(</span>purchaseDetailEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.7.png" alt="image-20220614204427993" tabindex="0" loading="lazy"><figcaption>image-20220614204427993</figcaption></figure><h4 id="_8ã€åœ¨purchaseentityç±»æ·»åŠ æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_8ã€åœ¨purchaseentityç±»æ·»åŠ æ³¨è§£" aria-hidden="true">#</a> 8ã€åœ¨<code>PurchaseEntity</code>ç±»æ·»åŠ æ³¨è§£</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.entity.PurchaseEntity</code>ç±»é‡Œçš„<code>createTime</code>å­—æ®µä¸Šæ·»åŠ <code>@TableField(fill = FieldFill.INSERT)</code>æ³¨è§£ï¼Œå½“åœ¨<code>æ’å…¥</code>æ—¶å‘è¯¥å­—æ®µæ’å…¥å½“å‰ç³»ç»Ÿæ—¶é—´ï¼›åœ¨<code>updateTime</code>å­—æ®µä¸Šæ·»åŠ <code>@TableField(fill = FieldFill.INSERT_UPDATE)</code>æ³¨è§£ï¼Œå½“åœ¨<code>æ’å…¥</code>æˆ–<code>æ›´æ–°</code>æ—¶å‘è¯¥å­—æ®µæ’å…¥æˆ–æ›´æ–°ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´</p><p><a href="code/4.8.9.8.PurchaseEntity.java">ç‚¹å‡»æŸ¥çœ‹<code>PurchaseEntity</code>ç±»å®Œæ•´ä»£ç </a></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.8.png" alt="image-20220614204518437" tabindex="0" loading="lazy"><figcaption>image-20220614204518437</figcaption></figure><h4 id="_9ã€è®¾ç½®æ—¶é—´æ ¼å¼å’Œæ—¶åŒº" tabindex="-1"><a class="header-anchor" href="#_9ã€è®¾ç½®æ—¶é—´æ ¼å¼å’Œæ—¶åŒº" aria-hidden="true">#</a> 9ã€è®¾ç½®<code>æ—¶é—´æ ¼å¼</code>å’Œ<code>æ—¶åŒº</code></h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>src/main/resources/application.yml</code>é…ç½®æ–‡ä»¶é‡Œè®¾ç½®<code>æ—¶é—´æ ¼å¼</code>å’Œ<code>æ—¶åŒº</code></p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">jackson</span><span class="token punctuation">:</span>
    <span class="token key atrule">date-format</span><span class="token punctuation">:</span> yyyy<span class="token punctuation">-</span>MM<span class="token punctuation">-</span>dd HH<span class="token punctuation">-</span>mm<span class="token punctuation">-</span>ss
    <span class="token key atrule">time-zone</span><span class="token punctuation">:</span> GMT+8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.9.png" alt="image-20220614205149464" tabindex="0" loading="lazy"><figcaption>image-20220614205149464</figcaption></figure><h4 id="_10ã€ä¿®æ”¹mergepurchaseæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_10ã€ä¿®æ”¹mergepurchaseæ–¹æ³•" aria-hidden="true">#</a> 10ã€ä¿®æ”¹<code>mergePurchase</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.PurchaseServiceImpl</code>ç±»é‡Œä¿®æ”¹<code>mergePurchase</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">PurchaseDetailService</span> purchaseDetailService<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">mergePurchase</span><span class="token punctuation">(</span><span class="token class-name">MergeVo</span> mergeVo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Long</span> purchaseId <span class="token operator">=</span> mergeVo<span class="token punctuation">.</span><span class="token function">getPurchaseId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>purchaseId <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">PurchaseEntity</span> purchaseEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PurchaseEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        purchaseEntity<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">PurchaseStatusEnum</span><span class="token punctuation">.</span><span class="token constant">CREATED</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è‡ªåŠ¨æ›´æ–°PurchaseEntityçš„æ›´æ–°æ—¶é—´</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>purchaseEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        purchaseId <span class="token operator">=</span> purchaseEntity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">//æ›´æ–°PurchaseEntity(é‡‡è´­å•)çš„æ›´æ–°æ—¶é—´</span>
        <span class="token class-name">PurchaseEntity</span> purchaseEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PurchaseEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        purchaseEntity<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>purchaseId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        purchaseEntity<span class="token punctuation">.</span><span class="token function">setUpdateTime</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>purchaseEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> items <span class="token operator">=</span> mergeVo<span class="token punctuation">.</span><span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Long</span> finalPurchaseId <span class="token operator">=</span> purchaseId<span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">&gt;</span></span> purchaseDetailEntities <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">PurchaseDetailEntity</span> purchaseDetailEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">setPurchaseId</span><span class="token punctuation">(</span>finalPurchaseId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDetailStatusEnum</span><span class="token punctuation">.</span><span class="token constant">ASSIGNED</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> purchaseDetailEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//åˆå¹¶é‡‡è´­éœ€æ±‚ï¼Œåˆ†æ´¾åˆ°æŒ‡å®šé‡‡è´­å•</span>
    purchaseDetailService<span class="token punctuation">.</span><span class="token function">updateBatchById</span><span class="token punctuation">(</span>purchaseDetailEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.10.png" alt="image-20220614210320804" tabindex="0" loading="lazy"><figcaption>image-20220614210320804</figcaption></figure><h4 id="_11ã€æµ‹è¯•ä¸€" tabindex="-1"><a class="header-anchor" href="#_11ã€æµ‹è¯•ä¸€" aria-hidden="true">#</a> 11ã€æµ‹è¯•ä¸€</h4><p>é‡å¯<code>gulimall-ware</code>æ¨¡å—,ç‚¹å‡»<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>ï¼Œé€‰ä¸­è¡¨å¤´ä¸­<code>id</code>å·¦ä¾§çš„å¯é€‰æŒ‰é’®ï¼Œä»¥å…¨é€‰æ‰€æœ‰é‡‡è´­éœ€æ±‚ï¼Œç„¶åç‚¹å‡»<code>æ‰¹é‡æ“ä½œ</code>ï¼Œåœ¨<code>æ‰¹é‡æ“ä½œ</code>é‡Œé€‰æ‹©<code>åˆå¹¶æ•´å•</code>,ç„¶åé€‰æ‹©<code>1 leifengyang: 12345678912</code>å ï¼Œç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.11.1.png" alt="image-20220614210524845" tabindex="0" loading="lazy"><figcaption>image-20220614210524845</figcaption></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œåˆšåˆšå…¨é€‰çš„ä¸¤ä¸ª<code>é‡‡è´­éœ€æ±‚</code>çš„<code>é‡‡è´­å•id</code>å’Œ<code>çŠ¶æ€</code>éƒ½å·²ç»æ›´æ–°äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.11.2.png" alt="image-20220614210635314" tabindex="0" loading="lazy"><figcaption>image-20220614210635314</figcaption></figure><p>ç‚¹å‡»\`\`åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­\`å•å·²ç»æ›´æ–°äº†ï¼Œè®¾ç½®æ—¶åŒºåï¼Œæ›´æ–°çš„æ—¶é—´ä¹Ÿæ˜¯ç³»ç»Ÿæ—¶é—´äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.11.3.png" alt="image-20220614211030868" tabindex="0" loading="lazy"><figcaption>image-20220614211030868</figcaption></figure><h4 id="_12ã€æµ‹è¯•äºŒ" tabindex="-1"><a class="header-anchor" href="#_12ã€æµ‹è¯•äºŒ" aria-hidden="true">#</a> 12ã€æµ‹è¯•äºŒ</h4><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œï¼Œç‚¹å‡»<code>æ–°å¢</code>ï¼Œåœ¨<code>é‡‡è´­å•†å“id</code>é‡Œè¾“å…¥<code>2</code>ï¼Œ<code>é‡‡è´­æ•°é‡</code>è¾“å…¥<code>20</code>ï¼Œ<code>ä»“åº“</code>é€‰æ‹©<code>2å·ä»“åº“</code>ï¼Œç„¶åç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.12.1.png" alt="image-20220614211131709" tabindex="0" loading="lazy"><figcaption>image-20220614211131709</figcaption></figure><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œï¼Œç‚¹å‡»<code>æ–°å»º</code>,åœ¨<code>æ–°å¢</code>å¯¹è¯æ¡†é‡Œï¼Œ<code>é‡‡è´­å•†å“id</code>è¾“å…¥<code>2</code>ï¼Œ<code>é‡‡è´­æ•°é‡</code>è¾“å…¥<code>20</code>ï¼Œ<code>ä»“åº“</code>é€‰æ‹©<code>2å·ä»“åº“</code></p><p>ç„¶åé€‰ä¸­åˆšåˆšåˆ›å»ºçš„<code>id</code>ä¸º<code>3</code>çš„é‡‡è´­éœ€æ±‚çš„å·¦ä¾§æŒ‰é’®ï¼Œç„¶åç‚¹å‡»<code>æ‰¹é‡æ“ä½œ</code>ï¼Œåœ¨<code>æ‰¹é‡æ“ä½œ</code>é‡Œé€‰æ‹©<code>åˆå¹¶æ•´å•</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.12.2.png" alt="image-20220614211230326" tabindex="0" loading="lazy"><figcaption>image-20220614211230326</figcaption></figure><p>åœ¨<code>åˆå¹¶åˆ°æ•´å•</code>é‡Œå¯ä»¥ä¸é€‰æ‹©æƒ³è¦åˆå¹¶çš„é‡‡è´­å•ï¼Œç›´æ¥ç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.12.3.png" alt="image-20220614211309852" tabindex="0" loading="lazy"><figcaption>image-20220614211309852</figcaption></figure><p>åœ¨å¼¹å‡ºçš„<code>æç¤º</code>å¯¹è¯æ¡†é‡Œç‚¹å‡»<code>ç¡®å®š</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.12.4.png" alt="image-20220614211325353" tabindex="0" loading="lazy"><figcaption>image-20220614211325353</figcaption></figure><p>å¯ä»¥çœ‹åˆ°åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œï¼Œåˆšåˆšåˆ›å»ºçš„<code>id</code>ä¸º<code>3</code>çš„<code>é‡‡è´­éœ€æ±‚</code>çš„<code>çŠ¶æ€</code>å·²å˜ä¸º<code>å·²åˆ†é…</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.12.5.png" alt="image-20220614211354619" tabindex="0" loading="lazy"><figcaption>image-20220614211354619</figcaption></figure><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­å•</code>é‡Œï¼Œå¯ä»¥çœ‹åˆ°å·²è‡ªåŠ¨åˆ›å»ºäº†ä¸€ä¸ª<code>é‡‡è´­å•</code>ï¼Œè¿™ä¸ªé‡‡è´­å•çš„<code>çŠ¶æ€</code>ä¸º<code>æ–°å»º</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.12.6.png" alt="image-20220614211426208" tabindex="0" loading="lazy"><figcaption>image-20220614211426208</figcaption></figure><p>ç‚¹å‡»è¿™ä¸ª<code>é‡‡è´­å•</code>çš„<code>æ“ä½œ</code>é‡Œçš„<code>åˆ†é…</code>æŒ‰é’®ï¼Œåœ¨<code>åˆ†é…é‡‡è´­äººå‘˜</code>çš„å¯¹è¯æ¡†ä¸­é€‰æ‹©<code>admin</code>ï¼Œç„¶åç‚¹å‡»<code>ç¡®å®š</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.12.7.png" alt="image-20220614211502224" tabindex="0" loading="lazy"><figcaption>image-20220614211502224</figcaption></figure><h4 id="_13ã€ä¿®æ”¹æ²¡æœ‰è‡ªåŠ¨åˆ›å»ºæ—¶é—´çš„bug" tabindex="-1"><a class="header-anchor" href="#_13ã€ä¿®æ”¹æ²¡æœ‰è‡ªåŠ¨åˆ›å»ºæ—¶é—´çš„bug" aria-hidden="true">#</a> 13ã€ä¿®æ”¹æ²¡æœ‰è‡ªåŠ¨åˆ›å»ºæ—¶é—´çš„bug</h4><p>å¯ä»¥çœ‹åˆ°åˆšåˆšè‡ªåŠ¨åˆ›å»ºçš„é‚£ä¸ª<code>é‡‡è´­å•</code>çš„<code>åˆ›å»ºæ—¶é—´</code>å’Œ<code>æ›´æ–°æ—¶é—´</code>æ²¡æœ‰è‡ªåŠ¨åˆ›å»º</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.13.1.png" alt="image-20220614211426208" tabindex="0" loading="lazy"><figcaption>image-20220614211426208</figcaption></figure><p>è°ƒè¯•åï¼Œå‘ç°<code>create_time</code>å’Œ<code>update_time</code>ä¼ å…¥çš„å‚æ•°éƒ½ä¸º<code>null</code></p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>INSERT INTO wms_ purchase ( create_timeï¼Œupdate_timeï¼Œstatus ) VALUES ( ?ï¼Œ ? ï¼Œ? )
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.13.2.png" alt="image-20220614211753133" tabindex="0" loading="lazy"><figcaption>image-20220614211753133</figcaption></figure><p>åŸå› æ˜¯æ²¡æœ‰è®¾ç½®<code>mybatisPlus</code>çš„å±æ€§è‡ªåŠ¨å¡«å……é…ç½®</p><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware</code>åŒ…é‡Œæ–°å»º<code>config</code>æ–‡ä»¶å¤¹ï¼Œ</p><p>å¤åˆ¶<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.config.MyMetaObjectHandler</code>ç±»ï¼Œç²˜è´´åˆ°<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.config</code>åŒ…é‡Œ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>ware<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>handlers<span class="token punctuation">.</span></span><span class="token class-name">MetaObjectHandler</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>reflection<span class="token punctuation">.</span></span><span class="token class-name">MetaObject</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/6/14
 * @Description:
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyMetaObjectHandler</span> <span class="token keyword">implements</span> <span class="token class-name">MetaObjectHandler</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insertFill</span><span class="token punctuation">(</span><span class="token class-name">MetaObject</span> metaObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;start insert fill...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setFieldValByName</span><span class="token punctuation">(</span><span class="token string">&quot;createTime&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setFieldValByName</span><span class="token punctuation">(</span><span class="token string">&quot;updateTime&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateFill</span><span class="token punctuation">(</span><span class="token class-name">MetaObject</span> metaObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;start update fill...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setFieldValByName</span><span class="token punctuation">(</span><span class="token string">&quot;updateTime&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> metaObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.13.3.png" alt="image-20220614212341199" tabindex="0" loading="lazy"><figcaption>image-20220614212341199</figcaption></figure><h4 id="_14ã€é‡æ–°æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_14ã€é‡æ–°æµ‹è¯•" aria-hidden="true">#</a> 14ã€é‡æ–°æµ‹è¯•</h4><p>é‡å¯<code>gulimall-ware</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯ç•Œé¢ï¼Œåœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­å•</code>é‡Œï¼Œç‚¹å‡»<code>æ–°å¢</code>ï¼Œåœ¨å¼¹å‡ºçš„<code>æ–°å¢</code>å¯¹è¯æ¡†é‡Œçš„<code>ä¼˜å…ˆçº§</code>é‡Œè¾“å…¥<code>3</code>ï¼Œç„¶åç‚¹å‡»<code>ç¡®å®š</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.14.1.png" alt="image-20220614212524728" tabindex="0" loading="lazy"><figcaption>image-20220614212524728</figcaption></figure><p>å¯ä»¥çœ‹åˆ°<code>create_time</code>å’Œ<code>update_time</code>éƒ½å·²ç»æˆåŠŸæ’å…¥è¿›å»äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.9.14.2.png" alt="image-20220614212551163" tabindex="0" loading="lazy"><figcaption>image-20220614212551163</figcaption></figure><h3 id="_4-8-10ã€é¢†å–é‡‡è´­å•" tabindex="-1"><a class="header-anchor" href="#_4-8-10ã€é¢†å–é‡‡è´­å•" aria-hidden="true">#</a> 4.8.10ã€é¢†å–é‡‡è´­å•</h3><h4 id="_1ã€æŸ¥çœ‹æ¥å£-5" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹æ¥å£-5" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹æ¥å£</h4><p><code>é¢†å–é‡‡è´­å•</code>ä¸ºé‡‡è´­å‘˜ä½¿ç”¨appé¢†å–ï¼Œä¸å±äºåå°ç®¡ç†ç³»ç»Ÿï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨<code>Postman</code>æ¨¡æ‹Ÿé‡‡è´­å‘˜<code>é¢†å–é‡‡è´­å•</code></p><p>æ¥å£æ–‡æ¡£åœ¨<code>åº“å­˜ç³»ç»Ÿ/06ã€é¢†å–é‡‡è´­å•</code>é‡Œ: https://easydoc.net/s/78237135/ZUqEdvA4/vXMBBgw1</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.1.1.png" alt="image-20220614213006277" tabindex="0" loading="lazy"><figcaption>image-20220614213006277</figcaption></figure><p>åœ¨<code>Postman</code>é‡Œæ–°å»ºä¸€ä¸ªè¯·æ±‚ï¼Œurlè¾“å…¥<code>http://localhost:88/api/ware/purchase/received</code>,è¯·æ±‚æ–¹å¼é€‰æ‹©<code>POST</code>ï¼Œç„¶åæŒ‰<code>ctrl+s</code>ä¿å­˜</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.1.2.png" alt="image-20220614213232724" tabindex="0" loading="lazy"><figcaption>image-20220614213232724</figcaption></figure><p>åœ¨å¼¹å‡ºçš„<code>SAVE REQUEST</code>å¯¹è¯æ¡†é‡Œï¼Œ<code>Request name</code>é‡Œè¾“å…¥<code>é¢†å–é‡‡è´­å•</code>ï¼Œç„¶åç‚¹å‡»ä¸‹é¢çš„<code>Create a collection</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.1.3.png" alt="image-20220614213431165" tabindex="0" loading="lazy"><figcaption>image-20220614213431165</figcaption></figure><p>åœ¨<code>SAVE REQUEST</code>å¯¹è¯æ¡†é‡Œçš„<code>Save to</code>é‡Œè¾“å…¥<code>é‡‡è´­äººå‘˜app</code>ï¼Œç‚¹å‡»å³ä¾§çš„<code>Create</code>æŒ‰é’®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.1.4.png" alt="image-20220614213539031" tabindex="0" loading="lazy"><figcaption>image-20220614213539031</figcaption></figure><p>ç„¶åç‚¹å‡»<code>Save</code>æŒ‰é’®</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.1.5.png" alt="image-20220614213552521" tabindex="0" loading="lazy"><figcaption>image-20220614213552521</figcaption></figure><p>åœ¨åˆšåˆšæ–°å»ºçš„è¯·æ±‚ä¸­ï¼Œç‚¹å‡»<code>Body</code>ã€ç„¶åç‚¹å‡»<code>raw</code>ï¼Œåœ¨<code>GraphQL</code>å³ä¾§çš„ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹©<code>JSON</code>ï¼Œç„¶ååœ¨ä¸‹æ–¹è¾“å…¥æ¡†ä¸­è¾“å…¥<code>[3,4]</code>ï¼Œæœ€åç‚¹å‡»<code>Send</code>(è¾“å…¥<code>[3,4]</code>è¡¨ç¤ºè¦é¢†å–idä¸º<code>3</code>å’Œ<code>4</code>çš„é‡‡è´­å•)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.1.6.png" alt="image-20220615104015989" tabindex="0" loading="lazy"><figcaption>image-20220615104015989</figcaption></figure><h4 id="_2ã€åˆ›å»ºreceivedæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2ã€åˆ›å»ºreceivedæ–¹æ³•" aria-hidden="true">#</a> 2ã€åˆ›å»º<code>received</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.controller.PurchaseController</code>ç±»ä¸­åˆ›å»º<code>received</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * é‡‡è´­å‘˜é¢†å–é‡‡è´­å•
 * <span class="token keyword">@param</span> <span class="token parameter">purchaseIds</span> é‡‡è´­å•id
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/received&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">received</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> purchaseIds<span class="token punctuation">)</span><span class="token punctuation">{</span>
    purchaseService<span class="token punctuation">.</span><span class="token function">received</span><span class="token punctuation">(</span>purchaseIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.2.png" alt="image-20220615083311741" tabindex="0" loading="lazy"><figcaption>image-20220615083311741</figcaption></figure><h4 id="_3ã€æ–°å»ºreceivedæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ–°å»ºreceivedæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 3ã€æ–°å»º<code>received</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.PurchaseService</code>æ¥å£é‡Œæ–°å»º<code>received</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">received</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> purchaseIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.3.png" alt="image-20220615083427579" tabindex="0" loading="lazy"><figcaption>image-20220615083427579</figcaption></figure><h4 id="_4ã€å®ç°receivedæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€å®ç°receivedæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€å®ç°<code>received</code>æŠ½è±¡æ–¹æ³•</h4><p>éœ€è¦å®Œæˆçš„æ•ˆæœä¸ºï¼š</p><p>1ã€é¦–å…ˆéœ€è¦ä¿®æ”¹åˆšåˆšé¢†å–çš„æ‰€æœ‰é‡‡è´­å•çŠ¶æ€ï¼ŒæŠŠé‡‡è´­å•çŠ¶æ€ä¿®æ”¹ä¸º<code>å·²é¢†å–</code></p><p>(è¿™é‡Œæˆ‘æŠŠ<code>é‡‡è´­å•id</code>ä¸º3çš„é‡‡è´­å•åˆ†é…ç»™<code>admin</code>ç”¨æˆ·äº†ï¼Œç‚¹å‡»<code>é‡‡è´­å•id</code>ä¸º3çš„å³ä¾§çš„åˆ†é…ï¼Œé€‰æ‹©<code>admin</code>å³å¯)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.4.1.png" alt="image-20220615083759255" tabindex="0" loading="lazy"><figcaption>image-20220615083759255</figcaption></figure><p>2ã€è¿™äº›é‡‡è´­å•å¯¹åº”çš„æ‰€æœ‰é‡‡è´­éœ€æ±‚éƒ½è¦æ”¹ä¸º<code>æ­£åœ¨é‡‡è´­</code></p><p>(æˆ‘å…ˆæŠŠidä¸º3çš„é‡‡è´­éœ€æ±‚çš„<code>é‡‡è´­å•id</code>ä¿®æ”¹ä¸º3äº†ï¼Œé€‰ä¸­è¯¥æ•°æ®å·¦ä¾§çš„æŒ‰é’®ï¼Œç‚¹å‡»<code>æ‰¹é‡æ“ä½œ</code>ï¼Œåœ¨<code>æ‰¹é‡æ“ä½œ</code>é‡Œé€‰æ‹©<code>åˆå¹¶æ•´å•</code>,åœ¨å¼¹å‡ºçš„<code>åˆ†é…é‡‡è´­äººå‘˜</code>é‡Œé€‰æ‹©<code>admin</code>ï¼Œç„¶åç‚¹å‡»<code>ç¡®å®š</code>æŒ‰é’®)</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.4.2.png" alt="image-20220615083915584" tabindex="0" loading="lazy"><figcaption>image-20220615083915584</figcaption></figure><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.PurchaseServiceImpl</code>ç±»é‡Œå®ç°æœªå®ç°çš„<code>received</code>æŠ½è±¡æ–¹æ³•</p><p>åœ¨<code>streat</code>çš„<code>map</code>é‚£ï¼ŒIDEAæç¤ºå»ºè®®ä½¿ç”¨<code>peek</code>æ¥ä»£æ›¿<code>map</code>ï¼›<code>java.util.Stream.peek()</code>ä¸»è¦ç”¨äºæ”¯æŒè°ƒè¯•ã€‚å¦‚æœæµç®¡é“ä¸åŒ…å«ç»ˆç«¯æ“ä½œï¼Œåˆ™ä¸ä¼šä½¿ç”¨ä»»ä½•å…ƒç´ ï¼Œå¹¶ä¸”æ ¹æœ¬ä¸ä¼šè°ƒç”¨peek()æ“ä½œã€‚æ‰€ä»¥æœ€å¥½ä¸è¦ä½¿ç”¨<code>peek</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * é‡‡è´­å‘˜é¢†å–é‡‡è´­å•
 *
 * <span class="token keyword">@param</span> <span class="token parameter">purchaseIds</span> é‡‡è´­å•id
 */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">received</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> purchaseIds<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//1ã€ç¡®è®¤å½“å‰é‡‡è´­å•çš„idæ˜¯&quot;æ–°å»º&quot;æˆ–è€…æ˜¯&quot;å·²åˆ†é…&quot;çŠ¶æ€</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseEntity</span><span class="token punctuation">&gt;</span></span> purchaseQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    purchaseQueryWrapper<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>wrapper <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        wrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">PurchaseEntity</span><span class="token operator">::</span><span class="token function">getStatus</span><span class="token punctuation">,</span> <span class="token class-name">PurchaseStatusEnum</span><span class="token punctuation">.</span><span class="token constant">CREATED</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">PurchaseEntity</span><span class="token operator">::</span><span class="token function">getStatus</span><span class="token punctuation">,</span> <span class="token class-name">PurchaseStatusEnum</span><span class="token punctuation">.</span><span class="token constant">ASSIGNED</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">in</span><span class="token punctuation">(</span><span class="token class-name">PurchaseEntity</span><span class="token operator">::</span><span class="token function">getId</span><span class="token punctuation">,</span> purchaseIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseEntity</span><span class="token punctuation">&gt;</span></span> purchaseEntities <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span>purchaseQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//2ã€æ”¹å˜é‡‡è´­å•çŠ¶æ€(å·²ä½¿ç”¨æ³¨è§£åœ¨æ›´æ–°å­—æ®µæ—¶è‡ªåŠ¨æ›´æ–°updateTime)</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseEntity</span><span class="token punctuation">&gt;</span></span> newPurchaseEntities <span class="token operator">=</span> purchaseEntities<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>purchaseEntity <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        purchaseEntity<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">PurchaseStatusEnum</span><span class="token punctuation">.</span><span class="token constant">RECEIVE</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> purchaseEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateBatchById</span><span class="token punctuation">(</span>newPurchaseEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//3ã€æ”¹å˜é‡‡è´­é¡¹çŠ¶æ€</span>
    <span class="token class-name">PurchaseDetailEntity</span> purchaseDetailEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDetailStatusEnum</span><span class="token punctuation">.</span><span class="token constant">BUYING</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    purchaseDetailService<span class="token punctuation">.</span><span class="token function">updatePurchaseDetailBatchByPurchaseId</span><span class="token punctuation">(</span>purchaseDetailEntity<span class="token punctuation">,</span>newPurchaseEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.4.3.png" alt="image-20220615095031917" tabindex="0" loading="lazy"><figcaption>image-20220615095031917</figcaption></figure><h4 id="_5ã€æ–°å»ºæ‰¹é‡ä¿®æ”¹é‡‡è´­éœ€æ±‚æŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€æ–°å»ºæ‰¹é‡ä¿®æ”¹é‡‡è´­éœ€æ±‚æŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 5ã€æ–°å»ºæ‰¹é‡ä¿®æ”¹é‡‡è´­éœ€æ±‚æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.PurchaseDetailService</code>æ¥å£é‡Œæ–°å»º<code>updatePurchaseDetailBatchByPurchaseId</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">updatePurchaseDetailBatchByPurchaseId</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDetailEntity</span> purchaseDetailEntity<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseEntity</span><span class="token punctuation">&gt;</span></span> purchaseEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.5.png" alt="image-20220615100049272" tabindex="0" loading="lazy"><figcaption>image-20220615100049272</figcaption></figure><h4 id="_6ã€å®ç°æ‰¹é‡ä¿®æ”¹é‡‡è´­éœ€æ±‚æŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_6ã€å®ç°æ‰¹é‡ä¿®æ”¹é‡‡è´­éœ€æ±‚æŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 6ã€å®ç°æ‰¹é‡ä¿®æ”¹é‡‡è´­éœ€æ±‚æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.PurchaseDetailServiceImpl</code>ç±»é‡Œå®ç°æœªå®ç°çš„<code>updatePurchaseDetailBatchByPurchaseId</code>æŠ½è±¡æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.6.png" alt="image-20220615100252009" tabindex="0" loading="lazy"><figcaption>image-20220615100252009</figcaption></figure><h4 id="_7ã€ç»™è¿™äº›å…·ä½“æ–¹æ³•æ·»åŠ äº‹åŠ¡æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_7ã€ç»™è¿™äº›å…·ä½“æ–¹æ³•æ·»åŠ äº‹åŠ¡æ³¨è§£" aria-hidden="true">#</a> 7ã€ç»™è¿™äº›å…·ä½“æ–¹æ³•æ·»åŠ äº‹åŠ¡æ³¨è§£</h4><p>ç»™<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.PurchaseServiceImpl</code>ç±»çš„<code>received</code>æ–¹æ³•æ·»åŠ äº‹åŠ¡æ³¨è§£ï¼Œå¹¶æŒ‡å®šæœ‰å¼‚å¸¸å°±å›æ»šäº‹åŠ¡</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.7.1.png" alt="image-20220615100748683" tabindex="0" loading="lazy"><figcaption>image-20220615100748683</figcaption></figure><p>ç»™<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.PurchaseDetailServiceImpl</code>ç±»çš„<code>updatePurchaseDetailBatchByPurchaseId</code>æ–¹æ³•æ·»åŠ äº‹åŠ¡æ³¨è§£ï¼Œå¹¶æŒ‡å®šæœ‰å¼‚å¸¸å°±å›æ»šäº‹åŠ¡</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.7.2.png" alt="image-20220615100803171" tabindex="0" loading="lazy"><figcaption>image-20220615100803171</figcaption></figure><h4 id="_8ã€æµ‹è¯•-1" tabindex="-1"><a class="header-anchor" href="#_8ã€æµ‹è¯•-1" aria-hidden="true">#</a> 8ã€æµ‹è¯•</h4><p>ç»™<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.PurchaseServiceImpl</code>ç±»çš„<code>received</code>æ–¹æ³•é‡Œçš„ç¬¬ä¸€æ¡è¯­å¥æ‰“æ–­ç‚¹ï¼Œç„¶åç‚¹å‡»<code>IDEA</code>åº•éƒ¨çš„<code>Service</code>æŒ‰é’®ï¼Œé€‰æ‹©<code>GulimallWareApplication</code>ï¼Œå³é”®é€‰æ‹©<code>Return in Debug Mode</code>ï¼Œä»¥<code>debug</code>æ–¹å¼é‡æ–°å¯åŠ¨<code>GulimallWareApplication</code>æ¨¡å—</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.8.1.png" alt="image-20220615100934480" tabindex="0" loading="lazy"><figcaption>image-20220615100934480</figcaption></figure><p>å°†<code>gulimall_wms</code>æ•°æ®åº“ä¸­çš„<code>wms_purchase</code>è¡¨ä¸­ä¿®æ”¹<code>id</code>ä¸º<code>3</code>çš„<code>status</code>ä¸º<code>2</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.8.2.png" alt="image-20220615104336853" tabindex="0" loading="lazy"><figcaption>image-20220615104336853</figcaption></figure><p>åˆ·æ–°å‰ç«¯é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­å•</code>é‡Œï¼Œ<code>id</code>ä¸º<code>3</code>çš„<code>é‡‡è´­éœ€æ±‚</code>çš„<code>çŠ¶æ€</code>å·²å˜ä¸º<code>å·²é¢†å–</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.8.3.png" alt="image-20220615104512089" tabindex="0" loading="lazy"><figcaption>image-20220615104512089</figcaption></figure><p>æ‰“å¼€<code>Postman</code>ï¼Œå‘é€é¢†å–é‡‡è´­å•çš„è¯·æ±‚</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.8.4.png" alt="image-20220615104045438" tabindex="0" loading="lazy"><figcaption>image-20220615104045438</figcaption></figure><p>åˆ‡æ¢åˆ°<code>IDEA</code>ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æ¥æ”¶åˆ°<code>purchase_id</code>ä¸º<code>3</code>å’Œ<code>4</code>çš„ä¸¤æ¡æ•°æ®äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.8.5.png" alt="image-20220615104124184" tabindex="0" loading="lazy"><figcaption>image-20220615104124184</figcaption></figure><p>ç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œç›´åˆ°<code>ç¡®è®¤å½“å‰é‡‡è´­å•çš„idæ˜¯&quot;æ–°å»º&quot;æˆ–è€…æ˜¯&quot;å·²åˆ†é…&quot;çŠ¶æ€</code>å®Œæˆï¼Œåˆ°<code>æ”¹å˜é‡‡è´­å•çŠ¶æ€(å·²ä½¿ç”¨æ³¨è§£åœ¨æ›´æ–°å­—æ®µæ—¶è‡ªåŠ¨æ›´æ–°updateTime)</code>åœæ­¢ï¼Œå¯ä»¥çœ‹åˆ°åˆšåˆšä¿®æ”¹çš„<code>id</code>ä¸º<code>3</code>çš„çŠ¶æ€ä¸º<code>å·²é¢†å–</code>çš„é‚£æ¡æ•°æ®å·²ç»è¢«è¿‡æ»¤æ‰äº†ï¼Œåªå‰©ä¸‹<code>id</code>ä¸º<code>4</code>çš„çŠ¶æ€ä¸º<code>æ–°å»º</code>çš„é‚£æ¡æ•°æ®äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.8.6.png" alt="image-20220615104627577" tabindex="0" loading="lazy"><figcaption>image-20220615104627577</figcaption></figure><p>é€‰æ‹©<code>GulimallWareApplication</code>æ¨¡å—çš„æ§åˆ¶å°ï¼Œæ­¤æ—¶çš„<code>sql</code>è¯­å¥ä¹Ÿæ­£ç¡®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>SELECT id, amount , ware_id, create_time, phone, assignee_name , update_time, priority, assignee_id, status FROM wms_purchase WHERE ( (status = ? OR status = ?) ) AND id IN (?,?)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.8.7.png" alt="image-20220615104801580" tabindex="0" loading="lazy"><figcaption>image-20220615104801580</figcaption></figure><p>ç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œç›´åˆ°æ˜ å°„ç»“æŸï¼Œåœåœ¨<code>this.updateBatchById(newPurchaseEntities);</code>æ–¹æ³•ä¸Šï¼Œå¯ä»¥çœ‹åˆ°æ­¤æ—¶çš„<code>newPurchaseEntities</code>çš„<code>status</code>å·²ä¿®æ”¹ä¸º<code>2</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.8.8.png" alt="image-20220615104859953" tabindex="0" loading="lazy"><figcaption>image-20220615104859953</figcaption></figure><p>ç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œæ‰§è¡Œå®Œ<code>this.updateBatchById(newPurchaseEntities);</code>æ–¹æ³•ï¼ŒæŸ¥çœ‹<code>GulimallWareApplication</code>æ¨¡å—çš„æ§åˆ¶å°ï¼Œæ­¤æ—¶çš„<code>sql</code>è¯­å¥ä¹Ÿæ­£ç¡®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>UPDATE wms_purchase SET create_time=?, phone=?, assignee_name=?ï¼Œupdate_time=?ï¼Œpriority=?, status=? WHERE id=?
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.8.9.png" alt="image-20220615105044203" tabindex="0" loading="lazy"><figcaption>image-20220615105044203</figcaption></figure><p>ç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œç›´åˆ°<code>æ”¹å˜é‡‡è´­é¡¹çŠ¶æ€</code>æ‰€æœ‰ä»£ç éƒ½æ‰§è¡Œå®Œï¼Œå¯ä»¥çœ‹åˆ°<code>PurchaseDetailEntity</code>çš„<code>status</code>ä¸º<code>2</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.8.10.png" alt="image-20220615105320878" tabindex="0" loading="lazy"><figcaption>image-20220615105320878</figcaption></figure><p>æŸ¥çœ‹<code>GulimallWareApplication</code>æ¨¡å—çš„æ§åˆ¶å°ï¼Œæ­¤æ—¶çš„<code>sql</code>è¯­å¥ä¹Ÿæ­£ç¡®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>UPDATE wms_purchase_detail SET status=? WHERE (purchase_id IN (?))
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.8.11.png" alt="image-20220615105420470" tabindex="0" loading="lazy"><figcaption>image-20220615105420470</figcaption></figure><h4 id="_9ã€æ·»åŠ å¾…åŠäº‹é¡¹" tabindex="-1"><a class="header-anchor" href="#_9ã€æ·»åŠ å¾…åŠäº‹é¡¹" aria-hidden="true">#</a> 9ã€æ·»åŠ å¾…åŠäº‹é¡¹</h4><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œï¼Œé€‰ä¸­è¡¨å¤´ä¸­<code>id</code>å·¦ä¾§çš„å¯é€‰æŒ‰é’®ï¼Œä»¥å…¨é€‰æ‰€æœ‰é‡‡è´­éœ€æ±‚ï¼Œç„¶åç‚¹å‡»<code>æ‰¹é‡æ“ä½œ</code>ï¼Œåœ¨<code>æ‰¹é‡æ“ä½œ</code>é‡Œé€‰æ‹©<code>åˆå¹¶æ•´å•</code>ï¼Œåœ¨<code>åˆå¹¶åˆ°æ•´å•</code>çš„ä¸‹æ‹‰åˆ—è¡¨é‡Œé€‰æ‹©<code>1 leifengyang 12345678912</code>ï¼Œç„¶åç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.9.1.png" alt="image-20220615105740827" tabindex="0" loading="lazy"><figcaption>image-20220615105740827</figcaption></figure><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.PurchaseServiceImpl</code>ç±»é‡Œçš„<code>mergePurchase</code>é‡Œæ·»åŠ å¾…åŠäº‹é¡¹ï¼Œåé¢å®Œæˆ<code>ç¡®è®¤é‡‡è´­å•çŠ¶æ€æ˜¯0ï¼Œ1æ‰å¯ä»¥åˆå¹¶</code>åŠŸèƒ½</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//TODO ç¡®è®¤é‡‡è´­å•çŠ¶æ€æ˜¯0ï¼Œ1æ‰å¯ä»¥åˆå¹¶</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.9.2.png" alt="image-20220615110011514" tabindex="0" loading="lazy"><figcaption>image-20220615110011514</figcaption></figure><p>å¯ä»¥çœ‹åˆ°åœ¨é¢†å–åˆ°é‡‡è´­å•åï¼Œè¿™äº›è¢«é¢†å–çš„<code>é‡‡è´­å•</code>ï¼Œå¹¶æ²¡æœ‰ä¿®æ”¹<code>é‡‡è´­äººid</code>ï¼Œ<code>é‡‡è´­äººå</code>ã€<code>è”ç³»æ–¹å¼</code>ï¼Œè¿™ä¸ªåŠŸèƒ½ç›®å‰ç”±äºæ²¡æœ‰ç™»å½•ï¼Œæ‰€ä»¥ç›®å‰å®ç°ä¸äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.9.3.png" alt="image-20220615155836991" tabindex="0" loading="lazy"><figcaption>image-20220615155836991</figcaption></figure><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.PurchaseServiceImpl</code>ç±»é‡Œçš„<code>received</code>æ–¹æ³•é‡Œæ·»åŠ å¾…åŠäº‹é¡¹ï¼Œåé¢å®Œæˆ<code>è®¾ç½®é‡‡è´­äººidï¼Œé‡‡è´­äººåã€è”ç³»æ–¹å¼</code>åŠŸèƒ½</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//TODO è®¾ç½®é‡‡è´­äººidï¼Œé‡‡è´­äººåã€è”ç³»æ–¹å¼</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.10.9.4.png" alt="image-20220615160034810" tabindex="0" loading="lazy"><figcaption>image-20220615160034810</figcaption></figure><h3 id="_4-8-11ã€å®Œæˆé‡‡è´­" tabindex="-1"><a class="header-anchor" href="#_4-8-11ã€å®Œæˆé‡‡è´­" aria-hidden="true">#</a> 4.8.11ã€å®Œæˆé‡‡è´­</h3><h4 id="_1ã€æŸ¥çœ‹æ¥å£-6" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥çœ‹æ¥å£-6" aria-hidden="true">#</a> 1ã€æŸ¥çœ‹æ¥å£</h4><p><code>å®Œæˆé‡‡è´­</code>ä¸ºé‡‡è´­å‘˜ä½¿ç”¨appé¢†å–ï¼Œä¸å±äºåå°ç®¡ç†ç³»ç»Ÿï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨<code>Postman</code>æ¨¡æ‹Ÿé‡‡è´­å‘˜<code>å®Œæˆé‡‡è´­</code></p><p>æ¥å£æ–‡æ¡£åœ¨<code>åº“å­˜ç³»ç»Ÿ/07ã€å®Œæˆé‡‡è´­</code>é‡Œï¼š https://easydoc.net/s/78237135/ZUqEdvA4/cTQHGXbK</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.1.1.png" alt="image-20220615155034336" tabindex="0" loading="lazy"><figcaption>image-20220615155034336</figcaption></figure><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œï¼Œ<code>id</code>ä¸º<code>3</code>çš„é‡‡è´­éœ€æ±‚çš„<code>é‡‡è´­å•id</code>ä¸º<code>3</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.1.2.png" alt="image-20220615160507927" tabindex="0" loading="lazy"><figcaption>image-20220615160507927</figcaption></figure><p>åœ¨<code>gulimall_wms</code>æ•°æ®åº“çš„<code>wms_purchase_detail</code>è¡¨é‡Œå°†<code>id</code>ä¸º<code>3</code>çš„<code>purchase_id</code>ä¿®æ”¹ä¸º<code>4</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.1.3.png" alt="image-20220615160630004" tabindex="0" loading="lazy"><figcaption>image-20220615160630004</figcaption></figure><p>å†æ–°å¢ä¸€æ¡æ•°æ®,<code>id</code>è¾“å…¥<code>4</code>ï¼Œ<code>purchase_id</code>è¾“å…¥<code>4</code>ï¼Œ<code>sku_id</code>è¾“å…¥<code>4</code>ï¼Œ<code>sku_num</code>è¾“å…¥<code>30</code>ï¼Œ<code>ware_id</code>è¾“å…¥<code>2</code>ï¼Œ<code>status</code>è¾“å…¥<code>2</code>ï¼Œç„¶åç‚¹å‡»ä¸‹é¢çš„<code>âˆš</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.1.4.png" alt="image-20220615160917672" tabindex="0" loading="lazy"><figcaption>image-20220615160917672</figcaption></figure><p>å‘é€çš„è¯·æ±‚ä¸­<code>id</code>å¯¹åº”<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œçš„<code>id</code>ï¼Œ<code>items</code>é‡Œçš„<code>itemId</code>å¯¹åº”<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œçš„<code>é‡‡è´­å•id</code>ï¼Œå³ä¸ºå®ŒæˆæŸä¸ªé‡‡è´­å•çš„éƒ¨åˆ†æˆ–å…¨éƒ¨<code>é‡‡è´­é¡¹(é‡‡è´­éœ€æ±‚)</code></p><p>è¯·æ±‚çš„urlä¸º: http://localhost:88/api/ware/purchase/done ï¼Œè¯·æ±‚æ–¹å¼ä¸º<code>POST</code></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
   <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
   <span class="token property">&quot;items&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token punctuation">{</span><span class="token property">&quot;itemId&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token property">&quot;reason&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token punctuation">{</span><span class="token property">&quot;itemId&quot;</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token property">&quot;reason&quot;</span><span class="token operator">:</span><span class="token string">&quot;æ— è´§&quot;</span><span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.1.5.png" alt="image-20220615162226790" tabindex="0" loading="lazy"><figcaption>image-20220615162226790</figcaption></figure><h4 id="_2ã€æ–°å»ºpurchasedonevoç±»" tabindex="-1"><a class="header-anchor" href="#_2ã€æ–°å»ºpurchasedonevoç±»" aria-hidden="true">#</a> 2ã€æ–°å»º<code>PurchaseDoneVo</code>ç±»</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.vo</code>åŒ…é‡Œæ–°å»º<code>PurchaseDoneVo</code>ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>ware<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token class-name">NotNull</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> æ— åæ°
 * <span class="token keyword">@date</span> 2022/6/15
 * @Description: é‡‡è´­å®Œæˆ
 *
 * <span class="token punctuation">{</span>
 *    &quot;id&quot;: 4,
 *    &quot;items&quot;: [
 *        <span class="token punctuation">{</span>&quot;itemId&quot;:3,&quot;status&quot;:3,&quot;reason&quot;:&quot;&quot;<span class="token punctuation">}</span>,
 *        <span class="token punctuation">{</span>&quot;itemId&quot;:4,&quot;status&quot;:4,&quot;reason&quot;:&quot;æ— è´§&quot;<span class="token punctuation">}</span>
 *     ]
 * <span class="token punctuation">}</span>
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PurchaseDoneVo</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * é‡‡è´­å•id
     */</span>
    <span class="token annotation punctuation">@NotNull</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span>  id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseItemDone</span><span class="token punctuation">&gt;</span></span> items<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * é‡‡è´­é¡¹
     */</span>
    <span class="token annotation punctuation">@Data</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PurchaseItemDone</span><span class="token punctuation">{</span>
        <span class="token doc-comment comment">/**
         * é‡‡è´­é¡¹id
         */</span>
        <span class="token keyword">private</span> <span class="token class-name">Long</span> itemId<span class="token punctuation">;</span>
        <span class="token doc-comment comment">/**
         * é‡‡è´­çŠ¶æ€(3:é‡‡è´­å®Œæˆ ; 4:é‡‡è´­å¤±è´¥)
         */</span>
        <span class="token keyword">private</span> <span class="token class-name">Integer</span> status<span class="token punctuation">;</span>
        <span class="token doc-comment comment">/**
         * å¤±è´¥åŸå› 
         */</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> reason<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.2.png" alt="image-20220615163320567" tabindex="0" loading="lazy"><figcaption>image-20220615163320567</figcaption></figure><h4 id="_3ã€æ–°å»ºfinishæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ–°å»ºfinishæ–¹æ³•" aria-hidden="true">#</a> 3ã€æ–°å»º<code>finish</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.controller.PurchaseController</code>ç±»é‡Œæ–°å»º<code>finish</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * é‡‡è´­å‘˜å®Œæˆé‡‡è´­
 * /ware/purchase/done
 * <span class="token keyword">@param</span> <span class="token parameter">purchaseDoneVo</span>
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/done&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">finish</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">PurchaseDoneVo</span> purchaseDoneVo<span class="token punctuation">)</span><span class="token punctuation">{</span>
    purchaseService<span class="token punctuation">.</span><span class="token function">donePurchase</span><span class="token punctuation">(</span>purchaseDoneVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.3.png" alt="image-20220615163521858" tabindex="0" loading="lazy"><figcaption>image-20220615163521858</figcaption></figure><h4 id="_4ã€æ–°å»ºdonepurchaseæŠ½è±¡æ¥å£" tabindex="-1"><a class="header-anchor" href="#_4ã€æ–°å»ºdonepurchaseæŠ½è±¡æ¥å£" aria-hidden="true">#</a> 4ã€æ–°å»º<code>donePurchase</code>æŠ½è±¡æ¥å£</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.PurchaseService</code>æ¥å£é‡Œæ–°å»º<code>donePurchase</code>æŠ½è±¡æ¥å£</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.4.png" alt="image-20220615163603585" tabindex="0" loading="lazy"><figcaption>image-20220615163603585</figcaption></figure><h4 id="_5ã€å®ç°donepurchaseæŠ½è±¡æ¥å£" tabindex="-1"><a class="header-anchor" href="#_5ã€å®ç°donepurchaseæŠ½è±¡æ¥å£" aria-hidden="true">#</a> 5ã€å®ç°<code>donePurchase</code>æŠ½è±¡æ¥å£</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.PurchaseServiceImpl</code>ç±»é‡Œå®ç°æœªå®ç°çš„<code>donePurchase</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">WareSkuService</span> wareSkuService<span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * é‡‡è´­å‘˜å®Œæˆé‡‡è´­
 * <span class="token keyword">@param</span> <span class="token parameter">purchaseDoneVo</span>
 */</span>
<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">donePurchase</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDoneVo</span> purchaseDoneVo<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token class-name">AtomicBoolean</span> flag <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicBoolean</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//1ã€æ”¹å˜é‡‡è´­é¡¹çŠ¶æ€</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">&gt;</span></span> purchaseDetailEntities <span class="token operator">=</span> purchaseDoneVo<span class="token punctuation">.</span><span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>purchaseItemDone <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">PurchaseDetailEntity</span> purchaseDetailEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>purchaseItemDone<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">PurchaseDetailStatusEnum</span><span class="token punctuation">.</span><span class="token constant">HASERROR</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            flag<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDetailStatusEnum</span><span class="token punctuation">.</span><span class="token constant">HASERROR</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>purchaseItemDone<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">PurchaseDetailStatusEnum</span><span class="token punctuation">.</span><span class="token constant">BUYING</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDetailStatusEnum</span><span class="token punctuation">.</span><span class="token constant">FINISHED</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>purchaseItemDone<span class="token punctuation">.</span><span class="token function">getItemId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> purchaseDetailEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    purchaseDetailService<span class="token punctuation">.</span><span class="token function">updateBatchById</span><span class="token punctuation">(</span>purchaseDetailEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//2ã€æ”¹å˜é‡‡è´­å•çŠ¶æ€</span>
    <span class="token class-name">Long</span> purchaseId <span class="token operator">=</span> purchaseDoneVo<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">PurchaseEntity</span> purchaseEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PurchaseEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    purchaseEntity<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>purchaseId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> status <span class="token operator">=</span> flag<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token class-name">PurchaseStatusEnum</span><span class="token punctuation">.</span><span class="token constant">FINISHED</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token class-name">PurchaseStatusEnum</span><span class="token punctuation">.</span><span class="token constant">HASERROR</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    purchaseEntity<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>purchaseEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//3ã€å°†æˆåŠŸé‡‡è´­çš„è¿›è¡Œå…¥åº“</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> purchaseDetailIds <span class="token operator">=</span> purchaseDoneVo<span class="token punctuation">.</span><span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>purchaseItemDone <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> purchaseItemDone<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">PurchaseDetailStatusEnum</span><span class="token punctuation">.</span><span class="token constant">BUYING</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDoneVo<span class="token punctuation">.</span>PurchaseItemDone</span><span class="token operator">::</span><span class="token function">getItemId</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">&gt;</span></span> purchaseDetailList <span class="token operator">=</span> purchaseDetailService<span class="token punctuation">.</span><span class="token function">listByIds</span><span class="token punctuation">(</span>purchaseDetailIds<span class="token punctuation">)</span><span class="token punctuation">;</span>

    wareSkuService<span class="token punctuation">.</span><span class="token function">addOrUpdateStockBatchByskuIdAndwareId</span><span class="token punctuation">(</span>purchaseDetailList<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.5.png" alt="image-20220615200305836" tabindex="0" loading="lazy"><figcaption>image-20220615200305836</figcaption></figure><h4 id="_6ã€æ–°å»ºæ·»åŠ æˆ–æ›´æ–°åº“å­˜æŠ½è±¡æ¥å£" tabindex="-1"><a class="header-anchor" href="#_6ã€æ–°å»ºæ·»åŠ æˆ–æ›´æ–°åº“å­˜æŠ½è±¡æ¥å£" aria-hidden="true">#</a> 6ã€æ–°å»ºæ·»åŠ æˆ–æ›´æ–°åº“å­˜æŠ½è±¡æ¥å£</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.WareSkuService</code>æ¥å£é‡Œæ–°å»º<code>addOrUpdateStockBatchByskuIdAndwareId</code>æŠ½è±¡æ¥å£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">addOrUpdateStockBatchByskuIdAndwareId</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">&gt;</span></span> purchaseDetailList<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.6.png" alt="image-20220615200456324" tabindex="0" loading="lazy"><figcaption>image-20220615200456324</figcaption></figure><h4 id="_7ã€å®ç°æ·»åŠ æˆ–æ›´æ–°åº“å­˜æŠ½è±¡æ¥å£" tabindex="-1"><a class="header-anchor" href="#_7ã€å®ç°æ·»åŠ æˆ–æ›´æ–°åº“å­˜æŠ½è±¡æ¥å£" aria-hidden="true">#</a> 7ã€å®ç°æ·»åŠ æˆ–æ›´æ–°åº“å­˜æŠ½è±¡æ¥å£</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.WareSkuServiceImpl</code>ç±»é‡Œå®ç°æœªå®ç°çš„<code>addOrUpdateStockBatchByskuIdAndwareId</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">WareSkuDao</span> wareSkuDao<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addOrUpdateStockBatchByskuIdAndwareId</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">&gt;</span></span> purchaseDetailList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    purchaseDetailList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">::</span><span class="token function">addOrUpdateStockByskuIdAndwareId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addOrUpdateStockByskuIdAndwareId</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDetailEntity</span> purchaseDetailEntity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">WareSkuEntity</span> wareSkuEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WareSkuEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    wareSkuEntity<span class="token punctuation">.</span><span class="token function">setSkuId</span><span class="token punctuation">(</span>purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getSkuId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    wareSkuEntity<span class="token punctuation">.</span><span class="token function">setWareId</span><span class="token punctuation">(</span>purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getWareId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WareSkuEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">WareSkuEntity</span><span class="token operator">::</span><span class="token function">getSkuId</span><span class="token punctuation">,</span>purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getSkuId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">WareSkuEntity</span><span class="token operator">::</span><span class="token function">getWareId</span><span class="token punctuation">,</span>purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getWareId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">WareSkuEntity</span> query <span class="token operator">=</span> wareSkuDao<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            wareSkuEntity<span class="token punctuation">.</span><span class="token function">setStock</span><span class="token punctuation">(</span>purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getSkuNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            wareSkuDao<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>wareSkuEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        wareSkuEntity<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        wareSkuEntity<span class="token punctuation">.</span><span class="token function">setStock</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">getStock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getSkuNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        wareSkuDao<span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>wareSkuEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.7.png" alt="image-20220615204549277" tabindex="0" loading="lazy"><figcaption>image-20220615204549277</figcaption></figure><h4 id="_8ã€æµ‹è¯•-2" tabindex="-1"><a class="header-anchor" href="#_8ã€æµ‹è¯•-2" aria-hidden="true">#</a> 8ã€æµ‹è¯•</h4><p>é‡å¯<code>gulimall-ware</code>æ¨¡å—ï¼Œæ‰“å¼€<code>Postman</code></p><p>é€‰æ‹©è¯·æ±‚çš„urlä¸º: http://localhost:88/api/ware/purchase/doneçš„å¯¹è¯æ¡†ï¼ŒæŒ‰<code>ctrl+S</code>å¿«æ·é”®ä¿å­˜ï¼Œåœ¨å¼¹å‡ºçš„<code>SAVE REQUEST</code>å¯¹è¯æ¡†é‡Œï¼Œ<code>Request name</code>é‡Œè¾“å…¥<code>å®Œæˆé‡‡è´­</code>ï¼Œç‚¹å‡»<code>Save to</code>é‡Œçš„<code>é‡‡è´­äººå‘˜app</code>ï¼ŒæŠŠ<code>å®Œæˆé‡‡è´­</code>æ”¾åˆ°<code>é‡‡è´­äººå‘˜app</code>é‡Œé¢ï¼Œç„¶åç‚¹å‡»<code>Save</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.8.1.gif" alt="GIF 2022-6-15 23-10-02" tabindex="0" loading="lazy"><figcaption>GIF 2022-6-15 23-10-02</figcaption></figure><p>ç‚¹å‡»<code>Send</code>åï¼Œæ˜¾ç¤ºæŠ¥äº†<code>400</code>çš„é”™è¯¯</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.8.2.png" alt="image-20220615231715243" tabindex="0" loading="lazy"><figcaption>image-20220615231715243</figcaption></figure><p>æŸ¥çœ‹<code>GulimallWareApplication</code>æ¨¡å—çš„æ§åˆ¶å°ï¼Œå¯ä»¥å‘ç°å·²ç»æŠ¥é”™äº†</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Resolved [org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Cannot construct instance of \`com.atguigu.gulimall.ware.vo.PurchaseDoneVo$PurchaseItemDone\` (although at least one Creator exists): can only instantiate non-static inner class by using default, no-argument

å·²è§£å†³ [org.springframework.http.converter.HttpMessageNotReadableExceptionï¼šJSON è§£æé”™è¯¯ï¼šæ— æ³•æ„é€  \`com.atguigu.gulimall.ware.vo.PurchaseDoneVo$PurchaseItemDone\` çš„å®ä¾‹ï¼ˆå°½ç®¡è‡³å°‘å­˜åœ¨ä¸€ä¸ª Creatorï¼‰ï¼šåªèƒ½å®ä¾‹åŒ–éé™æ€ ä½¿ç”¨é»˜è®¤çš„æ— å‚æ•°çš„å†…éƒ¨ç±»
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.8.3.png" alt="image-20220615231358244" tabindex="0" loading="lazy"><figcaption>image-20220615231358244</figcaption></figure><p>æŠŠ<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.vo.PurchaseDoneVo</code>ç±»çš„<code>PurchaseItemDone</code>å†…éƒ¨ç±»ä¸Šæ·»åŠ <code>static</code>å…³é”®å­—</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.8.4.png" alt="image-20220615231750046" tabindex="0" loading="lazy"><figcaption>image-20220615231750046</figcaption></figure><p>é‡å¯<code>gulimall-ware</code>æ¨¡å—ï¼Œæ‰“å¼€<code>Postman</code>ï¼Œå†æ¬¡å‘é€è¯·æ±‚ï¼Œè¿™æ¬¡æŠ¥äº†<code>500</code>çš„é”™è¯¯</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.8.5.png" alt="image-20220615233005159" tabindex="0" loading="lazy"><figcaption>image-20220615233005159</figcaption></figure><p>æŸ¥çœ‹<code>GulimallWareApplication</code>æ¨¡å—çš„æ§åˆ¶å°ï¼ŒæŸ¥çœ‹<code>sql</code>è¯­å¥å¯ä»¥çœ‹åˆ°æ‰§è¡Œ<code>update</code>æ“ä½œæ—¶åªæœ‰æ›´æ–°æ¡ä»¶ï¼Œå´æ²¡æœ‰æ›´æ–°çš„å­—æ®µ</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>UPDATE wms_ purchase_ detail WHERE id=?
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.8.6.png" alt="image-20220615233148420" tabindex="0" loading="lazy"><figcaption>image-20220615233148420</figcaption></figure><p>è°ƒè¯•å‘ç°ï¼Œ<code>purchaseDetailEntities</code>ä¸­<code>id</code>ä¸º<code>3</code>çš„æ•°æ®çš„<code>status</code>ä¸º<code>null</code>ï¼Œæ•´æ¡æ•°æ®åªæœ‰<code>id</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.8.7.png" alt="image-20220615233304771" tabindex="0" loading="lazy"><figcaption>image-20220615233304771</figcaption></figure><p>åœ¨è¯¥<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.PurchaseServiceImpl</code>ç±»çš„<code>donePurchase</code>æ–¹æ³•é‡Œæ·»åŠ è¿‡æ»¤æ¡ä»¶,åªæœ‰<code>purchaseDetailEntity.getStatus()!=null</code>çš„æ•°æ®æ‰ä¿ç•™</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//1ã€æ”¹å˜é‡‡è´­é¡¹çŠ¶æ€</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">&gt;</span></span> purchaseDetailEntities <span class="token operator">=</span> purchaseDoneVo<span class="token punctuation">.</span><span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>purchaseItemDone <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">PurchaseDetailEntity</span> purchaseDetailEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PurchaseDetailEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>purchaseItemDone<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">PurchaseDetailStatusEnum</span><span class="token punctuation">.</span><span class="token constant">HASERROR</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        flag<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDetailStatusEnum</span><span class="token punctuation">.</span><span class="token constant">HASERROR</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>purchaseItemDone<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">PurchaseDetailStatusEnum</span><span class="token punctuation">.</span><span class="token constant">FINISHED</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDetailStatusEnum</span><span class="token punctuation">.</span><span class="token constant">FINISHED</span><span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>purchaseItemDone<span class="token punctuation">.</span><span class="token function">getItemId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> purchaseDetailEntity<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>purchaseDetailEntity<span class="token operator">-&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
purchaseDetailService<span class="token punctuation">.</span><span class="token function">updateBatchById</span><span class="token punctuation">(</span>purchaseDetailEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.8.8.png" alt="image-20220615233734194" tabindex="0" loading="lazy"><figcaption>image-20220615233734194</figcaption></figure><p>é‡å¯<code>gulimall-ware</code>æ¨¡å—ï¼Œå†æ¬¡å‘é€è¯·æ±‚åˆæŠ¥é”™äº†ï¼Œå†æ¬¡è°ƒè¯•</p><p>æŸ¥çœ‹<code>GulimallWareApplication</code>æ¨¡å—çš„æ§åˆ¶å°ï¼ŒæŸ¥çœ‹<code>sql</code>è¯­å¥,å¯ä»¥çœ‹åˆ°åœ¨<code>in()</code>é‡Œé¢æ²¡æœ‰ä¼ é€’æ•°æ®</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>SELECT id,ware_id, purchase_id, sku_price, sku_num,sku_id, status FROM wms_purchase_detail WHERE id IN ( )
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.8.9.png" alt="image-20220615234429118" tabindex="0" loading="lazy"><figcaption>image-20220615234429118</figcaption></figure><p>åœ¨è¯¥<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.PurchaseServiceImpl</code>ç±»çš„<code>donePurchase</code>æ–¹æ³•é‡Œï¼Œä¿®æ”¹<code>purchaseItemDone.getStatus()</code>ä¸<code>PurchaseDetailStatusEnum.FINISHED.getStatus();</code>ç›¸æ¯”ï¼Œå¹¶åˆ¤æ–­<code>purchaseDetailIds</code>ä¸ä¸ºç©ºæ‰æ·»åŠ æˆ–æ›´æ–°åº“å­˜</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.8.10.png" alt="image-20220615234255037" tabindex="0" loading="lazy"><figcaption>image-20220615234255037</figcaption></figure><p><a href="code/4.8.11.8.PurchaseServiceImpl.java">ç‚¹å‡»æŸ¥çœ‹<code>PurchaseServiceImpl</code>ç±»å®Œæ•´ä»£ç </a></p><h4 id="_9ã€é‡æ–°æµ‹è¯•ä¸€" tabindex="-1"><a class="header-anchor" href="#_9ã€é‡æ–°æµ‹è¯•ä¸€" aria-hidden="true">#</a> 9ã€é‡æ–°æµ‹è¯•ä¸€</h4><p>é‡å¯<code>gulimall-ware</code>æ¨¡å—ï¼Œå†æ¬¡å‘é€è¯·æ±‚ï¼Œå¯ä»¥çœ‹åˆ°è¿™æ¬¡æˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.9.1.png" alt="image-20220615234546911" tabindex="0" loading="lazy"><figcaption>image-20220615234546911</figcaption></figure><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­å•</code>é‡Œï¼Œ<code>é‡‡è´­å•id</code>ä¸º<code>4</code>çš„<code>çŠ¶æ€</code>å·²æ­£ç¡®å˜ä¸º<code>æœ‰å¼‚å¸¸</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.9.2.png" alt="image-20220615234624963" tabindex="0" loading="lazy"><figcaption>image-20220615234624963</figcaption></figure><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œï¼Œ<code>id</code>ä¸º<code>3</code>çš„<code>çŠ¶æ€</code>å·²æ­£ç¡®å˜ä¸º<code>å·²å®Œæˆ</code>ï¼Œ<code>id</code>ä¸º<code>4</code>çš„<code>çŠ¶æ€</code>å·²æ­£ç¡®å˜ä¸º<code>é‡‡è´­å¤±è´¥</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.9.3.png" alt="image-20220615234706291" tabindex="0" loading="lazy"><figcaption>image-20220615234706291</figcaption></figure><h4 id="_10ã€é‡æ–°æµ‹è¯•äºŒ" tabindex="-1"><a class="header-anchor" href="#_10ã€é‡æ–°æµ‹è¯•äºŒ" aria-hidden="true">#</a> 10ã€é‡æ–°æµ‹è¯•äºŒ</h4><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œï¼Œç‚¹å‡»<code>æ–°å»º</code>ï¼Œåœ¨<code>é‡‡è´­å•†å“id</code>é‡Œè¾“å…¥<code>2</code>ï¼Œ<code>é‡‡è´­æ•°é‡</code>é‡Œè¾“å…¥<code>10</code>ï¼Œ<code>ä»“åº“</code>é‡Œé€‰æ‹©<code>1å·ä»“åº“</code>ï¼Œç„¶åç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.10.1.png" alt="image-20220615234821431" tabindex="0" loading="lazy"><figcaption>image-20220615234821431</figcaption></figure><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œï¼Œç‚¹å‡»<code>æ–°å»º</code>ï¼Œåœ¨<code>é‡‡è´­å•†å“id</code>é‡Œè¾“å…¥<code>3</code>ï¼Œ<code>é‡‡è´­æ•°é‡</code>é‡Œè¾“å…¥<code>15</code>ï¼Œ<code>ä»“åº“</code>é‡Œé€‰æ‹©<code>1å·ä»“åº“</code>ï¼Œç„¶åç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.10.2.png" alt="image-20220615234903216" tabindex="0" loading="lazy"><figcaption>image-20220615234903216</figcaption></figure><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œï¼Œç‚¹å‡»<code>æ–°å»º</code>ï¼Œåœ¨<code>é‡‡è´­å•†å“id</code>é‡Œè¾“å…¥<code>4</code>ï¼Œ<code>é‡‡è´­æ•°é‡</code>é‡Œè¾“å…¥<code>5</code>ï¼Œ<code>ä»“åº“</code>é‡Œé€‰æ‹©<code>1å·ä»“åº“</code>ï¼Œç„¶åç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.10.3.png" alt="image-20220615234940017" tabindex="0" loading="lazy"><figcaption>image-20220615234940017</figcaption></figure><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œé€‰æ‹©åˆšåˆšæ–°å»ºçš„<code>é‡‡è´­å•id</code>ä¸º<code>5</code>ã€<code>6</code>ã€<code>7</code>çš„ä¸‰ä¸ªé‡‡è´­å•ï¼Œç„¶åç‚¹å‡»<code>æ‰¹é‡æ“ä½œ</code>ï¼Œåœ¨<code>æ‰¹é‡æ“ä½œ</code>é‡Œé€‰æ‹©<code>åˆå¹¶æ•´å•</code>ï¼›åœ¨<code>åˆå¹¶åˆ°æ•´å•</code>é‡Œä¸é€‰æ‹©æƒ³è¦åˆå¹¶çš„é‡‡è´­å•ï¼Œç›´æ¥ç‚¹å‡»ç¡®å®šï¼Œåœ¨å¼¹å‡ºçš„<code>æç¤º</code>å¯¹è¯æ¡†é‡Œç‚¹å‡»<code>ç¡®å®š</code></p><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­å•</code>é‡Œï¼Œç‚¹å‡»åˆšåˆšè‡ªåŠ¨åˆ›å»ºçš„<code>é‡‡è´­å•</code>çš„å³ä¾§<code>ä¿®æ”¹</code>æŒ‰é’®,åœ¨å¼¹å‡ºçš„<code>åˆå¹¶åˆ°æ•´å•</code>çš„å¯¹è¯æ¡†ä¸­çš„ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹©<code>admin</code>,ç„¶åç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.10.4.gif" alt="GIF 2022-6-15 23-51-32" tabindex="0" loading="lazy"><figcaption>GIF 2022-6-15 23-51-32</figcaption></figure><p>ä½¿ç”¨<code>Postma</code>å‘é€<code>é¢†å–é‡‡è´­å•</code>ï¼Œåœ¨<code>json</code>çš„è¾“å…¥æ¡†é‡Œè¾“å…¥åˆšåˆšè‡ªåŠ¨åˆ›å»ºçš„é‡‡è´­å•çš„idï¼š<code>[5]</code>ï¼Œç„¶åç‚¹å‡»<code>Send</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.10.5.png" alt="image-20220615235334954" tabindex="0" loading="lazy"><figcaption>image-20220615235334954</figcaption></figure><p>å¯ä»¥çœ‹åˆ°åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­å•</code>é‡Œï¼Œ<code>é‡‡è´­å•id</code>ä¸º<code>5</code>çš„çŠ¶æ€å·²ç»å˜ä¸º<code>å·²é¢†å–</code>äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.10.6.png" alt="image-20220615235441128" tabindex="0" loading="lazy"><figcaption>image-20220615235441128</figcaption></figure><p>ç‚¹å‡»<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>ï¼Œå¯ä»¥çœ‹åˆ°åˆšåˆšæ–°å»ºçš„<code>é‡‡è´­å•id</code>ä¸º<code>5</code>ã€<code>6</code>ã€<code>7</code>çš„ä¸‰ä¸ªé‡‡è´­å•çš„çŠ¶æ€å·²å…¨éƒ¨å˜ä¸º<code>æ­£åœ¨é‡‡è´­</code>äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.10.7.png" alt="image-20220615235505421" tabindex="0" loading="lazy"><figcaption>image-20220615235505421</figcaption></figure><p>ä½¿ç”¨<code>Postma</code>å‘é€<code>å®Œæˆé‡‡è´­</code>ï¼Œåœ¨<code>json</code>çš„è¾“å…¥æ¡†é‡Œè¾“å…¥ä»¥ä¸‹<code>json</code>ï¼Œç„¶åç‚¹å‡»<code>Send</code></p><p>å‘é€çš„è¯·æ±‚ä¸­<code>id</code>å¯¹åº”<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œçš„<code>id</code>ï¼Œ<code>items</code>é‡Œçš„<code>itemId</code>å¯¹åº”<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œçš„<code>é‡‡è´­å•id</code>ï¼Œå³ä¸ºå®ŒæˆæŸä¸ªé‡‡è´­å•çš„éƒ¨åˆ†æˆ–å…¨éƒ¨<code>é‡‡è´­é¡¹(é‡‡è´­éœ€æ±‚)</code></p><p>è¿™é‡Œå°†<code>é‡‡è´­å•id</code>ä¸º<code>5</code>çš„æ‰€æœ‰<code>é‡‡è´­é¡¹(é‡‡è´­éœ€æ±‚)</code>çš„çŠ¶æ€éƒ½å˜ä¸º<code>3</code>ï¼Œè¡¨ç¤ºå…¨éƒ¨é‡‡è´­æˆåŠŸ</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
   <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
   <span class="token property">&quot;items&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token punctuation">{</span><span class="token property">&quot;itemId&quot;</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token property">&quot;reason&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token punctuation">{</span><span class="token property">&quot;itemId&quot;</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token property">&quot;reason&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token punctuation">{</span><span class="token property">&quot;itemId&quot;</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token property">&quot;reason&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.10.8.png" alt="image-20220616000426342" tabindex="0" loading="lazy"><figcaption>image-20220616000426342</figcaption></figure><p>å¯ä»¥çœ‹åˆ°åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­å•</code>é‡Œï¼Œ<code>é‡‡è´­å•id</code>ä¸º<code>5</code>çš„çŠ¶æ€å·²ç»å˜ä¸º<code>å·²å®Œæˆ</code>äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.10.9.png" alt="image-20220616002409091" tabindex="0" loading="lazy"><figcaption>image-20220616002409091</figcaption></figure><p>ç‚¹å‡»<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>ï¼Œå¯ä»¥çœ‹åˆ°åˆšåˆšæ–°å»ºçš„<code>é‡‡è´­å•id</code>ä¸º<code>5</code>ã€<code>6</code>ã€<code>7</code>çš„ä¸‰ä¸ªé‡‡è´­å•çš„çŠ¶æ€å·²å…¨éƒ¨å˜ä¸º<code>å·²å®Œæˆ</code>äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.11.10.10.png" alt="image-20220616002426774" tabindex="0" loading="lazy"><figcaption>image-20220616002426774</figcaption></figure><h3 id="_4-8-12ã€è¿œç¨‹è°ƒç”¨gulimall-productæ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_4-8-12ã€è¿œç¨‹è°ƒç”¨gulimall-productæ¨¡å—" aria-hidden="true">#</a> 4.8.12ã€è¿œç¨‹è°ƒç”¨<code>gulimall-product</code>æ¨¡å—</h3><h4 id="_1ã€æŸ¥å‡ºsku-name" tabindex="-1"><a class="header-anchor" href="#_1ã€æŸ¥å‡ºsku-name" aria-hidden="true">#</a> 1ã€æŸ¥å‡º<code>sku_name</code></h4><p>æƒ³æŸ¥å‡º<code>åº“å­˜ç³»ç»Ÿ/å•†å“åº“å­˜</code>é‡Œï¼Œæ¯æ¡æ•°æ®çš„<code>sku_name</code>çš„å€¼</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.1.png" alt="image-20220618181715170" tabindex="0" loading="lazy"><figcaption>image-20220618181715170</figcaption></figure><h4 id="_2ã€æŸ¥çœ‹è¿œç¨‹æä¾›çš„æœåŠ¡æ¥å£" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹è¿œç¨‹æä¾›çš„æœåŠ¡æ¥å£" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹è¿œç¨‹æä¾›çš„æœåŠ¡æ¥å£</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.WareSkuServiceImpl</code>ç±»çš„<code>addOrUpdateStockByskuIdAndwareId</code>æ–¹æ³•é‡Œæ·»åŠ ä»£åŠäº‹é¡¹ï¼Œç¨åå®Œæˆ<code>è¿œç¨‹æŸ¥è¯¢skuçš„åå­—</code>è¿™ä¸ªåŠŸèƒ½</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.2.1.png" alt="image-20220616233031996" tabindex="0" loading="lazy"><figcaption>image-20220616233031996</figcaption></figure><p>æ­¤æ—¶æƒ³è¦è°ƒç”¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.SkuInfoController</code>ç±»çš„<code>info</code>è¿™ä¸ªæ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.2.2.png" alt="image-20220616233341069" tabindex="0" loading="lazy"><figcaption>image-20220616233341069</figcaption></figure><h4 id="_3ã€æ–°å»ºcouponfeignserviceæ¥å£" tabindex="-1"><a class="header-anchor" href="#_3ã€æ–°å»ºcouponfeignserviceæ¥å£" aria-hidden="true">#</a> 3ã€æ–°å»º<code>CouponFeignService</code>æ¥å£</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—é‡Œ<code>com.atguigu.gulimall.ware</code>åŒ…ä¸‹æ–°å»º<code>feign</code>æ–‡ä»¶å¤¹ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œæ–°å»º<code>CouponFeignService</code>æ¥å£</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.3.1.png" alt="image-20220616233614305" tabindex="0" loading="lazy"><figcaption>image-20220616233614305</figcaption></figure><p>æ·»åŠ ä¸Šä¸€äº›æ³¨é‡Š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>gulimall<span class="token punctuation">.</span>ware<span class="token punctuation">.</span>feign</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>common<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">R</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">FeignClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span>  æ— åæ°
 * <span class="token keyword">@date</span>  2022/6/16
 * @Description:
 */</span>
<span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span><span class="token string">&quot;gulimall-gateway&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ProductFeignService</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * 1)ã€è®©æ‰€æœ‰è¯·æ±‚è¿‡ç½‘å…³;
     *    1ã€@FeignClient( &quot;gulimall-gateway&quot;):ç»™gulimall-gatewayæ‰€åœ¨çš„æœºå™¨å‘è¯·æ±‚
     *    2ã€/api/product/skuinfo/info/<span class="token punctuation">{</span>skuId<span class="token punctuation">}</span>
     * 2)ã€ç›´æ¥è®©åå°æŒ‡å®šæœåŠ¡å¤„ç†
     *    1ã€@FeignClient( &quot;gulimall-gateway&quot;)
     *    2ã€/product/skuinfo/info/<span class="token punctuation">{</span>skuId<span class="token punctuation">}</span>
     * <span class="token keyword">@param</span> <span class="token parameter">skuId</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/api/product/skuinfo/info/{skuId}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">info</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;skuId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> skuId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.3.2.png" alt="image-20220616233927770" tabindex="0" loading="lazy"><figcaption>image-20220616233927770</figcaption></figure><h4 id="_4ã€ä¿®æ”¹æ·»åŠ æˆ–æ›´æ–°åº“å­˜æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€ä¿®æ”¹æ·»åŠ æˆ–æ›´æ–°åº“å­˜æ–¹æ³•" aria-hidden="true">#</a> 4ã€ä¿®æ”¹<code>æ·»åŠ æˆ–æ›´æ–°åº“å­˜</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.WareSkuServiceImpl</code>ç±»é‡Œä¿®æ”¹<code>addOrUpdateStockByskuIdAndwareId</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">ProductFeignService</span> productFeignService<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addOrUpdateStockByskuIdAndwareId</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDetailEntity</span> purchaseDetailEntity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">WareSkuEntity</span> wareSkuEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WareSkuEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    wareSkuEntity<span class="token punctuation">.</span><span class="token function">setSkuId</span><span class="token punctuation">(</span>purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getSkuId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    wareSkuEntity<span class="token punctuation">.</span><span class="token function">setWareId</span><span class="token punctuation">(</span>purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getWareId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WareSkuEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">WareSkuEntity</span><span class="token operator">::</span><span class="token function">getSkuId</span><span class="token punctuation">,</span> purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getSkuId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">WareSkuEntity</span><span class="token operator">::</span><span class="token function">getWareId</span><span class="token punctuation">,</span> purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getWareId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">WareSkuEntity</span> query <span class="token operator">=</span> wareSkuDao<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>query <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        wareSkuEntity<span class="token punctuation">.</span><span class="token function">setStockLocked</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è¿œç¨‹æŸ¥è¯¢skuçš„åå­—ï¼›å¦‚æœå¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡ä¸å›æ»š</span>
        <span class="token comment">//1ã€ è‡ªå·±catchå¼‚å¸¸</span>
        <span class="token comment">//TODO è¿˜å¯ä»¥ç”¨ä»€ä¹ˆåŠæ³•è®©å¼‚å¸¸å‡ºç°ä»¥åä¸å›æ»š?é«˜çº§</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">R</span> info <span class="token operator">=</span> productFeignService<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>wareSkuEntity<span class="token punctuation">.</span><span class="token function">getSkuId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>info<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> skuInfo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> info<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;skuInfo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                wareSkuEntity<span class="token punctuation">.</span><span class="token function">setSkuName</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> skuInfo<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;skuName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token punctuation">}</span>
        wareSkuEntity<span class="token punctuation">.</span><span class="token function">setStock</span><span class="token punctuation">(</span>purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getSkuNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        wareSkuDao<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>wareSkuEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        wareSkuEntity<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        wareSkuEntity<span class="token punctuation">.</span><span class="token function">setStock</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">getStock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getSkuNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        wareSkuDao<span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>wareSkuEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.4.png" alt="image-20220616235351460" tabindex="0" loading="lazy"><figcaption>image-20220616235351460</figcaption></figure><p>æœ€åç»è¿‡ä¼˜åŒ–ï¼Œæ”¹æˆäº†è¿™æ ·</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">ProductFeignService</span> productFeignService<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addOrUpdateStockByskuIdAndwareId</span><span class="token punctuation">(</span><span class="token class-name">PurchaseDetailEntity</span> purchaseDetailEntity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">WareSkuEntity</span> wareSkuEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WareSkuEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    wareSkuEntity<span class="token punctuation">.</span><span class="token function">setSkuId</span><span class="token punctuation">(</span>purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getSkuId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    wareSkuEntity<span class="token punctuation">.</span><span class="token function">setWareId</span><span class="token punctuation">(</span>purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getWareId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WareSkuEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">WareSkuEntity</span><span class="token operator">::</span><span class="token function">getSkuId</span><span class="token punctuation">,</span> purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getSkuId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">WareSkuEntity</span><span class="token operator">::</span><span class="token function">getWareId</span><span class="token punctuation">,</span> purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getWareId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">WareSkuEntity</span> query <span class="token operator">=</span> wareSkuDao<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token operator">==</span><span class="token keyword">null</span> <span class="token operator">||</span> query<span class="token punctuation">.</span><span class="token function">getSkuName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//è¿œç¨‹æŸ¥è¯¢skuçš„åå­—ï¼›å¦‚æœå¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡ä¸å›æ»š</span>
        <span class="token comment">//1ã€ è‡ªå·±catchå¼‚å¸¸</span>
        <span class="token comment">//TODO è¿˜å¯ä»¥ç”¨ä»€ä¹ˆåŠæ³•è®©å¼‚å¸¸å‡ºç°ä»¥åä¸å›æ»š?é«˜çº§</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">R</span> info <span class="token operator">=</span> productFeignService<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>wareSkuEntity<span class="token punctuation">.</span><span class="token function">getSkuId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>info<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> skuInfo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> info<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;skuInfo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                wareSkuEntity<span class="token punctuation">.</span><span class="token function">setSkuName</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> skuInfo<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;skuName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>query <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        wareSkuEntity<span class="token punctuation">.</span><span class="token function">setStockLocked</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        wareSkuEntity<span class="token punctuation">.</span><span class="token function">setStock</span><span class="token punctuation">(</span>purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getSkuNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        wareSkuDao<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>wareSkuEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        wareSkuEntity<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        wareSkuEntity<span class="token punctuation">.</span><span class="token function">setStock</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">getStock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> purchaseDetailEntity<span class="token punctuation">.</span><span class="token function">getSkuNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        wareSkuDao<span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>wareSkuEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5ã€è§£å†³ideaæŠ¥çº¢" tabindex="-1"><a class="header-anchor" href="#_5ã€è§£å†³ideaæŠ¥çº¢" aria-hidden="true">#</a> 5ã€è§£å†³<code>IDEA</code>æŠ¥çº¢</h4><p>å¯ä»¥çœ‹åˆ°åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.WareSkuServiceImpl</code>ç±»é‡Œæ³¨å…¥çš„<code>productFeignService</code>å¯¹è±¡æŠ¥çº¢ï¼Œè¿™ä¸ªæŠ¥çº¢å±äº<code>IDEA</code>çš„é—®é¢˜ï¼Œæ˜¯<code>IDEA</code>æ£€æµ‹åˆ°æ— æ³•æ³¨å…¥æ‰€ä»¥æŠ¥çº¢</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.5.1.png" alt="image-20220618175013156" tabindex="0" loading="lazy"><figcaption>image-20220618175013156</figcaption></figure><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.feign.ProductFeignService</code>æ¥å£ä¸Šæ·»åŠ <code>@Service</code>æ³¨è§£</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.5.2.png" alt="image-20220618175103940" tabindex="0" loading="lazy"><figcaption>image-20220618175103940</figcaption></figure><p>è¿™æ ·<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.service.impl.WareSkuServiceImpl</code>ç±»é‡Œæ³¨å…¥çš„<code>productFeignService</code>å¯¹è±¡å°±ä¸æŠ¥çº¢äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.5.3.png" alt="image-20220618224651290" tabindex="0" loading="lazy"><figcaption>image-20220618224651290</figcaption></figure><h4 id="_6ã€å¯åŠ¨gulimall-wareæ¨¡å—å¤±è´¥" tabindex="-1"><a class="header-anchor" href="#_6ã€å¯åŠ¨gulimall-wareæ¨¡å—å¤±è´¥" aria-hidden="true">#</a> 6ã€å¯åŠ¨<code>gulimall-ware</code>æ¨¡å—å¤±è´¥</h4><p>é‡å¯<code>gulimall-ware</code>æ¨¡å—æ—¶ï¼Œæ§åˆ¶å°æŠ¥é”™</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;purchaseController&#39;: Unsatisfied dependency expressed through field &#39;purchaseService&#39;; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;purchaseService&#39;: Unsatisfied dependency expressed through field &#39;wareSkuService&#39;; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;wareSkuService&#39;: Unsatisfied dependency expressed through field &#39;productFeignService&#39;; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type &#39;com.atguigu.gulimall.ware.feign.ProductFeignService&#39; available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}

ConfigServletWebServerApplicationContextï¼šä¸Šä¸‹æ–‡åˆå§‹åŒ–æœŸé—´é‡åˆ°å¼‚å¸¸ - å–æ¶ˆåˆ·æ–°å°è¯•ï¼šorg.springframework.beans.factory.UnsatisfiedDependencyExceptionï¼šåˆ›å»ºåç§°ä¸ºâ€œpurchaseControllerâ€çš„beanæ—¶å‡ºé”™ï¼šé€šè¿‡å­—æ®µâ€œpurchaseServiceâ€è¡¨ç¤ºä¸æ»¡è¶³çš„ä¾èµ–å…³ç³»ï¼›åµŒå¥—å¼‚å¸¸æ˜¯ org.springframework.beans.factory.UnsatisfiedDependencyExceptionï¼šåˆ›å»ºåç§°ä¸ºâ€œpurchaseServiceâ€çš„ bean æ—¶å‡ºé”™ï¼šé€šè¿‡å­—æ®µâ€œwareSkuServiceâ€è¡¨ç¤ºçš„ä¾èµ–å…³ç³»ä¸æ»¡è¶³ï¼›åµŒå¥—å¼‚å¸¸æ˜¯ org.springframework.beans.factory.UnsatisfiedDependencyExceptionï¼šåˆ›å»ºåä¸º &#39;wareSkuService&#39; çš„ bean æ—¶å‡ºé”™ï¼šé€šè¿‡å­—æ®µ &#39;productFeignService&#39; è¡¨è¾¾çš„ä¾èµ–å…³ç³»ä¸æ»¡è¶³ï¼›åµŒå¥—å¼‚å¸¸æ˜¯ org.springframework.beans.factory.NoSuchBeanDefinitionExceptionï¼šæ²¡æœ‰â€œcom.atguigu.gulimall.ware.feign.ProductFeignServiceâ€ç±»å‹çš„åˆæ ¼ bean å¯ç”¨ï¼šé¢„è®¡è‡³å°‘æœ‰ 1 ä¸ªæœ‰èµ„æ ¼ä½œä¸ºè‡ªåŠ¨è£…é…å€™é€‰è€…çš„ beanã€‚ä¾èµ–æ³¨è§£ï¼š{@org.springframework.beans.factory.annotation.Autowired(required=true)}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code> &#39;com.atguigu.gulimall.ware.feign.ProductFeignService&#39; that could not be found</code>è¿™å¥è¯è¯´å¾—å¾ˆæ¸…æ¥šäº†ï¼Œå°±æ˜¯<code>ProductFeignService</code>è¿™ä¸ªæ¥å£æ²¡æœ‰æ‰¾åˆ°(å‡†ç¡®çš„è¯´æ˜¯å®ƒçš„å®ç°ç±»æ²¡æœ‰æ‰¾åˆ°ï¼Œä¸èƒ½æˆåŠŸæ³¨å…¥ï¼Œ<code>Spring</code>ä¸­ä¸èƒ½æ³¨å…¥æ¥å£)</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Field productFeignService in com.atguigu.gulimall.ware.service.impl.WareSkuServiceImpl required a bean of type &#39;com.atguigu.gulimall.ware.feign.ProductFeignService&#39; that could not be found.

com.atguigu.gulimall.ware.service.impl.WareSkuServiceImpl ä¸­çš„å­—æ®µ productFeignService éœ€è¦ç±»å‹ä¸ºâ€œcom.atguigu.gulimall.ware.feign.ProductFeignServiceâ€çš„ beanã€‚ä½†æ˜¯æ²¡æœ‰æ‰¾åˆ°
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.6.png" alt="image-20220618174435966" tabindex="0" loading="lazy"><figcaption>image-20220618174435966</figcaption></figure><p>å®Œæ•´æŠ¥é”™ä¿¡æ¯</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>2022-06-18 17:43:29.843  WARN 18808 --- [           main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;purchaseController&#39;: Unsatisfied dependency expressed through field &#39;purchaseService&#39;; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;purchaseService&#39;: Unsatisfied dependency expressed through field &#39;wareSkuService&#39;; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;wareSkuService&#39;: Unsatisfied dependency expressed through field &#39;productFeignService&#39;; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type &#39;com.atguigu.gulimall.ware.feign.ProductFeignService&#39; available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
2022-06-18 17:43:29.845  INFO 18808 --- [           main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2022-06-18 17:43:29.856  INFO 18808 --- [           main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with &#39;debug&#39; enabled.
2022-06-18 17:43:29.944 ERROR 18808 --- [           main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Field productFeignService in com.atguigu.gulimall.ware.service.impl.WareSkuServiceImpl required a bean of type &#39;com.atguigu.gulimall.ware.feign.ProductFeignService&#39; that could not be found.

The injection point has the following annotations:
	- @org.springframework.beans.factory.annotation.Autowired(required=true)


Action:

Consider defining a bean of type &#39;com.atguigu.gulimall.ware.feign.ProductFeignService&#39; in your configuration.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7ã€å¼€å¯è¿œç¨‹è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#_7ã€å¼€å¯è¿œç¨‹è°ƒç”¨" aria-hidden="true">#</a> 7ã€å¼€å¯è¿œç¨‹è°ƒç”¨</h4><p>åœ¨<code>gulimall-ware</code>æ¨¡å—çš„<code>com.atguigu.gulimall.ware.GulimallWareApplication</code>å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£ï¼Œä»¥å¼€å¯è¿œç¨‹è°ƒç”¨</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableFeignClients</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">&quot;com.atguigu.gulimall.ware.feign&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.7.png" alt="image-20220618224737308" tabindex="0" loading="lazy"><figcaption>image-20220618224737308</figcaption></figure><h4 id="_8ã€é‡æ–°æµ‹è¯•-1" tabindex="-1"><a class="header-anchor" href="#_8ã€é‡æ–°æµ‹è¯•-1" aria-hidden="true">#</a> 8ã€é‡æ–°æµ‹è¯•</h4><p>é‡å¯<code>gulimall-ware</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢</p><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­éœ€æ±‚</code>é‡Œï¼Œç‚¹å‡»<code>æ–°å»º</code>ï¼Œåœ¨<code>é‡‡è´­å•†å“id</code>é‡Œè¾“å…¥<code>7</code>ï¼Œ<code>é‡‡è´­æ•°é‡</code>é‡Œè¾“å…¥<code>7</code>ï¼Œ<code>ä»“åº“</code>é‡Œé€‰æ‹©<code>1å·ä»“åº“</code>ï¼Œç„¶åç‚¹å‡»ç¡®å®šï¼Œ</p><p>é€‰ä¸­åˆšåˆšæ–°å»ºçš„<code>id</code>ä¸º<code>8</code>çš„é‡‡è´­éœ€æ±‚æŒ‰é’®ï¼Œç„¶åç‚¹å‡»<code>æ‰¹é‡æ“ä½œ</code>ï¼Œåœ¨<code>æ‰¹é‡æ“ä½œ</code>é‡Œé€‰æ‹©<code>åˆå¹¶æ•´å•</code>ï¼›åœ¨<code>åˆå¹¶åˆ°æ•´å•</code>é‡Œä¸é€‰æ‹©æƒ³è¦åˆå¹¶çš„é‡‡è´­å•ï¼Œç›´æ¥ç‚¹å‡»ç¡®å®šï¼Œåœ¨å¼¹å‡ºçš„<code>æç¤º</code>å¯¹è¯æ¡†é‡Œç‚¹å‡»<code>ç¡®å®š</code></p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.8.1.gif" alt="GIF 2022-6-18 22-03-49" tabindex="0" loading="lazy"><figcaption>GIF 2022-6-18 22-03-49</figcaption></figure><p>åœ¨<code>åº“å­˜ç³»ç»Ÿ/é‡‡è´­å•ç»´æŠ¤/é‡‡è´­å•</code>é‡Œï¼Œç‚¹å‡»åˆšåˆšè‡ªåŠ¨åˆ›å»ºçš„<code>é‡‡è´­å•</code>çš„å³ä¾§<code>åˆ†é…</code>æŒ‰é’®,åœ¨å¼¹å‡ºçš„<code>åˆ†é…é‡‡è´­äººå‘˜</code>çš„å¯¹è¯æ¡†ä¸­çš„ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹©<code>admin</code>,ç„¶åç‚¹å‡»ç¡®å®š</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.8.2.gif" alt="GIF 2022-6-18 22-05-31" tabindex="0" loading="lazy"><figcaption>GIF 2022-6-18 22-05-31</figcaption></figure><p>æ‰“å¼€<code>Postman</code>ï¼Œåœ¨<code>é¢†å–é‡‡è´­å•</code>çš„<code>json</code>è¾“å…¥æ¡†é‡Œè¾“å…¥<code>[6]</code>ï¼Œç‚¹å‡»<code>Send</code></p><p>åœ¨<code>å®Œæˆé‡‡è´­</code>çš„<code>json</code>è¾“å…¥æ¡†é‡Œè¾“å…¥å¦‚ä¸‹<code>json</code>ï¼Œç‚¹å‡»<code>Send</code></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
   <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
   <span class="token property">&quot;items&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token punctuation">{</span><span class="token property">&quot;itemId&quot;</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token property">&quot;reason&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.8.3.png" alt="GIF 2022-6-18 22-06-55" tabindex="0" loading="lazy"><figcaption>GIF 2022-6-18 22-06-55</figcaption></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶å¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸæ’å…¥<code>sku_name</code>å­—æ®µäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.8.12.8.4.png" alt="image-20220618224951824" tabindex="0" loading="lazy"><figcaption>image-20220618224951824</figcaption></figure><h2 id="_4-9ã€å•†å“æœåŠ¡-api-å•†å“ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_4-9ã€å•†å“æœåŠ¡-api-å•†å“ç®¡ç†" aria-hidden="true">#</a> 4.9ã€å•†å“æœåŠ¡-API-å•†å“ç®¡ç†</h2><h4 id="_1ã€æ— æ³•è®¿é—®" tabindex="-1"><a class="header-anchor" href="#_1ã€æ— æ³•è®¿é—®" aria-hidden="true">#</a> 1ã€æ— æ³•è®¿é—®</h4><p>ç‚¹å‡»<code>å•†å“ç³»ç»Ÿ/å•†å“ç»´æŠ¤/spuç®¡ç†</code>ï¼Œéšä¾¿ç‚¹å‡»ä¸€æ¡æ•°æ®çš„å³è¾¹çš„<code>è§„æ ¼</code>æŒ‰é’®ï¼Œå¯ä»¥çœ‹åˆ°æŠ¥äº†<code>400</code>çš„å¼‚å¸¸</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.1.1.gif" alt="GIF 2022-6-18 22-57-00" tabindex="0" loading="lazy"><figcaption>GIF 2022-6-18 22-57-00</figcaption></figure><p>å¯ä»¥åœ¨é€‰ä¸­<code>gulimall_admin</code>æ•°æ®åº“ï¼Œå³é”®é€‰æ‹©<code>æ–°å»ºæŸ¥è¯¢</code>ï¼Œè¾“å…¥ä»¥ä¸‹<code>sql</code>ï¼Œæ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªè·¯ç”±çš„è·¯å¾„</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>INSERT INTO sys_menu (menu_id, parent_id, name, url, perms, type, icon, order_num) VALUES (76, 37, &#39;è§„æ ¼ç»´æŠ¤&#39;, &#39;product/attrupdate&#39;, &#39;&#39;, 2, &#39;log&#39;, 0);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.1.2.gif" alt="GIF 2022-6-18 22-59-57" tabindex="0" loading="lazy"><figcaption>GIF 2022-6-18 22-59-57</figcaption></figure><p>ç‚¹å‡»<code>å•†å“ç³»ç»Ÿ/å•†å“ç»´æŠ¤/spuç®¡ç†</code>ï¼Œå†éšä¾¿ç‚¹å‡»ä¸€æ¡æ•°æ®çš„å³è¾¹çš„<code>è§„æ ¼</code>æŒ‰é’®ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»å¯ä»¥æ­£å¸¸æ˜¾ç¤ºå‡ºæ¥<code>è§„æ ¼ç»´æŠ¤</code>äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.1.3.png" alt="GIF 2022-6-18 23-01-32" tabindex="0" loading="lazy"><figcaption>GIF 2022-6-18 23-01-32</figcaption></figure><p>å¦‚æœè¿˜æ˜¯æ— æ³•è®¿é—®ï¼Œå¯ä»¥åœ¨<code>navicat</code>é‡Œé€‰æ‹©<code>gulimall_admin</code>æ•°æ®åº“ä¸­çš„<code>sys_menu</code>è¡¨ï¼Œåœ¨é‡Œé¢æŠŠåˆšåˆšæ’å…¥<code>name</code>ä¸ºè§„æ ¼ç»´æŠ¤çš„é‚£æ¡æ•°æ®çš„<code>type</code>æŠŠ<code>2</code>æ”¹æˆ<code>1</code>å°±å¯ä»¥äº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.1.4.png" alt="image-20220618232306790" tabindex="0" loading="lazy"><figcaption>image-20220618232306790</figcaption></figure><p>å¦‚æœè¿˜æ˜¯æ— æ³•è®¿é—®ï¼Œå¯ä»¥æ‰“å¼€<code>VS Code</code>ï¼Œåœ¨<code>src\\router\\index.js</code>æ–‡ä»¶é‡Œçš„<code>mainRoutes</code>é‡Œçš„<code>children</code>é‡Œæ·»åŠ ä¸€æ¡è·¯å¾„</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span> path<span class="token operator">:</span> &#39;/product-attrupdate&#39;<span class="token punctuation">,</span> component<span class="token operator">:</span> _import(&#39;modules/product/attrupdate&#39;)<span class="token punctuation">,</span> name<span class="token operator">:</span> &#39;attr-update&#39;<span class="token punctuation">,</span> meta<span class="token operator">:</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> &#39;è§„æ ¼ç»´æŠ¤&#39;<span class="token punctuation">,</span> isTab<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.1.5.png" alt="image-20220618232119164" tabindex="0" loading="lazy"><figcaption>image-20220618232119164</figcaption></figure><h4 id="_2ã€æŸ¥çœ‹æ¥å£" tabindex="-1"><a class="header-anchor" href="#_2ã€æŸ¥çœ‹æ¥å£" aria-hidden="true">#</a> 2ã€æŸ¥çœ‹æ¥å£</h4><p>æ¥å£æ–‡æ¡£åœ¨<code>å•†å“ç³»ç»Ÿ/22ã€è·å–spuè§„æ ¼</code>é‡Œï¼šhttps://easydoc.net/s/78237135/ZUqEdvA4/GhhJhkg7</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.2.png" alt="image-20220616235801916" tabindex="0" loading="lazy"><figcaption>image-20220616235801916</figcaption></figure><h4 id="_3ã€æ·»åŠ baseattrlistforspuæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ baseattrlistforspuæ–¹æ³•" aria-hidden="true">#</a> 3ã€æ·»åŠ <code>baseAttrlistforspu</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.AttrController</code>ç±»é‡Œæ·»åŠ <code>baseAttrlistforspu</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * /product/attr/base/listforspu/<span class="token punctuation">{</span>spuId<span class="token punctuation">}</span>
 * <span class="token keyword">@param</span> <span class="token parameter">spuId</span>
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/base/listforspu/{spuId}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">baseAttrlistforspu</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;spuId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> spuId<span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductAttrValueEntity</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> productAttrValueService<span class="token punctuation">.</span><span class="token function">baseAttrlistforspu</span><span class="token punctuation">(</span>spuId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.3.png" alt="image-20220618234506140" tabindex="0" loading="lazy"><figcaption>image-20220618234506140</figcaption></figure><h4 id="_4ã€æ·»åŠ baseattrlistforspuæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€æ·»åŠ baseattrlistforspuæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 4ã€æ·»åŠ <code>baseAttrlistforspu</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.ProductAttrValueService</code>ç±»é‡Œæ·»åŠ <code>baseAttrlistforspu</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductAttrValueEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">baseAttrlistforspu</span><span class="token punctuation">(</span><span class="token class-name">Long</span> spuId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.4.png" alt="image-20220618233809045" tabindex="0" loading="lazy"><figcaption>image-20220618233809045</figcaption></figure><h4 id="_5ã€å®ç°baseattrlistforspuæŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€å®ç°baseattrlistforspuæŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 5ã€å®ç°<code>baseAttrlistforspu</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.ProductAttrValueServiceImpl</code>ç±»é‡Œå®ç°æœªå®ç°çš„<code>baseAttrlistforspu</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductAttrValueEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">baseAttrlistforspu</span><span class="token punctuation">(</span><span class="token class-name">Long</span> spuId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductAttrValueEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">ProductAttrValueEntity</span><span class="token operator">::</span><span class="token function">getSpuId</span><span class="token punctuation">,</span>spuId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>baseMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span>lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.5.png" alt="image-20220618234037898" tabindex="0" loading="lazy"><figcaption>image-20220618234037898</figcaption></figure><h4 id="_6ã€æ— æ³•å›æ˜¾æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_6ã€æ— æ³•å›æ˜¾æ•°æ®" aria-hidden="true">#</a> 6ã€æ— æ³•å›æ˜¾æ•°æ®</h4><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œå¦‚æœå‰ç«¯æ— æ³•å›æ˜¾æ•°æ®ï¼Œå¯ä»¥ä¿®æ”¹<code>src\\views\\modules\\product\\spuinfo.vue</code>é‡Œçš„<code>attrUpdateShow</code>æ–¹æ³•çš„åä¸º<code>query</code>çš„<code>catalogId</code>ä¸º<code>row.catalogId</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">attrUpdateShow</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&quot;/product-attrupdate&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">spuId</span><span class="token operator">:</span> row<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token literal-property property">catalogId</span><span class="token operator">:</span> row<span class="token punctuation">.</span>catalogId <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>æ•°æ®åº“ä¸­ ä¸å•†å“spu skuæœ‰å…³çš„ä¸¤å¼ è¡¨ pms_spu_info å’Œ pms_sku_infoä¸­å…³äºå•†å“åˆ†ç±»çš„å­—æ®µcatelog_idåœ¨å»ºè¡¨æ—¶éƒ½æ‰“æˆäº†catalog_idï¼Œå¦‚æœè¦çŸ«æ­£é‚£ä¹ˆé™¤äº†ä¿®æ”¹æ•°æ®åº“ï¼Œå¯¹åº”ç”±å·¥å…·ç”Ÿæˆçš„å®ä½“ç±»Entityï¼Œcontroller,serviceå’Œmapperä¸­çš„å­—æ®µé…ç½®éƒ½è¦æ”¹ã€‚æ­¤å¤–ï¼Œè¡¨çš„catelog_idæ²¡æœ‰é”™è¯¯ã€‚ç‚¹å‡»â€œè§„æ ¼â€æŠ¥404æ˜¯å› ä¸ºåœ¨è§„æ ¼ç‚¹å‡»åï¼Œå‰ç«¯ä¸ä¼šåšè·¯ç”±è·³è½¬ï¼Œéœ€è¦å‚ç…§è¯„è®ºå›å¤ä¸­çš„å°ä¼™ä¼´çš„æ–¹æ³•åœ¨å‰ç«¯src/router/index.jsä¸­æ·»åŠ å¯¹åº”é…ç½®(ä½ ä»¬æ‰¾ä¸€æ‰¾æŠŠ)ã€‚è¿™ä¸ªâ€œspuç®¡ç†â€ç•Œé¢å¯¹åº”vueçš„spuinfo.vueï¼Œä»–åœ¨è·³è½¬æ—¶ä¼šæŠŠé€‰ä¸­è¡Œçš„idå’Œåˆ†ç±»idéƒ½å°è£…è¿›å»åšè·³è½¬ï¼Œæ‰¿æ¥å¼€å¤´ï¼Œæ‰¾åˆ°spuinfo.vueçš„101è¡Œï¼ŒæŠŠ ã€query: {spuId: row.id, catelogId: row.catelogId}ã€‘ä¸­çš„row.catelogIdæ”¹æˆrow.catalogIdå³å¯ï¼Œå› ä¸ºæ˜¯ä»pms_spu_infoè¡¨ä¸­æ¥çš„catalog_idå­—æ®µå»å’Œpms_attr_groupä¸­æ¬§å† çš„catelog_idå­—æ®µåšé€»è¾‘ä¸Šçš„å…³è”æŸ¥è¯¢çš„ã€‚å­—æ®µä¸å¯¹åº”æŸ¥ä¸å‡ºç»“æœå°±åªå‰©ä¸‹ä¸€ä¸ªç¡®è®¤ä¿®æ”¹ï¼Œå…¶ä»–ç»„ä»¶ä¹Ÿä¸ä¼šæ¸²æŸ“å‡ºæ¥ã€‚</p></blockquote><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.6.1.png" alt="image-20220618235131788" tabindex="0" loading="lazy"><figcaption>image-20220618235131788</figcaption></figure><p>å¦‚æœé‡åˆ°å¤šé€‰æ— æ³•å›æ˜¾é—®é¢˜å¯ä»¥åœ¨<code>src\\views\\modules\\product\\attrupdate.vue</code>æ–‡ä»¶çš„<code>showBaseAttrs</code>æ–¹æ³•é‡ŒåŠ ä¸€ä¸ªåˆ¤æ–­</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> attr<span class="token punctuation">.</span>valueType <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          v <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦å¤–å½“å±æ€§åˆ†ç»„ä¸­ï¼Œæœ‰çš„åˆ†ç»„æ²¡æœ‰ä»»ä½•å±æ€§æ—¶å€™ï¼Œä¹Ÿä¼šæŠ¥Cannot read property &#39;forEach&#39; of nullã€‚ å› ä¸ºè¯¥åˆ†ç»„çš„attrsä¼šæŸ¥å‡ºnullå€¼ã€‚</p><p>å¯ä»¥ä¿®æ”¹ä¸ºä»¥ä¸‹ä»£ç </p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//å…ˆå¯¹è¡¨å•çš„baseAttrsè¿›è¡Œåˆå§‹åŒ–</span>
data<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> attrArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>attrs <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    item<span class="token punctuation">.</span>attrs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">attr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>_this<span class="token punctuation">.</span>spuAttrsMap<span class="token punctuation">[</span><span class="token string">&quot;&quot;</span> <span class="token operator">+</span> attr<span class="token punctuation">.</span>attrId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        v <span class="token operator">=</span> _this<span class="token punctuation">.</span>spuAttrsMap<span class="token punctuation">[</span><span class="token string">&quot;&quot;</span> <span class="token operator">+</span> attr<span class="token punctuation">.</span>attrId<span class="token punctuation">]</span><span class="token punctuation">.</span>attrValue<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> attr<span class="token punctuation">.</span>valueType <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          v <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      attrArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">attrId</span><span class="token operator">:</span> attr<span class="token punctuation">.</span>attrId<span class="token punctuation">,</span>
        <span class="token literal-property property">attrName</span><span class="token operator">:</span> attr<span class="token punctuation">.</span>attrName<span class="token punctuation">,</span>
        <span class="token literal-property property">attrValues</span><span class="token operator">:</span> v<span class="token punctuation">,</span>
        <span class="token literal-property property">showDesc</span><span class="token operator">:</span> _this<span class="token punctuation">.</span>spuAttrsMap<span class="token punctuation">[</span><span class="token string">&quot;&quot;</span> <span class="token operator">+</span> attr<span class="token punctuation">.</span>attrId<span class="token punctuation">]</span>
          <span class="token operator">?</span> _this<span class="token punctuation">.</span>spuAttrsMap<span class="token punctuation">[</span><span class="token string">&quot;&quot;</span> <span class="token operator">+</span> attr<span class="token punctuation">.</span>attrId<span class="token punctuation">]</span><span class="token punctuation">.</span>quickShow
          <span class="token operator">:</span> attr<span class="token punctuation">.</span>showDesc<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dataResp<span class="token punctuation">.</span>baseAttrs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>attrArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>dataResp<span class="token punctuation">.</span>attrGroups <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.6.2.png" alt="image-20220619000414268" tabindex="0" loading="lazy"><figcaption>image-20220619000414268</figcaption></figure><h4 id="_7ã€æŸ¥çœ‹æ¥å£" tabindex="-1"><a class="header-anchor" href="#_7ã€æŸ¥çœ‹æ¥å£" aria-hidden="true">#</a> 7ã€æŸ¥çœ‹æ¥å£</h4><p>ç‚¹å‡»<code>å•†å“ç³»ç»Ÿ/å•†å“ç»´æŠ¤/spuç®¡ç†</code>ï¼Œéšä¾¿ç‚¹å‡»ä¸€æ¡æ•°æ®çš„å³è¾¹çš„<code>è§„æ ¼</code>æŒ‰é’®ï¼Œå…ˆæ‰“å¼€æ§åˆ¶å°ï¼Œç‚¹å‡»<code>Network</code>ï¼Œæ¸…ç©ºæ•°æ®ï¼Œç„¶åç‚¹å‡»<code>ç¡®è®¤ä¿®æ”¹</code>æŸ¥çœ‹æ¥å£ä¸ºï¼š http://localhost:88/api/product/attr/update/1</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.7.1.png" alt="image-20220619001237932" tabindex="0" loading="lazy"><figcaption>image-20220619001237932</figcaption></figure><p>æ¥å£æ–‡æ¡£åœ¨<code>å•†å“ç³»ç»Ÿ/23ã€ä¿®æ”¹å•†å“è§„æ ¼</code>é‡Œï¼š https://easydoc.net/s/78237135/ZUqEdvA4/GhnJ0L85</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.7.2.png" alt="image-20220619083101912" tabindex="0" loading="lazy"><figcaption>image-20220619083101912</figcaption></figure><h4 id="_8ã€æ–°å»ºupdatespuattræ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_8ã€æ–°å»ºupdatespuattræ–¹æ³•" aria-hidden="true">#</a> 8ã€æ–°å»º<code>updateSpuAttr</code>æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.AttrController</code>ç±»é‡Œæ–°å»º<code>updateSpuAttr</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ ¹æ®spuidä¿®æ”¹è§„æ ¼å‚æ•°
 */</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/update/{spuId}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">updateSpuAttr</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;spuId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> spuId<span class="token punctuation">,</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductAttrValueEntity</span><span class="token punctuation">&gt;</span></span> productAttrValueEntities<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    productAttrValueService<span class="token punctuation">.</span><span class="token function">updateSpuAttr</span><span class="token punctuation">(</span>spuId<span class="token punctuation">,</span>productAttrValueEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.8.png" alt="image-20220619083218353" tabindex="0" loading="lazy"><figcaption>image-20220619083218353</figcaption></figure><h4 id="_9ã€æ–°å»ºupdatespuattræŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_9ã€æ–°å»ºupdatespuattræŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 9ã€æ–°å»º<code>updateSpuAttr</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.ProductAttrValueService</code>æ¥å£é‡Œæ–°å»º<code>updateSpuAttr</code>æŠ½è±¡æ–¹æ³•</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.9.png" alt="image-20220619083256215" tabindex="0" loading="lazy"><figcaption>image-20220619083256215</figcaption></figure><h4 id="_10ã€å®ç°updatespuattræŠ½è±¡æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_10ã€å®ç°updatespuattræŠ½è±¡æ–¹æ³•" aria-hidden="true">#</a> 10ã€å®ç°<code>updateSpuAttr</code>æŠ½è±¡æ–¹æ³•</h4><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.service.impl.ProductAttrValueServiceImpl</code>ç±»é‡Œå®ç°æœªå®ç°çš„<code>updateSpuAttr</code>æŠ½è±¡æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateSpuAttr</span><span class="token punctuation">(</span><span class="token class-name">Long</span> spuId<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductAttrValueEntity</span><span class="token punctuation">&gt;</span></span> productAttrValueEntities<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductAttrValueEntity</span><span class="token punctuation">&gt;</span></span> lambdaQueryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lambdaQueryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">ProductAttrValueEntity</span><span class="token operator">::</span><span class="token function">getSpuId</span><span class="token punctuation">,</span>spuId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>baseMapper<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>lambdaQueryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductAttrValueEntity</span><span class="token punctuation">&gt;</span></span> collect <span class="token operator">=</span> productAttrValueEntities<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>productAttrValueEntity <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        productAttrValueEntity<span class="token punctuation">.</span><span class="token function">setSpuId</span><span class="token punctuation">(</span>spuId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> productAttrValueEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">saveBatch</span><span class="token punctuation">(</span>collect<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.10.png" alt="image-20220619084026551" tabindex="0" loading="lazy"><figcaption>image-20220619084026551</figcaption></figure><h4 id="_11ã€æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_11ã€æµ‹è¯•" aria-hidden="true">#</a> 11ã€æµ‹è¯•</h4><p>é€‰æ‹©<code>å•†å“ç³»ç»Ÿ/å•†å“ç»´æŠ¤/spuç®¡ç†</code>ï¼Œç‚¹å‡»<code>id</code>ä¸º<code>1</code>çš„é‚£æ¡æ•°æ®çš„å³è¾¹çš„<code>è§„æ ¼</code>æŒ‰é’®ï¼Œå°†<code>åŸºæœ¬ä¿¡æ¯</code>ä¸­çš„<code>æœºèº«é¢œè‰²</code>ä¿®æ”¹ä¸º<code>é»‘è‰²</code>ï¼Œç„¶åç‚¹å‡»ç¡®è®¤ä¿®æ”¹ï¼Œåœ¨å¼¹å‡ºçš„<code>æç¤º</code>å¯¹è¯æ¡†ä¸­ç‚¹å‡»<code>ç¡®å®š</code>,å†æ¬¡ä»<code>spuç®¡ç†</code>é‡Œè¿›å…¥è¯¥é¡µé¢ï¼Œå¯ä»¥å‘ç°å¹¶æ²¡æœ‰ä¿®æ”¹æˆåŠŸ</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.11.1.gif" alt="GIF 2022-6-19 8-48-41" tabindex="0" loading="lazy"><figcaption>GIF 2022-6-19 8-48-41</figcaption></figure><p>æŸ¥çœ‹<code>GulimallProductApplication</code>æ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æŠ¥é”™äº†</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>No primary or default constructor found for interface java.util.List
æœªæ‰¾åˆ°æ¥å£ java.util.List çš„ä¸»æ„é€ å‡½æ•°æˆ–é»˜è®¤æ„é€ å‡½æ•°
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.11.2.png" alt="image-20220619085027587" tabindex="0" loading="lazy"><figcaption>image-20220619085027587</figcaption></figure><p>åœ¨<code>gulimall-product</code>æ¨¡å—çš„<code>com.atguigu.gulimall.product.controller.AttrController</code>ç±»çš„<code>updateSpuAttr</code>æ–¹æ³•çš„<code>List&lt;ProductAttrValueEntity&gt; productAttrValueEntities</code>è¿™ä¸ªå‚æ•°å·¦è¾¹æ·»åŠ <code>@RequestBody</code>æ³¨è§£ï¼ŒæŒ‡æ˜è¯¥æ•°æ®åœ¨è¯·æ±‚ä½“é‡Œé¢</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.11.3.png" alt="image-20220619085149599" tabindex="0" loading="lazy"><figcaption>image-20220619085149599</figcaption></figure><p>é‡å¯<code>gulimall-product</code>æ¨¡å—ï¼Œåˆ·æ–°å‰ç«¯é¡µé¢</p><p>å†æ¬¡é€‰æ‹©<code>å•†å“ç³»ç»Ÿ/å•†å“ç»´æŠ¤/spuç®¡ç†</code>ï¼Œç‚¹å‡»<code>id</code>ä¸º<code>1</code>çš„é‚£æ¡æ•°æ®çš„å³è¾¹çš„<code>è§„æ ¼</code>æŒ‰é’®ï¼Œå°†<code>åŸºæœ¬ä¿¡æ¯</code>ä¸­çš„<code>æœºèº«é¢œè‰²</code>ä¿®æ”¹ä¸º<code>é»‘è‰²</code>ï¼Œç„¶åç‚¹å‡»ç¡®è®¤ä¿®æ”¹ï¼Œåœ¨å¼¹å‡ºçš„<code>æç¤º</code>å¯¹è¯æ¡†ä¸­ç‚¹å‡»<code>ç¡®å®š</code>,å†æ¬¡ä»<code>spuç®¡ç†</code>é‡Œè¿›å…¥è¯¥é¡µé¢ï¼Œå¯ä»¥å‘ç°å·²ç»ä¿®æ”¹æˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.11.4.gif" alt="GIF 2022-6-19 8-52-52" tabindex="0" loading="lazy"><figcaption>GIF 2022-6-19 8-52-52</figcaption></figure><h2 id="_4-10ã€åˆ†å¸ƒå¼åŸºç¡€ç¯‡æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#_4-10ã€åˆ†å¸ƒå¼åŸºç¡€ç¯‡æ€»ç»“" aria-hidden="true">#</a> 4.10ã€åˆ†å¸ƒå¼åŸºç¡€ç¯‡æ€»ç»“</h2><p><strong>1</strong>ã€åˆ†å¸ƒå¼åŸºç¡€æ¦‚å¿µ</p><p>â€¢å¾®æœåŠ¡ã€æ³¨å†Œä¸­å¿ƒã€é…ç½®ä¸­å¿ƒã€è¿œç¨‹è°ƒç”¨ã€Feignã€ç½‘å…³</p><p><strong>2</strong>ã€åŸºç¡€å¼€å‘</p><p>å†æ¬¡é€‰æ‹©<code>å•†å“ç³»ç»Ÿ/å•†å“ç»´æŠ¤/spuç®¡ç†</code>ï¼Œç‚¹å‡»<code>id</code>ä¸º<code>1</code>çš„é‚£æ¡æ•°æ®çš„å³è¾¹çš„<code>è§„æ ¼</code>æŒ‰é’®ï¼Œå°†<code>åŸºæœ¬ä¿¡æ¯</code>ä¸­çš„<code>æœºèº«é¢œè‰²</code>ä¿®æ”¹ä¸º<code>é»‘è‰²</code>ï¼Œç„¶åç‚¹å‡»ç¡®è®¤ä¿®æ”¹ï¼Œåœ¨å¼¹å‡ºçš„<code>æç¤º</code>å¯¹è¯æ¡†ä¸­ç‚¹å‡»<code>ç¡®å®š</code>,å†æ¬¡ä»<code>spuç®¡ç†</code>é‡Œè¿›å…¥è¯¥é¡µé¢ï¼Œå¯ä»¥å‘ç°å·²ç»ä¿®æ”¹æˆåŠŸäº†</p><figure><img src="https://gitlab.com/apzs/image/-/raw/master/image/4.9.11.4.gif" alt="GIF 2022-6-19 8-52-52" tabindex="0" loading="lazy"><figcaption>GIF 2022-6-19 8-52-52</figcaption></figure><h2 id="_4-10ã€åˆ†å¸ƒå¼åŸºç¡€ç¯‡æ€»ç»“-1" tabindex="-1"><a class="header-anchor" href="#_4-10ã€åˆ†å¸ƒå¼åŸºç¡€ç¯‡æ€»ç»“-1" aria-hidden="true">#</a> 4.10ã€åˆ†å¸ƒå¼åŸºç¡€ç¯‡æ€»ç»“</h2><p><strong>1</strong>ã€åˆ†å¸ƒå¼åŸºç¡€æ¦‚å¿µ</p><p>â€¢å¾®æœåŠ¡ã€æ³¨å†Œä¸­å¿ƒã€é…ç½®ä¸­å¿ƒã€è¿œç¨‹è°ƒç”¨ã€Feignã€ç½‘å…³</p><p><strong>2</strong>ã€åŸºç¡€å¼€å‘</p><p>â€¢SpringBoot2.0ã€SpringCloudã€Mybatis-Plusã€Vueç»„ä»¶åŒ–ã€é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨</p><p><strong>3</strong>ã€ç¯å¢ƒ</p><p>â€¢Vagrantã€Linuxã€Dockerã€MySQLã€Redisã€é€†å‘å·¥ç¨‹&amp;äººäººå¼€æº</p><p><strong>4</strong>ã€å¼€å‘è§„èŒƒ</p><p>â€¢æ•°æ®æ ¡éªŒJSR303ã€å…¨å±€å¼‚å¸¸å¤„ç†ã€å…¨å±€ç»Ÿä¸€è¿”å›ã€å…¨å±€è·¨åŸŸå¤„ç†</p><p>â€¢æšä¸¾çŠ¶æ€ã€ä¸šåŠ¡çŠ¶æ€ç ã€VOä¸TOä¸POåˆ’åˆ†ã€é€»è¾‘åˆ é™¤</p><p>â€¢Lombokï¼š@Dataã€@Slf4j</p>`,1520);function Ya(an,nn){const s=o("ExternalLinkIcon");return c(),i("div",null,[u,a("blockquote",null,[a("p",null,[n("Spring Boot ä¸­å¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜:"),a("a",r,[n("å‚è€ƒé“¾æ¥"),t(s)]),n(" ?")]),d]),k,a("p",null,[n("åœ¨"),m,n("æ–‡ä»¶å†…ä½¿ç”¨element-uiä¸­çš„Tree æ ‘å½¢ç»„ä»¶ => "),a("a",g,[n("ç»„ä»¶ | Element"),t(s)])]),v,a("p",null,[n("ä»¥ä¸‹ä»£ç ä¸ºæ¨¡æ¿ "),a("a",b,[n("ç»„ä»¶ | Element"),t(s)])]),h,a("p",null,[n("å‚è€ƒæ–‡æ¡£: "),a("a",f,[n("ç»„ä»¶ | Element"),t(s)])]),y,a("p",null,[n("å‚è€ƒ"),w,n("çš„"),x,n("é‡Œçš„"),_,n("ï¼š"),a("a",z,[n("ç»„ä»¶ | Element"),t(s)])]),q,a("p",null,[n("å‚è€ƒ"),S,n("çš„"),I,n("é‡Œçš„"),E,n("ä¸­çš„"),j,n("ï¼š"),a("a",A,[n("ç»„ä»¶ | Element"),t(s)])]),P,a("p",null,[n("å‚è€ƒ"),R,n("çš„"),C,n("é‡Œ"),D,n(":"),a("a",B,[n("ç»„ä»¶ | Element"),t(s)])]),T,a("p",null,[n("å‚è€ƒ"),L,n("çš„"),G,n("é‡Œçš„"),M,n("ï¼š"),a("a",O,[n("ç»„ä»¶ | Element"),t(s)])]),N,a("table",null,[V,a("tbody",null,[F,U,a("tr",null,[W,Q,a("td",H,[n("åœ°åŸŸè¡¨ç¤º OSS çš„æ•°æ®ä¸­å¿ƒæ‰€åœ¨ç‰©ç†ä½ç½®ã€‚æ‚¨å¯ä»¥æ ¹æ®è´¹ç”¨ã€è¯·æ±‚æ¥æºç­‰ç»¼åˆé€‰æ‹©æ•°æ®å­˜å‚¨çš„åœ°åŸŸã€‚è¯¦æƒ…è¯·æŸ¥çœ‹"),a("a",$,[n("OSSå·²ç»å¼€é€šçš„Region"),t(s)]),n("ã€‚")])]),a("tr",null,[K,X,a("td",J,[n("Endpoint è¡¨ç¤ºOSSå¯¹å¤–æœåŠ¡çš„è®¿é—®åŸŸåã€‚OSSä»¥HTTP RESTful APIçš„å½¢å¼å¯¹å¤–æä¾›æœåŠ¡ï¼Œå½“è®¿é—®ä¸åŒåœ°åŸŸçš„æ—¶å€™ï¼Œéœ€è¦ä¸åŒçš„åŸŸåã€‚é€šè¿‡å†…ç½‘å’Œå¤–ç½‘è®¿é—®åŒä¸€ä¸ªåœ°åŸŸæ‰€éœ€è¦çš„åŸŸåä¹Ÿæ˜¯ä¸åŒçš„ã€‚å…·ä½“çš„å†…å®¹è¯·å‚è§"),a("a",Z,[n("å„ä¸ªRegionå¯¹åº”çš„Endpoint"),t(s)]),n("ã€‚")])]),Y])]),aa,a("p",null,[n("å‚è€ƒæ–‡æ¡£ï¼š"),a("a",na,[n("aliyun-spring-boot/README-zh.md at master Â· alibaba/aliyun-spring-boot (github.com)"),t(s)])]),sa,a("p",null,[n("ä¾èµ–æ–‡ä»¶: "),a("a",ta,[n("Central Repository: org/springframework/boot/spring-boot-parent/2.2.1.RELEASE (maven.org)"),t(s)])]),ea,a("p",null,[pa,n("ä¸­"),oa,n("ç»„ä»¶ï¼š"),a("a",ca,[n("ç»„ä»¶ | Element"),t(s)])]),ia,a("p",null,[la,n("è‡ªå®šä¹‰åˆ—æ¨¡æ¿ï¼š"),a("a",ua,[n("ç»„ä»¶ | Element"),t(s)])]),ra,a("p",null,[da,n("é‡Œçš„åŸºç¡€ç”¨æ³•ä¸­çš„containï¼š"),a("a",ka,[n("ç»„ä»¶ | Element"),t(s)])]),ma,a("p",null,[ga,n("ç»„ä»¶ï¼š"),a("a",va,[n("ç»„ä»¶ | Element"),t(s)])]),ba,a("p",null,[ha,n("ä¸­çš„è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™ï¼š"),a("a",fa,[n("ç»„ä»¶ | Element"),t(s)])]),ya,a("p",null,[wa,n("é‡Œé¢çš„"),xa,n("ä¸‹çš„"),_a,n(": "),a("a",za,[n("ç»„ä»¶ | Element"),t(s)])]),qa,a("p",null,[Sa,n("ä¸­çš„"),Ia,n(": "),a("a",Ea,[n("ç»„ä»¶ | Element"),t(s)])]),ja,a("p",null,[Aa,n("ä¸­"),Pa,n("ä¸­çš„äº‹ä»¶ï¼š"),a("a",Ra,[n("ç»„ä»¶ | Element"),t(s)])]),Ca,a("p",null,[Da,n("çš„"),Ba,n("é‡Œé¢çš„"),Ta,n("ï¼š"),a("a",La,[n("ç»„ä»¶ | Element"),t(s)])]),Ga,a("p",null,[n("æ¥å£æ–‡æ¡£ï¼š"),a("a",Ma,[n("05ã€è·å–åˆ†ç±»è§„æ ¼å‚æ•° - è°·ç²’å•†åŸ - æ˜“æ–‡æ¡£ (easydoc.net)"),t(s)])]),Oa,a("p",null,[n("æ¥å£æ–‡æ¡£: "),a("a",Na,[n("09ã€è·å–åˆ†ç±»é”€å”®å±æ€§ - è°·ç²’å•†åŸ - æ˜“æ–‡æ¡£ (easydoc.net)"),t(s)])]),Va,a("p",null,[n("æ¥å£æ–‡æ¡£ï¼š"),a("a",Fa,[n("10ã€è·å–å±æ€§åˆ†ç»„çš„å…³è”çš„æ‰€æœ‰å±æ€§ - è°·ç²’å•†åŸ - æ˜“æ–‡æ¡£ (easydoc.net)"),t(s)])]),Ua,a("p",null,[n("æ¥å£æ–‡æ¡£ï¼š"),a("a",Wa,[n("12ã€åˆ é™¤å±æ€§ä¸åˆ†ç»„çš„å…³è”å…³ç³» - è°·ç²’å•†åŸ - æ˜“æ–‡æ¡£ (easydoc.net)"),t(s)])]),Qa,a("p",null,[n("æ¥å£åœ°å€ï¼š"),a("a",Ha,[n("13ã€è·å–å±æ€§åˆ†ç»„æ²¡æœ‰å…³è”çš„å…¶ä»–å±æ€§ - è°·ç²’å•†åŸ - æ˜“æ–‡æ¡£ (easydoc.net)"),t(s)])]),$a,a("p",null,[n("æ¥å£æ–‡æ¡£ï¼š"),a("a",Ka,[n("11ã€æ·»åŠ å±æ€§ä¸åˆ†ç»„å…³è”å…³ç³» - è°·ç²’å•†åŸ - æ˜“æ–‡æ¡£ (easydoc.net)"),t(s)])]),Xa,a("p",null,[n("url: "),a("a",Ja,[n("åœ¨çº¿JSONæ ¡éªŒæ ¼å¼åŒ–å·¥å…·ï¼ˆBe JSONï¼‰"),t(s)])]),Za])}const en=p(l,[["render",Ya],["__file","base2.html.vue"]]);export{en as default};
