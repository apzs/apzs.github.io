 

> ğŸŒ±æœ¬ä¸“æ å°†ä¼šä»åŸºç¡€å¼€å§‹ï¼Œå¾ªåºæ¸è¿›è®²è§£Nginxçš„ä½¿ç”¨å’Œæœ‰å…³é…ç½®ï¼Œä¹Ÿè¯·å¤§å®¶å¤šå¤šæ”¯æŒ,å¸Œæœ›å¤§å®¶éƒ½èƒ½å¤Ÿä»ä¸­è·ç›Šã€‚  
> ğŸ“«ä¸“æ åœ°å€:[Nginx](https://blog.csdn.net/learning_xzj/category_11792194.html)  
> ğŸ“«ç›¸å…³è½¯ä»¶:[é“¾æ¥åœ°å€](https://pan.baidu.com/s/12VmjEzxEKeiwrONceaWguA?pwd=aaaa)

### æ–‡ç« ç›®å½•

*   *   [ä½¿ç”¨é˜¿é‡Œäº‘é…ç½®https](#https_5)
    *   *   [å®æˆ˜](#_76)
    

ä½¿ç”¨é˜¿é‡Œäº‘é…ç½®https
------------

é˜¿é‡Œäº‘å…è´¹è¯ä¹¦è´­ä¹°åœ¨å¦‚ä¸‹ä½ç½®ï¼š

![image-20220502180114579](https://gitlab.com/apzs/image/-/raw/master/image/75623dc67cb36f649da95b78a7f74f99.png)

![image-20220502180214498](https://gitlab.com/apzs/image/-/raw/master/image/bd00fb70abe129333354572c660fb670.png)

![image-20220502180253209](https://gitlab.com/apzs/image/-/raw/master/image/2c71e7a6c02cabfde45431ed5a55ab77.png)

è´­ä¹°å®Œæˆååœ¨å¦‚ä¸‹ä½ç½®åˆ›å»ºè¯ä¹¦å¹¶ç”³è¯·è¯ä¹¦ï¼š

![image-20220502180721249](https://gitlab.com/apzs/image/-/raw/master/image/4fbf13f6e0e98049133f5d77a2f1400c.png)

å¡«å†™éªŒè¯ä¿¡æ¯

![image-20220502180746873](https://gitlab.com/apzs/image/-/raw/master/image/cf354daaeb3d26dffd0ec61949124689.png)

![image-20220502180905706](https://gitlab.com/apzs/image/-/raw/master/image/a0ebc865297fab463b6614082bfecbfb.png)

DNSå¯¹åº”çš„è®°å½•åœ¨å¦‚ä¸‹é¡µé¢ï¼š

![image-20220502185442580](https://gitlab.com/apzs/image/-/raw/master/image/6001a15ab5c5306a07fc66f0cb553a0c.png)

è¯ä¹¦ç­¾å‘åï¼Œé€‰æ‹©ä¸‹è½½ï¼š

![image-20220502185524886](https://gitlab.com/apzs/image/-/raw/master/image/916f5f7fd55308cd17034fc78b01f213.png)

![image-20220502185354484](https://gitlab.com/apzs/image/-/raw/master/image/303201c7b58e2977a24a0e7982935a9e.png)

ä¸‹è½½åçš„æ–‡ä»¶å¦‚å›¾æ‰€ç¤ºï¼š

![image-20220502185627427](https://gitlab.com/apzs/image/-/raw/master/image/46f5beab54d365cf6b2187c80eb607ae.png)

æ¥ä¸‹æ¥éœ€è¦å°†è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°nginxç›®å½•ä¸‹çš„confç›®å½•ä¸‹ï¼š

![image-20220502185843137](https://gitlab.com/apzs/image/-/raw/master/image/3c3b6a8a0d6cbdbfda5f446295d280b5.png)

nginxé…ç½®è¯ä¹¦ï¼š

```nginx
server {
	listen 443 ssl;
	server_name localhost;  # æ¥æ”¶æ‰€æœ‰è®¿é—®443ç«¯å£çš„è¯·æ±‚
	ssl_certificate 7706851_www.xzj520520.cn.pem;
	ssl_certificate_key 7706851_www.xzj520520.cn.key;
}
```


é…ç½®å®Œä¹‹åï¼Œé‡å¯nginx:

```nginx
systemctl restart nginx
```


ç”±äºhttpåè®®é»˜è®¤çš„ç«¯å£æ˜¯80ï¼Œè€Œhttpsé»˜è®¤çš„ç«¯å£æ˜¯443ï¼Œå¦‚æœæƒ³è®©httpçš„è®¿é—®è·³è½¬åˆ°httpsçš„è®¿é—®ï¼Œå¯ä»¥åšå¦‚ä¸‹é…ç½®ï¼š

```nginx
server {

	listen 80;
	server_name www.xzj520520.cn xzj520520.cn; # æ¢æˆè‡ªå·±çš„åŸŸå
	...

	return 301 https://$server_name$request_uri;	

}
```


è‡³æ­¤ï¼Œå·²ç»å®Œæˆhttpsçš„é…ç½®ã€‚

### å®æˆ˜

é…ç½®nginx.cfg

```nginx
user  www www;
worker_processes auto;
error_log  /www/wwwlogs/nginx_error.log  crit;
pid        /www/server/nginx/logs/nginx.pid;
worker_rlimit_nofile 51200;

events
    {
        use epoll;
        worker_connections 51200;
        multi_accept on;
    }

http
    {
        include       mime.types;

		include proxy.conf;

        default_type  application/octet-stream;

        server_names_hash_bucket_size 512;
        client_header_buffer_size 32k;
        large_client_header_buffers 4 32k;
        client_max_body_size 50m;

        sendfile   on;
        tcp_nopush on;

        keepalive_timeout 60;

        tcp_nodelay on;

        fastcgi_connect_timeout 300;
        fastcgi_send_timeout 300;
        fastcgi_read_timeout 300;
        fastcgi_buffer_size 64k;
        fastcgi_buffers 4 64k;
        fastcgi_busy_buffers_size 128k;
        fastcgi_temp_file_write_size 256k;
		fastcgi_intercept_errors on;

        gzip on;
        gzip_min_length  1k;
        gzip_buffers     4 16k;
        gzip_http_version 1.1;
        gzip_comp_level 2;
        gzip_types     text/plain application/javascript application/x-javascript text/javascript text/css application/xml;
        gzip_vary on;
        gzip_proxied   expired no-cache no-store private auth;
        gzip_disable   "MSIE [1-6]\.";

        limit_conn_zone $binary_remote_addr zone=perip:10m;
		limit_conn_zone $server_name zone=perserver:10m;

        server_tokens off;
        access_log off;

server {
	listen 443 ssl;
	server_name localhost;  
	ssl_certificate 7706851_www.xzj520520.cn.pem;
	ssl_certificate_key 7706851_www.xzj520520.cn.key;
	
	#é…ç½®æ ¹ç›®å½•ä»¥åŠé»˜è®¤é¡µé¢
        location / {
            root   html;
            index  index.html index.htm index.php;
        }

	#å‡ºé”™é¡µé¢é…ç½®
        error_page   500 502 503 504  /50x.html;
        #/50x.htmlæ–‡ä»¶æ‰€åœ¨ä½ç½®
        location = /50x.html {
            root   html;
        }
}

server {
	listen 80;
# 	server_name localhost www.xzj520520.cn xzj520520.cn; 
  server_name www.xzj520520.cn xzj520520.cn;

	# é‡å®šå‘ï¼Œä¼šæ˜¾ç¤ºè·³è½¬çš„åœ°å€server_name,å¦‚æœè®¿é—®çš„åœ°å€æ²¡æœ‰åŒ¹é…ä¼šé»˜è®¤ä½¿ç”¨ç¬¬ä¸€ä¸ªï¼Œå³www.xzj520520.cn
	return 301 https://$server_name$request_uri;	
}

}
```


è®¿é—®http://xzj520520.cn, å‘ç°è‡ªåŠ¨å˜æˆhttpsè®¿é—®ï¼š

![image-20220503091752269](https://gitlab.com/apzs/image/-/raw/master/image/debc77dd0c49471f9e9a2673179a2768.png)

è®¿é—®https://a.xzj520520.cn,æ˜¾ç¤ºå®‰å…¨æç¤ºé¡µé¢:

![image-20220503091912018](https://gitlab.com/apzs/image/-/raw/master/image/2b5395b8525d0e8d2b4cb517da2c3680.png)
