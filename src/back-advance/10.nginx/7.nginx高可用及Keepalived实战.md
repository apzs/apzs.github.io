 

> ğŸŒ±æœ¬ä¸“æ å°†ä¼šä»åŸºç¡€å¼€å§‹ï¼Œå¾ªåºæ¸è¿›è®²è§£Nginxçš„ä½¿ç”¨å’Œæœ‰å…³é…ç½®ï¼Œä¹Ÿè¯·å¤§å®¶å¤šå¤šæ”¯æŒ,å¸Œæœ›å¤§å®¶éƒ½èƒ½å¤Ÿä»ä¸­è·ç›Šã€‚  
> ğŸ“«ä¸“æ åœ°å€:[Nginx](https://blog.csdn.net/learning_xzj/category_11792194.html)  
> ğŸ“«ç›¸å…³è½¯ä»¶:[é“¾æ¥åœ°å€](https://pan.baidu.com/s/12VmjEzxEKeiwrONceaWguA?pwd=aaaa)

### æ–‡ç« ç›®å½•

*   *   [é«˜å¯ç”¨é…ç½®](#_5)
    *   *   [é«˜å¯ç”¨åœºæ™¯åŠè§£å†³æ–¹æ¡ˆ](#_7)
        *   [å®‰è£…keepalived](#keepalived_19)
        *   [keepalivedå®æˆ˜](#keepalived_32)

é«˜å¯ç”¨é…ç½®
-----

### é«˜å¯ç”¨åœºæ™¯åŠè§£å†³æ–¹æ¡ˆ

Keepalivedè½¯ä»¶èµ·åˆæ˜¯ä¸“ä¸º[LVSè´Ÿè½½å‡è¡¡](https://so.csdn.net/so/search?q=LVS%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1&spm=1001.2101.3001.7020)è½¯ä»¶è®¾è®¡çš„ï¼Œç”¨æ¥ç®¡ç†å¹¶ç›‘æ§LVSé›†ç¾¤ç³»ç»Ÿä¸­å„ä¸ªæœåŠ¡èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œåæ¥åˆåŠ å…¥äº†å¯ä»¥å®ç°é«˜å¯ç”¨çš„VRRPåŠŸèƒ½ã€‚å› æ­¤ï¼ŒKeepalivedé™¤äº†èƒ½å¤Ÿç®¡ç†LVSè½¯ä»¶å¤–ï¼Œè¿˜å¯ä»¥ä½œä¸ºå…¶ä»–æœåŠ¡ï¼ˆä¾‹å¦‚ï¼šNginxã€Haproxyã€MySQLç­‰ï¼‰çš„é«˜å¯ç”¨è§£å†³æ–¹æ¡ˆè½¯ä»¶ã€‚VRRPå‡ºç°çš„ç›®çš„å°±æ˜¯ä¸ºäº†è§£å†³é™æ€è·¯ç”±å•ç‚¹æ•…éšœé—®é¢˜çš„ï¼Œå®ƒèƒ½å¤Ÿä¿è¯å½“ä¸ªåˆ«èŠ‚ç‚¹å®•æœºæ—¶ï¼Œæ•´ä¸ªç½‘ç»œå¯ä»¥ä¸é—´æ–­åœ°è¿è¡Œã€‚æ‰€ä»¥ï¼ŒKeepalived ä¸€æ–¹é¢å…·æœ‰é…ç½®ç®¡ç†LVSçš„åŠŸèƒ½ï¼ŒåŒæ—¶è¿˜å…·æœ‰å¯¹LVSä¸‹é¢èŠ‚ç‚¹è¿›è¡Œå¥åº·æ£€æŸ¥çš„åŠŸèƒ½ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¯å®ç°ç³»ç»Ÿç½‘ç»œæœåŠ¡çš„é«˜å¯ç”¨åŠŸèƒ½ã€‚

keepalivedå®˜ç½‘[http://www.keepalived.org](http://www.keepalived.org/)

keepalivedæœåŠ¡çš„ä¸‰ä¸ªé‡è¦åŠŸèƒ½ï¼š

*   ç®¡ç†LVSè´Ÿè½½å‡è¡¡è½¯ä»¶
*   å®ç°LVSé›†ç¾¤èŠ‚ç‚¹çš„å¥åº·æ£€æŸ¥ä¸­
*   ä½œä¸ºç³»ç»Ÿç½‘ç»œæœåŠ¡çš„é«˜å¯ç”¨æ€§ï¼ˆfailoverï¼‰

### å®‰è£…keepalived

centoså®‰è£…å‘½ä»¤ï¼š

```bash
 yum install -y keepalived
```


å®‰è£…æˆåŠŸçš„æˆªå›¾å¦‚ä¸‹ï¼š

![afdas](https://gitlab.com/apzs/image/-/raw/master/image/e07cd9f9164d4c7fb452a6f6d47b2ee7.png)

### keepalivedå®æˆ˜

keepalivedçš„é…ç½®æ–‡ä»¶åœ¨å¦‚ä¸‹ä½ç½®ï¼š

![image-20220501200719615](https://gitlab.com/apzs/image/-/raw/master/image/26e162a6aac3208c0a9d3d647360587a.png)

åœ¨è¯¥å®æˆ˜ä¸­ï¼Œ101ä¸ºä¸»nginxï¼Œ102ä¸ºå¤‡ç”¨æœºï¼Œé¦–å…ˆéœ€è¦ä¿®æ”¹101å’Œ102çš„keepalived.confé…ç½®

101çš„keepalived.confé…ç½®

    ! Configuration File for keepalived
    
    global_defs {
       router_id LB_102
    }
    
    vrrp_instance VI_102 {
        state MASTER
        interface ens33
        virtual_router_id 51
        priority 100
        advert_int 1
        authentication {
            auth_type PASS
            auth_pass 1111
        }
        virtual_ipaddress {
            192.168.8.200
        }
    }


 ä½¿ç”¨systemctl start keepalivedå¯åŠ¨keepalived,æŸ¥çœ‹ipå‘ç°å¤šäº†è™šæ‹Ÿip192.168.8.200:

![image-20220501202555004](https://gitlab.com/apzs/image/-/raw/master/image/cff83eadf4e88eadbba6ee03bbaf7ad5.png)

interface ens33è¿™é‡Œçš„ens33éœ€è¦å’Œä»¥ä¸‹ä½ç½®å¯¹åº”:

![image-20220501201254706](https://gitlab.com/apzs/image/-/raw/master/image/de70295e96ff2cf132e55c46f26385d9.png)

102çš„keepalived.confé…ç½®

    ! Configuration File for keepalived
    
    global_defs {
       router_id LB_101
    }
    
    vrrp_instance VI_102 {
        state BACKUP
        interface ens33
        virtual_router_id 51
        priority 50
        advert_int 1
        authentication {
            auth_type PASS
            auth_pass 1111
        }
        virtual_ipaddress {
            192.168.8.200
        }
    }


  ä½¿ç”¨systemctl start keepalivedå¯åŠ¨keepalived

![image-20220501203202864](https://gitlab.com/apzs/image/-/raw/master/image/1212604f8cb45321ad014afdef6291cd.png)

è®¿é—® 162.168.8.200ï¼š

![image-20220501203541619](https://gitlab.com/apzs/image/-/raw/master/image/52a00837a626c36afbcde5352a88f22d.png)

å…³é—­102ï¼Œå†æ¬¡è®¿é—®192.168.8.200ï¼š

![image-20220501203753748](https://gitlab.com/apzs/image/-/raw/master/image/ffb724e72e13607410c6c23e9beb797b.png)

ç”±äºå›¾ç‰‡èµ„æºå­˜æ”¾åœ¨102ä¸Šï¼Œé€šè¿‡192.168.8.200è®¿é—®åˆ°çš„ä¸»æœºæ˜¯102ï¼Œæ‰€ä»¥èƒŒæ™¯æ˜¯ç©ºç™½ï¼Œæ²¡æœ‰è®¿é—®åˆ°é™æ€èµ„æºï¼Œkeepalivedé…ç½®æˆåŠŸã€‚
