 

> ğŸŒ±æœ¬ä¸“æ å°†ä¼šä»åŸºç¡€å¼€å§‹ï¼Œå¾ªåºæ¸è¿›è®²è§£[Nginx](https://so.csdn.net/so/search?q=Nginx&spm=1001.2101.3001.7020)çš„ä½¿ç”¨å’Œæœ‰å…³é…ç½®ï¼Œä¹Ÿè¯·å¤§å®¶å¤šå¤šæ”¯æŒ,å¸Œæœ›å¤§å®¶éƒ½èƒ½å¤Ÿä»ä¸­è·ç›Šã€‚  
> ğŸ“«ä¸“æ åœ°å€:[Nginx](https://blog.csdn.net/learning_xzj/category_11792194.html)  
> ğŸ“«ç›¸å…³è½¯ä»¶:[é“¾æ¥åœ°å€](https://pan.baidu.com/s/12VmjEzxEKeiwrONceaWguA?pwd=aaaa)

### æ–‡ç« ç›®å½•

*   *   [Nginxç›®å½•ç»“æ„](#Nginx_5)
    *   [NginxåŸºæœ¬è¿è¡ŒåŸç†](#Nginx_70)
    *   [Nginxçš„åŸºæœ¬é…ç½®æ–‡ä»¶](#Nginx_76)

Nginxç›®å½•ç»“æ„
---------

![image-20220429195500124](https://gitlab.com/apzs/image/-/raw/master/image/4a778a190221c045365d48b1c5a454b2.png)

```bash
[root@localhost ~]# tree /usr/local/nginx
/usr/local/nginx
â”œâ”€â”€ client_body_temp                 # POST å¤§æ–‡ä»¶æš‚å­˜ç›®å½•
â”œâ”€â”€ conf                             # Nginxæ‰€æœ‰é…ç½®æ–‡ä»¶çš„ç›®å½•
â”‚   â”œâ”€â”€ fastcgi.conf                 # fastcgiç›¸å…³å‚æ•°çš„é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ fastcgi.conf.default         # fastcgi.confçš„åŸå§‹å¤‡ä»½æ–‡ä»¶
â”‚   â”œâ”€â”€ fastcgi_params               # fastcgiçš„å‚æ•°æ–‡ä»¶
â”‚   â”œâ”€â”€ fastcgi_params.default       
â”‚   â”œâ”€â”€ koi-utf
â”‚   â”œâ”€â”€ koi-win
â”‚   â”œâ”€â”€ mime.types                   # åª’ä½“ç±»å‹
â”‚   â”œâ”€â”€ mime.types.default
â”‚   â”œâ”€â”€ nginx.conf                   #è¿™æ˜¯Nginxé»˜è®¤çš„ä¸»é…ç½®æ–‡ä»¶ï¼Œæ—¥å¸¸ä½¿ç”¨å’Œä¿®æ”¹çš„æ–‡ä»¶
â”‚   â”œâ”€â”€ nginx.conf.default
â”‚   â”œâ”€â”€ scgi_params                  # scgiç›¸å…³å‚æ•°æ–‡ä»¶
â”‚   â”œâ”€â”€ scgi_params.default  
â”‚   â”œâ”€â”€ uwsgi_params                 # uwsgiç›¸å…³å‚æ•°æ–‡ä»¶
â”‚   â”œâ”€â”€ uwsgi_params.default
â”‚   â””â”€â”€ win-utf
â”œâ”€â”€ fastcgi_temp                     # fastcgiä¸´æ—¶æ•°æ®ç›®å½•
â”œâ”€â”€ html                             # Nginxé»˜è®¤ç«™ç‚¹ç›®å½•
â”‚   â”œâ”€â”€ 50x.html                     # é”™è¯¯é¡µé¢ä¼˜é›…æ›¿ä»£æ˜¾ç¤ºæ–‡ä»¶ï¼Œä¾‹å¦‚å‡ºç°502é”™è¯¯æ—¶ä¼šè°ƒç”¨æ­¤é¡µé¢
â”‚   â””â”€â”€ index.html                   # é»˜è®¤çš„é¦–é¡µæ–‡ä»¶
â”œâ”€â”€ logs                             # Nginxæ—¥å¿—ç›®å½•
â”‚   â”œâ”€â”€ access.log                   # è®¿é—®æ—¥å¿—æ–‡ä»¶
â”‚   â”œâ”€â”€ error.log                    # é”™è¯¯æ—¥å¿—æ–‡ä»¶
â”‚   â””â”€â”€ nginx.pid                    # pidæ–‡ä»¶ï¼ŒNginxè¿›ç¨‹å¯åŠ¨åï¼Œä¼šæŠŠæ‰€æœ‰è¿›ç¨‹çš„IDå·å†™åˆ°æ­¤æ–‡ä»¶
â”œâ”€â”€ proxy_temp                       # ä¸´æ—¶ç›®å½•
â”œâ”€â”€ sbin                             # Nginx å¯æ‰§è¡Œæ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ nginx                        # Nginx äºŒè¿›åˆ¶å¯æ‰§è¡Œç¨‹åº
â”œâ”€â”€ scgi_temp                        # ä¸´æ—¶ç›®å½•
â””â”€â”€ uwsgi_temp                       # ä¸´æ—¶ç›®å½•
```


ä¸»è¦çš„ç›®å½•æ˜¯conf,html,åŠsbinã€‚

*   confç›®å½•æ”¾çš„æ˜¯æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼š

![image-20220429200035684](https://gitlab.com/apzs/image/-/raw/master/image/27af4b92ca67eb0b67bbf799fcedc5b6.png)

*   htmlç›®å½•æ”¾çš„æ˜¯é™æ€é¡µé¢ï¼š

![image-20220429200014255](https://gitlab.com/apzs/image/-/raw/master/image/a0536acedc8bd3bf6160a01cd0f88f92.png)

50x.htmlæ˜¯å‘ç”Ÿé”™è¯¯å±•ç¤ºçš„é¡µé¢ï¼Œindex.htmlæ˜¯é»˜è®¤çš„è®¿é—®é¡µé¢ã€‚å¯ä»¥åœ¨è¯¥ç›®å½•ä¸‹æ–°å»ºhtmlï¼Œç„¶ååœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼Œä¾‹å¦‚åœ¨è¯¥ç›®å½•ä¸‹æ–°å»ºhello.htmlï¼Œå†…å®¹æ˜¯helloï¼Œç„¶åè®¿é—®ï¼šhttp://192.168.8.101/hello.htmlï¼Œç»“æœå¦‚ä¸‹ï¼š

![image-20220429200252678](https://gitlab.com/apzs/image/-/raw/master/image/8ef3f32251347e137b0271d853def339.png)

*   logsæ–‡ä»¶å¤¹ç”¨äºå­˜æ”¾æ—¥å¿—ä¿¡æ¯ï¼š

![image-20220429200510783](https://gitlab.com/apzs/image/-/raw/master/image/8be7daeb79647a2c142f5062d4fd72a4.png)

error.logå­˜æ”¾å‡ºé”™çš„ä¿¡æ¯ï¼Œnginx.pidå­˜æ”¾çš„æ˜¯å½“å‰nginxçš„pidã€‚

*   sbinå­˜æ”¾çš„æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥ç”¨ ./nginxå¯åŠ¨nginxï¼š

![image-20220429200833528](https://gitlab.com/apzs/image/-/raw/master/image/99ad10f00dcf3df4925e8e1e41d00ee3.png)

NginxåŸºæœ¬è¿è¡ŒåŸç†
-----------

![image-20220429201217315](https://gitlab.com/apzs/image/-/raw/master/image/18cb3d8e9aa7d44b2e1e5f3c54231fab.png)

Nginxçš„è¿›ç¨‹æ˜¯ä½¿ç”¨ç»å…¸çš„ã€ŒMaster-Workerã€æ¨¡å‹,Nginxåœ¨å¯åŠ¨åï¼Œä¼šæœ‰ä¸€ä¸ªmasterè¿›ç¨‹å’Œå¤šä¸ªworkerè¿›ç¨‹ã€‚masterè¿›ç¨‹ä¸»è¦ç”¨æ¥ç®¡ç†workerè¿›ç¨‹ï¼ŒåŒ…å«ï¼šæ¥æ”¶æ¥è‡ªå¤–ç•Œçš„ä¿¡å·ï¼Œå‘å„workerè¿›ç¨‹å‘é€ä¿¡å·ï¼Œç›‘æ§workerè¿›ç¨‹çš„è¿è¡ŒçŠ¶æ€ï¼Œå½“workerè¿›ç¨‹é€€å‡ºå(å¼‚å¸¸æƒ…å†µä¸‹)ï¼Œä¼šè‡ªåŠ¨é‡æ–°å¯åŠ¨æ–°çš„workerè¿›ç¨‹ã€‚workerè¿›ç¨‹ä¸»è¦å¤„ç†åŸºæœ¬çš„ç½‘ç»œäº‹ä»¶ï¼Œå¤šä¸ªworkerè¿›ç¨‹ä¹‹é—´æ˜¯å¯¹ç­‰çš„ï¼Œä»–ä»¬åŒç­‰ç«äº‰æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå„è¿›ç¨‹äº’ç›¸ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ã€‚ä¸€ä¸ªè¯·æ±‚ï¼Œåªå¯èƒ½åœ¨ä¸€ä¸ªworkerè¿›ç¨‹ä¸­å¤„ç†ï¼Œä¸€ä¸ªworkerè¿›ç¨‹ï¼Œä¸å¯èƒ½å¤„ç†å…¶å®ƒè¿›ç¨‹çš„è¯·æ±‚ã€‚workerè¿›ç¨‹çš„ä¸ªæ•°æ˜¯å¯ä»¥è®¾ç½®çš„ï¼Œä¸€èˆ¬ä¼šè®¾ç½®ä¸æœºå™¨cpuæ ¸æ•°ä¸€è‡´ï¼Œè¿™é‡Œé¢çš„åŸå› ä¸nginxçš„è¿›ç¨‹æ¨¡å‹ä»¥åŠäº‹ä»¶å¤„ç†æ¨¡å‹æ˜¯åˆ†ä¸å¼€çš„ã€‚

Nginxçš„åŸºæœ¬é…ç½®æ–‡ä»¶
------------

Nginxçš„é»˜è®¤é…ç½®æ–‡ä»¶æ˜¯nginx.conf

![image-20220429202028274](https://gitlab.com/apzs/image/-/raw/master/image/9587854b59d7ba64ca9a09eaaef0f53c.png)

åˆšå®‰è£…å¥½çš„nginx.confå¦‚ä¸‹ï¼š

```nginx
#user  nobody;
worker_processes  1;

#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

#pid        logs/nginx.pid;


events {
    worker_connections  1024;
}


http {
    include       mime.types;
    default_type  application/octet-stream;

    #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
    #                  '$status $body_bytes_sent "$http_referer" '
    #                  '"$http_user_agent" "$http_x_forwarded_for"';

    #access_log  logs/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  65;

    #gzip  on;

    server {
        listen       80;
        server_name  localhost;

        #charset koi8-r;

        #access_log  logs/host.access.log  main;

        location / {
            root   html;
            index  index.html index.htm;
        }

        #error_page  404              /404.html;

        # redirect server error pages to the static page /50x.html
        #
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }

        # proxy the PHP scripts to Apache listening on 127.0.0.1:80
        #
        #location ~ \.php$ {
        #    proxy_pass   http://127.0.0.1;
        #}

        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
        #
        #location ~ \.php$ {
        #    root           html;
        #    fastcgi_pass   127.0.0.1:9000;
        #    fastcgi_index  index.php;
        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
        #    include        fastcgi_params;
        #}

        # deny access to .htaccess files, if Apache's document root
        # concurs with nginx's one
        #
        #location ~ /\.ht {
        #    deny  all;
        #}
    }


    # another virtual host using mix of IP-, name-, and port-based configuration
    #
    #server {
    #    listen       8000;
    #    listen       somename:8080;
    #    server_name  somename  alias  another.alias;

    #    location / {
    #        root   html;
    #        index  index.html index.htm;
    #    }
    #}


    # HTTPS server
    #
    #server {
    #    listen       443 ssl;
    #    server_name  localhost;

    #    ssl_certificate      cert.pem;
    #    ssl_certificate_key  cert.key;

    #    ssl_session_cache    shared:SSL:1m;
    #    ssl_session_timeout  5m;

    #    ssl_ciphers  HIGH:!aNULL:!MD5;
    #    ssl_prefer_server_ciphers  on;

    #    location / {
    #        root   html;
    #        index  index.html index.htm;
    #    }
    #}

}
```

 å»æ‰æ³¨é‡Šçš„ç®€å•ç‰ˆå¦‚ä¸‹ï¼š

```nginx
worker_processes  1; #å…è®¸è¿›ç¨‹æ•°é‡ï¼Œå»ºè®®è®¾ç½®ä¸ºcpuæ ¸å¿ƒæ•°æˆ–è€…autoè‡ªåŠ¨æ£€æµ‹ï¼Œæ³¨æ„WindowsæœåŠ¡å™¨ä¸Šè™½ç„¶å¯ä»¥å¯åŠ¨å¤šä¸ªprocessesï¼Œä½†æ˜¯å®é™…åªä¼šç”¨å…¶ä¸­ä¸€ä¸ª

events {
    #å•ä¸ªè¿›ç¨‹æœ€å¤§è¿æ¥æ•°ï¼ˆæœ€å¤§è¿æ¥æ•°=è¿æ¥æ•°*è¿›ç¨‹æ•°ï¼‰
    #æ ¹æ®ç¡¬ä»¶è°ƒæ•´ï¼Œå’Œå‰é¢å·¥ä½œè¿›ç¨‹é…åˆèµ·æ¥ç”¨ï¼Œå°½é‡å¤§ï¼Œä½†æ˜¯åˆ«æŠŠcpuè·‘åˆ°100%å°±è¡Œã€‚
    worker_connections  1024;
}


http {
    #æ–‡ä»¶æ‰©å±•åä¸æ–‡ä»¶ç±»å‹æ˜ å°„è¡¨(æ˜¯confç›®å½•ä¸‹çš„ä¸€ä¸ªæ–‡ä»¶)
    include       mime.types;
    #é»˜è®¤æ–‡ä»¶ç±»å‹ï¼Œå¦‚æœmime.typesé¢„å…ˆå®šä¹‰çš„ç±»å‹æ²¡åŒ¹é…ä¸Šï¼Œé»˜è®¤ä½¿ç”¨äºŒè¿›åˆ¶æµçš„æ–¹å¼ä¼ è¾“
    default_type  application/octet-stream;

    #sendfileæŒ‡ä»¤æŒ‡å®šnginxæ˜¯å¦è°ƒç”¨sendfile å‡½æ•°ï¼ˆzero copy æ–¹å¼ï¼‰æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨ï¼Œå¿…é¡»è®¾ä¸ºonã€‚å¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸ºoffï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œIOå¤„ç†é€Ÿåº¦ã€‚
    sendfile        on;
    
     #é•¿è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ˜¯ç§’
    keepalive_timeout  65;

 #è™šæ‹Ÿä¸»æœºçš„é…ç½®
    server {
    #ç›‘å¬ç«¯å£
        listen       80;
        #åŸŸåï¼Œå¯ä»¥æœ‰å¤šä¸ªï¼Œç”¨ç©ºæ ¼éš”å¼€
        server_name  localhost;

	#é…ç½®æ ¹ç›®å½•ä»¥åŠé»˜è®¤é¡µé¢
        location / {
            root   html;
            index  index.html index.htm;
        }

	#å‡ºé”™é¡µé¢é…ç½®
        error_page   500 502 503 504  /50x.html;
        #/50x.htmlæ–‡ä»¶æ‰€åœ¨ä½ç½®
        location = /50x.html {
            root   html;
        }
        
    }

}
```
